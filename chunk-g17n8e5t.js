var xL=Object.create;var{getPrototypeOf:qL,defineProperty:BY,getOwnPropertyNames:ZL}=Object;var YL=Object.prototype.hasOwnProperty;var o5=(g,x,Y)=>{Y=g!=null?xL(qL(g)):{};let G=x||!g||!g.__esModule?BY(Y,"default",{value:g,enumerable:!0}):Y;for(let U of ZL(g))if(!YL.call(G,U))BY(G,U,{get:()=>g[U],enumerable:!0});return G};var Nx=(g,x)=>()=>(x||g((x={exports:{}}).exports,x),x.exports);var HH=(g,x)=>{for(var Y in x)BY(g,Y,{get:x[Y],enumerable:!0,configurable:!0,set:(G)=>x[Y]=()=>G})};var AY=(g,x)=>()=>(g&&(x=g(g=0)),x);var Z3=Nx((KL)=>{var QY=Symbol.for("react.transitional.element"),kL=Symbol.for("react.portal"),vL=Symbol.for("react.fragment"),JL=Symbol.for("react.strict_mode"),GL=Symbol.for("react.profiler"),HL=Symbol.for("react.consumer"),UL=Symbol.for("react.context"),BL=Symbol.for("react.forward_ref"),AL=Symbol.for("react.suspense"),ML=Symbol.for("react.memo"),XH=Symbol.for("react.lazy"),XL=Symbol.for("react.activity"),UH=Symbol.iterator;function QL(g){if(g===null||typeof g!=="object")return null;return g=UH&&g[UH]||g["@@iterator"],typeof g==="function"?g:null}var QH={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},VH=Object.assign,LH={};function jw(g,x,Y){this.props=g,this.context=x,this.refs=LH,this.updater=Y||QH}jw.prototype.isReactComponent={};jw.prototype.setState=function(g,x){if(typeof g!=="object"&&typeof g!=="function"&&g!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,g,x,"setState")};jw.prototype.forceUpdate=function(g){this.updater.enqueueForceUpdate(this,g,"forceUpdate")};function WH(){}WH.prototype=jw.prototype;function VY(g,x,Y){this.props=g,this.context=x,this.refs=LH,this.updater=Y||QH}var LY=VY.prototype=new WH;LY.constructor=VY;VH(LY,jw.prototype);LY.isPureReactComponent=!0;var BH=Array.isArray;function XY(){}var C5={H:null,A:null,T:null,S:null},hH=Object.prototype.hasOwnProperty;function WY(g,x,Y){var G=Y.ref;return{$$typeof:QY,type:g,key:x,ref:G!==void 0?G:null,props:Y}}function VL(g,x){return WY(g.type,x,g.props)}function hY(g){return typeof g==="object"&&g!==null&&g.$$typeof===QY}function LL(g){var x={"=":"=0",":":"=2"};return"$"+g.replace(/[=:]/g,function(Y){return x[Y]})}var AH=/\/+/g;function MY(g,x){return typeof g==="object"&&g!==null&&g.key!=null?LL(""+g.key):x.toString(36)}function WL(g){switch(g.status){case"fulfilled":return g.value;case"rejected":throw g.reason;default:switch(typeof g.status==="string"?g.then(XY,XY):(g.status="pending",g.then(function(x){g.status==="pending"&&(g.status="fulfilled",g.value=x)},function(x){g.status==="pending"&&(g.status="rejected",g.reason=x)})),g.status){case"fulfilled":return g.value;case"rejected":throw g.reason}}throw g}function $w(g,x,Y,G,U){var Z=typeof g;if(Z==="undefined"||Z==="boolean")g=null;var l=!1;if(g===null)l=!0;else switch(Z){case"bigint":case"string":case"number":l=!0;break;case"object":switch(g.$$typeof){case QY:case kL:l=!0;break;case XH:return l=g._init,$w(l(g._payload),x,Y,G,U)}}if(l)return U=U(g),l=G===""?"."+MY(g,0):G,BH(U)?(Y="",l!=null&&(Y=l.replace(AH,"$&/")+"/"),$w(U,x,Y,"",function(w1){return w1})):U!=null&&(hY(U)&&(U=VL(U,Y+(U.key==null||g&&g.key===U.key?"":(""+U.key).replace(AH,"$&/")+"/")+l)),x.push(U)),1;l=0;var N=G===""?".":G+":";if(BH(g))for(var P=0;P<g.length;P++)G=g[P],Z=N+MY(G,P),l+=$w(G,x,Y,Z,U);else if(P=QL(g),typeof P==="function")for(g=P.call(g),P=0;!(G=g.next()).done;)G=G.value,Z=N+MY(G,P++),l+=$w(G,x,Y,Z,U);else if(Z==="object"){if(typeof g.then==="function")return $w(WL(g),x,Y,G,U);throw x=String(g),Error("Objects are not valid as a React child (found: "+(x==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":x)+"). If you meant to render a collection of children, use an array instead.")}return l}function Ix(g,x,Y){if(g==null)return g;var G=[],U=0;return $w(g,G,"","",function(Z){return x.call(Y,Z,U++)}),G}function hL(g){if(g._status===-1){var x=g._result;x=x(),x.then(function(Y){if(g._status===0||g._status===-1)g._status=1,g._result=Y},function(Y){if(g._status===0||g._status===-1)g._status=2,g._result=Y}),g._status===-1&&(g._status=0,g._result=x)}if(g._status===1)return g._result.default;throw g._result}var MH=typeof reportError==="function"?reportError:function(g){if(typeof window==="object"&&typeof window.ErrorEvent==="function"){var x=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof g==="object"&&g!==null&&typeof g.message==="string"?String(g.message):String(g),error:g});if(!window.dispatchEvent(x))return}else if(typeof process==="object"&&typeof process.emit==="function"){process.emit("uncaughtException",g);return}console.error(g)},FL={map:Ix,forEach:function(g,x,Y){Ix(g,function(){x.apply(this,arguments)},Y)},count:function(g){var x=0;return Ix(g,function(){x++}),x},toArray:function(g){return Ix(g,function(x){return x})||[]},only:function(g){if(!hY(g))throw Error("React.Children.only expected to receive a single React element child.");return g}};KL.Activity=XL;KL.Children=FL;KL.Component=jw;KL.Fragment=vL;KL.Profiler=GL;KL.PureComponent=VY;KL.StrictMode=JL;KL.Suspense=AL;KL.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C5;KL.__COMPILER_RUNTIME={__proto__:null,c:function(g){return C5.H.useMemoCache(g)}};KL.cache=function(g){return function(){return g.apply(null,arguments)}};KL.cacheSignal=function(){return null};KL.cloneElement=function(g,x,Y){if(g===null||g===void 0)throw Error("The argument must be a React element, but you passed "+g+".");var G=VH({},g.props),U=g.key;if(x!=null)for(Z in x.key!==void 0&&(U=""+x.key),x)!hH.call(x,Z)||Z==="key"||Z==="__self"||Z==="__source"||Z==="ref"&&x.ref===void 0||(G[Z]=x[Z]);var Z=arguments.length-2;if(Z===1)G.children=Y;else if(1<Z){for(var l=Array(Z),N=0;N<Z;N++)l[N]=arguments[N+2];G.children=l}return WY(g.type,U,G)};KL.createContext=function(g){return g={$$typeof:UL,_currentValue:g,_currentValue2:g,_threadCount:0,Provider:null,Consumer:null},g.Provider=g,g.Consumer={$$typeof:HL,_context:g},g};KL.createElement=function(g,x,Y){var G,U={},Z=null;if(x!=null)for(G in x.key!==void 0&&(Z=""+x.key),x)hH.call(x,G)&&G!=="key"&&G!=="__self"&&G!=="__source"&&(U[G]=x[G]);var l=arguments.length-2;if(l===1)U.children=Y;else if(1<l){for(var N=Array(l),P=0;P<l;P++)N[P]=arguments[P+2];U.children=N}if(g&&g.defaultProps)for(G in l=g.defaultProps,l)U[G]===void 0&&(U[G]=l[G]);return WY(g,Z,U)};KL.createRef=function(){return{current:null}};KL.forwardRef=function(g){return{$$typeof:BL,render:g}};KL.isValidElement=hY;KL.lazy=function(g){return{$$typeof:XH,_payload:{_status:-1,_result:g},_init:hL}};KL.memo=function(g,x){return{$$typeof:ML,type:g,compare:x===void 0?null:x}};KL.startTransition=function(g){var x=C5.T,Y={};C5.T=Y;try{var G=g(),U=C5.S;U!==null&&U(Y,G),typeof G==="object"&&G!==null&&typeof G.then==="function"&&G.then(XY,MH)}catch(Z){MH(Z)}finally{x!==null&&Y.types!==null&&(x.types=Y.types),C5.T=x}};KL.unstable_useCacheRefresh=function(){return C5.H.useCacheRefresh()};KL.use=function(g){return C5.H.use(g)};KL.useActionState=function(g,x,Y){return C5.H.useActionState(g,x,Y)};KL.useCallback=function(g,x){return C5.H.useCallback(g,x)};KL.useContext=function(g){return C5.H.useContext(g)};KL.useDebugValue=function(){};KL.useDeferredValue=function(g,x){return C5.H.useDeferredValue(g,x)};KL.useEffect=function(g,x){return C5.H.useEffect(g,x)};KL.useEffectEvent=function(g){return C5.H.useEffectEvent(g)};KL.useId=function(){return C5.H.useId()};KL.useImperativeHandle=function(g,x,Y){return C5.H.useImperativeHandle(g,x,Y)};KL.useInsertionEffect=function(g,x){return C5.H.useInsertionEffect(g,x)};KL.useLayoutEffect=function(g,x){return C5.H.useLayoutEffect(g,x)};KL.useMemo=function(g,x){return C5.H.useMemo(g,x)};KL.useOptimistic=function(g,x){return C5.H.useOptimistic(g,x)};KL.useReducer=function(g,x,Y){return C5.H.useReducer(g,x,Y)};KL.useRef=function(g){return C5.H.useRef(g)};KL.useState=function(g){return C5.H.useState(g)};KL.useSyncExternalStore=function(g,x,Y){return C5.H.useSyncExternalStore(g,x,Y)};KL.useTransition=function(){return C5.H.useTransition()};KL.version="19.2.0"});function KY(g,x){var Y=g.length;g.push(x);w:for(;0<Y;){var G=Y-1>>>1,U=g[G];if(0<Sx(U,x))g[G]=x,g[Y]=U,Y=G;else break w}}function q7(g){return g.length===0?null:g[0]}function _x(g){if(g.length===0)return null;var x=g[0],Y=g.pop();if(Y!==x){g[0]=Y;w:for(var G=0,U=g.length,Z=U>>>1;G<Z;){var l=2*(G+1)-1,N=g[l],P=l+1,w1=g[P];if(0>Sx(N,Y))P<U&&0>Sx(w1,N)?(g[G]=w1,g[P]=Y,G=P):(g[G]=N,g[l]=Y,G=l);else if(P<U&&0>Sx(w1,Y))g[G]=w1,g[P]=Y,G=P;else break w}}return x}function Sx(g,x){var Y=g.sortIndex-x.sortIndex;return Y!==0?Y:g.id-x.id}function jx(g){for(var x=q7(P6);x!==null;){if(x.callback===null)_x(P6);else if(x.startTime<=g)_x(P6),x.sortIndex=x.expirationTime,KY(P7,x);else break;x=q7(P6)}}function yY(g){if(ag=!1,jx(g),!cg)if(q7(P7)!==null)cg=!0,_w||(_w=!0,mw());else{var x=q7(P6);x!==null&&RY(yY,x.startTime-g)}}function DH(){return OY?!0:Z7()-CH<BW?!1:!0}function FY(){if(OY=!1,_w){var g=Z7();CH=g;var x=!0;try{w:{cg=!1,ag&&(ag=!1,lH(rg),rg=-1),DY=!0;var Y=$x;try{b:{jx(g);for(G4=q7(P7);G4!==null&&!(G4.expirationTime>g&&DH());){var G=G4.callback;if(typeof G==="function"){G4.callback=null,$x=G4.priorityLevel;var U=G(G4.expirationTime<=g);if(g=Z7(),typeof U==="function"){G4.callback=U,jx(g),x=!0;break b}G4===q7(P7)&&_x(P7),jx(g)}else _x(P7);G4=q7(P7)}if(G4!==null)x=!0;else{var Z=q7(P6);Z!==null&&RY(yY,Z.startTime-g),x=!1}}break w}finally{G4=null,$x=Y,DY=!1}x=void 0}}finally{x?mw():_w=!1}}}function RY(g,x){rg=KH(function(){g(Z7())},x)}var Z7=void 0,lY,Tx,CY,P7,P6,UW=1,G4=null,$x=3,DY=!1,cg=!1,ag=!1,OY=!1,KH,lH,FH,_w=!1,rg=-1,BW=5,CH=-1,mw,mx,dY,NY=5,IY=1,SY=4,Pw=3,TY=2,$Y=function(g){g.callback=null},jY=function(){return $x},mY=function(){OY=!0},Ew=function(g,x,Y){var G=Z7();switch(typeof Y==="object"&&Y!==null?(Y=Y.delay,Y=typeof Y==="number"&&0<Y?G+Y:G):Y=G,g){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5000}return U=Y+U,g={id:UW++,callback:x,priorityLevel:g,startTime:Y,expirationTime:U,sortIndex:-1},Y>G?(g.sortIndex=Y,KY(P6,g),q7(P7)===null&&g===q7(P6)&&(ag?(lH(rg),rg=-1):ag=!0,RY(yY,Y-G))):(g.sortIndex=U,KY(P7,g),cg||DY||(cg=!0,_w||(_w=!0,mw()))),g},_Y;var dH=AY(()=>{if(typeof performance==="object"&&typeof performance.now==="function")lY=performance,Z7=function(){return lY.now()};else Tx=Date,CY=Tx.now(),Z7=function(){return Tx.now()-CY};P7=[],P6=[],KH=typeof setTimeout==="function"?setTimeout:null,lH=typeof clearTimeout==="function"?clearTimeout:null,FH=typeof setImmediate<"u"?setImmediate:null;if(typeof FH==="function")mw=function(){FH(FY)};else if(typeof MessageChannel<"u")mx=new MessageChannel,dY=mx.port2,mx.port1.onmessage=FY,mw=function(){dY.postMessage(null)};else mw=function(){KH(FY,0)};_Y=DH});var PY={};HH(PY,{version:()=>cH,useFormStatus:()=>pH,useFormState:()=>uH,unstable_batchedUpdates:()=>EH,requestFormReset:()=>PH,preloadModule:()=>_H,preload:()=>mH,preinitModule:()=>jH,preinit:()=>$H,prefetchDNS:()=>TH,preconnect:()=>SH,flushSync:()=>IH,createPortal:()=>NH,__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE:()=>RH});function yH(g){var x="https://react.dev/errors/"+g;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var Y=2;Y<arguments.length;Y++)x+="&args[]="+encodeURIComponent(arguments[Y])}return"Minified React error #"+g+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function E6(){}function XW(g,x,Y){var G=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:MW,key:G==null?null:""+G,children:g,containerInfo:x,implementation:Y}}function Px(g,x){if(g==="font")return"";if(typeof x==="string")return x==="use-credentials"?x:""}var OH,M3,MW,og,RH,NH=function(g,x){var Y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(yH(299));return XW(g,x,null,Y)},IH=function(g){var x=og.T,Y=M3.p;try{if(og.T=null,M3.p=2,g)return g()}finally{og.T=x,M3.p=Y,M3.d.f()}},SH=function(g,x){typeof g==="string"&&(x?(x=x.crossOrigin,x=typeof x==="string"?x==="use-credentials"?x:"":void 0):x=null,M3.d.C(g,x))},TH=function(g){typeof g==="string"&&M3.d.D(g)},$H=function(g,x){if(typeof g==="string"&&x&&typeof x.as==="string"){var Y=x.as,G=Px(Y,x.crossOrigin),U=typeof x.integrity==="string"?x.integrity:void 0,Z=typeof x.fetchPriority==="string"?x.fetchPriority:void 0;Y==="style"?M3.d.S(g,typeof x.precedence==="string"?x.precedence:void 0,{crossOrigin:G,integrity:U,fetchPriority:Z}):Y==="script"&&M3.d.X(g,{crossOrigin:G,integrity:U,fetchPriority:Z,nonce:typeof x.nonce==="string"?x.nonce:void 0})}},jH=function(g,x){if(typeof g==="string")if(typeof x==="object"&&x!==null){if(x.as==null||x.as==="script"){var Y=Px(x.as,x.crossOrigin);M3.d.M(g,{crossOrigin:Y,integrity:typeof x.integrity==="string"?x.integrity:void 0,nonce:typeof x.nonce==="string"?x.nonce:void 0})}}else x==null&&M3.d.M(g)},mH=function(g,x){if(typeof g==="string"&&typeof x==="object"&&x!==null&&typeof x.as==="string"){var Y=x.as,G=Px(Y,x.crossOrigin);M3.d.L(g,Y,{crossOrigin:G,integrity:typeof x.integrity==="string"?x.integrity:void 0,nonce:typeof x.nonce==="string"?x.nonce:void 0,type:typeof x.type==="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority==="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy==="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet==="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes==="string"?x.imageSizes:void 0,media:typeof x.media==="string"?x.media:void 0})}},_H=function(g,x){if(typeof g==="string")if(x){var Y=Px(x.as,x.crossOrigin);M3.d.m(g,{as:typeof x.as==="string"&&x.as!=="script"?x.as:void 0,crossOrigin:Y,integrity:typeof x.integrity==="string"?x.integrity:void 0})}else M3.d.m(g)},PH=function(g){M3.d.r(g)},EH=function(g,x){return g(x)},uH=function(g,x,Y){return og.H.useFormState(g,x,Y)},pH=function(){return og.H.useHostTransitionStatus()},cH="19.2.0";var aH=AY(()=>{OH=o5(Z3(),1);M3={d:{f:E6,r:function(){throw Error(yH(522))},D:E6,C:E6,L:E6,m:E6,X:E6,S:E6,M:E6},p:0,findDOMNode:null},MW=Symbol.for("react.portal");og=OH.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;RH=M3});var Ex=Nx((Nl,oH)=>{aH();function rH(){if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!=="function")return;try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(rH)}catch(g){console.error(g)}}rH(),oH.exports=PY});var HJ={};HH(HJ,{version:()=>qX,hydrateRoot:()=>xX,createRoot:()=>zX});function y1(g){var x="https://react.dev/errors/"+g;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var Y=2;Y<arguments.length;Y++)x+="&args[]="+encodeURIComponent(arguments[Y])}return"Minified React error #"+g+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function QB(g){return!(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)}function $f(g){var x=g,Y=g;if(g.alternate)for(;x.return;)x=x.return;else{g=x;do x=g,(x.flags&4098)!==0&&(Y=x.return),g=x.return;while(g)}return x.tag===3?Y:null}function VB(g){if(g.tag===13){var x=g.memoizedState;if(x===null&&(g=g.alternate,g!==null&&(x=g.memoizedState)),x!==null)return x.dehydrated}return null}function LB(g){if(g.tag===31){var x=g.memoizedState;if(x===null&&(g=g.alternate,g!==null&&(x=g.memoizedState)),x!==null)return x.dehydrated}return null}function nH(g){if($f(g)!==g)throw Error(y1(188))}function QW(g){var x=g.alternate;if(!x){if(x=$f(g),x===null)throw Error(y1(188));return x!==g?null:g}for(var Y=g,G=x;;){var U=Y.return;if(U===null)break;var Z=U.alternate;if(Z===null){if(G=U.return,G!==null){Y=G;continue}break}if(U.child===Z.child){for(Z=U.child;Z;){if(Z===Y)return nH(U),g;if(Z===G)return nH(U),x;Z=Z.sibling}throw Error(y1(188))}if(Y.return!==G.return)Y=U,G=Z;else{for(var l=!1,N=U.child;N;){if(N===Y){l=!0,Y=U,G=Z;break}if(N===G){l=!0,G=U,Y=Z;break}N=N.sibling}if(!l){for(N=Z.child;N;){if(N===Y){l=!0,Y=Z,G=U;break}if(N===G){l=!0,G=Z,Y=U;break}N=N.sibling}if(!l)throw Error(y1(189))}}if(Y.alternate!==G)throw Error(y1(190))}if(Y.tag!==3)throw Error(y1(188));return Y.stateNode.current===Y?g:x}function WB(g){var x=g.tag;if(x===5||x===26||x===27||x===6)return g;for(g=g.child;g!==null;){if(x=WB(g),x!==null)return x;g=g.sibling}return null}function ng(g){if(g===null||typeof g!=="object")return null;return g=sH&&g[sH]||g["@@iterator"],typeof g==="function"?g:null}function Fk(g){if(g==null)return null;if(typeof g==="function")return g.$$typeof===WW?null:g.displayName||g.name||null;if(typeof g==="string")return g;switch(g){case ow:return"Fragment";case Vk:return"Profiler";case hB:return"StrictMode";case Lk:return"Suspense";case Wk:return"SuspenseList";case hk:return"Activity"}if(typeof g==="object")switch(g.$$typeof){case bf:return"Portal";case n7:return g.displayName||"Context";case FB:return(g._context.displayName||"Context")+".Consumer";case Mv:var x=g.render;return g=g.displayName,g||(g=x.displayName||x.name||"",g=g!==""?"ForwardRef("+g+")":"ForwardRef"),g;case Xv:return x=g.displayName||null,x!==null?x:Fk(g.type)||"Memo";case u6:x=g._payload,g=g._init;try{return Fk(g(x))}catch(Y){}}return null}function G7(g){return{current:g}}function S2(g){0>nw||(g.current=Kk[nw],Kk[nw]=null,nw--)}function L5(g,x){nw++,Kk[nw]=g.current,g.current=x}function Vq(g,x){switch(L5(w8,x),L5(hf,g),L5(J7,null),x.nodeType){case 9:case 11:g=(g=x.documentElement)?(g=g.namespaceURI)?bB(g):0:0;break;default:if(g=x.tagName,x=x.namespaceURI)x=bB(x),g=pM(x,g);else switch(g){case"svg":g=1;break;case"math":g=2;break;default:g=0}}S2(J7),L5(J7,g)}function Hb(){S2(J7),S2(hf),S2(w8)}function lk(g){g.memoizedState!==null&&L5(Qq,g);var x=J7.current,Y=pM(x,g.type);x!==Y&&(L5(hf,g),L5(J7,Y))}function Lq(g){hf.current===g&&(S2(J7),S2(hf)),Qq.current===g&&(S2(Qq),If._currentValue=Q9)}function U9(g){if(EY===void 0)try{throw Error()}catch(Y){var x=Y.stack.trim().match(/\n( *(at )?)/);EY=x&&x[1]||"",iH=-1<Y.stack.indexOf(`
    at`)?" (<anonymous>)":-1<Y.stack.indexOf("@")?"@unknown:0:0":""}return`
`+EY+g+iH}function pY(g,x){if(!g||uY)return"";uY=!0;var Y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var G={DetermineComponentFrameRoot:function(){try{if(x){var r=function(){throw Error()};if(Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect==="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(u){var z1=u}Reflect.construct(g,[],r)}else{try{r.call()}catch(u){z1=u}g.call(r.prototype)}}else{try{throw Error()}catch(u){z1=u}(r=g())&&typeof r.catch==="function"&&r.catch(function(){})}}catch(u){if(u&&z1&&typeof u.stack==="string")return[u.stack,z1.stack]}return[null,null]}};G.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var U=Object.getOwnPropertyDescriptor(G.DetermineComponentFrameRoot,"name");U&&U.configurable&&Object.defineProperty(G.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var Z=G.DetermineComponentFrameRoot(),l=Z[0],N=Z[1];if(l&&N){var P=l.split(`
`),w1=N.split(`
`);for(U=G=0;G<P.length&&!P[G].includes("DetermineComponentFrameRoot");)G++;for(;U<w1.length&&!w1[U].includes("DetermineComponentFrameRoot");)U++;if(G===P.length||U===w1.length)for(G=P.length-1,U=w1.length-1;1<=G&&0<=U&&P[G]!==w1[U];)U--;for(;1<=G&&0<=U;G--,U--)if(P[G]!==w1[U]){if(G!==1||U!==1)do if(G--,U--,0>U||P[G]!==w1[U]){var H1=`
`+P[G].replace(" at new "," at ");return g.displayName&&H1.includes("<anonymous>")&&(H1=H1.replace("<anonymous>",g.displayName)),H1}while(1<=G&&0<=U);break}}}finally{uY=!1,Error.prepareStackTrace=Y}return(Y=g?g.displayName||g.name:"")?U9(Y):""}function hW(g,x){switch(g.tag){case 26:case 27:case 5:return U9(g.type);case 16:return U9("Lazy");case 13:return g.child!==x&&x!==null?U9("Suspense Fallback"):U9("Suspense");case 19:return U9("SuspenseList");case 0:case 15:return pY(g.type,!1);case 11:return pY(g.type.render,!1);case 1:return pY(g.type,!0);case 31:return U9("Activity");default:return""}}function tH(g){try{var x="",Y=null;do x+=hW(g,Y),Y=g,g=g.return;while(g);return x}catch(G){return`
Error generating stack: `+G.message+`
`+G.stack}}function n6(g){if(typeof DW==="function"&&dW(g),t3&&typeof t3.setStrictMode==="function")try{t3.setStrictMode(jf,g)}catch(x){}}function RW(g){return g>>>=0,g===0?32:31-(OW(g)/yW|0)|0}function B9(g){var x=g&42;if(x!==0)return x;switch(g&-g){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return g&261888;case 262144:case 524288:case 1048576:case 2097152:return g&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return g&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return g}}function nq(g,x,Y){var G=g.pendingLanes;if(G===0)return 0;var U=0,Z=g.suspendedLanes,l=g.pingedLanes;g=g.warmLanes;var N=G&134217727;return N!==0?(G=N&~Z,G!==0?U=B9(G):(l&=N,l!==0?U=B9(l):Y||(Y=N&~g,Y!==0&&(U=B9(Y))))):(N=G&~Z,N!==0?U=B9(N):l!==0?U=B9(l):Y||(Y=G&~g,Y!==0&&(U=B9(Y)))),U===0?0:x!==0&&x!==U&&(x&Z)===0&&(Z=U&-U,Y=x&-x,Z>=Y||Z===32&&(Y&4194048)!==0)?x:U}function mf(g,x){return(g.pendingLanes&~(g.suspendedLanes&~g.pingedLanes)&x)===0}function NW(g,x){switch(g){case 1:case 2:case 4:case 8:case 64:return x+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return x+5000;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function DB(){var g=ax;return ax<<=1,(ax&62914560)===0&&(ax=4194304),g}function aY(g){for(var x=[],Y=0;31>Y;Y++)x.push(g);return x}function _f(g,x){g.pendingLanes|=x,x!==268435456&&(g.suspendedLanes=0,g.pingedLanes=0,g.warmLanes=0)}function IW(g,x,Y,G,U,Z){var l=g.pendingLanes;g.pendingLanes=Y,g.suspendedLanes=0,g.pingedLanes=0,g.warmLanes=0,g.expiredLanes&=Y,g.entangledLanes&=Y,g.errorRecoveryDisabledLanes&=Y,g.shellSuspendCounter=0;var{entanglements:N,expirationTimes:P,hiddenUpdates:w1}=g;for(Y=l&~Y;0<Y;){var H1=31-e3(Y),r=1<<H1;N[H1]=0,P[H1]=-1;var z1=w1[H1];if(z1!==null)for(w1[H1]=null,H1=0;H1<z1.length;H1++){var u=z1[H1];u!==null&&(u.lane&=-536870913)}Y&=~r}G!==0&&dB(g,G,0),Z!==0&&U===0&&g.tag!==0&&(g.suspendedLanes|=Z&~(l&~x))}function dB(g,x,Y){g.pendingLanes|=x,g.suspendedLanes&=~x;var G=31-e3(x);g.entangledLanes|=x,g.entanglements[G]=g.entanglements[G]|1073741824|Y&261930}function OB(g,x){var Y=g.entangledLanes|=x;for(g=g.entanglements;Y;){var G=31-e3(Y),U=1<<G;U&x|g[G]&x&&(g[G]|=x),Y&=~U}}function yB(g,x){var Y=x&-x;return Y=(Y&42)!==0?1:Vv(Y),(Y&(g.suspendedLanes|x))!==0?0:Y}function Vv(g){switch(g){case 2:g=1;break;case 8:g=4;break;case 32:g=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:g=128;break;case 268435456:g=134217728;break;default:g=0}return g}function Lv(g){return g&=-g,2<g?8<g?(g&134217727)!==0?32:268435456:8:2}function RB(){var g=b5.p;if(g!==0)return g;return g=window.event,g===void 0?32:bX(g.type)}function eH(g,x){var Y=b5.p;try{return b5.p=g,x()}finally{b5.p=Y}}function Wv(g){delete g[a2],delete g[N3],delete g[Dk],delete g[SW],delete g[TW]}function sw(g){var x=g[a2];if(x)return x;for(var Y=g.parentNode;Y;){if(x=Y[Fb]||Y[a2]){if(Y=x.alternate,x.child!==null||Y!==null&&Y.child!==null)for(g=qB(g);g!==null;){if(Y=g[a2])return Y;g=qB(g)}return x}g=Y,Y=g.parentNode}return null}function Kb(g){if(g=g[a2]||g[Fb]){var x=g.tag;if(x===5||x===6||x===13||x===31||x===26||x===27||x===3)return g}return null}function ff(g){var x=g.tag;if(x===5||x===26||x===27||x===6)return g.stateNode;throw Error(y1(33))}function qb(g){var x=g[wU];return x||(x=g[wU]={hoistableStyles:new Map,hoistableScripts:new Map}),x}function I2(g){g[Pf]=!0}function d9(g,x){Ub(g,x),Ub(g+"Capture",x)}function Ub(g,x){IB[g]=x;for(g=0;g<x.length;g++)NB.add(x[g])}function jW(g){if(Ck.call(gU,g))return!0;if(Ck.call(bU,g))return!1;if($W.test(g))return gU[g]=!0;return bU[g]=!0,!1}function fq(g,x,Y){if(jW(x))if(Y===null)g.removeAttribute(x);else{switch(typeof Y){case"undefined":case"function":case"symbol":g.removeAttribute(x);return;case"boolean":var G=x.toLowerCase().slice(0,5);if(G!=="data-"&&G!=="aria-"){g.removeAttribute(x);return}}g.setAttribute(x,""+Y)}}function rx(g,x,Y){if(Y===null)g.removeAttribute(x);else{switch(typeof Y){case"undefined":case"function":case"symbol":case"boolean":g.removeAttribute(x);return}g.setAttribute(x,""+Y)}}function E7(g,x,Y,G){if(G===null)g.removeAttribute(Y);else{switch(typeof G){case"undefined":case"function":case"symbol":case"boolean":g.removeAttribute(Y);return}g.setAttributeNS(x,Y,""+G)}}function U4(g){switch(typeof g){case"bigint":case"boolean":case"number":case"string":case"undefined":return g;case"object":return g;default:return""}}function SB(g){var x=g.type;return(g=g.nodeName)&&g.toLowerCase()==="input"&&(x==="checkbox"||x==="radio")}function mW(g,x,Y){var G=Object.getOwnPropertyDescriptor(g.constructor.prototype,x);if(!g.hasOwnProperty(x)&&typeof G<"u"&&typeof G.get==="function"&&typeof G.set==="function"){var{get:U,set:Z}=G;return Object.defineProperty(g,x,{configurable:!0,get:function(){return U.call(this)},set:function(l){Y=""+l,Z.call(this,l)}}),Object.defineProperty(g,x,{enumerable:G.enumerable}),{getValue:function(){return Y},setValue:function(l){Y=""+l},stopTracking:function(){g._valueTracker=null,delete g[x]}}}}function dk(g){if(!g._valueTracker){var x=SB(g)?"checked":"value";g._valueTracker=mW(g,x,""+g[x])}}function TB(g){if(!g)return!1;var x=g._valueTracker;if(!x)return!0;var Y=x.getValue(),G="";return g&&(G=SB(g)?g.checked?"true":"false":g.value),g=G,g!==Y?(x.setValue(g),!0):!1}function hq(g){if(g=g||(typeof document<"u"?document:void 0),typeof g>"u")return null;try{return g.activeElement||g.body}catch(x){return g.body}}function M4(g){return g.replace(_W,function(x){return"\\"+x.charCodeAt(0).toString(16)+" "})}function Ok(g,x,Y,G,U,Z,l,N){if(g.name="",l!=null&&typeof l!=="function"&&typeof l!=="symbol"&&typeof l!=="boolean"?g.type=l:g.removeAttribute("type"),x!=null)if(l==="number"){if(x===0&&g.value===""||g.value!=x)g.value=""+U4(x)}else g.value!==""+U4(x)&&(g.value=""+U4(x));else l!=="submit"&&l!=="reset"||g.removeAttribute("value");x!=null?yk(g,l,U4(x)):Y!=null?yk(g,l,U4(Y)):G!=null&&g.removeAttribute("value"),U==null&&Z!=null&&(g.defaultChecked=!!Z),U!=null&&(g.checked=U&&typeof U!=="function"&&typeof U!=="symbol"),N!=null&&typeof N!=="function"&&typeof N!=="symbol"&&typeof N!=="boolean"?g.name=""+U4(N):g.removeAttribute("name")}function $B(g,x,Y,G,U,Z,l,N){if(Z!=null&&typeof Z!=="function"&&typeof Z!=="symbol"&&typeof Z!=="boolean"&&(g.type=Z),x!=null||Y!=null){if(!(Z!=="submit"&&Z!=="reset"||x!==void 0&&x!==null)){dk(g);return}Y=Y!=null?""+U4(Y):"",x=x!=null?""+U4(x):Y,N||x===g.value||(g.value=x),g.defaultValue=x}G=G!=null?G:U,G=typeof G!=="function"&&typeof G!=="symbol"&&!!G,g.checked=N?g.checked:!!G,g.defaultChecked=!!G,l!=null&&typeof l!=="function"&&typeof l!=="symbol"&&typeof l!=="boolean"&&(g.name=l),dk(g)}function yk(g,x,Y){x==="number"&&hq(g.ownerDocument)===g||g.defaultValue===""+Y||(g.defaultValue=""+Y)}function Zb(g,x,Y,G){if(g=g.options,x){x={};for(var U=0;U<Y.length;U++)x["$"+Y[U]]=!0;for(Y=0;Y<g.length;Y++)U=x.hasOwnProperty("$"+g[Y].value),g[Y].selected!==U&&(g[Y].selected=U),U&&G&&(g[Y].defaultSelected=!0)}else{Y=""+U4(Y),x=null;for(U=0;U<g.length;U++){if(g[U].value===Y){g[U].selected=!0,G&&(g[U].defaultSelected=!0);return}x!==null||g[U].disabled||(x=g[U])}x!==null&&(x.selected=!0)}}function jB(g,x,Y){if(x!=null&&(x=""+U4(x),x!==g.value&&(g.value=x),Y==null)){g.defaultValue!==x&&(g.defaultValue=x);return}g.defaultValue=Y!=null?""+U4(Y):""}function mB(g,x,Y,G){if(x==null){if(G!=null){if(Y!=null)throw Error(y1(92));if(gf(G)){if(1<G.length)throw Error(y1(93));G=G[0]}Y=G}Y==null&&(Y=""),x=Y}Y=U4(x),g.defaultValue=Y,G=g.textContent,G===Y&&G!==""&&G!==null&&(g.value=G),dk(g)}function Bb(g,x){if(x){var Y=g.firstChild;if(Y&&Y===g.lastChild&&Y.nodeType===3){Y.nodeValue=x;return}}g.textContent=x}function fU(g,x,Y){var G=x.indexOf("--")===0;Y==null||typeof Y==="boolean"||Y===""?G?g.setProperty(x,""):x==="float"?g.cssFloat="":g[x]="":G?g.setProperty(x,Y):typeof Y!=="number"||Y===0||PW.has(x)?x==="float"?g.cssFloat=Y:g[x]=(""+Y).trim():g[x]=Y+"px"}function _B(g,x,Y){if(x!=null&&typeof x!=="object")throw Error(y1(62));if(g=g.style,Y!=null){for(var G in Y)!Y.hasOwnProperty(G)||x!=null&&x.hasOwnProperty(G)||(G.indexOf("--")===0?g.setProperty(G,""):G==="float"?g.cssFloat="":g[G]="");for(var U in x)G=x[U],x.hasOwnProperty(U)&&Y[U]!==G&&fU(g,U,G)}else for(var Z in x)x.hasOwnProperty(Z)&&fU(g,Z,x[Z])}function hv(g){if(g.indexOf("-")===-1)return!1;switch(g){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function zq(g){return uW.test(""+g)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":g}function s7(){}function Fv(g){return g=g.target||g.srcElement||window,g.correspondingUseElement&&(g=g.correspondingUseElement),g.nodeType===3?g.parentNode:g}function zU(g){var x=Kb(g);if(x&&(g=x.stateNode)){var Y=g[N3]||null;w:switch(g=x.stateNode,x.type){case"input":if(Ok(g,Y.value,Y.defaultValue,Y.defaultValue,Y.checked,Y.defaultChecked,Y.type,Y.name),x=Y.name,Y.type==="radio"&&x!=null){for(Y=g;Y.parentNode;)Y=Y.parentNode;Y=Y.querySelectorAll('input[name="'+M4(""+x)+'"][type="radio"]');for(x=0;x<Y.length;x++){var G=Y[x];if(G!==g&&G.form===g.form){var U=G[N3]||null;if(!U)throw Error(y1(90));Ok(G,U.value,U.defaultValue,U.defaultValue,U.checked,U.defaultChecked,U.type,U.name)}}for(x=0;x<Y.length;x++)G=Y[x],G.form===g.form&&TB(G)}break w;case"textarea":jB(g,Y.value,Y.defaultValue);break w;case"select":x=Y.value,x!=null&&Zb(g,!!Y.multiple,x,!1)}}}function PB(g,x,Y){if(rY)return g(x,Y);rY=!0;try{var G=g(x);return G}finally{if(rY=!1,iw!==null||Yb!==null){if(ZZ(),iw&&(x=iw,g=Yb,Yb=iw=null,zU(x),g))for(x=0;x<g.length;x++)zU(g[x])}}}function Ff(g,x){var Y=g.stateNode;if(Y===null)return null;var G=Y[N3]||null;if(G===null)return null;Y=G[x];w:switch(x){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(G=!G.disabled)||(g=g.type,G=!(g==="button"||g==="input"||g==="select"||g==="textarea")),g=!G;break w;default:g=!1}if(g)return null;if(Y&&typeof Y!=="function")throw Error(y1(231,x,typeof Y));return Y}function EB(){if(xq)return xq;var g,x=Kv,Y=x.length,G,U="value"in s6?s6.value:s6.textContent,Z=U.length;for(g=0;g<Y&&x[g]===U[g];g++);var l=Y-g;for(G=1;G<=l&&x[Y-G]===U[Z-G];G++);return xq=U.slice(g,1<G?1-G:void 0)}function qq(g){var x=g.keyCode;return"charCode"in g?(g=g.charCode,g===0&&x===13&&(g=13)):g=x,g===10&&(g=13),32<=g||g===13?g:0}function ox(){return!0}function xU(){return!1}function I3(g){function x(Y,G,U,Z,l){this._reactName=Y,this._targetInst=U,this.type=G,this.nativeEvent=Z,this.target=l,this.currentTarget=null;for(var N in g)g.hasOwnProperty(N)&&(Y=g[N],this[N]=Y?Y(Z):Z[N]);return this.isDefaultPrevented=(Z.defaultPrevented!=null?Z.defaultPrevented:Z.returnValue===!1)?ox:xU,this.isPropagationStopped=xU,this}return O5(x.prototype,{preventDefault:function(){this.defaultPrevented=!0;var Y=this.nativeEvent;Y&&(Y.preventDefault?Y.preventDefault():typeof Y.returnValue!=="unknown"&&(Y.returnValue=!1),this.isDefaultPrevented=ox)},stopPropagation:function(){var Y=this.nativeEvent;Y&&(Y.stopPropagation?Y.stopPropagation():typeof Y.cancelBubble!=="unknown"&&(Y.cancelBubble=!0),this.isPropagationStopped=ox)},persist:function(){},isPersistent:ox}),x}function gh(g){var x=this.nativeEvent;return x.getModifierState?x.getModifierState(g):(g=bh[g])?!!x[g]:!1}function lv(){return gh}function pB(g,x){switch(g){case"keyup":return Uh.indexOf(x.keyCode)!==-1;case"keydown":return x.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cB(g){return g=g.detail,typeof g==="object"&&"data"in g?g.data:null}function Ah(g,x){switch(g){case"compositionend":return cB(x);case"keypress":if(x.which!==32)return null;return vU=!0,kU;case"textInput":return g=x.data,g===kU&&vU?null:g;default:return null}}function Mh(g,x){if(tw)return g==="compositionend"||!Cv&&pB(g,x)?(g=EB(),xq=Kv=s6=null,tw=!1,g):null;switch(g){case"paste":return null;case"keypress":if(!(x.ctrlKey||x.altKey||x.metaKey)||x.ctrlKey&&x.altKey){if(x.char&&1<x.char.length)return x.char;if(x.which)return String.fromCharCode(x.which)}return null;case"compositionend":return uB&&x.locale!=="ko"?null:x.data;default:return null}}function JU(g){var x=g&&g.nodeName&&g.nodeName.toLowerCase();return x==="input"?!!Xh[g.type]:x==="textarea"?!0:!1}function aB(g,x,Y,G){iw?Yb?Yb.push(G):Yb=[G]:iw=G,x=Pq(x,"onChange"),0<x.length&&(Y=new sq("onChange","change",null,Y,G),g.push({event:Y,listeners:x}))}function Qh(g){PM(g,0)}function tq(g){var x=ff(g);if(TB(x))return g}function GU(g,x){if(g==="change")return x}function HU(){Jf&&(Jf.detachEvent("onpropertychange",oB),Kf=Jf=null)}function oB(g){if(g.propertyName==="value"&&tq(Kf)){var x=[];aB(x,Kf,g,Fv(g)),PB(Qh,x)}}function Vh(g,x,Y){g==="focusin"?(HU(),Jf=x,Kf=Y,Jf.attachEvent("onpropertychange",oB)):g==="focusout"&&HU()}function Lh(g){if(g==="selectionchange"||g==="keyup"||g==="keydown")return tq(Kf)}function Wh(g,x){if(g==="click")return tq(x)}function hh(g,x){if(g==="input"||g==="change")return tq(x)}function Fh(g,x){return g===x&&(g!==0||1/g===1/x)||g!==g&&x!==x}function lf(g,x){if(b4(g,x))return!0;if(typeof g!=="object"||g===null||typeof x!=="object"||x===null)return!1;var Y=Object.keys(g),G=Object.keys(x);if(Y.length!==G.length)return!1;for(G=0;G<Y.length;G++){var U=Y[G];if(!Ck.call(x,U)||!b4(g[U],x[U]))return!1}return!0}function UU(g){for(;g&&g.firstChild;)g=g.firstChild;return g}function BU(g,x){var Y=UU(g);g=0;for(var G;Y;){if(Y.nodeType===3){if(G=g+Y.textContent.length,g<=x&&G>=x)return{node:Y,offset:x-g};g=G}w:{for(;Y;){if(Y.nextSibling){Y=Y.nextSibling;break w}Y=Y.parentNode}Y=void 0}Y=UU(Y)}}function nB(g,x){return g&&x?g===x?!0:g&&g.nodeType===3?!1:x&&x.nodeType===3?nB(g,x.parentNode):("contains"in g)?g.contains(x):g.compareDocumentPosition?!!(g.compareDocumentPosition(x)&16):!1:!1}function sB(g){g=g!=null&&g.ownerDocument!=null&&g.ownerDocument.defaultView!=null?g.ownerDocument.defaultView:window;for(var x=hq(g.document);x instanceof g.HTMLIFrameElement;){try{var Y=typeof x.contentWindow.location.href==="string"}catch(G){Y=!1}if(Y)g=x.contentWindow;else break;x=hq(g.document)}return x}function Dv(g){var x=g&&g.nodeName&&g.nodeName.toLowerCase();return x&&(x==="input"&&(g.type==="text"||g.type==="search"||g.type==="tel"||g.type==="url"||g.type==="password")||x==="textarea"||g.contentEditable==="true")}function AU(g,x,Y){var G=Y.window===Y?Y.document:Y.nodeType===9?Y:Y.ownerDocument;Sk||ew==null||ew!==hq(G)||(G=ew,("selectionStart"in G)&&Dv(G)?G={start:G.selectionStart,end:G.selectionEnd}:(G=(G.ownerDocument&&G.ownerDocument.defaultView||window).getSelection(),G={anchorNode:G.anchorNode,anchorOffset:G.anchorOffset,focusNode:G.focusNode,focusOffset:G.focusOffset}),Gf&&lf(Gf,G)||(Gf=G,G=Pq(Ik,"onSelect"),0<G.length&&(x=new sq("onSelect","select",null,x,Y),g.push({event:x,listeners:G}),x.target=ew)))}function H9(g,x){var Y={};return Y[g.toLowerCase()]=x.toLowerCase(),Y["Webkit"+g]="webkit"+x,Y["Moz"+g]="moz"+x,Y}function y9(g){if(iY[g])return iY[g];if(!wb[g])return g;var x=wb[g],Y;for(Y in x)if(x.hasOwnProperty(Y)&&Y in iB)return iY[g]=x[Y];return g}function u4(g,x){gA.set(g,x),d9(x,[g])}function eq(){for(var g=bb,x=dv=bb=0;x<g;){var Y=H4[x];H4[x++]=null;var G=H4[x];H4[x++]=null;var U=H4[x];H4[x++]=null;var Z=H4[x];if(H4[x++]=null,G!==null&&U!==null){var l=G.pending;l===null?U.next=U:(U.next=l.next,l.next=U),G.pending=U}Z!==0&&fA(Y,U,Z)}}function wZ(g,x,Y,G){H4[bb++]=g,H4[bb++]=x,H4[bb++]=Y,H4[bb++]=G,dv|=G,g.lanes|=G,g=g.alternate,g!==null&&(g.lanes|=G)}function Ov(g,x,Y,G){return wZ(g,x,Y,G),Kq(g)}function R9(g,x){return wZ(g,null,null,x),Kq(g)}function fA(g,x,Y){g.lanes|=Y;var G=g.alternate;G!==null&&(G.lanes|=Y);for(var U=!1,Z=g.return;Z!==null;)Z.childLanes|=Y,G=Z.alternate,G!==null&&(G.childLanes|=Y),Z.tag===22&&(g=Z.stateNode,g===null||g._visibility&1||(U=!0)),g=Z,Z=Z.return;return g.tag===3?(Z=g.stateNode,U&&x!==null&&(U=31-e3(Y),g=Z.hiddenUpdates,G=g[U],G===null?g[U]=[x]:G.push(x),x.lane=Y|536870912),Z):null}function Kq(g){if(50<Lf)throw Lf=0,fv=null,Error(y1(185));for(var x=g.return;x!==null;)g=x,x=g.return;return g.tag===3?g.stateNode:null}function dh(g,x,Y,G){this.tag=g,this.key=Y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=x,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=G,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function n3(g,x,Y,G){return new dh(g,x,Y,G)}function yv(g){return g=g.prototype,!(!g||!g.isReactComponent)}function t7(g,x){var Y=g.alternate;return Y===null?(Y=n3(g.tag,x,g.key,g.mode),Y.elementType=g.elementType,Y.type=g.type,Y.stateNode=g.stateNode,Y.alternate=g,g.alternate=Y):(Y.pendingProps=x,Y.type=g.type,Y.flags=0,Y.subtreeFlags=0,Y.deletions=null),Y.flags=g.flags&65011712,Y.childLanes=g.childLanes,Y.lanes=g.lanes,Y.child=g.child,Y.memoizedProps=g.memoizedProps,Y.memoizedState=g.memoizedState,Y.updateQueue=g.updateQueue,x=g.dependencies,Y.dependencies=x===null?null:{lanes:x.lanes,firstContext:x.firstContext},Y.sibling=g.sibling,Y.index=g.index,Y.ref=g.ref,Y.refCleanup=g.refCleanup,Y}function zA(g,x){g.flags&=65011714;var Y=g.alternate;return Y===null?(g.childLanes=0,g.lanes=x,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=Y.childLanes,g.lanes=Y.lanes,g.child=Y.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=Y.memoizedProps,g.memoizedState=Y.memoizedState,g.updateQueue=Y.updateQueue,g.type=Y.type,x=Y.dependencies,g.dependencies=x===null?null:{lanes:x.lanes,firstContext:x.firstContext}),g}function Yq(g,x,Y,G,U,Z){var l=0;if(G=g,typeof g==="function")yv(g)&&(l=1);else if(typeof g==="string")l=RF(g,Y,J7.current)?26:g==="html"||g==="head"||g==="body"?27:5;else w:switch(g){case hk:return g=n3(31,Y,x,U),g.elementType=hk,g.lanes=Z,g;case ow:return V9(Y.children,U,Z,x);case hB:l=8,U|=24;break;case Vk:return g=n3(12,Y,x,U|2),g.elementType=Vk,g.lanes=Z,g;case Lk:return g=n3(13,Y,x,U),g.elementType=Lk,g.lanes=Z,g;case Wk:return g=n3(19,Y,x,U),g.elementType=Wk,g.lanes=Z,g;default:if(typeof g==="object"&&g!==null)switch(g.$$typeof){case n7:l=10;break w;case FB:l=9;break w;case Mv:l=11;break w;case Xv:l=14;break w;case u6:l=16,G=null;break w}l=29,Y=Error(y1(130,g===null?"null":typeof g,"")),G=null}return x=n3(l,Y,x,U),x.elementType=g,x.type=G,x.lanes=Z,x}function V9(g,x,Y,G){return g=n3(7,g,G,x),g.lanes=Y,g}function tY(g,x,Y){return g=n3(6,g,null,x),g.lanes=Y,g}function xA(g){var x=n3(18,null,null,0);return x.stateNode=g,x}function eY(g,x,Y){return x=n3(4,g.children!==null?g.children:[],g.key,x),x.lanes=Y,x.stateNode={containerInfo:g.containerInfo,pendingChildren:null,implementation:g.implementation},x}function X4(g,x){if(typeof g==="object"&&g!==null){var Y=MU.get(g);if(Y!==void 0)return Y;return x={value:g,source:x,stack:tH(x)},MU.set(g,x),x}return{value:g,source:x,stack:tH(x)}}function r7(g,x){fb[zb++]=Cf,fb[zb++]=lq,lq=g,Cf=x}function qA(g,x,Y){B4[A4++]=Y7,B4[A4++]=k7,B4[A4++]=k8,k8=g;var G=Y7;g=k7;var U=32-e3(G)-1;G&=~(1<<U),Y+=1;var Z=32-e3(x)+U;if(30<Z){var l=U-U%5;Z=(G&(1<<l)-1).toString(32),G>>=l,U-=l,Y7=1<<32-e3(x)+U|Y<<U|G,k7=Z+g}else Y7=1<<Z|Y<<U|G,k7=g}function Rv(g){g.return!==null&&(r7(g,1),qA(g,1,0))}function Nv(g){for(;g===lq;)lq=fb[--zb],fb[zb]=null,Cf=fb[--zb],fb[zb]=null;for(;g===k8;)k8=B4[--A4],B4[A4]=null,k7=B4[--A4],B4[A4]=null,Y7=B4[--A4],B4[A4]=null}function ZA(g,x){B4[A4++]=Y7,B4[A4++]=k7,B4[A4++]=k8,Y7=x.id,k7=x.overflow,k8=g}function v8(g){var x=Error(y1(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Df(X4(x,g)),$k}function XU(g){var{stateNode:x,type:Y,memoizedProps:G}=g;switch(x[a2]=g,x[N3]=G,Y){case"dialog":u0("cancel",x),u0("close",x);break;case"iframe":case"object":case"embed":u0("load",x);break;case"video":case"audio":for(Y=0;Y<Rf.length;Y++)u0(Rf[Y],x);break;case"source":u0("error",x);break;case"img":case"image":case"link":u0("error",x),u0("load",x);break;case"details":u0("toggle",x);break;case"input":u0("invalid",x),$B(x,G.value,G.defaultValue,G.checked,G.defaultChecked,G.type,G.name,!0);break;case"select":u0("invalid",x);break;case"textarea":u0("invalid",x),mB(x,G.value,G.defaultValue,G.children)}Y=G.children,typeof Y!=="string"&&typeof Y!=="number"&&typeof Y!=="bigint"||x.textContent===""+Y||G.suppressHydrationWarning===!0||uM(x.textContent,Y)?(G.popover!=null&&(u0("beforetoggle",x),u0("toggle",x)),G.onScroll!=null&&u0("scroll",x),G.onScrollEnd!=null&&u0("scrollend",x),G.onClick!=null&&(x.onclick=s7),x=!0):x=!1,x||v8(g,!0)}function QU(g){for(r2=g.return;r2;)switch(r2.tag){case 5:case 31:case 13:Q4=!1;return;case 27:case 3:Q4=!0;return;default:r2=r2.return}}function uw(g){if(g!==r2)return!1;if(!o0)return QU(g),o0=!0,!1;var x=g.tag,Y;if(Y=x!==3&&x!==27){if(Y=x===5)Y=g.type,Y=!(Y!=="form"&&Y!=="button")||vv(g.type,g.memoizedProps);Y=!Y}if(Y&&d5&&v8(g),QU(g),x===13){if(g=g.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(y1(317));d5=xB(g)}else if(x===31){if(g=g.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(y1(317));d5=xB(g)}else x===27?(x=d5,U8(g.type)?(g=Uv,Uv=null,d5=g):d5=x):d5=r2?L4(g.stateNode.nextSibling):null;return!0}function F9(){d5=r2=null,o0=!1}function wk(){var g=b8;return g!==null&&(y3===null?y3=g:y3.push.apply(y3,g),b8=null),g}function Df(g){b8===null?b8=[g]:b8.push(g)}function c6(g,x,Y){L5(jk,x._currentValue),x._currentValue=Y}function e7(g){g._currentValue=jk.current,S2(jk)}function mk(g,x,Y){for(;g!==null;){var G=g.alternate;if((g.childLanes&x)!==x?(g.childLanes|=x,G!==null&&(G.childLanes|=x)):G!==null&&(G.childLanes&x)!==x&&(G.childLanes|=x),g===Y)break;g=g.return}}function _k(g,x,Y,G){var U=g.child;U!==null&&(U.return=g);for(;U!==null;){var Z=U.dependencies;if(Z!==null){var l=U.child;Z=Z.firstContext;w:for(;Z!==null;){var N=Z;Z=U;for(var P=0;P<x.length;P++)if(N.context===x[P]){Z.lanes|=Y,N=Z.alternate,N!==null&&(N.lanes|=Y),mk(Z.return,Y,g),G||(l=null);break w}Z=N.next}}else if(U.tag===18){if(l=U.return,l===null)throw Error(y1(341));l.lanes|=Y,Z=l.alternate,Z!==null&&(Z.lanes|=Y),mk(l,Y,g),l=null}else l=U.child;if(l!==null)l.return=U;else for(l=U;l!==null;){if(l===g){l=null;break}if(U=l.sibling,U!==null){U.return=l.return,l=U;break}l=l.return}U=l}}function lb(g,x,Y,G){g=null;for(var U=x,Z=!1;U!==null;){if(!Z){if((U.flags&524288)!==0)Z=!0;else if((U.flags&262144)!==0)break}if(U.tag===10){var l=U.alternate;if(l===null)throw Error(y1(387));if(l=l.memoizedProps,l!==null){var N=U.type;b4(U.pendingProps.value,l.value)||(g!==null?g.push(N):g=[N])}}else if(U===Qq.current){if(l=U.alternate,l===null)throw Error(y1(387));l.memoizedState.memoizedState!==U.memoizedState.memoizedState&&(g!==null?g.push(If):g=[If])}U=U.return}g!==null&&_k(x,g,Y,G),x.flags|=262144}function Cq(g){for(g=g.firstContext;g!==null;){if(!b4(g.context._currentValue,g.memoizedValue))return!0;g=g.next}return!1}function K9(g){N9=g,i7=null,g=g.dependencies,g!==null&&(g.firstContext=null)}function o2(g){return YA(N9,g)}function nx(g,x){return N9===null&&K9(g),YA(g,x)}function YA(g,x){var Y=x._currentValue;if(x={context:x,memoizedValue:Y,next:null},i7===null){if(g===null)throw Error(y1(308));i7=x,g.dependencies={lanes:0,firstContext:x},g.flags|=524288}else i7=i7.next=x;return Y}function Iv(){return{controller:new Oh,data:new Map,refCount:0}}function uf(g){g.refCount--,g.refCount===0&&yh(Rh,function(){g.controller.abort()})}function Nh(g,x){if(Hf===null){var Y=Hf=[];Pk=0,Ab=xJ(),kb={status:"pending",value:void 0,then:function(G){Y.push(G)}}}return Pk++,x.then(VU,VU),x}function VU(){if(--Pk===0&&Hf!==null){kb!==null&&(kb.status="fulfilled");var g=Hf;Hf=null,Ab=0,kb=null;for(var x=0;x<g.length;x++)(0,g[x])()}}function Ih(g,x){var Y=[],G={status:"pending",value:null,reason:null,then:function(U){Y.push(U)}};return g.then(function(){G.status="fulfilled",G.value=x;for(var U=0;U<Y.length;U++)(0,Y[U])(x)},function(U){G.status="rejected",G.reason=U;for(U=0;U<Y.length;U++)(0,Y[U])(void 0)}),G}function Sv(){var g=L9.current;return g!==null?g:M5.pooledCache}function kq(g,x){x===null?L5(L9,L9.current):L5(L9,x.pool)}function kA(){var g=Sv();return g===null?null:{parent:U2._currentValue,pool:g}}function WU(g){return g=g.status,g==="fulfilled"||g==="rejected"}function vA(g,x,Y){switch(Y=g[Y],Y===void 0?g.push(x):Y!==x&&(x.then(s7,s7),x=Y),x.status){case"fulfilled":return x.value;case"rejected":throw g=x.reason,FU(g),g;default:if(typeof x.status==="string")x.then(s7,s7);else{if(g=M5,g!==null&&100<g.shellSuspendCounter)throw Error(y1(482));g=x,g.status="pending",g.then(function(G){if(x.status==="pending"){var U=x;U.status="fulfilled",U.value=G}},function(G){if(x.status==="pending"){var U=x;U.status="rejected",U.reason=G}})}switch(x.status){case"fulfilled":return x.value;case"rejected":throw g=x.reason,FU(g),g}throw W9=x,Cb}}function M9(g){try{var x=g._init;return x(g._payload)}catch(Y){if(Y!==null&&typeof Y==="object"&&typeof Y.then==="function")throw W9=Y,Cb;throw Y}}function hU(){if(W9===null)throw Error(y1(459));var g=W9;return W9=null,g}function FU(g){if(g===Cb||g===bZ)throw Error(y1(483))}function sx(g){var x=df;return df+=1,vb===null&&(vb=[]),vA(vb,g,x)}function ig(g,x){x=x.props.ref,g.ref=x!==void 0?x:null}function ix(g,x){if(x.$$typeof===VW)throw Error(y1(525));throw g=Object.prototype.toString.call(x),Error(y1(31,g==="[object Object]"?"object with keys {"+Object.keys(x).join(", ")+"}":g))}function JA(g){function x(f1,Y1){if(g){var B1=f1.deletions;B1===null?(f1.deletions=[Y1],f1.flags|=16):B1.push(Y1)}}function Y(f1,Y1){if(!g)return null;for(;Y1!==null;)x(f1,Y1),Y1=Y1.sibling;return null}function G(f1){for(var Y1=new Map;f1!==null;)f1.key!==null?Y1.set(f1.key,f1):Y1.set(f1.index,f1),f1=f1.sibling;return Y1}function U(f1,Y1){return f1=t7(f1,Y1),f1.index=0,f1.sibling=null,f1}function Z(f1,Y1,B1){if(f1.index=B1,!g)return f1.flags|=1048576,Y1;if(B1=f1.alternate,B1!==null)return B1=B1.index,B1<Y1?(f1.flags|=67108866,Y1):B1;return f1.flags|=67108866,Y1}function l(f1){return g&&f1.alternate===null&&(f1.flags|=67108866),f1}function N(f1,Y1,B1,F1){if(Y1===null||Y1.tag!==6)return Y1=tY(B1,f1.mode,F1),Y1.return=f1,Y1;return Y1=U(Y1,B1),Y1.return=f1,Y1}function P(f1,Y1,B1,F1){var i1=B1.type;if(i1===ow)return H1(f1,Y1,B1.props.children,F1,B1.key);if(Y1!==null&&(Y1.elementType===i1||typeof i1==="object"&&i1!==null&&i1.$$typeof===u6&&M9(i1)===Y1.type))return Y1=U(Y1,B1.props),ig(Y1,B1),Y1.return=f1,Y1;return Y1=Yq(B1.type,B1.key,B1.props,null,f1.mode,F1),ig(Y1,B1),Y1.return=f1,Y1}function w1(f1,Y1,B1,F1){if(Y1===null||Y1.tag!==4||Y1.stateNode.containerInfo!==B1.containerInfo||Y1.stateNode.implementation!==B1.implementation)return Y1=eY(B1,f1.mode,F1),Y1.return=f1,Y1;return Y1=U(Y1,B1.children||[]),Y1.return=f1,Y1}function H1(f1,Y1,B1,F1,i1){if(Y1===null||Y1.tag!==7)return Y1=V9(B1,f1.mode,F1,i1),Y1.return=f1,Y1;return Y1=U(Y1,B1),Y1.return=f1,Y1}function r(f1,Y1,B1){if(typeof Y1==="string"&&Y1!==""||typeof Y1==="number"||typeof Y1==="bigint")return Y1=tY(""+Y1,f1.mode,B1),Y1.return=f1,Y1;if(typeof Y1==="object"&&Y1!==null){switch(Y1.$$typeof){case ux:return B1=Yq(Y1.type,Y1.key,Y1.props,null,f1.mode,B1),ig(B1,Y1),B1.return=f1,B1;case bf:return Y1=eY(Y1,f1.mode,B1),Y1.return=f1,Y1;case u6:return Y1=M9(Y1),r(f1,Y1,B1)}if(gf(Y1)||ng(Y1))return Y1=V9(Y1,f1.mode,B1,null),Y1.return=f1,Y1;if(typeof Y1.then==="function")return r(f1,sx(Y1),B1);if(Y1.$$typeof===n7)return r(f1,nx(f1,Y1),B1);ix(f1,Y1)}return null}function z1(f1,Y1,B1,F1){var i1=Y1!==null?Y1.key:null;if(typeof B1==="string"&&B1!==""||typeof B1==="number"||typeof B1==="bigint")return i1!==null?null:N(f1,Y1,""+B1,F1);if(typeof B1==="object"&&B1!==null){switch(B1.$$typeof){case ux:return B1.key===i1?P(f1,Y1,B1,F1):null;case bf:return B1.key===i1?w1(f1,Y1,B1,F1):null;case u6:return B1=M9(B1),z1(f1,Y1,B1,F1)}if(gf(B1)||ng(B1))return i1!==null?null:H1(f1,Y1,B1,F1,null);if(typeof B1.then==="function")return z1(f1,Y1,sx(B1),F1);if(B1.$$typeof===n7)return z1(f1,Y1,nx(f1,B1),F1);ix(f1,B1)}return null}function u(f1,Y1,B1,F1,i1){if(typeof F1==="string"&&F1!==""||typeof F1==="number"||typeof F1==="bigint")return f1=f1.get(B1)||null,N(Y1,f1,""+F1,i1);if(typeof F1==="object"&&F1!==null){switch(F1.$$typeof){case ux:return f1=f1.get(F1.key===null?B1:F1.key)||null,P(Y1,f1,F1,i1);case bf:return f1=f1.get(F1.key===null?B1:F1.key)||null,w1(Y1,f1,F1,i1);case u6:return F1=M9(F1),u(f1,Y1,B1,F1,i1)}if(gf(F1)||ng(F1))return f1=f1.get(B1)||null,H1(Y1,f1,F1,i1,null);if(typeof F1.then==="function")return u(f1,Y1,B1,sx(F1),i1);if(F1.$$typeof===n7)return u(f1,Y1,B1,nx(Y1,F1),i1);ix(Y1,F1)}return null}function R1(f1,Y1,B1,F1){for(var i1=null,k0=null,r1=Y1,$1=Y1=0,q0=null;r1!==null&&$1<B1.length;$1++){r1.index>$1?(q0=r1,r1=null):q0=r1.sibling;var G0=z1(f1,r1,B1[$1],F1);if(G0===null){r1===null&&(r1=q0);break}g&&r1&&G0.alternate===null&&x(f1,r1),Y1=Z(G0,Y1,$1),k0===null?i1=G0:k0.sibling=G0,k0=G0,r1=q0}if($1===B1.length)return Y(f1,r1),o0&&r7(f1,$1),i1;if(r1===null){for(;$1<B1.length;$1++)r1=r(f1,B1[$1],F1),r1!==null&&(Y1=Z(r1,Y1,$1),k0===null?i1=r1:k0.sibling=r1,k0=r1);return o0&&r7(f1,$1),i1}for(r1=G(r1);$1<B1.length;$1++)q0=u(r1,f1,$1,B1[$1],F1),q0!==null&&(g&&q0.alternate!==null&&r1.delete(q0.key===null?$1:q0.key),Y1=Z(q0,Y1,$1),k0===null?i1=q0:k0.sibling=q0,k0=q0);return g&&r1.forEach(function(T5){return x(f1,T5)}),o0&&r7(f1,$1),i1}function P1(f1,Y1,B1,F1){if(B1==null)throw Error(y1(151));for(var i1=null,k0=null,r1=Y1,$1=Y1=0,q0=null,G0=B1.next();r1!==null&&!G0.done;$1++,G0=B1.next()){r1.index>$1?(q0=r1,r1=null):q0=r1.sibling;var T5=z1(f1,r1,G0.value,F1);if(T5===null){r1===null&&(r1=q0);break}g&&r1&&T5.alternate===null&&x(f1,r1),Y1=Z(T5,Y1,$1),k0===null?i1=T5:k0.sibling=T5,k0=T5,r1=q0}if(G0.done)return Y(f1,r1),o0&&r7(f1,$1),i1;if(r1===null){for(;!G0.done;$1++,G0=B1.next())G0=r(f1,G0.value,F1),G0!==null&&(Y1=Z(G0,Y1,$1),k0===null?i1=G0:k0.sibling=G0,k0=G0);return o0&&r7(f1,$1),i1}for(r1=G(r1);!G0.done;$1++,G0=B1.next())G0=u(r1,f1,$1,G0.value,F1),G0!==null&&(g&&G0.alternate!==null&&r1.delete(G0.key===null?$1:G0.key),Y1=Z(G0,Y1,$1),k0===null?i1=G0:k0.sibling=G0,k0=G0);return g&&r1.forEach(function(i5){return x(f1,i5)}),o0&&r7(f1,$1),i1}function s1(f1,Y1,B1,F1){if(typeof B1==="object"&&B1!==null&&B1.type===ow&&B1.key===null&&(B1=B1.props.children),typeof B1==="object"&&B1!==null){switch(B1.$$typeof){case ux:w:{for(var i1=B1.key;Y1!==null;){if(Y1.key===i1){if(i1=B1.type,i1===ow){if(Y1.tag===7){Y(f1,Y1.sibling),F1=U(Y1,B1.props.children),F1.return=f1,f1=F1;break w}}else if(Y1.elementType===i1||typeof i1==="object"&&i1!==null&&i1.$$typeof===u6&&M9(i1)===Y1.type){Y(f1,Y1.sibling),F1=U(Y1,B1.props),ig(F1,B1),F1.return=f1,f1=F1;break w}Y(f1,Y1);break}else x(f1,Y1);Y1=Y1.sibling}B1.type===ow?(F1=V9(B1.props.children,f1.mode,F1,B1.key),F1.return=f1,f1=F1):(F1=Yq(B1.type,B1.key,B1.props,null,f1.mode,F1),ig(F1,B1),F1.return=f1,f1=F1)}return l(f1);case bf:w:{for(i1=B1.key;Y1!==null;){if(Y1.key===i1)if(Y1.tag===4&&Y1.stateNode.containerInfo===B1.containerInfo&&Y1.stateNode.implementation===B1.implementation){Y(f1,Y1.sibling),F1=U(Y1,B1.children||[]),F1.return=f1,f1=F1;break w}else{Y(f1,Y1);break}else x(f1,Y1);Y1=Y1.sibling}F1=eY(B1,f1.mode,F1),F1.return=f1,f1=F1}return l(f1);case u6:return B1=M9(B1),s1(f1,Y1,B1,F1)}if(gf(B1))return R1(f1,Y1,B1,F1);if(ng(B1)){if(i1=ng(B1),typeof i1!=="function")throw Error(y1(150));return B1=i1.call(B1),P1(f1,Y1,B1,F1)}if(typeof B1.then==="function")return s1(f1,Y1,sx(B1),F1);if(B1.$$typeof===n7)return s1(f1,Y1,nx(f1,B1),F1);ix(f1,B1)}return typeof B1==="string"&&B1!==""||typeof B1==="number"||typeof B1==="bigint"?(B1=""+B1,Y1!==null&&Y1.tag===6?(Y(f1,Y1.sibling),F1=U(Y1,B1),F1.return=f1,f1=F1):(Y(f1,Y1),F1=tY(B1,f1.mode,F1),F1.return=f1,f1=F1),l(f1)):Y(f1,Y1)}return function(f1,Y1,B1,F1){try{df=0;var i1=s1(f1,Y1,B1,F1);return vb=null,i1}catch(r1){if(r1===Cb||r1===bZ)throw r1;var k0=n3(29,r1,null,f1.mode);return k0.lanes=F1,k0.return=f1,k0}finally{}}}function $v(g){g.updateQueue={baseState:g.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ek(g,x){g=g.updateQueue,x.updateQueue===g&&(x.updateQueue={baseState:g.baseState,firstBaseUpdate:g.firstBaseUpdate,lastBaseUpdate:g.lastBaseUpdate,shared:g.shared,callbacks:null})}function g8(g){return{lane:g,tag:0,payload:null,callback:null,next:null}}function f8(g,x,Y){var G=g.updateQueue;if(G===null)return null;if(G=G.shared,(w5&2)!==0){var U=G.pending;return U===null?x.next=x:(x.next=U.next,U.next=x),G.pending=x,x=Kq(g),fA(g,null,Y),x}return wZ(g,G,x,Y),Kq(g)}function Uf(g,x,Y){if(x=x.updateQueue,x!==null&&(x=x.shared,(Y&4194048)!==0)){var G=x.lanes;G&=g.pendingLanes,Y|=G,x.lanes=Y,OB(g,Y)}}function bk(g,x){var{updateQueue:Y,alternate:G}=g;if(G!==null&&(G=G.updateQueue,Y===G)){var U=null,Z=null;if(Y=Y.firstBaseUpdate,Y!==null){do{var l={lane:Y.lane,tag:Y.tag,payload:Y.payload,callback:null,next:null};Z===null?U=Z=l:Z=Z.next=l,Y=Y.next}while(Y!==null);Z===null?U=Z=x:Z=Z.next=x}else U=Z=x;Y={baseState:G.baseState,firstBaseUpdate:U,lastBaseUpdate:Z,shared:G.shared,callbacks:G.callbacks},g.updateQueue=Y;return}g=Y.lastBaseUpdate,g===null?Y.firstBaseUpdate=x:g.next=x,Y.lastBaseUpdate=x}function Bf(){if(uk){var g=kb;if(g!==null)throw g}}function Af(g,x,Y,G){uk=!1;var U=g.updateQueue;p6=!1;var{firstBaseUpdate:Z,lastBaseUpdate:l}=U,N=U.shared.pending;if(N!==null){U.shared.pending=null;var P=N,w1=P.next;P.next=null,l===null?Z=w1:l.next=w1,l=P;var H1=g.alternate;H1!==null&&(H1=H1.updateQueue,N=H1.lastBaseUpdate,N!==l&&(N===null?H1.firstBaseUpdate=w1:N.next=w1,H1.lastBaseUpdate=P))}if(Z!==null){var r=U.baseState;l=0,H1=w1=P=null,N=Z;do{var z1=N.lane&-536870913,u=z1!==N.lane;if(u?(c0&z1)===z1:(G&z1)===z1){z1!==0&&z1===Ab&&(uk=!0),H1!==null&&(H1=H1.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});w:{var R1=g,P1=N;z1=x;var s1=Y;switch(P1.tag){case 1:if(R1=P1.payload,typeof R1==="function"){r=R1.call(s1,r,z1);break w}r=R1;break w;case 3:R1.flags=R1.flags&-65537|128;case 0:if(R1=P1.payload,z1=typeof R1==="function"?R1.call(s1,r,z1):R1,z1===null||z1===void 0)break w;r=O5({},r,z1);break w;case 2:p6=!0}}z1=N.callback,z1!==null&&(g.flags|=64,u&&(g.flags|=8192),u=U.callbacks,u===null?U.callbacks=[z1]:u.push(z1))}else u={lane:z1,tag:N.tag,payload:N.payload,callback:N.callback,next:null},H1===null?(w1=H1=u,P=r):H1=H1.next=u,l|=z1;if(N=N.next,N===null)if(N=U.shared.pending,N===null)break;else u=N,N=u.next,u.next=null,U.lastBaseUpdate=u,U.shared.pending=null}while(1);H1===null&&(P=r),U.baseState=P,U.firstBaseUpdate=w1,U.lastBaseUpdate=H1,Z===null&&(U.shared.lanes=0),G8|=l,g.lanes=l,g.memoizedState=r}}function HA(g,x){if(typeof g!=="function")throw Error(y1(191,g));g.call(x)}function UA(g,x){var Y=g.callbacks;if(Y!==null)for(g.callbacks=null,g=0;g<Y.length;g++)HA(Y[g],x)}function KU(g,x){g=x6,L5(dq,g),L5(Mb,x),x6=g|x.baseLanes}function pk(){L5(dq,x6),L5(Mb,Mb.current)}function jv(){x6=dq.current,S2(Mb),S2(dq)}function a6(g){var x=g.alternate;L5(g2,g2.current&1),L5(g4,g),V4===null&&(x===null||Mb.current!==null?V4=g:x.memoizedState!==null&&(V4=g))}function ck(g){L5(g2,g2.current),L5(g4,g),V4===null&&(V4=g)}function BA(g){g.tag===22?(L5(g2,g2.current),L5(g4,g),V4===null&&(V4=g)):r6(g)}function r6(){L5(g2,g2.current),L5(g4,g4.current)}function o3(g){S2(g4),V4===g&&(V4=null),S2(g2)}function Oq(g){for(var x=g;x!==null;){if(x.tag===13){var Y=x.memoizedState;if(Y!==null&&(Y=Y.dehydrated,Y===null||Gv(Y)||Hv(Y)))return x}else if(x.tag===19&&(x.memoizedProps.revealOrder==="forwards"||x.memoizedProps.revealOrder==="backwards"||x.memoizedProps.revealOrder==="unstable_legacy-backwards"||x.memoizedProps.revealOrder==="together")){if((x.flags&128)!==0)return x}else if(x.child!==null){x.child.return=x,x=x.child;continue}if(x===g)break;for(;x.sibling===null;){if(x.return===null||x.return===g)return null;x=x.return}x.sibling.return=x.return,x=x.sibling}return null}function n5(){throw Error(y1(321))}function mv(g,x){if(x===null)return!1;for(var Y=0;Y<x.length&&Y<g.length;Y++)if(!b4(g[Y],x[Y]))return!1;return!0}function _v(g,x,Y,G,U,Z){return g6=Z,T0=x,x.memoizedState=null,x.updateQueue=null,x.lanes=0,F0.H=g===null||g.memoizedState===null?aA:iv,C9=!1,Z=Y(G,U),C9=!1,Jb&&(Z=MA(x,Y,G,U)),AA(g),Z}function AA(g){F0.H=yf;var x=J5!==null&&J5.next!==null;if(g6=0,G2=J5=T0=null,yq=!1,Of=0,Gb=null,x)throw Error(y1(300));g===null||B2||(g=g.dependencies,g!==null&&Cq(g)&&(B2=!0))}function MA(g,x,Y,G){T0=g;var U=0;do{if(Jb&&(Gb=null),Of=0,Jb=!1,25<=U)throw Error(y1(301));if(U+=1,G2=J5=null,g.updateQueue!=null){var Z=g.updateQueue;Z.lastEffect=null,Z.events=null,Z.stores=null,Z.memoCache!=null&&(Z.memoCache.index=0)}F0.H=rA,Z=x(Y,G)}while(Jb);return Z}function Th(){var g=F0.H,x=g.useState()[0];return x=typeof x.then==="function"?pf(x):x,g=g.useState()[0],(J5!==null?J5.memoizedState:null)!==g&&(T0.flags|=1024),x}function Pv(){var g=Rq!==0;return Rq=0,g}function Ev(g,x,Y){x.updateQueue=g.updateQueue,x.flags&=-2053,g.lanes&=~Y}function uv(g){if(yq){for(g=g.memoizedState;g!==null;){var x=g.queue;x!==null&&(x.pending=null),g=g.next}yq=!1}g6=0,G2=J5=T0=null,Jb=!1,Of=Rq=0,Gb=null}function X3(){var g={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return G2===null?T0.memoizedState=G2=g:G2=G2.next=g,G2}function f2(){if(J5===null){var g=T0.alternate;g=g!==null?g.memoizedState:null}else g=J5.next;var x=G2===null?T0.memoizedState:G2.next;if(x!==null)G2=x,J5=g;else{if(g===null){if(T0.alternate===null)throw Error(y1(467));throw Error(y1(310))}J5=g,g={memoizedState:J5.memoizedState,baseState:J5.baseState,baseQueue:J5.baseQueue,queue:J5.queue,next:null},G2===null?T0.memoizedState=G2=g:G2=G2.next=g}return G2}function gZ(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function pf(g){var x=Of;return Of+=1,Gb===null&&(Gb=[]),g=vA(Gb,g,x),x=T0,(G2===null?x.memoizedState:G2.next)===null&&(x=x.alternate,F0.H=x===null||x.memoizedState===null?aA:iv),g}function fZ(g){if(g!==null&&typeof g==="object"){if(typeof g.then==="function")return pf(g);if(g.$$typeof===n7)return o2(g)}throw Error(y1(438,String(g)))}function pv(g){var x=null,Y=T0.updateQueue;if(Y!==null&&(x=Y.memoCache),x==null){var G=T0.alternate;G!==null&&(G=G.updateQueue,G!==null&&(G=G.memoCache,G!=null&&(x={data:G.data.map(function(U){return U.slice()}),index:0})))}if(x==null&&(x={data:[],index:0}),Y===null&&(Y=gZ(),T0.updateQueue=Y),Y.memoCache=x,Y=x.data[x.index],Y===void 0)for(Y=x.data[x.index]=Array(g),G=0;G<g;G++)Y[G]=LW;return x.index++,Y}function f6(g,x){return typeof x==="function"?x(g):x}function vq(g){var x=f2();return cv(x,J5,g)}function cv(g,x,Y){var G=g.queue;if(G===null)throw Error(y1(311));G.lastRenderedReducer=Y;var U=g.baseQueue,Z=G.pending;if(Z!==null){if(U!==null){var l=U.next;U.next=Z.next,Z.next=l}x.baseQueue=U=Z,G.pending=null}if(Z=g.baseState,U===null)g.memoizedState=Z;else{x=U.next;var N=l=null,P=null,w1=x,H1=!1;do{var r=w1.lane&-536870913;if(r!==w1.lane?(c0&r)===r:(g6&r)===r){var z1=w1.revertLane;if(z1===0)P!==null&&(P=P.next={lane:0,revertLane:0,gesture:null,action:w1.action,hasEagerState:w1.hasEagerState,eagerState:w1.eagerState,next:null}),r===Ab&&(H1=!0);else if((g6&z1)===z1){w1=w1.next,z1===Ab&&(H1=!0);continue}else r={lane:0,revertLane:w1.revertLane,gesture:null,action:w1.action,hasEagerState:w1.hasEagerState,eagerState:w1.eagerState,next:null},P===null?(N=P=r,l=Z):P=P.next=r,T0.lanes|=z1,G8|=z1;r=w1.action,C9&&Y(Z,r),Z=w1.hasEagerState?w1.eagerState:Y(Z,r)}else z1={lane:r,revertLane:w1.revertLane,gesture:w1.gesture,action:w1.action,hasEagerState:w1.hasEagerState,eagerState:w1.eagerState,next:null},P===null?(N=P=z1,l=Z):P=P.next=z1,T0.lanes|=r,G8|=r;w1=w1.next}while(w1!==null&&w1!==x);if(P===null?l=Z:P.next=N,!b4(Z,g.memoizedState)&&(B2=!0,H1&&(Y=kb,Y!==null)))throw Y;g.memoizedState=Z,g.baseState=l,g.baseQueue=P,G.lastRenderedState=Z}return U===null&&(G.lanes=0),[g.memoizedState,G.dispatch]}function gk(g){var x=f2(),Y=x.queue;if(Y===null)throw Error(y1(311));Y.lastRenderedReducer=g;var{dispatch:G,pending:U}=Y,Z=x.memoizedState;if(U!==null){Y.pending=null;var l=U=U.next;do Z=g(Z,l.action),l=l.next;while(l!==U);b4(Z,x.memoizedState)||(B2=!0),x.memoizedState=Z,x.baseQueue===null&&(x.baseState=Z),Y.lastRenderedState=Z}return[Z,G]}function XA(g,x,Y){var G=T0,U=f2(),Z=o0;if(Z){if(Y===void 0)throw Error(y1(407));Y=Y()}else Y=x();var l=!b4((J5||U).memoizedState,Y);if(l&&(U.memoizedState=Y,B2=!0),U=U.queue,av(LA.bind(null,G,U,g),[g]),U.getSnapshot!==x||l||G2!==null&&G2.memoizedState.tag&1){if(G.flags|=2048,Xb(9,{destroy:void 0},VA.bind(null,G,U,Y,x),null),M5===null)throw Error(y1(349));Z||(g6&127)!==0||QA(G,x,Y)}return Y}function QA(g,x,Y){g.flags|=16384,g={getSnapshot:x,value:Y},x=T0.updateQueue,x===null?(x=gZ(),T0.updateQueue=x,x.stores=[g]):(Y=x.stores,Y===null?x.stores=[g]:Y.push(g))}function VA(g,x,Y,G){x.value=Y,x.getSnapshot=G,WA(x)&&hA(g)}function LA(g,x,Y){return Y(function(){WA(x)&&hA(g)})}function WA(g){var x=g.getSnapshot;g=g.value;try{var Y=x();return!b4(g,Y)}catch(G){return!0}}function hA(g){var x=R9(g,2);x!==null&&R3(x,g,2)}function ak(g){var x=X3();if(typeof g==="function"){var Y=g;if(g=Y(),C9){n6(!0);try{Y()}finally{n6(!1)}}}return x.memoizedState=x.baseState=g,x.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:f6,lastRenderedState:g},x}function FA(g,x,Y,G){return g.baseState=Y,cv(g,J5,typeof G==="function"?G:f6)}function $h(g,x,Y,G,U){if(xZ(g))throw Error(y1(485));if(g=x.action,g!==null){var Z={payload:U,action:g,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(l){Z.listeners.push(l)}};F0.T!==null?Y(!0):Z.isTransition=!1,G(Z),Y=x.pending,Y===null?(Z.next=x.pending=Z,KA(x,Z)):(Z.next=Y.next,x.pending=Y.next=Z)}}function KA(g,x){var{action:Y,payload:G}=x,U=g.state;if(x.isTransition){var Z=F0.T,l={};F0.T=l;try{var N=Y(U,G),P=F0.S;P!==null&&P(l,N),lU(g,x,N)}catch(w1){rk(g,x,w1)}finally{Z!==null&&l.types!==null&&(Z.types=l.types),F0.T=Z}}else try{Z=Y(U,G),lU(g,x,Z)}catch(w1){rk(g,x,w1)}}function lU(g,x,Y){Y!==null&&typeof Y==="object"&&typeof Y.then==="function"?Y.then(function(G){CU(g,x,G)},function(G){return rk(g,x,G)}):CU(g,x,Y)}function CU(g,x,Y){x.status="fulfilled",x.value=Y,lA(x),g.state=Y,x=g.pending,x!==null&&(Y=x.next,Y===x?g.pending=null:(Y=Y.next,x.next=Y,KA(g,Y)))}function rk(g,x,Y){var G=g.pending;if(g.pending=null,G!==null){G=G.next;do x.status="rejected",x.reason=Y,lA(x),x=x.next;while(x!==G)}g.action=null}function lA(g){g=g.listeners;for(var x=0;x<g.length;x++)(0,g[x])()}function CA(g,x){return x}function DU(g,x){if(o0){var Y=M5.formState;if(Y!==null){w:{var G=T0;if(o0){if(d5){b:{var U=d5;for(var Z=Q4;U.nodeType!==8;){if(!Z){U=null;break b}if(U=L4(U.nextSibling),U===null){U=null;break b}}Z=U.data,U=Z==="F!"||Z==="F"?U:null}if(U){d5=L4(U.nextSibling),G=U.data==="F!";break w}}v8(G)}G=!1}G&&(x=Y[0])}}return Y=X3(),Y.memoizedState=Y.baseState=x,G={pending:null,lanes:0,dispatch:null,lastRenderedReducer:CA,lastRenderedState:x},Y.queue=G,Y=uA.bind(null,T0,G),G.dispatch=Y,G=ak(!1),Z=sv.bind(null,T0,!1,G.queue),G=X3(),U={state:x,dispatch:null,action:g,pending:null},G.queue=U,Y=$h.bind(null,T0,U,Z,Y),U.dispatch=Y,G.memoizedState=g,[x,Y,!1]}function dU(g){var x=f2();return DA(x,J5,g)}function DA(g,x,Y){if(x=cv(g,x,CA)[0],g=vq(f6)[0],typeof x==="object"&&x!==null&&typeof x.then==="function")try{var G=pf(x)}catch(l){if(l===Cb)throw bZ;throw l}else G=x;x=f2();var U=x.queue,Z=U.dispatch;return Y!==x.memoizedState&&(T0.flags|=2048,Xb(9,{destroy:void 0},jh.bind(null,U,Y),null)),[G,Z,g]}function jh(g,x){g.action=x}function OU(g){var x=f2(),Y=J5;if(Y!==null)return DA(x,Y,g);f2(),x=x.memoizedState,Y=f2();var G=Y.queue.dispatch;return Y.memoizedState=g,[x,G,!1]}function Xb(g,x,Y,G){return g={tag:g,create:Y,deps:G,inst:x,next:null},x=T0.updateQueue,x===null&&(x=gZ(),T0.updateQueue=x),Y=x.lastEffect,Y===null?x.lastEffect=g.next=g:(G=Y.next,Y.next=g,g.next=G,x.lastEffect=g),g}function dA(){return f2().memoizedState}function Jq(g,x,Y,G){var U=X3();T0.flags|=g,U.memoizedState=Xb(1|x,{destroy:void 0},Y,G===void 0?null:G)}function zZ(g,x,Y,G){var U=f2();G=G===void 0?null:G;var Z=U.memoizedState.inst;J5!==null&&G!==null&&mv(G,J5.memoizedState.deps)?U.memoizedState=Xb(x,Z,Y,G):(T0.flags|=g,U.memoizedState=Xb(1|x,Z,Y,G))}function yU(g,x){Jq(8390656,8,g,x)}function av(g,x){zZ(2048,8,g,x)}function mh(g){T0.flags|=4;var x=T0.updateQueue;if(x===null)x=gZ(),T0.updateQueue=x,x.events=[g];else{var Y=x.events;Y===null?x.events=[g]:Y.push(g)}}function OA(g){var x=f2().memoizedState;return mh({ref:x,nextImpl:g}),function(){if((w5&2)!==0)throw Error(y1(440));return x.impl.apply(void 0,arguments)}}function yA(g,x){return zZ(4,2,g,x)}function RA(g,x){return zZ(4,4,g,x)}function NA(g,x){if(typeof x==="function"){g=g();var Y=x(g);return function(){typeof Y==="function"?Y():x(null)}}if(x!==null&&x!==void 0)return g=g(),x.current=g,function(){x.current=null}}function IA(g,x,Y){Y=Y!==null&&Y!==void 0?Y.concat([g]):null,zZ(4,4,NA.bind(null,x,g),Y)}function rv(){}function SA(g,x){var Y=f2();x=x===void 0?null:x;var G=Y.memoizedState;if(x!==null&&mv(x,G[1]))return G[0];return Y.memoizedState=[g,x],g}function TA(g,x){var Y=f2();x=x===void 0?null:x;var G=Y.memoizedState;if(x!==null&&mv(x,G[1]))return G[0];if(G=g(),C9){n6(!0);try{g()}finally{n6(!1)}}return Y.memoizedState=[G,x],G}function ov(g,x,Y){if(Y===void 0||(g6&1073741824)!==0&&(c0&261930)===0)return g.memoizedState=x;return g.memoizedState=Y,g=FM(),T0.lanes|=g,G8|=g,Y}function $A(g,x,Y,G){if(b4(Y,x))return Y;if(Mb.current!==null)return g=ov(g,Y,G),b4(g,x)||(B2=!0),g;if((g6&42)===0||(g6&1073741824)!==0&&(c0&261930)===0)return B2=!0,g.memoizedState=Y;return g=FM(),T0.lanes|=g,G8|=g,x}function jA(g,x,Y,G,U){var Z=b5.p;b5.p=Z!==0&&8>Z?Z:8;var l=F0.T,N={};F0.T=N,sv(g,!1,x,Y);try{var P=U(),w1=F0.S;if(w1!==null&&w1(N,P),P!==null&&typeof P==="object"&&typeof P.then==="function"){var H1=Ih(P,G);Mf(g,x,H1,w4(g))}else Mf(g,x,G,w4(g))}catch(r){Mf(g,x,{then:function(){},status:"rejected",reason:r},w4())}finally{b5.p=Z,l!==null&&N.types!==null&&(l.types=N.types),F0.T=l}}function _h(){}function ok(g,x,Y,G){if(g.tag!==5)throw Error(y1(476));var U=mA(g).queue;jA(g,U,x,Q9,Y===null?_h:function(){return _A(g),Y(G)})}function mA(g){var x=g.memoizedState;if(x!==null)return x;x={memoizedState:Q9,baseState:Q9,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:f6,lastRenderedState:Q9},next:null};var Y={};return x.next={memoizedState:Y,baseState:Y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:f6,lastRenderedState:Y},next:null},g.memoizedState=x,g=g.alternate,g!==null&&(g.memoizedState=x),x}function _A(g){var x=mA(g);x.next===null&&(x=g.alternate.memoizedState),Mf(g,x.next.queue,{},w4())}function nv(){return o2(If)}function PA(){return f2().memoizedState}function EA(){return f2().memoizedState}function Ph(g){for(var x=g.return;x!==null;){switch(x.tag){case 24:case 3:var Y=w4();g=g8(Y);var G=f8(x,g,Y);G!==null&&(R3(G,x,Y),Uf(G,x,Y)),x={cache:Iv()},g.payload=x;return}x=x.return}}function Eh(g,x,Y){var G=w4();Y={lane:G,revertLane:0,gesture:null,action:Y,hasEagerState:!1,eagerState:null,next:null},xZ(g)?pA(x,Y):(Y=Ov(g,x,Y,G),Y!==null&&(R3(Y,g,G),cA(Y,x,G)))}function uA(g,x,Y){var G=w4();Mf(g,x,Y,G)}function Mf(g,x,Y,G){var U={lane:G,revertLane:0,gesture:null,action:Y,hasEagerState:!1,eagerState:null,next:null};if(xZ(g))pA(x,U);else{var Z=g.alternate;if(g.lanes===0&&(Z===null||Z.lanes===0)&&(Z=x.lastRenderedReducer,Z!==null))try{var l=x.lastRenderedState,N=Z(l,Y);if(U.hasEagerState=!0,U.eagerState=N,b4(N,l))return wZ(g,x,U,0),M5===null&&eq(),!1}catch(P){}finally{}if(Y=Ov(g,x,U,G),Y!==null)return R3(Y,g,G),cA(Y,x,G),!0}return!1}function sv(g,x,Y,G){if(G={lane:2,revertLane:xJ(),gesture:null,action:G,hasEagerState:!1,eagerState:null,next:null},xZ(g)){if(x)throw Error(y1(479))}else x=Ov(g,Y,G,2),x!==null&&R3(x,g,2)}function xZ(g){var x=g.alternate;return g===T0||x!==null&&x===T0}function pA(g,x){Jb=yq=!0;var Y=g.pending;Y===null?x.next=x:(x.next=Y.next,Y.next=x),g.pending=x}function cA(g,x,Y){if((Y&4194048)!==0){var G=x.lanes;G&=g.pendingLanes,Y|=G,x.lanes=Y,OB(g,Y)}}function fk(g,x,Y,G){x=g.memoizedState,Y=Y(G,x),Y=Y===null||Y===void 0?x:O5({},x,Y),g.memoizedState=Y,g.lanes===0&&(g.updateQueue.baseState=Y)}function RU(g,x,Y,G,U,Z,l){return g=g.stateNode,typeof g.shouldComponentUpdate==="function"?g.shouldComponentUpdate(G,Z,l):x.prototype&&x.prototype.isPureReactComponent?!lf(Y,G)||!lf(U,Z):!0}function NU(g,x,Y,G){g=x.state,typeof x.componentWillReceiveProps==="function"&&x.componentWillReceiveProps(Y,G),typeof x.UNSAFE_componentWillReceiveProps==="function"&&x.UNSAFE_componentWillReceiveProps(Y,G),x.state!==g&&nk.enqueueReplaceState(x,x.state,null)}function D9(g,x){var Y=x;if("ref"in x){Y={};for(var G in x)G!=="ref"&&(Y[G]=x[G])}if(g=g.defaultProps){Y===x&&(Y=O5({},Y));for(var U in g)Y[U]===void 0&&(Y[U]=g[U])}return Y}function oA(g){Fq(g)}function nA(g){console.error(g)}function sA(g){Fq(g)}function Nq(g,x){try{var Y=g.onUncaughtError;Y(x.value,{componentStack:x.stack})}catch(G){setTimeout(function(){throw G})}}function IU(g,x,Y){try{var G=g.onCaughtError;G(Y.value,{componentStack:Y.stack,errorBoundary:x.tag===1?x.stateNode:null})}catch(U){setTimeout(function(){throw U})}}function sk(g,x,Y){return Y=g8(Y),Y.tag=3,Y.payload={element:null},Y.callback=function(){Nq(g,x)},Y}function iA(g){return g=g8(g),g.tag=3,g}function tA(g,x,Y,G){var U=Y.type.getDerivedStateFromError;if(typeof U==="function"){var Z=G.value;g.payload=function(){return U(Z)},g.callback=function(){IU(x,Y,G)}}var l=Y.stateNode;l!==null&&typeof l.componentDidCatch==="function"&&(g.callback=function(){IU(x,Y,G),typeof U!=="function"&&(z8===null?z8=new Set([this]):z8.add(this));var N=G.stack;this.componentDidCatch(G.value,{componentStack:N!==null?N:""})})}function uh(g,x,Y,G,U){if(Y.flags|=32768,G!==null&&typeof G==="object"&&typeof G.then==="function"){if(x=Y.alternate,x!==null&&lb(x,Y,U,!0),Y=g4.current,Y!==null){switch(Y.tag){case 31:case 13:return V4===null?jq():Y.alternate===null&&s5===0&&(s5=3),Y.flags&=-257,Y.flags|=65536,Y.lanes=U,G===Dq?Y.flags|=16384:(x=Y.updateQueue,x===null?Y.updateQueue=new Set([G]):x.add(G),Uk(g,G,U)),!1;case 22:return Y.flags|=65536,G===Dq?Y.flags|=16384:(x=Y.updateQueue,x===null?(x={transitions:null,markerInstances:null,retryQueue:new Set([G])},Y.updateQueue=x):(Y=x.retryQueue,Y===null?x.retryQueue=new Set([G]):Y.add(G)),Uk(g,G,U)),!1}throw Error(y1(435,Y.tag))}return Uk(g,G,U),jq(),!1}if(o0)return x=g4.current,x!==null?((x.flags&65536)===0&&(x.flags|=256),x.flags|=65536,x.lanes=U,G!==$k&&(g=Error(y1(422),{cause:G}),Df(X4(g,Y)))):(G!==$k&&(x=Error(y1(423),{cause:G}),Df(X4(x,Y))),g=g.current.alternate,g.flags|=65536,U&=-U,g.lanes|=U,G=X4(G,Y),U=sk(g.stateNode,G,U),bk(g,U),s5!==4&&(s5=2)),!1;var Z=Error(y1(520),{cause:G});if(Z=X4(Z,Y),Vf===null?Vf=[Z]:Vf.push(Z),s5!==4&&(s5=2),x===null)return!0;G=X4(G,Y),Y=x;do{switch(Y.tag){case 3:return Y.flags|=65536,g=U&-U,Y.lanes|=g,g=sk(Y.stateNode,G,g),bk(Y,g),!1;case 1:if(x=Y.type,Z=Y.stateNode,(Y.flags&128)===0&&(typeof x.getDerivedStateFromError==="function"||Z!==null&&typeof Z.componentDidCatch==="function"&&(z8===null||!z8.has(Z))))return Y.flags|=65536,U&=-U,Y.lanes|=U,U=iA(U),tA(U,g,Y,G),bk(Y,U),!1}Y=Y.return}while(Y!==null);return!1}function c2(g,x,Y,G){x.child=g===null?GA(x,null,Y,G):l9(x,g.child,Y,G)}function SU(g,x,Y,G,U){Y=Y.render;var Z=x.ref;if("ref"in G){var l={};for(var N in G)N!=="ref"&&(l[N]=G[N])}else l=G;if(K9(x),G=_v(g,x,Y,l,Z,U),N=Pv(),g!==null&&!B2)return Ev(g,x,U),z6(g,x,U);return o0&&N&&Rv(x),x.flags|=1,c2(g,x,G,U),x.child}function TU(g,x,Y,G,U){if(g===null){var Z=Y.type;if(typeof Z==="function"&&!yv(Z)&&Z.defaultProps===void 0&&Y.compare===null)return x.tag=15,x.type=Z,eA(g,x,Z,G,U);return g=Yq(Y.type,null,G,x,x.mode,U),g.ref=x.ref,g.return=x,x.child=g}if(Z=g.child,!ev(g,U)){var l=Z.memoizedProps;if(Y=Y.compare,Y=Y!==null?Y:lf,Y(l,G)&&g.ref===x.ref)return z6(g,x,U)}return x.flags|=1,g=t7(Z,G),g.ref=x.ref,g.return=x,x.child=g}function eA(g,x,Y,G,U){if(g!==null){var Z=g.memoizedProps;if(lf(Z,G)&&g.ref===x.ref)if(B2=!1,x.pendingProps=G=Z,ev(g,U))(g.flags&131072)!==0&&(B2=!0);else return x.lanes=g.lanes,z6(g,x,U)}return ik(g,x,Y,G,U)}function wM(g,x,Y,G){var U=G.children,Z=g!==null?g.memoizedState:null;if(g===null&&x.stateNode===null&&(x.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),G.mode==="hidden"){if((x.flags&128)!==0){if(Z=Z!==null?Z.baseLanes|Y:Y,g!==null){G=x.child=g.child;for(U=0;G!==null;)U=U|G.lanes|G.childLanes,G=G.sibling;G=U&~Z}else G=0,x.child=null;return $U(g,x,Z,Y,G)}if((Y&536870912)!==0)x.memoizedState={baseLanes:0,cachePool:null},g!==null&&kq(x,Z!==null?Z.cachePool:null),Z!==null?KU(x,Z):pk(),BA(x);else return G=x.lanes=536870912,$U(g,x,Z!==null?Z.baseLanes|Y:Y,Y,G)}else Z!==null?(kq(x,Z.cachePool),KU(x,Z),r6(x),x.memoizedState=null):(g!==null&&kq(x,null),pk(),r6(x));return c2(g,x,U,Y),x.child}function qf(g,x){return g!==null&&g.tag===22||x.stateNode!==null||(x.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),x.sibling}function $U(g,x,Y,G,U){var Z=Sv();return Z=Z===null?null:{parent:U2._currentValue,pool:Z},x.memoizedState={baseLanes:Y,cachePool:Z},g!==null&&kq(x,null),pk(),BA(x),g!==null&&lb(g,x,G,!0),x.childLanes=U,null}function Gq(g,x){return x=Iq({mode:x.mode,children:x.children},g.mode),x.ref=g.ref,g.child=x,x.return=g,x}function jU(g,x,Y){return l9(x,g.child,null,Y),g=Gq(x,x.pendingProps),g.flags|=2,o3(x),x.memoizedState=null,g}function ph(g,x,Y){var G=x.pendingProps,U=(x.flags&128)!==0;if(x.flags&=-129,g===null){if(o0){if(G.mode==="hidden")return g=Gq(x,G),x.lanes=536870912,qf(null,g);if(ck(x),(g=d5)?(g=aM(g,Q4),g=g!==null&&g.data==="&"?g:null,g!==null&&(x.memoizedState={dehydrated:g,treeContext:k8!==null?{id:Y7,overflow:k7}:null,retryLane:536870912,hydrationErrors:null},Y=xA(g),Y.return=x,x.child=Y,r2=x,d5=null)):g=null,g===null)throw v8(x);return x.lanes=536870912,null}return Gq(x,G)}var Z=g.memoizedState;if(Z!==null){var l=Z.dehydrated;if(ck(x),U)if(x.flags&256)x.flags&=-257,x=jU(g,x,Y);else if(x.memoizedState!==null)x.child=g.child,x.flags|=128,x=null;else throw Error(y1(558));else if(B2||lb(g,x,Y,!1),U=(Y&g.childLanes)!==0,B2||U){if(G=M5,G!==null&&(l=yB(G,Y),l!==0&&l!==Z.retryLane))throw Z.retryLane=l,R9(g,l),R3(G,g,l),tv;jq(),x=jU(g,x,Y)}else g=Z.treeContext,d5=L4(l.nextSibling),r2=x,o0=!0,b8=null,Q4=!1,g!==null&&ZA(x,g),x=Gq(x,G),x.flags|=4096;return x}return g=t7(g.child,{mode:G.mode,children:G.children}),g.ref=x.ref,x.child=g,g.return=x,g}function Hq(g,x){var Y=x.ref;if(Y===null)g!==null&&g.ref!==null&&(x.flags|=4194816);else{if(typeof Y!=="function"&&typeof Y!=="object")throw Error(y1(284));if(g===null||g.ref!==Y)x.flags|=4194816}}function ik(g,x,Y,G,U){if(K9(x),Y=_v(g,x,Y,G,void 0,U),G=Pv(),g!==null&&!B2)return Ev(g,x,U),z6(g,x,U);return o0&&G&&Rv(x),x.flags|=1,c2(g,x,Y,U),x.child}function mU(g,x,Y,G,U,Z){if(K9(x),x.updateQueue=null,Y=MA(x,G,Y,U),AA(g),G=Pv(),g!==null&&!B2)return Ev(g,x,Z),z6(g,x,Z);return o0&&G&&Rv(x),x.flags|=1,c2(g,x,Y,Z),x.child}function _U(g,x,Y,G,U){if(K9(x),x.stateNode===null){var Z=gb,l=Y.contextType;typeof l==="object"&&l!==null&&(Z=o2(l)),Z=new Y(G,Z),x.memoizedState=Z.state!==null&&Z.state!==void 0?Z.state:null,Z.updater=nk,x.stateNode=Z,Z._reactInternals=x,Z=x.stateNode,Z.props=G,Z.state=x.memoizedState,Z.refs={},$v(x),l=Y.contextType,Z.context=typeof l==="object"&&l!==null?o2(l):gb,Z.state=x.memoizedState,l=Y.getDerivedStateFromProps,typeof l==="function"&&(fk(x,Y,l,G),Z.state=x.memoizedState),typeof Y.getDerivedStateFromProps==="function"||typeof Z.getSnapshotBeforeUpdate==="function"||typeof Z.UNSAFE_componentWillMount!=="function"&&typeof Z.componentWillMount!=="function"||(l=Z.state,typeof Z.componentWillMount==="function"&&Z.componentWillMount(),typeof Z.UNSAFE_componentWillMount==="function"&&Z.UNSAFE_componentWillMount(),l!==Z.state&&nk.enqueueReplaceState(Z,Z.state,null),Af(x,G,Z,U),Bf(),Z.state=x.memoizedState),typeof Z.componentDidMount==="function"&&(x.flags|=4194308),G=!0}else if(g===null){Z=x.stateNode;var N=x.memoizedProps,P=D9(Y,N);Z.props=P;var w1=Z.context,H1=Y.contextType;l=gb,typeof H1==="object"&&H1!==null&&(l=o2(H1));var r=Y.getDerivedStateFromProps;H1=typeof r==="function"||typeof Z.getSnapshotBeforeUpdate==="function",N=x.pendingProps!==N,H1||typeof Z.UNSAFE_componentWillReceiveProps!=="function"&&typeof Z.componentWillReceiveProps!=="function"||(N||w1!==l)&&NU(x,Z,G,l),p6=!1;var z1=x.memoizedState;Z.state=z1,Af(x,G,Z,U),Bf(),w1=x.memoizedState,N||z1!==w1||p6?(typeof r==="function"&&(fk(x,Y,r,G),w1=x.memoizedState),(P=p6||RU(x,Y,P,G,z1,w1,l))?(H1||typeof Z.UNSAFE_componentWillMount!=="function"&&typeof Z.componentWillMount!=="function"||(typeof Z.componentWillMount==="function"&&Z.componentWillMount(),typeof Z.UNSAFE_componentWillMount==="function"&&Z.UNSAFE_componentWillMount()),typeof Z.componentDidMount==="function"&&(x.flags|=4194308)):(typeof Z.componentDidMount==="function"&&(x.flags|=4194308),x.memoizedProps=G,x.memoizedState=w1),Z.props=G,Z.state=w1,Z.context=l,G=P):(typeof Z.componentDidMount==="function"&&(x.flags|=4194308),G=!1)}else{Z=x.stateNode,Ek(g,x),l=x.memoizedProps,H1=D9(Y,l),Z.props=H1,r=x.pendingProps,z1=Z.context,w1=Y.contextType,P=gb,typeof w1==="object"&&w1!==null&&(P=o2(w1)),N=Y.getDerivedStateFromProps,(w1=typeof N==="function"||typeof Z.getSnapshotBeforeUpdate==="function")||typeof Z.UNSAFE_componentWillReceiveProps!=="function"&&typeof Z.componentWillReceiveProps!=="function"||(l!==r||z1!==P)&&NU(x,Z,G,P),p6=!1,z1=x.memoizedState,Z.state=z1,Af(x,G,Z,U),Bf();var u=x.memoizedState;l!==r||z1!==u||p6||g!==null&&g.dependencies!==null&&Cq(g.dependencies)?(typeof N==="function"&&(fk(x,Y,N,G),u=x.memoizedState),(H1=p6||RU(x,Y,H1,G,z1,u,P)||g!==null&&g.dependencies!==null&&Cq(g.dependencies))?(w1||typeof Z.UNSAFE_componentWillUpdate!=="function"&&typeof Z.componentWillUpdate!=="function"||(typeof Z.componentWillUpdate==="function"&&Z.componentWillUpdate(G,u,P),typeof Z.UNSAFE_componentWillUpdate==="function"&&Z.UNSAFE_componentWillUpdate(G,u,P)),typeof Z.componentDidUpdate==="function"&&(x.flags|=4),typeof Z.getSnapshotBeforeUpdate==="function"&&(x.flags|=1024)):(typeof Z.componentDidUpdate!=="function"||l===g.memoizedProps&&z1===g.memoizedState||(x.flags|=4),typeof Z.getSnapshotBeforeUpdate!=="function"||l===g.memoizedProps&&z1===g.memoizedState||(x.flags|=1024),x.memoizedProps=G,x.memoizedState=u),Z.props=G,Z.state=u,Z.context=P,G=H1):(typeof Z.componentDidUpdate!=="function"||l===g.memoizedProps&&z1===g.memoizedState||(x.flags|=4),typeof Z.getSnapshotBeforeUpdate!=="function"||l===g.memoizedProps&&z1===g.memoizedState||(x.flags|=1024),G=!1)}return Z=G,Hq(g,x),G=(x.flags&128)!==0,Z||G?(Z=x.stateNode,Y=G&&typeof Y.getDerivedStateFromError!=="function"?null:Z.render(),x.flags|=1,g!==null&&G?(x.child=l9(x,g.child,null,U),x.child=l9(x,null,Y,U)):c2(g,x,Y,U),x.memoizedState=Z.state,g=x.child):g=z6(g,x,U),g}function PU(g,x,Y,G){return F9(),x.flags|=256,c2(g,x,Y,G),x.child}function xk(g){return{baseLanes:g,cachePool:kA()}}function qk(g,x,Y){return g=g!==null?g.childLanes&~Y:0,x&&(g|=s3),g}function bM(g,x,Y){var G=x.pendingProps,U=!1,Z=(x.flags&128)!==0,l;if((l=Z)||(l=g!==null&&g.memoizedState===null?!1:(g2.current&2)!==0),l&&(U=!0,x.flags&=-129),l=(x.flags&32)!==0,x.flags&=-33,g===null){if(o0){if(U?a6(x):r6(x),(g=d5)?(g=aM(g,Q4),g=g!==null&&g.data!=="&"?g:null,g!==null&&(x.memoizedState={dehydrated:g,treeContext:k8!==null?{id:Y7,overflow:k7}:null,retryLane:536870912,hydrationErrors:null},Y=xA(g),Y.return=x,x.child=Y,r2=x,d5=null)):g=null,g===null)throw v8(x);return Hv(g)?x.lanes=32:x.lanes=536870912,null}var N=G.children;if(G=G.fallback,U)return r6(x),U=x.mode,N=Iq({mode:"hidden",children:N},U),G=V9(G,U,Y,null),N.return=x,G.return=x,N.sibling=G,x.child=N,G=x.child,G.memoizedState=xk(Y),G.childLanes=qk(g,l,Y),x.memoizedState=zk,qf(null,G);return a6(x),tk(x,N)}var P=g.memoizedState;if(P!==null&&(N=P.dehydrated,N!==null)){if(Z)x.flags&256?(a6(x),x.flags&=-257,x=Zk(g,x,Y)):x.memoizedState!==null?(r6(x),x.child=g.child,x.flags|=128,x=null):(r6(x),N=G.fallback,U=x.mode,G=Iq({mode:"visible",children:G.children},U),N=V9(N,U,Y,null),N.flags|=2,G.return=x,N.return=x,G.sibling=N,x.child=G,l9(x,g.child,null,Y),G=x.child,G.memoizedState=xk(Y),G.childLanes=qk(g,l,Y),x.memoizedState=zk,x=qf(null,G));else if(a6(x),Hv(N)){if(l=N.nextSibling&&N.nextSibling.dataset,l)var w1=l.dgst;l=w1,G=Error(y1(419)),G.stack="",G.digest=l,Df({value:G,source:null,stack:null}),x=Zk(g,x,Y)}else if(B2||lb(g,x,Y,!1),l=(Y&g.childLanes)!==0,B2||l){if(l=M5,l!==null&&(G=yB(l,Y),G!==0&&G!==P.retryLane))throw P.retryLane=G,R9(g,G),R3(l,g,G),tv;Gv(N)||jq(),x=Zk(g,x,Y)}else Gv(N)?(x.flags|=192,x.child=g.child,x=null):(g=P.treeContext,d5=L4(N.nextSibling),r2=x,o0=!0,b8=null,Q4=!1,g!==null&&ZA(x,g),x=tk(x,G.children),x.flags|=4096);return x}if(U)return r6(x),N=G.fallback,U=x.mode,P=g.child,w1=P.sibling,G=t7(P,{mode:"hidden",children:G.children}),G.subtreeFlags=P.subtreeFlags&65011712,w1!==null?N=t7(w1,N):(N=V9(N,U,Y,null),N.flags|=2),N.return=x,G.return=x,G.sibling=N,x.child=G,qf(null,G),G=x.child,N=g.child.memoizedState,N===null?N=xk(Y):(U=N.cachePool,U!==null?(P=U2._currentValue,U=U.parent!==P?{parent:P,pool:P}:U):U=kA(),N={baseLanes:N.baseLanes|Y,cachePool:U}),G.memoizedState=N,G.childLanes=qk(g,l,Y),x.memoizedState=zk,qf(g.child,G);return a6(x),Y=g.child,g=Y.sibling,Y=t7(Y,{mode:"visible",children:G.children}),Y.return=x,Y.sibling=null,g!==null&&(l=x.deletions,l===null?(x.deletions=[g],x.flags|=16):l.push(g)),x.child=Y,x.memoizedState=null,Y}function tk(g,x){return x=Iq({mode:"visible",children:x},g.mode),x.return=g,g.child=x}function Iq(g,x){return g=n3(22,g,null,x),g.lanes=0,g}function Zk(g,x,Y){return l9(x,g.child,null,Y),g=tk(x,x.pendingProps.children),g.flags|=2,x.memoizedState=null,g}function EU(g,x,Y){g.lanes|=x;var G=g.alternate;G!==null&&(G.lanes|=x),mk(g.return,x,Y)}function Yk(g,x,Y,G,U,Z){var l=g.memoizedState;l===null?g.memoizedState={isBackwards:x,rendering:null,renderingStartTime:0,last:G,tail:Y,tailMode:U,treeForkCount:Z}:(l.isBackwards=x,l.rendering=null,l.renderingStartTime=0,l.last=G,l.tail=Y,l.tailMode=U,l.treeForkCount=Z)}function gM(g,x,Y){var G=x.pendingProps,U=G.revealOrder,Z=G.tail;G=G.children;var l=g2.current,N=(l&2)!==0;if(N?(l=l&1|2,x.flags|=128):l&=1,L5(g2,l),c2(g,x,G,Y),G=o0?Cf:0,!N&&g!==null&&(g.flags&128)!==0)w:for(g=x.child;g!==null;){if(g.tag===13)g.memoizedState!==null&&EU(g,Y,x);else if(g.tag===19)EU(g,Y,x);else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===x)break w;for(;g.sibling===null;){if(g.return===null||g.return===x)break w;g=g.return}g.sibling.return=g.return,g=g.sibling}switch(U){case"forwards":Y=x.child;for(U=null;Y!==null;)g=Y.alternate,g!==null&&Oq(g)===null&&(U=Y),Y=Y.sibling;Y=U,Y===null?(U=x.child,x.child=null):(U=Y.sibling,Y.sibling=null),Yk(x,!1,U,Y,Z,G);break;case"backwards":case"unstable_legacy-backwards":Y=null,U=x.child;for(x.child=null;U!==null;){if(g=U.alternate,g!==null&&Oq(g)===null){x.child=U;break}g=U.sibling,U.sibling=Y,Y=U,U=g}Yk(x,!0,Y,null,Z,G);break;case"together":Yk(x,!1,null,null,void 0,G);break;default:x.memoizedState=null}return x.child}function z6(g,x,Y){if(g!==null&&(x.dependencies=g.dependencies),G8|=x.lanes,(Y&x.childLanes)===0)if(g!==null){if(lb(g,x,Y,!1),(Y&x.childLanes)===0)return null}else return null;if(g!==null&&x.child!==g.child)throw Error(y1(153));if(x.child!==null){g=x.child,Y=t7(g,g.pendingProps),x.child=Y;for(Y.return=x;g.sibling!==null;)g=g.sibling,Y=Y.sibling=t7(g,g.pendingProps),Y.return=x;Y.sibling=null}return x.child}function ev(g,x){if((g.lanes&x)!==0)return!0;return g=g.dependencies,g!==null&&Cq(g)?!0:!1}function ch(g,x,Y){switch(x.tag){case 3:Vq(x,x.stateNode.containerInfo),c6(x,U2,g.memoizedState.cache),F9();break;case 27:case 5:lk(x);break;case 4:Vq(x,x.stateNode.containerInfo);break;case 10:c6(x,x.type,x.memoizedProps.value);break;case 31:if(x.memoizedState!==null)return x.flags|=128,ck(x),null;break;case 13:var G=x.memoizedState;if(G!==null){if(G.dehydrated!==null)return a6(x),x.flags|=128,null;if((Y&x.child.childLanes)!==0)return bM(g,x,Y);return a6(x),g=z6(g,x,Y),g!==null?g.sibling:null}a6(x);break;case 19:var U=(g.flags&128)!==0;if(G=(Y&x.childLanes)!==0,G||(lb(g,x,Y,!1),G=(Y&x.childLanes)!==0),U){if(G)return gM(g,x,Y);x.flags|=128}if(U=x.memoizedState,U!==null&&(U.rendering=null,U.tail=null,U.lastEffect=null),L5(g2,g2.current),G)break;else return null;case 22:return x.lanes=0,wM(g,x,Y,x.pendingProps);case 24:c6(x,U2,g.memoizedState.cache)}return z6(g,x,Y)}function fM(g,x,Y){if(g!==null)if(g.memoizedProps!==x.pendingProps)B2=!0;else{if(!ev(g,Y)&&(x.flags&128)===0)return B2=!1,ch(g,x,Y);B2=(g.flags&131072)!==0?!0:!1}else B2=!1,o0&&(x.flags&1048576)!==0&&qA(x,Cf,x.index);switch(x.lanes=0,x.tag){case 16:w:{var G=x.pendingProps;if(g=M9(x.elementType),x.type=g,typeof g==="function")yv(g)?(G=D9(g,G),x.tag=1,x=_U(null,x,g,G,Y)):(x.tag=0,x=ik(null,x,g,G,Y));else{if(g!==void 0&&g!==null){var U=g.$$typeof;if(U===Mv){x.tag=11,x=SU(null,x,g,G,Y);break w}else if(U===Xv){x.tag=14,x=TU(null,x,g,G,Y);break w}}throw x=Fk(g)||g,Error(y1(306,x,""))}}return x;case 0:return ik(g,x,x.type,x.pendingProps,Y);case 1:return G=x.type,U=D9(G,x.pendingProps),_U(g,x,G,U,Y);case 3:w:{if(Vq(x,x.stateNode.containerInfo),g===null)throw Error(y1(387));G=x.pendingProps;var Z=x.memoizedState;U=Z.element,Ek(g,x),Af(x,G,null,Y);var l=x.memoizedState;if(G=l.cache,c6(x,U2,G),G!==Z.cache&&_k(x,[U2],Y,!0),Bf(),G=l.element,Z.isDehydrated)if(Z={element:G,isDehydrated:!1,cache:l.cache},x.updateQueue.baseState=Z,x.memoizedState=Z,x.flags&256){x=PU(g,x,G,Y);break w}else if(G!==U){U=X4(Error(y1(424)),x),Df(U),x=PU(g,x,G,Y);break w}else{switch(g=x.stateNode.containerInfo,g.nodeType){case 9:g=g.body;break;default:g=g.nodeName==="HTML"?g.ownerDocument.body:g}d5=L4(g.firstChild),r2=x,o0=!0,b8=null,Q4=!0,Y=GA(x,null,G,Y);for(x.child=Y;Y;)Y.flags=Y.flags&-3|4096,Y=Y.sibling}else{if(F9(),G===U){x=z6(g,x,Y);break w}c2(g,x,G,Y)}x=x.child}return x;case 26:return Hq(g,x),g===null?(Y=YB(x.type,null,x.pendingProps,null))?x.memoizedState=Y:o0||(Y=x.type,g=x.pendingProps,G=Eq(w8.current).createElement(Y),G[a2]=x,G[N3]=g,n2(G,Y,g),I2(G),x.stateNode=G):x.memoizedState=YB(x.type,g.memoizedProps,x.pendingProps,g.memoizedState),null;case 27:return lk(x),g===null&&o0&&(G=x.stateNode=rM(x.type,x.pendingProps,w8.current),r2=x,Q4=!0,U=d5,U8(x.type)?(Uv=U,d5=L4(G.firstChild)):d5=U),c2(g,x,x.pendingProps.children,Y),Hq(g,x),g===null&&(x.flags|=4194304),x.child;case 5:if(g===null&&o0){if(U=G=d5)G=QF(G,x.type,x.pendingProps,Q4),G!==null?(x.stateNode=G,r2=x,d5=L4(G.firstChild),Q4=!1,U=!0):U=!1;U||v8(x)}return lk(x),U=x.type,Z=x.pendingProps,l=g!==null?g.memoizedProps:null,G=Z.children,vv(U,Z)?G=null:l!==null&&vv(U,l)&&(x.flags|=32),x.memoizedState!==null&&(U=_v(g,x,Th,null,null,Y),If._currentValue=U),Hq(g,x),c2(g,x,G,Y),x.child;case 6:if(g===null&&o0){if(g=Y=d5)Y=VF(Y,x.pendingProps,Q4),Y!==null?(x.stateNode=Y,r2=x,d5=null,g=!0):g=!1;g||v8(x)}return null;case 13:return bM(g,x,Y);case 4:return Vq(x,x.stateNode.containerInfo),G=x.pendingProps,g===null?x.child=l9(x,null,G,Y):c2(g,x,G,Y),x.child;case 11:return SU(g,x,x.type,x.pendingProps,Y);case 7:return c2(g,x,x.pendingProps,Y),x.child;case 8:return c2(g,x,x.pendingProps.children,Y),x.child;case 12:return c2(g,x,x.pendingProps.children,Y),x.child;case 10:return G=x.pendingProps,c6(x,x.type,G.value),c2(g,x,G.children,Y),x.child;case 9:return U=x.type._context,G=x.pendingProps.children,K9(x),U=o2(U),G=G(U),x.flags|=1,c2(g,x,G,Y),x.child;case 14:return TU(g,x,x.type,x.pendingProps,Y);case 15:return eA(g,x,x.type,x.pendingProps,Y);case 19:return gM(g,x,Y);case 31:return ph(g,x,Y);case 22:return wM(g,x,Y,x.pendingProps);case 24:return K9(x),G=o2(U2),g===null?(U=Sv(),U===null&&(U=M5,Z=Iv(),U.pooledCache=Z,Z.refCount++,Z!==null&&(U.pooledCacheLanes|=Y),U=Z),x.memoizedState={parent:G,cache:U},$v(x),c6(x,U2,U)):((g.lanes&Y)!==0&&(Ek(g,x),Af(x,null,null,Y),Bf()),U=g.memoizedState,Z=x.memoizedState,U.parent!==G?(U={parent:G,cache:G},x.memoizedState=U,x.lanes===0&&(x.memoizedState=x.updateQueue.baseState=U),c6(x,U2,G)):(G=Z.cache,c6(x,U2,G),G!==U.cache&&_k(x,[U2],Y,!0))),c2(g,x,x.pendingProps.children,Y),x.child;case 29:throw x.pendingProps}throw Error(y1(156,x.tag))}function u7(g){g.flags|=4}function kk(g,x,Y,G,U){if(x=(g.mode&32)!==0)x=!1;if(x){if(g.flags|=16777216,(U&335544128)===U)if(g.stateNode.complete)g.flags|=8192;else if(CM())g.flags|=8192;else throw W9=Dq,Tv}else g.flags&=-16777217}function uU(g,x){if(x.type!=="stylesheet"||(x.state.loading&4)!==0)g.flags&=-16777217;else if(g.flags|=16777216,!sM(x))if(CM())g.flags|=8192;else throw W9=Dq,Tv}function tx(g,x){x!==null&&(g.flags|=4),g.flags&16384&&(x=g.tag!==22?DB():536870912,g.lanes|=x,Qb|=x)}function tg(g,x){if(!o0)switch(g.tailMode){case"hidden":x=g.tail;for(var Y=null;x!==null;)x.alternate!==null&&(Y=x),x=x.sibling;Y===null?g.tail=null:Y.sibling=null;break;case"collapsed":Y=g.tail;for(var G=null;Y!==null;)Y.alternate!==null&&(G=Y),Y=Y.sibling;G===null?x||g.tail===null?g.tail=null:g.tail.sibling=null:G.sibling=null}}function D5(g){var x=g.alternate!==null&&g.alternate.child===g.child,Y=0,G=0;if(x)for(var U=g.child;U!==null;)Y|=U.lanes|U.childLanes,G|=U.subtreeFlags&65011712,G|=U.flags&65011712,U.return=g,U=U.sibling;else for(U=g.child;U!==null;)Y|=U.lanes|U.childLanes,G|=U.subtreeFlags,G|=U.flags,U.return=g,U=U.sibling;return g.subtreeFlags|=G,g.childLanes=Y,x}function ah(g,x,Y){var G=x.pendingProps;switch(Nv(x),x.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return D5(x),null;case 1:return D5(x),null;case 3:if(Y=x.stateNode,G=null,g!==null&&(G=g.memoizedState.cache),x.memoizedState.cache!==G&&(x.flags|=2048),e7(U2),Hb(),Y.pendingContext&&(Y.context=Y.pendingContext,Y.pendingContext=null),g===null||g.child===null)uw(x)?u7(x):g===null||g.memoizedState.isDehydrated&&(x.flags&256)===0||(x.flags|=1024,wk());return D5(x),null;case 26:var{type:U,memoizedState:Z}=x;return g===null?(u7(x),Z!==null?(D5(x),uU(x,Z)):(D5(x),kk(x,U,null,G,Y))):Z?Z!==g.memoizedState?(u7(x),D5(x),uU(x,Z)):(D5(x),x.flags&=-16777217):(g=g.memoizedProps,g!==G&&u7(x),D5(x),kk(x,U,g,G,Y)),null;case 27:if(Lq(x),Y=w8.current,U=x.type,g!==null&&x.stateNode!=null)g.memoizedProps!==G&&u7(x);else{if(!G){if(x.stateNode===null)throw Error(y1(166));return D5(x),null}g=J7.current,uw(x)?XU(x,g):(g=rM(U,G,Y),x.stateNode=g,u7(x))}return D5(x),null;case 5:if(Lq(x),U=x.type,g!==null&&x.stateNode!=null)g.memoizedProps!==G&&u7(x);else{if(!G){if(x.stateNode===null)throw Error(y1(166));return D5(x),null}if(Z=J7.current,uw(x))XU(x,Z);else{var l=Eq(w8.current);switch(Z){case 1:Z=l.createElementNS("http://www.w3.org/2000/svg",U);break;case 2:Z=l.createElementNS("http://www.w3.org/1998/Math/MathML",U);break;default:switch(U){case"svg":Z=l.createElementNS("http://www.w3.org/2000/svg",U);break;case"math":Z=l.createElementNS("http://www.w3.org/1998/Math/MathML",U);break;case"script":Z=l.createElement("div"),Z.innerHTML="<script></script>",Z=Z.removeChild(Z.firstChild);break;case"select":Z=typeof G.is==="string"?l.createElement("select",{is:G.is}):l.createElement("select"),G.multiple?Z.multiple=!0:G.size&&(Z.size=G.size);break;default:Z=typeof G.is==="string"?l.createElement(U,{is:G.is}):l.createElement(U)}}Z[a2]=x,Z[N3]=G;w:for(l=x.child;l!==null;){if(l.tag===5||l.tag===6)Z.appendChild(l.stateNode);else if(l.tag!==4&&l.tag!==27&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===x)break w;for(;l.sibling===null;){if(l.return===null||l.return===x)break w;l=l.return}l.sibling.return=l.return,l=l.sibling}x.stateNode=Z;w:switch(n2(Z,U,G),U){case"button":case"input":case"select":case"textarea":G=!!G.autoFocus;break w;case"img":G=!0;break w;default:G=!1}G&&u7(x)}}return D5(x),kk(x,x.type,g===null?null:g.memoizedProps,x.pendingProps,Y),null;case 6:if(g&&x.stateNode!=null)g.memoizedProps!==G&&u7(x);else{if(typeof G!=="string"&&x.stateNode===null)throw Error(y1(166));if(g=w8.current,uw(x)){if(g=x.stateNode,Y=x.memoizedProps,G=null,U=r2,U!==null)switch(U.tag){case 27:case 5:G=U.memoizedProps}g[a2]=x,g=g.nodeValue===Y||G!==null&&G.suppressHydrationWarning===!0||uM(g.nodeValue,Y)?!0:!1,g||v8(x,!0)}else g=Eq(g).createTextNode(G),g[a2]=x,x.stateNode=g}return D5(x),null;case 31:if(Y=x.memoizedState,g===null||g.memoizedState!==null){if(G=uw(x),Y!==null){if(g===null){if(!G)throw Error(y1(318));if(g=x.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(y1(557));g[a2]=x}else F9(),(x.flags&128)===0&&(x.memoizedState=null),x.flags|=4;D5(x),g=!1}else Y=wk(),g!==null&&g.memoizedState!==null&&(g.memoizedState.hydrationErrors=Y),g=!0;if(!g){if(x.flags&256)return o3(x),x;return o3(x),null}if((x.flags&128)!==0)throw Error(y1(558))}return D5(x),null;case 13:if(G=x.memoizedState,g===null||g.memoizedState!==null&&g.memoizedState.dehydrated!==null){if(U=uw(x),G!==null&&G.dehydrated!==null){if(g===null){if(!U)throw Error(y1(318));if(U=x.memoizedState,U=U!==null?U.dehydrated:null,!U)throw Error(y1(317));U[a2]=x}else F9(),(x.flags&128)===0&&(x.memoizedState=null),x.flags|=4;D5(x),U=!1}else U=wk(),g!==null&&g.memoizedState!==null&&(g.memoizedState.hydrationErrors=U),U=!0;if(!U){if(x.flags&256)return o3(x),x;return o3(x),null}}if(o3(x),(x.flags&128)!==0)return x.lanes=Y,x;return Y=G!==null,g=g!==null&&g.memoizedState!==null,Y&&(G=x.child,U=null,G.alternate!==null&&G.alternate.memoizedState!==null&&G.alternate.memoizedState.cachePool!==null&&(U=G.alternate.memoizedState.cachePool.pool),Z=null,G.memoizedState!==null&&G.memoizedState.cachePool!==null&&(Z=G.memoizedState.cachePool.pool),Z!==U&&(G.flags|=2048)),Y!==g&&Y&&(x.child.flags|=8192),tx(x,x.updateQueue),D5(x),null;case 4:return Hb(),g===null&&qJ(x.stateNode.containerInfo),D5(x),null;case 10:return e7(x.type),D5(x),null;case 19:if(S2(g2),G=x.memoizedState,G===null)return D5(x),null;if(U=(x.flags&128)!==0,Z=G.rendering,Z===null)if(U)tg(G,!1);else{if(s5!==0||g!==null&&(g.flags&128)!==0)for(g=x.child;g!==null;){if(Z=Oq(g),Z!==null){x.flags|=128,tg(G,!1),g=Z.updateQueue,x.updateQueue=g,tx(x,g),x.subtreeFlags=0,g=Y;for(Y=x.child;Y!==null;)zA(Y,g),Y=Y.sibling;return L5(g2,g2.current&1|2),o0&&r7(x,G.treeForkCount),x.child}g=g.sibling}G.tail!==null&&i3()>Tq&&(x.flags|=128,U=!0,tg(G,!1),x.lanes=4194304)}else{if(!U)if(g=Oq(Z),g!==null){if(x.flags|=128,U=!0,g=g.updateQueue,x.updateQueue=g,tx(x,g),tg(G,!0),G.tail===null&&G.tailMode==="hidden"&&!Z.alternate&&!o0)return D5(x),null}else 2*i3()-G.renderingStartTime>Tq&&Y!==536870912&&(x.flags|=128,U=!0,tg(G,!1),x.lanes=4194304);G.isBackwards?(Z.sibling=x.child,x.child=Z):(g=G.last,g!==null?g.sibling=Z:x.child=Z,G.last=Z)}if(G.tail!==null)return g=G.tail,G.rendering=g,G.tail=g.sibling,G.renderingStartTime=i3(),g.sibling=null,Y=g2.current,L5(g2,U?Y&1|2:Y&1),o0&&r7(x,G.treeForkCount),g;return D5(x),null;case 22:case 23:return o3(x),jv(),G=x.memoizedState!==null,g!==null?g.memoizedState!==null!==G&&(x.flags|=8192):G&&(x.flags|=8192),G?(Y&536870912)!==0&&(x.flags&128)===0&&(D5(x),x.subtreeFlags&6&&(x.flags|=8192)):D5(x),Y=x.updateQueue,Y!==null&&tx(x,Y.retryQueue),Y=null,g!==null&&g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(Y=g.memoizedState.cachePool.pool),G=null,x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(G=x.memoizedState.cachePool.pool),G!==Y&&(x.flags|=2048),g!==null&&S2(L9),null;case 24:return Y=null,g!==null&&(Y=g.memoizedState.cache),x.memoizedState.cache!==Y&&(x.flags|=2048),e7(U2),D5(x),null;case 25:return null;case 30:return null}throw Error(y1(156,x.tag))}function rh(g,x){switch(Nv(x),x.tag){case 1:return g=x.flags,g&65536?(x.flags=g&-65537|128,x):null;case 3:return e7(U2),Hb(),g=x.flags,(g&65536)!==0&&(g&128)===0?(x.flags=g&-65537|128,x):null;case 26:case 27:case 5:return Lq(x),null;case 31:if(x.memoizedState!==null){if(o3(x),x.alternate===null)throw Error(y1(340));F9()}return g=x.flags,g&65536?(x.flags=g&-65537|128,x):null;case 13:if(o3(x),g=x.memoizedState,g!==null&&g.dehydrated!==null){if(x.alternate===null)throw Error(y1(340));F9()}return g=x.flags,g&65536?(x.flags=g&-65537|128,x):null;case 19:return S2(g2),null;case 4:return Hb(),null;case 10:return e7(x.type),null;case 22:case 23:return o3(x),jv(),g!==null&&S2(L9),g=x.flags,g&65536?(x.flags=g&-65537|128,x):null;case 24:return e7(U2),null;case 25:return null;default:return null}}function zM(g,x){switch(Nv(x),x.tag){case 3:e7(U2),Hb();break;case 26:case 27:case 5:Lq(x);break;case 4:Hb();break;case 31:x.memoizedState!==null&&o3(x);break;case 13:o3(x);break;case 19:S2(g2);break;case 10:e7(x.type);break;case 22:case 23:o3(x),jv(),g!==null&&S2(L9);break;case 24:e7(U2)}}function cf(g,x){try{var Y=x.updateQueue,G=Y!==null?Y.lastEffect:null;if(G!==null){var U=G.next;Y=U;do{if((Y.tag&g)===g){G=void 0;var{create:Z,inst:l}=Y;G=Z(),l.destroy=G}Y=Y.next}while(Y!==U)}}catch(N){Y5(x,x.return,N)}}function J8(g,x,Y){try{var G=x.updateQueue,U=G!==null?G.lastEffect:null;if(U!==null){var Z=U.next;G=Z;do{if((G.tag&g)===g){var l=G.inst,N=l.destroy;if(N!==void 0){l.destroy=void 0,U=x;var P=Y,w1=N;try{w1()}catch(H1){Y5(U,P,H1)}}}G=G.next}while(G!==Z)}}catch(H1){Y5(x,x.return,H1)}}function xM(g){var x=g.updateQueue;if(x!==null){var Y=g.stateNode;try{UA(x,Y)}catch(G){Y5(g,g.return,G)}}}function qM(g,x,Y){Y.props=D9(g.type,g.memoizedProps),Y.state=g.memoizedState;try{Y.componentWillUnmount()}catch(G){Y5(g,x,G)}}function Xf(g,x){try{var Y=g.ref;if(Y!==null){switch(g.tag){case 26:case 27:case 5:var G=g.stateNode;break;case 30:G=g.stateNode;break;default:G=g.stateNode}typeof Y==="function"?g.refCleanup=Y(G):Y.current=G}}catch(U){Y5(g,x,U)}}function v7(g,x){var{ref:Y,refCleanup:G}=g;if(Y!==null)if(typeof G==="function")try{G()}catch(U){Y5(g,x,U)}finally{g.refCleanup=null,g=g.alternate,g!=null&&(g.refCleanup=null)}else if(typeof Y==="function")try{Y(null)}catch(U){Y5(g,x,U)}else Y.current=null}function ZM(g){var{type:x,memoizedProps:Y,stateNode:G}=g;try{w:switch(x){case"button":case"input":case"select":case"textarea":Y.autoFocus&&G.focus();break w;case"img":Y.src?G.src=Y.src:Y.srcSet&&(G.srcset=Y.srcSet)}}catch(U){Y5(g,g.return,U)}}function vk(g,x,Y){try{var G=g.stateNode;HF(G,g.type,Y,x),G[N3]=x}catch(U){Y5(g,g.return,U)}}function YM(g){return g.tag===5||g.tag===3||g.tag===26||g.tag===27&&U8(g.type)||g.tag===4}function Jk(g){w:for(;;){for(;g.sibling===null;){if(g.return===null||YM(g.return))return null;g=g.return}g.sibling.return=g.return;for(g=g.sibling;g.tag!==5&&g.tag!==6&&g.tag!==18;){if(g.tag===27&&U8(g.type))continue w;if(g.flags&2)continue w;if(g.child===null||g.tag===4)continue w;else g.child.return=g,g=g.child}if(!(g.flags&2))return g.stateNode}}function ek(g,x,Y){var G=g.tag;if(G===5||G===6)g=g.stateNode,x?(Y.nodeType===9?Y.body:Y.nodeName==="HTML"?Y.ownerDocument.body:Y).insertBefore(g,x):(x=Y.nodeType===9?Y.body:Y.nodeName==="HTML"?Y.ownerDocument.body:Y,x.appendChild(g),Y=Y._reactRootContainer,Y!==null&&Y!==void 0||x.onclick!==null||(x.onclick=s7));else if(G!==4&&(G===27&&U8(g.type)&&(Y=g.stateNode,x=null),g=g.child,g!==null))for(ek(g,x,Y),g=g.sibling;g!==null;)ek(g,x,Y),g=g.sibling}function Sq(g,x,Y){var G=g.tag;if(G===5||G===6)g=g.stateNode,x?Y.insertBefore(g,x):Y.appendChild(g);else if(G!==4&&(G===27&&U8(g.type)&&(Y=g.stateNode),g=g.child,g!==null))for(Sq(g,x,Y),g=g.sibling;g!==null;)Sq(g,x,Y),g=g.sibling}function kM(g){var{stateNode:x,memoizedProps:Y}=g;try{for(var G=g.type,U=x.attributes;U.length;)x.removeAttributeNode(U[0]);n2(x,G,Y),x[a2]=g,x[N3]=Y}catch(Z){Y5(g,g.return,Z)}}function oh(g,x){if(g=g.containerInfo,Yv=aq,g=sB(g),Dv(g)){if("selectionStart"in g)var Y={start:g.selectionStart,end:g.selectionEnd};else w:{Y=(Y=g.ownerDocument)&&Y.defaultView||window;var G=Y.getSelection&&Y.getSelection();if(G&&G.rangeCount!==0){Y=G.anchorNode;var{anchorOffset:U,focusNode:Z}=G;G=G.focusOffset;try{Y.nodeType,Z.nodeType}catch(P1){Y=null;break w}var l=0,N=-1,P=-1,w1=0,H1=0,r=g,z1=null;b:for(;;){for(var u;;){if(r!==Y||U!==0&&r.nodeType!==3||(N=l+U),r!==Z||G!==0&&r.nodeType!==3||(P=l+G),r.nodeType===3&&(l+=r.nodeValue.length),(u=r.firstChild)===null)break;z1=r,r=u}for(;;){if(r===g)break b;if(z1===Y&&++w1===U&&(N=l),z1===Z&&++H1===G&&(P=l),(u=r.nextSibling)!==null)break;r=z1,z1=r.parentNode}r=u}Y=N===-1||P===-1?null:{start:N,end:P}}else Y=null}Y=Y||{start:0,end:0}}else Y=null;kv={focusedElem:g,selectionRange:Y},aq=!1;for(N2=x;N2!==null;)if(x=N2,g=x.child,(x.subtreeFlags&1028)!==0&&g!==null)g.return=x,N2=g;else for(;N2!==null;){switch(x=N2,Z=x.alternate,g=x.flags,x.tag){case 0:if((g&4)!==0&&(g=x.updateQueue,g=g!==null?g.events:null,g!==null))for(Y=0;Y<g.length;Y++)U=g[Y],U.ref.impl=U.nextImpl;break;case 11:case 15:break;case 1:if((g&1024)!==0&&Z!==null){g=void 0,Y=x,U=Z.memoizedProps,Z=Z.memoizedState,G=Y.stateNode;try{var R1=D9(Y.type,U);g=G.getSnapshotBeforeUpdate(R1,Z),G.__reactInternalSnapshotBeforeUpdate=g}catch(P1){Y5(Y,Y.return,P1)}}break;case 3:if((g&1024)!==0){if(g=x.stateNode.containerInfo,Y=g.nodeType,Y===9)Jv(g);else if(Y===1)switch(g.nodeName){case"HEAD":case"HTML":case"BODY":Jv(g);break;default:g.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((g&1024)!==0)throw Error(y1(163))}if(g=x.sibling,g!==null){g.return=x.return,N2=g;break}N2=x.return}}function vM(g,x,Y){var G=Y.flags;switch(Y.tag){case 0:case 11:case 15:c7(g,Y),G&4&&cf(5,Y);break;case 1:if(c7(g,Y),G&4)if(g=Y.stateNode,x===null)try{g.componentDidMount()}catch(l){Y5(Y,Y.return,l)}else{var U=D9(Y.type,x.memoizedProps);x=x.memoizedState;try{g.componentDidUpdate(U,x,g.__reactInternalSnapshotBeforeUpdate)}catch(l){Y5(Y,Y.return,l)}}G&64&&xM(Y),G&512&&Xf(Y,Y.return);break;case 3:if(c7(g,Y),G&64&&(g=Y.updateQueue,g!==null)){if(x=null,Y.child!==null)switch(Y.child.tag){case 27:case 5:x=Y.child.stateNode;break;case 1:x=Y.child.stateNode}try{UA(g,x)}catch(l){Y5(Y,Y.return,l)}}break;case 27:x===null&&G&4&&kM(Y);case 26:case 5:c7(g,Y),x===null&&G&4&&ZM(Y),G&512&&Xf(Y,Y.return);break;case 12:c7(g,Y);break;case 31:c7(g,Y),G&4&&HM(g,Y);break;case 13:c7(g,Y),G&4&&UM(g,Y),G&64&&(g=Y.memoizedState,g!==null&&(g=g.dehydrated,g!==null&&(Y=fF.bind(null,Y),LF(g,Y))));break;case 22:if(G=Y.memoizedState!==null||o7,!G){x=x!==null&&x.memoizedState!==null||H2,U=o7;var Z=H2;o7=G,(H2=x)&&!Z?a7(g,Y,(Y.subtreeFlags&8772)!==0):c7(g,Y),o7=U,H2=Z}break;case 30:break;default:c7(g,Y)}}function JM(g){var x=g.alternate;x!==null&&(g.alternate=null,JM(x)),g.child=null,g.deletions=null,g.sibling=null,g.tag===5&&(x=g.stateNode,x!==null&&Wv(x)),g.stateNode=null,g.return=null,g.dependencies=null,g.memoizedProps=null,g.memoizedState=null,g.pendingProps=null,g.stateNode=null,g.updateQueue=null}function p7(g,x,Y){for(Y=Y.child;Y!==null;)GM(g,x,Y),Y=Y.sibling}function GM(g,x,Y){if(t3&&typeof t3.onCommitFiberUnmount==="function")try{t3.onCommitFiberUnmount(jf,Y)}catch(Z){}switch(Y.tag){case 26:H2||v7(Y,x),p7(g,x,Y),Y.memoizedState?Y.memoizedState.count--:Y.stateNode&&(Y=Y.stateNode,Y.parentNode.removeChild(Y));break;case 27:H2||v7(Y,x);var G=I5,U=O3;U8(Y.type)&&(I5=Y.stateNode,O3=!1),p7(g,x,Y),Wf(Y.stateNode),I5=G,O3=U;break;case 5:H2||v7(Y,x);case 6:if(G=I5,U=O3,I5=null,p7(g,x,Y),I5=G,O3=U,I5!==null)if(O3)try{(I5.nodeType===9?I5.body:I5.nodeName==="HTML"?I5.ownerDocument.body:I5).removeChild(Y.stateNode)}catch(Z){Y5(Y,x,Z)}else try{I5.removeChild(Y.stateNode)}catch(Z){Y5(Y,x,Z)}break;case 18:I5!==null&&(O3?(g=I5,fB(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,Y.stateNode),hb(g)):fB(I5,Y.stateNode));break;case 4:G=I5,U=O3,I5=Y.stateNode.containerInfo,O3=!0,p7(g,x,Y),I5=G,O3=U;break;case 0:case 11:case 14:case 15:J8(2,Y,x),H2||J8(4,Y,x),p7(g,x,Y);break;case 1:H2||(v7(Y,x),G=Y.stateNode,typeof G.componentWillUnmount==="function"&&qM(Y,x,G)),p7(g,x,Y);break;case 21:p7(g,x,Y);break;case 22:H2=(G=H2)||Y.memoizedState!==null,p7(g,x,Y),H2=G;break;default:p7(g,x,Y)}}function HM(g,x){if(x.memoizedState===null&&(g=x.alternate,g!==null&&(g=g.memoizedState,g!==null))){g=g.dehydrated;try{hb(g)}catch(Y){Y5(x,x.return,Y)}}}function UM(g,x){if(x.memoizedState===null&&(g=x.alternate,g!==null&&(g=g.memoizedState,g!==null&&(g=g.dehydrated,g!==null))))try{hb(g)}catch(Y){Y5(x,x.return,Y)}}function nh(g){switch(g.tag){case 31:case 13:case 19:var x=g.stateNode;return x===null&&(x=g.stateNode=new pU),x;case 22:return g=g.stateNode,x=g._retryCache,x===null&&(x=g._retryCache=new pU),x;default:throw Error(y1(435,g.tag))}}function ex(g,x){var Y=nh(g);x.forEach(function(G){if(!Y.has(G)){Y.add(G);var U=zF.bind(null,g,G);G.then(U,U)}})}function D3(g,x){var Y=x.deletions;if(Y!==null)for(var G=0;G<Y.length;G++){var U=Y[G],Z=g,l=x,N=l;w:for(;N!==null;){switch(N.tag){case 27:if(U8(N.type)){I5=N.stateNode,O3=!1;break w}break;case 5:I5=N.stateNode,O3=!1;break w;case 3:case 4:I5=N.stateNode.containerInfo,O3=!0;break w}N=N.return}if(I5===null)throw Error(y1(160));GM(Z,l,U),I5=null,O3=!1,Z=U.alternate,Z!==null&&(Z.return=null),U.return=null}if(x.subtreeFlags&13886)for(x=x.child;x!==null;)BM(x,g),x=x.sibling}function BM(g,x){var{alternate:Y,flags:G}=g;switch(g.tag){case 0:case 11:case 14:case 15:D3(x,g),d3(g),G&4&&(J8(3,g,g.return),cf(3,g),J8(5,g,g.return));break;case 1:D3(x,g),d3(g),G&512&&(H2||Y===null||v7(Y,Y.return)),G&64&&o7&&(g=g.updateQueue,g!==null&&(G=g.callbacks,G!==null&&(Y=g.shared.hiddenCallbacks,g.shared.hiddenCallbacks=Y===null?G:Y.concat(G))));break;case 26:var U=E4;if(D3(x,g),d3(g),G&512&&(H2||Y===null||v7(Y,Y.return)),G&4){var Z=Y!==null?Y.memoizedState:null;if(G=g.memoizedState,Y===null)if(G===null)if(g.stateNode===null){w:{G=g.type,Y=g.memoizedProps,U=U.ownerDocument||U;b:switch(G){case"title":if(Z=U.getElementsByTagName("title")[0],!Z||Z[Pf]||Z[a2]||Z.namespaceURI==="http://www.w3.org/2000/svg"||Z.hasAttribute("itemprop"))Z=U.createElement(G),U.head.insertBefore(Z,U.querySelector("head > title"));n2(Z,G,Y),Z[a2]=g,I2(Z),G=Z;break w;case"link":var l=vB("link","href",U).get(G+(Y.href||""));if(l){for(var N=0;N<l.length;N++)if(Z=l[N],Z.getAttribute("href")===(Y.href==null||Y.href===""?null:Y.href)&&Z.getAttribute("rel")===(Y.rel==null?null:Y.rel)&&Z.getAttribute("title")===(Y.title==null?null:Y.title)&&Z.getAttribute("crossorigin")===(Y.crossOrigin==null?null:Y.crossOrigin)){l.splice(N,1);break b}}Z=U.createElement(G),n2(Z,G,Y),U.head.appendChild(Z);break;case"meta":if(l=vB("meta","content",U).get(G+(Y.content||""))){for(N=0;N<l.length;N++)if(Z=l[N],Z.getAttribute("content")===(Y.content==null?null:""+Y.content)&&Z.getAttribute("name")===(Y.name==null?null:Y.name)&&Z.getAttribute("property")===(Y.property==null?null:Y.property)&&Z.getAttribute("http-equiv")===(Y.httpEquiv==null?null:Y.httpEquiv)&&Z.getAttribute("charset")===(Y.charSet==null?null:Y.charSet)){l.splice(N,1);break b}}Z=U.createElement(G),n2(Z,G,Y),U.head.appendChild(Z);break;default:throw Error(y1(468,G))}Z[a2]=g,I2(Z),G=Z}g.stateNode=G}else JB(U,g.type,g.stateNode);else g.stateNode=kB(U,G,g.memoizedProps);else Z!==G?(Z===null?Y.stateNode!==null&&(Y=Y.stateNode,Y.parentNode.removeChild(Y)):Z.count--,G===null?JB(U,g.type,g.stateNode):kB(U,G,g.memoizedProps)):G===null&&g.stateNode!==null&&vk(g,g.memoizedProps,Y.memoizedProps)}break;case 27:D3(x,g),d3(g),G&512&&(H2||Y===null||v7(Y,Y.return)),Y!==null&&G&4&&vk(g,g.memoizedProps,Y.memoizedProps);break;case 5:if(D3(x,g),d3(g),G&512&&(H2||Y===null||v7(Y,Y.return)),g.flags&32){U=g.stateNode;try{Bb(U,"")}catch(R1){Y5(g,g.return,R1)}}G&4&&g.stateNode!=null&&(U=g.memoizedProps,vk(g,U,Y!==null?Y.memoizedProps:U)),G&1024&&(Gk=!0);break;case 6:if(D3(x,g),d3(g),G&4){if(g.stateNode===null)throw Error(y1(162));G=g.memoizedProps,Y=g.stateNode;try{Y.nodeValue=G}catch(R1){Y5(g,g.return,R1)}}break;case 3:if(Aq=null,U=E4,E4=uq(x.containerInfo),D3(x,g),E4=U,d3(g),G&4&&Y!==null&&Y.memoizedState.isDehydrated)try{hb(x.containerInfo)}catch(R1){Y5(g,g.return,R1)}Gk&&(Gk=!1,AM(g));break;case 4:G=E4,E4=uq(g.stateNode.containerInfo),D3(x,g),d3(g),E4=G;break;case 12:D3(x,g),d3(g);break;case 31:D3(x,g),d3(g),G&4&&(G=g.updateQueue,G!==null&&(g.updateQueue=null,ex(g,G)));break;case 13:D3(x,g),d3(g),g.child.flags&8192&&g.memoizedState!==null!==(Y!==null&&Y.memoizedState!==null)&&(qZ=i3()),G&4&&(G=g.updateQueue,G!==null&&(g.updateQueue=null,ex(g,G)));break;case 22:U=g.memoizedState!==null;var P=Y!==null&&Y.memoizedState!==null,w1=o7,H1=H2;if(o7=w1||U,H2=H1||P,D3(x,g),H2=H1,o7=w1,d3(g),G&8192)w:for(x=g.stateNode,x._visibility=U?x._visibility&-2:x._visibility|1,U&&(Y===null||P||o7||H2||X9(g)),Y=null,x=g;;){if(x.tag===5||x.tag===26){if(Y===null){P=Y=x;try{if(Z=P.stateNode,U)l=Z.style,typeof l.setProperty==="function"?l.setProperty("display","none","important"):l.display="none";else{N=P.stateNode;var r=P.memoizedProps.style,z1=r!==void 0&&r!==null&&r.hasOwnProperty("display")?r.display:null;N.style.display=z1==null||typeof z1==="boolean"?"":(""+z1).trim()}}catch(R1){Y5(P,P.return,R1)}}}else if(x.tag===6){if(Y===null){P=x;try{P.stateNode.nodeValue=U?"":P.memoizedProps}catch(R1){Y5(P,P.return,R1)}}}else if(x.tag===18){if(Y===null){P=x;try{var u=P.stateNode;U?zB(u,!0):zB(P.stateNode,!1)}catch(R1){Y5(P,P.return,R1)}}}else if((x.tag!==22&&x.tag!==23||x.memoizedState===null||x===g)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===g)break w;for(;x.sibling===null;){if(x.return===null||x.return===g)break w;Y===x&&(Y=null),x=x.return}Y===x&&(Y=null),x.sibling.return=x.return,x=x.sibling}G&4&&(G=g.updateQueue,G!==null&&(Y=G.retryQueue,Y!==null&&(G.retryQueue=null,ex(g,Y))));break;case 19:D3(x,g),d3(g),G&4&&(G=g.updateQueue,G!==null&&(g.updateQueue=null,ex(g,G)));break;case 30:break;case 21:break;default:D3(x,g),d3(g)}}function d3(g){var x=g.flags;if(x&2){try{for(var Y,G=g.return;G!==null;){if(YM(G)){Y=G;break}G=G.return}if(Y==null)throw Error(y1(160));switch(Y.tag){case 27:var U=Y.stateNode,Z=Jk(g);Sq(g,Z,U);break;case 5:var l=Y.stateNode;Y.flags&32&&(Bb(l,""),Y.flags&=-33);var N=Jk(g);Sq(g,N,l);break;case 3:case 4:var P=Y.stateNode.containerInfo,w1=Jk(g);ek(g,w1,P);break;default:throw Error(y1(161))}}catch(H1){Y5(g,g.return,H1)}g.flags&=-3}x&4096&&(g.flags&=-4097)}function AM(g){if(g.subtreeFlags&1024)for(g=g.child;g!==null;){var x=g;AM(x),x.tag===5&&x.flags&1024&&x.stateNode.reset(),g=g.sibling}}function c7(g,x){if(x.subtreeFlags&8772)for(x=x.child;x!==null;)vM(g,x.alternate,x),x=x.sibling}function X9(g){for(g=g.child;g!==null;){var x=g;switch(x.tag){case 0:case 11:case 14:case 15:J8(4,x,x.return),X9(x);break;case 1:v7(x,x.return);var Y=x.stateNode;typeof Y.componentWillUnmount==="function"&&qM(x,x.return,Y),X9(x);break;case 27:Wf(x.stateNode);case 26:case 5:v7(x,x.return),X9(x);break;case 22:x.memoizedState===null&&X9(x);break;case 30:X9(x);break;default:X9(x)}g=g.sibling}}function a7(g,x,Y){Y=Y&&(x.subtreeFlags&8772)!==0;for(x=x.child;x!==null;){var G=x.alternate,U=g,Z=x,l=Z.flags;switch(Z.tag){case 0:case 11:case 15:a7(U,Z,Y),cf(4,Z);break;case 1:if(a7(U,Z,Y),G=Z,U=G.stateNode,typeof U.componentDidMount==="function")try{U.componentDidMount()}catch(w1){Y5(G,G.return,w1)}if(G=Z,U=G.updateQueue,U!==null){var N=G.stateNode;try{var P=U.shared.hiddenCallbacks;if(P!==null)for(U.shared.hiddenCallbacks=null,U=0;U<P.length;U++)HA(P[U],N)}catch(w1){Y5(G,G.return,w1)}}Y&&l&64&&xM(Z),Xf(Z,Z.return);break;case 27:kM(Z);case 26:case 5:a7(U,Z,Y),Y&&G===null&&l&4&&ZM(Z),Xf(Z,Z.return);break;case 12:a7(U,Z,Y);break;case 31:a7(U,Z,Y),Y&&l&4&&HM(U,Z);break;case 13:a7(U,Z,Y),Y&&l&4&&UM(U,Z);break;case 22:Z.memoizedState===null&&a7(U,Z,Y),Xf(Z,Z.return);break;case 30:break;default:a7(U,Z,Y)}x=x.sibling}}function wJ(g,x){var Y=null;g!==null&&g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(Y=g.memoizedState.cachePool.pool),g=null,x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(g=x.memoizedState.cachePool.pool),g!==Y&&(g!=null&&g.refCount++,Y!=null&&uf(Y))}function bJ(g,x){g=null,x.alternate!==null&&(g=x.alternate.memoizedState.cache),x=x.memoizedState.cache,x!==g&&(x.refCount++,g!=null&&uf(g))}function P4(g,x,Y,G){if(x.subtreeFlags&10256)for(x=x.child;x!==null;)MM(g,x,Y,G),x=x.sibling}function MM(g,x,Y,G){var U=x.flags;switch(x.tag){case 0:case 11:case 15:P4(g,x,Y,G),U&2048&&cf(9,x);break;case 1:P4(g,x,Y,G);break;case 3:P4(g,x,Y,G),U&2048&&(g=null,x.alternate!==null&&(g=x.alternate.memoizedState.cache),x=x.memoizedState.cache,x!==g&&(x.refCount++,g!=null&&uf(g)));break;case 12:if(U&2048){P4(g,x,Y,G),g=x.stateNode;try{var Z=x.memoizedProps,l=Z.id,N=Z.onPostCommit;typeof N==="function"&&N(l,x.alternate===null?"mount":"update",g.passiveEffectDuration,-0)}catch(P){Y5(x,x.return,P)}}else P4(g,x,Y,G);break;case 31:P4(g,x,Y,G);break;case 13:P4(g,x,Y,G);break;case 23:break;case 22:Z=x.stateNode,l=x.alternate,x.memoizedState!==null?Z._visibility&2?P4(g,x,Y,G):Qf(g,x):Z._visibility&2?P4(g,x,Y,G):(Z._visibility|=2,cw(g,x,Y,G,(x.subtreeFlags&10256)!==0||!1)),U&2048&&wJ(l,x);break;case 24:P4(g,x,Y,G),U&2048&&bJ(x.alternate,x);break;default:P4(g,x,Y,G)}}function cw(g,x,Y,G,U){U=U&&((x.subtreeFlags&10256)!==0||!1);for(x=x.child;x!==null;){var Z=g,l=x,N=Y,P=G,w1=l.flags;switch(l.tag){case 0:case 11:case 15:cw(Z,l,N,P,U),cf(8,l);break;case 23:break;case 22:var H1=l.stateNode;l.memoizedState!==null?H1._visibility&2?cw(Z,l,N,P,U):Qf(Z,l):(H1._visibility|=2,cw(Z,l,N,P,U)),U&&w1&2048&&wJ(l.alternate,l);break;case 24:cw(Z,l,N,P,U),U&&w1&2048&&bJ(l.alternate,l);break;default:cw(Z,l,N,P,U)}x=x.sibling}}function Qf(g,x){if(x.subtreeFlags&10256)for(x=x.child;x!==null;){var Y=g,G=x,U=G.flags;switch(G.tag){case 22:Qf(Y,G),U&2048&&wJ(G.alternate,G);break;case 24:Qf(Y,G),U&2048&&bJ(G.alternate,G);break;default:Qf(Y,G)}x=x.sibling}}function pw(g,x,Y){if(g.subtreeFlags&Zf)for(g=g.child;g!==null;)XM(g,x,Y),g=g.sibling}function XM(g,x,Y){switch(g.tag){case 26:pw(g,x,Y),g.flags&Zf&&g.memoizedState!==null&&NF(Y,E4,g.memoizedState,g.memoizedProps);break;case 5:pw(g,x,Y);break;case 3:case 4:var G=E4;E4=uq(g.stateNode.containerInfo),pw(g,x,Y),E4=G;break;case 22:g.memoizedState===null&&(G=g.alternate,G!==null&&G.memoizedState!==null?(G=Zf,Zf=16777216,pw(g,x,Y),Zf=G):pw(g,x,Y));break;default:pw(g,x,Y)}}function QM(g){var x=g.alternate;if(x!==null&&(g=x.child,g!==null)){x.child=null;do x=g.sibling,g.sibling=null,g=x;while(g!==null)}}function eg(g){var x=g.deletions;if((g.flags&16)!==0){if(x!==null)for(var Y=0;Y<x.length;Y++){var G=x[Y];N2=G,LM(G,g)}QM(g)}if(g.subtreeFlags&10256)for(g=g.child;g!==null;)VM(g),g=g.sibling}function VM(g){switch(g.tag){case 0:case 11:case 15:eg(g),g.flags&2048&&J8(9,g,g.return);break;case 3:eg(g);break;case 12:eg(g);break;case 22:var x=g.stateNode;g.memoizedState!==null&&x._visibility&2&&(g.return===null||g.return.tag!==13)?(x._visibility&=-3,Uq(g)):eg(g);break;default:eg(g)}}function Uq(g){var x=g.deletions;if((g.flags&16)!==0){if(x!==null)for(var Y=0;Y<x.length;Y++){var G=x[Y];N2=G,LM(G,g)}QM(g)}for(g=g.child;g!==null;){switch(x=g,x.tag){case 0:case 11:case 15:J8(8,x,x.return),Uq(x);break;case 22:Y=x.stateNode,Y._visibility&2&&(Y._visibility&=-3,Uq(x));break;default:Uq(x)}g=g.sibling}}function LM(g,x){for(;N2!==null;){var Y=N2;switch(Y.tag){case 0:case 11:case 15:J8(8,Y,x);break;case 23:case 22:if(Y.memoizedState!==null&&Y.memoizedState.cachePool!==null){var G=Y.memoizedState.cachePool.pool;G!=null&&G.refCount++}break;case 24:uf(Y.memoizedState.cache)}if(G=Y.child,G!==null)G.return=Y,N2=G;else w:for(Y=g;N2!==null;){G=N2;var{sibling:U,return:Z}=G;if(JM(G),G===Y){N2=null;break w}if(U!==null){U.return=Z,N2=U;break w}N2=Z}}}function w4(){return(w5&2)!==0&&c0!==0?c0&-c0:F0.T!==null?xJ():RB()}function FM(){if(s3===0)if((c0&536870912)===0||o0){var g=cx;cx<<=1,(cx&3932160)===0&&(cx=262144),s3=g}else s3=536870912;return g=g4.current,g!==null&&(g.flags|=32),s3}function R3(g,x,Y){if(g===M5&&(Z5===2||Z5===9)||g.cancelPendingCommit!==null)Lb(g,0),t6(g,c0,s3,!1);if(_f(g,Y),(w5&2)===0||g!==M5)g===M5&&((w5&2)===0&&(h9|=Y),s5===4&&t6(g,c0,s3,!1)),H7(g)}function KM(g,x,Y){if((w5&6)!==0)throw Error(y1(327));var G=!Y&&(x&127)===0&&(x&g.expiredLanes)===0||mf(g,x),U=G?wF(g,x):Hk(g,x,!0),Z=G;do{if(U===0){Db&&!G&&t6(g,x,0,!1);break}else{if(Y=g.current.alternate,Z&&!th(Y)){U=Hk(g,x,!1),Z=!1;continue}if(U===2){if(Z=x,g.errorRecoveryDisabledLanes&Z)var l=0;else l=g.pendingLanes&-536870913,l=l!==0?l:l&536870912?536870912:0;if(l!==0){x=l;w:{var N=g;U=Vf;var P=N.current.memoizedState.isDehydrated;if(P&&(Lb(N,l).flags|=256),l=Hk(N,l,!1),l!==2){if(gJ&&!P){N.errorRecoveryDisabledLanes|=Z,h9|=Z,U=4;break w}Z=y3,y3=U,Z!==null&&(y3===null?y3=Z:y3.push.apply(y3,Z))}U=l}if(Z=!1,U!==2)continue}}if(U===1){Lb(g,0),t6(g,x,0,!0);break}w:{switch(G=g,Z=U,Z){case 0:case 1:throw Error(y1(345));case 4:if((x&4194048)!==x)break;case 6:t6(G,x,s3,!i6);break w;case 2:y3=null;break;case 3:case 5:break;default:throw Error(y1(329))}if((x&62914560)===x&&(U=qZ+300-i3(),10<U)){if(t6(G,x,s3,!i6),nq(G,0,!0)!==0)break w;w6=x,G.timeoutHandle=cM(cU.bind(null,G,Y,y3,$q,wv,x,s3,h9,Qb,i6,Z,"Throttled",-0,0),U);break w}cU(G,Y,y3,$q,wv,x,s3,h9,Qb,i6,Z,null,-0,0)}}break}while(1);H7(g)}function cU(g,x,Y,G,U,Z,l,N,P,w1,H1,r,z1,u){if(g.timeoutHandle=-1,r=x.subtreeFlags,r&8192||(r&16785408)===16785408){r={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:s7},XM(x,Z,r);var R1=(Z&62914560)===Z?qZ-i3():(Z&4194048)===Z?WM-i3():0;if(R1=IF(r,R1),R1!==null){w6=Z,g.cancelPendingCommit=R1(rU.bind(null,g,x,Z,Y,G,U,l,N,P,H1,r,null,z1,u)),t6(g,Z,l,!w1);return}}rU(g,x,Z,Y,G,U,l,N,P)}function th(g){for(var x=g;;){var Y=x.tag;if((Y===0||Y===11||Y===15)&&x.flags&16384&&(Y=x.updateQueue,Y!==null&&(Y=Y.stores,Y!==null)))for(var G=0;G<Y.length;G++){var U=Y[G],Z=U.getSnapshot;U=U.value;try{if(!b4(Z(),U))return!1}catch(l){return!1}}if(Y=x.child,x.subtreeFlags&16384&&Y!==null)Y.return=x,x=Y;else{if(x===g)break;for(;x.sibling===null;){if(x.return===null||x.return===g)return!0;x=x.return}x.sibling.return=x.return,x=x.sibling}}return!0}function t6(g,x,Y,G){x&=~fJ,x&=~h9,g.suspendedLanes|=x,g.pingedLanes&=~x,G&&(g.warmLanes|=x),G=g.expirationTimes;for(var U=x;0<U;){var Z=31-e3(U),l=1<<Z;G[Z]=-1,U&=~l}Y!==0&&dB(g,Y,x)}function ZZ(){return(w5&6)===0?(af(0,!1),!1):!0}function zJ(){if(p0!==null){if(Z5===0)var g=p0.return;else g=p0,i7=N9=null,uv(g),vb=null,df=0,g=p0;for(;g!==null;)zM(g.alternate,g),g=g.return;p0=null}}function Lb(g,x){var Y=g.timeoutHandle;Y!==-1&&(g.timeoutHandle=-1,AF(Y)),Y=g.cancelPendingCommit,Y!==null&&(g.cancelPendingCommit=null,Y()),w6=0,zJ(),M5=g,p0=Y=t7(g.current,null),c0=x,Z5=0,r3=null,i6=!1,Db=mf(g,x),gJ=!1,Qb=s3=fJ=h9=G8=s5=0,y3=Vf=null,wv=!1,(x&8)!==0&&(x|=x&32);var G=g.entangledLanes;if(G!==0)for(g=g.entanglements,G&=x;0<G;){var U=31-e3(G),Z=1<<U;x|=g[U],G&=~Z}return x6=x,eq(),Y}function lM(g,x){T0=null,F0.H=yf,x===Cb||x===bZ?(x=hU(),Z5=3):x===Tv?(x=hU(),Z5=4):Z5=x===tv?8:x!==null&&typeof x==="object"&&typeof x.then==="function"?6:1,r3=x,p0===null&&(s5=1,Nq(g,X4(x,g.current)))}function CM(){var g=g4.current;return g===null?!0:(c0&4194048)===c0?V4===null?!0:!1:(c0&62914560)===c0||(c0&536870912)!==0?g===V4:!1}function DM(){var g=F0.H;return F0.H=yf,g===null?yf:g}function dM(){var g=F0.A;return F0.A=sh,g}function jq(){s5=4,i6||(c0&4194048)!==c0&&g4.current!==null||(Db=!0),(G8&134217727)===0&&(h9&134217727)===0||M5===null||t6(M5,c0,s3,!1)}function Hk(g,x,Y){var G=w5;w5|=2;var U=DM(),Z=dM();if(M5!==g||c0!==x)$q=null,Lb(g,x);x=!1;var l=s5;w:do try{if(Z5!==0&&p0!==null){var N=p0,P=r3;switch(Z5){case 8:zJ(),l=6;break w;case 3:case 2:case 9:case 6:g4.current===null&&(x=!0);var w1=Z5;if(Z5=0,r3=null,xb(g,N,P,w1),Y&&Db){l=0;break w}break;default:w1=Z5,Z5=0,r3=null,xb(g,N,P,w1)}}eh(),l=s5;break}catch(H1){lM(g,H1)}while(1);return x&&g.shellSuspendCounter++,i7=N9=null,w5=G,F0.H=U,F0.A=Z,p0===null&&(M5=null,c0=0,eq()),l}function eh(){for(;p0!==null;)OM(p0)}function wF(g,x){var Y=w5;w5|=2;var G=DM(),U=dM();M5!==g||c0!==x?($q=null,Tq=i3()+500,Lb(g,x)):Db=mf(g,x);w:do try{if(Z5!==0&&p0!==null){x=p0;var Z=r3;b:switch(Z5){case 1:Z5=0,r3=null,xb(g,x,Z,1);break;case 2:case 9:if(WU(Z)){Z5=0,r3=null,aU(x);break}x=function(){Z5!==2&&Z5!==9||M5!==g||(Z5=7),H7(g)},Z.then(x,x);break w;case 3:Z5=7;break w;case 4:Z5=5;break w;case 7:WU(Z)?(Z5=0,r3=null,aU(x)):(Z5=0,r3=null,xb(g,x,Z,7));break;case 5:var l=null;switch(p0.tag){case 26:l=p0.memoizedState;case 5:case 27:var N=p0;if(l?sM(l):N.stateNode.complete){Z5=0,r3=null;var P=N.sibling;if(P!==null)p0=P;else{var w1=N.return;w1!==null?(p0=w1,YZ(w1)):p0=null}break b}}Z5=0,r3=null,xb(g,x,Z,5);break;case 6:Z5=0,r3=null,xb(g,x,Z,6);break;case 8:zJ(),s5=6;break w;default:throw Error(y1(462))}}bF();break}catch(H1){lM(g,H1)}while(1);if(i7=N9=null,F0.H=G,F0.A=U,w5=Y,p0!==null)return 0;return M5=null,c0=0,eq(),s5}function bF(){for(;p0!==null&&!FW();)OM(p0)}function OM(g){var x=fM(g.alternate,g,x6);g.memoizedProps=g.pendingProps,x===null?YZ(g):p0=x}function aU(g){var x=g,Y=x.alternate;switch(x.tag){case 15:case 0:x=mU(Y,x,x.pendingProps,x.type,void 0,c0);break;case 11:x=mU(Y,x,x.pendingProps,x.type.render,x.ref,c0);break;case 5:uv(x);default:zM(Y,x),x=p0=zA(x,x6),x=fM(Y,x,x6)}g.memoizedProps=g.pendingProps,x===null?YZ(g):p0=x}function xb(g,x,Y,G){i7=N9=null,uv(x),vb=null,df=0;var U=x.return;try{if(uh(g,U,x,Y,c0)){s5=1,Nq(g,X4(Y,g.current)),p0=null;return}}catch(Z){if(U!==null)throw p0=U,Z;s5=1,Nq(g,X4(Y,g.current)),p0=null;return}if(x.flags&32768){if(o0||G===1)g=!0;else if(Db||(c0&536870912)!==0)g=!1;else if(i6=g=!0,G===2||G===9||G===3||G===6)G=g4.current,G!==null&&G.tag===13&&(G.flags|=16384);yM(x,g)}else YZ(x)}function YZ(g){var x=g;do{if((x.flags&32768)!==0){yM(x,i6);return}g=x.return;var Y=ah(x.alternate,x,x6);if(Y!==null){p0=Y;return}if(x=x.sibling,x!==null){p0=x;return}p0=x=g}while(x!==null);s5===0&&(s5=5)}function yM(g,x){do{var Y=rh(g.alternate,g);if(Y!==null){Y.flags&=32767,p0=Y;return}if(Y=g.return,Y!==null&&(Y.flags|=32768,Y.subtreeFlags=0,Y.deletions=null),!x&&(g=g.sibling,g!==null)){p0=g;return}p0=g=Y}while(g!==null);s5=6,p0=null}function rU(g,x,Y,G,U,Z,l,N,P){g.cancelPendingCommit=null;do kZ();while(K2!==0);if((w5&6)!==0)throw Error(y1(327));if(x!==null){if(x===g.current)throw Error(y1(177));if(Z=x.lanes|x.childLanes,Z|=dv,IW(g,Y,Z,l,N,P),g===M5&&(p0=M5=null,c0=0),Vb=x,x8=g,w6=Y,bv=Z,gv=U,hM=G,(x.subtreeFlags&10256)!==0||(x.flags&10256)!==0?(g.callbackNode=null,g.callbackPriority=0,xF(Wq,function(){return TM(),null})):(g.callbackNode=null,g.callbackPriority=0),G=(x.flags&13878)!==0,(x.subtreeFlags&13878)!==0||G){G=F0.T,F0.T=null,U=b5.p,b5.p=2,l=w5,w5|=4;try{oh(g,x,Y)}finally{w5=l,b5.p=U,F0.T=G}}K2=1,RM(),NM(),IM()}}function RM(){if(K2===1){K2=0;var g=x8,x=Vb,Y=(x.flags&13878)!==0;if((x.subtreeFlags&13878)!==0||Y){Y=F0.T,F0.T=null;var G=b5.p;b5.p=2;var U=w5;w5|=4;try{BM(x,g);var Z=kv,l=sB(g.containerInfo),N=Z.focusedElem,P=Z.selectionRange;if(l!==N&&N&&N.ownerDocument&&nB(N.ownerDocument.documentElement,N)){if(P!==null&&Dv(N)){var{start:w1,end:H1}=P;if(H1===void 0&&(H1=w1),"selectionStart"in N)N.selectionStart=w1,N.selectionEnd=Math.min(H1,N.value.length);else{var r=N.ownerDocument||document,z1=r&&r.defaultView||window;if(z1.getSelection){var u=z1.getSelection(),R1=N.textContent.length,P1=Math.min(P.start,R1),s1=P.end===void 0?P1:Math.min(P.end,R1);!u.extend&&P1>s1&&(l=s1,s1=P1,P1=l);var f1=BU(N,P1),Y1=BU(N,s1);if(f1&&Y1&&(u.rangeCount!==1||u.anchorNode!==f1.node||u.anchorOffset!==f1.offset||u.focusNode!==Y1.node||u.focusOffset!==Y1.offset)){var B1=r.createRange();B1.setStart(f1.node,f1.offset),u.removeAllRanges(),P1>s1?(u.addRange(B1),u.extend(Y1.node,Y1.offset)):(B1.setEnd(Y1.node,Y1.offset),u.addRange(B1))}}}}r=[];for(u=N;u=u.parentNode;)u.nodeType===1&&r.push({element:u,left:u.scrollLeft,top:u.scrollTop});typeof N.focus==="function"&&N.focus();for(N=0;N<r.length;N++){var F1=r[N];F1.element.scrollLeft=F1.left,F1.element.scrollTop=F1.top}}aq=!!Yv,kv=Yv=null}finally{w5=U,b5.p=G,F0.T=Y}}g.current=x,K2=2}}function NM(){if(K2===2){K2=0;var g=x8,x=Vb,Y=(x.flags&8772)!==0;if((x.subtreeFlags&8772)!==0||Y){Y=F0.T,F0.T=null;var G=b5.p;b5.p=2;var U=w5;w5|=4;try{vM(g,x.alternate,x)}finally{w5=U,b5.p=G,F0.T=Y}}K2=3}}function IM(){if(K2===4||K2===3){K2=0,KW();var g=x8,x=Vb,Y=w6,G=hM;(x.subtreeFlags&10256)!==0||(x.flags&10256)!==0?K2=5:(K2=0,Vb=x8=null,SM(g,g.pendingLanes));var U=g.pendingLanes;if(U===0&&(z8=null),Lv(Y),x=x.stateNode,t3&&typeof t3.onCommitFiberRoot==="function")try{t3.onCommitFiberRoot(jf,x,void 0,(x.current.flags&128)===128)}catch(P){}if(G!==null){x=F0.T,U=b5.p,b5.p=2,F0.T=null;try{for(var Z=g.onRecoverableError,l=0;l<G.length;l++){var N=G[l];Z(N.value,{componentStack:N.stack})}}finally{F0.T=x,b5.p=U}}(w6&3)!==0&&kZ(),H7(g),U=g.pendingLanes,(Y&261930)!==0&&(U&42)!==0?g===fv?Lf++:(Lf=0,fv=g):Lf=0,af(0,!1)}}function SM(g,x){(g.pooledCacheLanes&=x)===0&&(x=g.pooledCache,x!=null&&(g.pooledCache=null,uf(x)))}function kZ(){return RM(),NM(),IM(),TM()}function TM(){if(K2!==5)return!1;var g=x8,x=bv;bv=0;var Y=Lv(w6),G=F0.T,U=b5.p;try{b5.p=32>Y?32:Y,F0.T=null,Y=gv,gv=null;var Z=x8,l=w6;if(K2=0,Vb=x8=null,w6=0,(w5&6)!==0)throw Error(y1(331));var N=w5;if(w5|=4,VM(Z.current),MM(Z,Z.current,l,Y),w5=N,af(0,!1),t3&&typeof t3.onPostCommitFiberRoot==="function")try{t3.onPostCommitFiberRoot(jf,Z)}catch(P){}return!0}finally{b5.p=U,F0.T=G,SM(g,x)}}function oU(g,x,Y){x=X4(Y,x),x=sk(g.stateNode,x,2),g=f8(g,x,2),g!==null&&(_f(g,2),H7(g))}function Y5(g,x,Y){if(g.tag===3)oU(g,g,Y);else for(;x!==null;){if(x.tag===3){oU(x,g,Y);break}else if(x.tag===1){var G=x.stateNode;if(typeof x.type.getDerivedStateFromError==="function"||typeof G.componentDidCatch==="function"&&(z8===null||!z8.has(G))){g=X4(Y,g),Y=iA(2),G=f8(x,Y,2),G!==null&&(tA(Y,G,x,g),_f(G,2),H7(G));break}}x=x.return}}function Uk(g,x,Y){var G=g.pingCache;if(G===null){G=g.pingCache=new ih;var U=new Set;G.set(x,U)}else U=G.get(x),U===void 0&&(U=new Set,G.set(x,U));U.has(Y)||(gJ=!0,U.add(Y),g=gF.bind(null,g,x,Y),x.then(g,g))}function gF(g,x,Y){var G=g.pingCache;G!==null&&G.delete(x),g.pingedLanes|=g.suspendedLanes&Y,g.warmLanes&=~Y,M5===g&&(c0&Y)===Y&&(s5===4||s5===3&&(c0&62914560)===c0&&300>i3()-qZ?(w5&2)===0&&Lb(g,0):fJ|=Y,Qb===c0&&(Qb=0)),H7(g)}function $M(g,x){x===0&&(x=DB()),g=R9(g,x),g!==null&&(_f(g,x),H7(g))}function fF(g){var x=g.memoizedState,Y=0;x!==null&&(Y=x.retryLane),$M(g,Y)}function zF(g,x){var Y=0;switch(g.tag){case 31:case 13:var{stateNode:G,memoizedState:U}=g;U!==null&&(Y=U.retryLane);break;case 19:G=g.stateNode;break;case 22:G=g.stateNode._retryCache;break;default:throw Error(y1(314))}G!==null&&G.delete(x),$M(g,Y)}function xF(g,x){return Qv(g,x)}function H7(g){g!==aw&&g.next===null&&(aw===null?mq=aw=g:aw=aw.next=g),_q=!0,zv||(zv=!0,ZF())}function af(g,x){if(!Bk&&_q){Bk=!0;do{var Y=!1;for(var G=mq;G!==null;){if(!x)if(g!==0){var U=G.pendingLanes;if(U===0)var Z=0;else{var{suspendedLanes:l,pingedLanes:N}=G;Z=(1<<31-e3(42|g)+1)-1,Z&=U&~(l&~N),Z=Z&201326741?Z&201326741|1:Z?Z|2:0}Z!==0&&(Y=!0,nU(G,Z))}else Z=c0,Z=nq(G,G===M5?Z:0,G.cancelPendingCommit!==null||G.timeoutHandle!==-1),(Z&3)===0||mf(G,Z)||(Y=!0,nU(G,Z));G=G.next}}while(Y);Bk=!1}}function qF(){jM()}function jM(){_q=zv=!1;var g=0;e6!==0&&BF()&&(g=e6);for(var x=i3(),Y=null,G=mq;G!==null;){var U=G.next,Z=mM(G,x);if(Z===0)G.next=null,Y===null?mq=U:Y.next=U,U===null&&(aw=Y);else if(Y=G,g!==0||(Z&3)!==0)_q=!0;G=U}K2!==0&&K2!==5||af(g,!1),e6!==0&&(e6=0)}function mM(g,x){for(var{suspendedLanes:Y,pingedLanes:G,expirationTimes:U}=g,Z=g.pendingLanes&-62914561;0<Z;){var l=31-e3(Z),N=1<<l,P=U[l];if(P===-1){if((N&Y)===0||(N&G)!==0)U[l]=NW(N,x)}else P<=x&&(g.expiredLanes|=N);Z&=~N}if(x=M5,Y=c0,Y=nq(g,g===x?Y:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),G=g.callbackNode,Y===0||g===x&&(Z5===2||Z5===9)||g.cancelPendingCommit!==null)return G!==null&&G!==null&&cY(G),g.callbackNode=null,g.callbackPriority=0;if((Y&3)===0||mf(g,Y)){if(x=Y&-Y,x===g.callbackPriority)return x;switch(G!==null&&cY(G),Lv(Y)){case 2:case 8:Y=lB;break;case 32:Y=Wq;break;case 268435456:Y=CB;break;default:Y=Wq}return G=_M.bind(null,g),Y=Qv(Y,G),g.callbackPriority=x,g.callbackNode=Y,x}return G!==null&&G!==null&&cY(G),g.callbackPriority=2,g.callbackNode=null,2}function _M(g,x){if(K2!==0&&K2!==5)return g.callbackNode=null,g.callbackPriority=0,null;var Y=g.callbackNode;if(kZ()&&g.callbackNode!==Y)return null;var G=c0;if(G=nq(g,g===M5?G:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),G===0)return null;return KM(g,G,x),mM(g,i3()),g.callbackNode!=null&&g.callbackNode===Y?_M.bind(null,g):null}function nU(g,x){if(kZ())return null;KM(g,x,!0)}function ZF(){MF(function(){(w5&6)!==0?Qv(KB,qF):jM()})}function xJ(){if(e6===0){var g=Ab;g===0&&(g=px,px<<=1,(px&261888)===0&&(px=256)),e6=g}return e6}function sU(g){return g==null||typeof g==="symbol"||typeof g==="boolean"?null:typeof g==="function"?g:zq(""+g)}function iU(g,x){var Y=x.ownerDocument.createElement("input");return Y.name=x.name,Y.value=x.value,g.id&&Y.setAttribute("form",g.id),x.parentNode.insertBefore(Y,x),g=new FormData(g),Y.parentNode.removeChild(Y),g}function YF(g,x,Y,G,U){if(x==="submit"&&Y&&Y.stateNode===U){var Z=sU((U[N3]||null).action),l=G.submitter;l&&(x=(x=l[N3]||null)?sU(x.formAction):l.getAttribute("formAction"),x!==null&&(Z=x,l=null));var N=new sq("action","action",null,G,U);g.push({event:N,listeners:[{instance:null,listener:function(){if(G.defaultPrevented){if(e6!==0){var P=l?iU(U,l):new FormData(U);ok(Y,{pending:!0,data:P,method:U.method,action:Z},null,P)}}else typeof Z==="function"&&(N.preventDefault(),P=l?iU(U,l):new FormData(U),ok(Y,{pending:!0,data:P,method:U.method,action:Z},Z,P))},currentTarget:U}]})}}function PM(g,x){x=(x&4)!==0;for(var Y=0;Y<g.length;Y++){var G=g[Y],U=G.event;G=G.listeners;w:{var Z=void 0;if(x)for(var l=G.length-1;0<=l;l--){var N=G[l],P=N.instance,w1=N.currentTarget;if(N=N.listener,P!==Z&&U.isPropagationStopped())break w;Z=N,U.currentTarget=w1;try{Z(U)}catch(H1){Fq(H1)}U.currentTarget=null,Z=P}else for(l=0;l<G.length;l++){if(N=G[l],P=N.instance,w1=N.currentTarget,N=N.listener,P!==Z&&U.isPropagationStopped())break w;Z=N,U.currentTarget=w1;try{Z(U)}catch(H1){Fq(H1)}U.currentTarget=null,Z=P}}}}function u0(g,x){var Y=x[Dk];Y===void 0&&(Y=x[Dk]=new Set);var G=g+"__bubble";Y.has(G)||(EM(x,g,2,!1),Y.add(G))}function Ak(g,x,Y){var G=0;x&&(G|=4),EM(Y,g,G,x)}function qJ(g){if(!g[wq]){g[wq]=!0,NB.forEach(function(Y){Y!=="selectionchange"&&(kF.has(Y)||Ak(Y,!1,g),Ak(Y,!0,g))});var x=g.nodeType===9?g:g.ownerDocument;x===null||x[wq]||(x[wq]=!0,Ak("selectionchange",!1,x))}}function EM(g,x,Y,G){switch(bX(x)){case 2:var U=$F;break;case 8:U=jF;break;default:U=vJ}Y=U.bind(null,x,Y,g),U=void 0,!Nk||x!=="touchstart"&&x!=="touchmove"&&x!=="wheel"||(U=!0),G?U!==void 0?g.addEventListener(x,Y,{capture:!0,passive:U}):g.addEventListener(x,Y,!0):U!==void 0?g.addEventListener(x,Y,{passive:U}):g.addEventListener(x,Y,!1)}function Mk(g,x,Y,G,U){var Z=G;if((x&1)===0&&(x&2)===0&&G!==null)w:for(;;){if(G===null)return;var l=G.tag;if(l===3||l===4){var N=G.stateNode.containerInfo;if(N===U)break;if(l===4)for(l=G.return;l!==null;){var P=l.tag;if((P===3||P===4)&&l.stateNode.containerInfo===U)return;l=l.return}for(;N!==null;){if(l=sw(N),l===null)return;if(P=l.tag,P===5||P===6||P===26||P===27){G=Z=l;continue w}N=N.parentNode}}G=G.return}PB(function(){var w1=Z,H1=Fv(Y),r=[];w:{var z1=gA.get(g);if(z1!==void 0){var u=sq,R1=g;switch(g){case"keypress":if(qq(Y)===0)break w;case"keydown":case"keyup":u=zh;break;case"focusin":R1="focus",u=sY;break;case"focusout":R1="blur",u=sY;break;case"beforeblur":case"afterblur":u=sY;break;case"click":if(Y.button===2)break w;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=qU;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=aW;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Zh;break;case tB:case eB:case wA:u=nW;break;case bA:u=kh;break;case"scroll":case"scrollend":u=pW;break;case"wheel":u=Jh;break;case"copy":case"cut":case"paste":u=iW;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=YU;break;case"toggle":case"beforetoggle":u=Hh}var P1=(x&4)!==0,s1=!P1&&(g==="scroll"||g==="scrollend"),f1=P1?z1!==null?z1+"Capture":null:z1;P1=[];for(var Y1=w1,B1;Y1!==null;){var F1=Y1;if(B1=F1.stateNode,F1=F1.tag,F1!==5&&F1!==26&&F1!==27||B1===null||f1===null||(F1=Ff(Y1,f1),F1!=null&&P1.push(Nf(Y1,F1,B1))),s1)break;Y1=Y1.return}0<P1.length&&(z1=new u(z1,R1,null,Y,H1),r.push({event:z1,listeners:P1}))}}if((x&7)===0){w:{if(z1=g==="mouseover"||g==="pointerover",u=g==="mouseout"||g==="pointerout",z1&&Y!==Rk&&(R1=Y.relatedTarget||Y.fromElement)&&(sw(R1)||R1[Fb]))break w;if(u||z1){if(z1=H1.window===H1?H1:(z1=H1.ownerDocument)?z1.defaultView||z1.parentWindow:window,u){if(R1=Y.relatedTarget||Y.toElement,u=w1,R1=R1?sw(R1):null,R1!==null&&(s1=$f(R1),P1=R1.tag,R1!==s1||P1!==5&&P1!==27&&P1!==6))R1=null}else u=null,R1=w1;if(u!==R1){if(P1=qU,F1="onMouseLeave",f1="onMouseEnter",Y1="mouse",g==="pointerout"||g==="pointerover")P1=YU,F1="onPointerLeave",f1="onPointerEnter",Y1="pointer";if(s1=u==null?z1:ff(u),B1=R1==null?z1:ff(R1),z1=new P1(F1,Y1+"leave",u,Y,H1),z1.target=s1,z1.relatedTarget=B1,F1=null,sw(H1)===w1&&(P1=new P1(f1,Y1+"enter",R1,Y,H1),P1.target=B1,P1.relatedTarget=s1,F1=P1),s1=F1,u&&R1)b:{P1=vF,f1=u,Y1=R1,B1=0;for(F1=f1;F1;F1=P1(F1))B1++;F1=0;for(var i1=Y1;i1;i1=P1(i1))F1++;for(;0<B1-F1;)f1=P1(f1),B1--;for(;0<F1-B1;)Y1=P1(Y1),F1--;for(;B1--;){if(f1===Y1||Y1!==null&&f1===Y1.alternate){P1=f1;break b}f1=P1(f1),Y1=P1(Y1)}P1=null}else P1=null;u!==null&&tU(r,z1,u,P1,!1),R1!==null&&s1!==null&&tU(r,s1,R1,P1,!0)}}}w:{if(z1=w1?ff(w1):window,u=z1.nodeName&&z1.nodeName.toLowerCase(),u==="select"||u==="input"&&z1.type==="file")var k0=GU;else if(JU(z1))if(rB)k0=hh;else{k0=Lh;var r1=Vh}else u=z1.nodeName,!u||u.toLowerCase()!=="input"||z1.type!=="checkbox"&&z1.type!=="radio"?w1&&hv(w1.elementType)&&(k0=GU):k0=Wh;if(k0&&(k0=k0(g,w1))){aB(r,k0,Y,H1);break w}r1&&r1(g,z1,w1),g==="focusout"&&w1&&z1.type==="number"&&w1.memoizedProps.value!=null&&yk(z1,"number",z1.value)}switch(r1=w1?ff(w1):window,g){case"focusin":if(JU(r1)||r1.contentEditable==="true")ew=r1,Ik=w1,Gf=null;break;case"focusout":Gf=Ik=ew=null;break;case"mousedown":Sk=!0;break;case"contextmenu":case"mouseup":case"dragend":Sk=!1,AU(r,Y,H1);break;case"selectionchange":if(Kh)break;case"keydown":case"keyup":AU(r,Y,H1)}var $1;if(Cv)w:{switch(g){case"compositionstart":var q0="onCompositionStart";break w;case"compositionend":q0="onCompositionEnd";break w;case"compositionupdate":q0="onCompositionUpdate";break w}q0=void 0}else tw?pB(g,Y)&&(q0="onCompositionEnd"):g==="keydown"&&Y.keyCode===229&&(q0="onCompositionStart");if(q0&&(uB&&Y.locale!=="ko"&&(tw||q0!=="onCompositionStart"?q0==="onCompositionEnd"&&tw&&($1=EB()):(s6=H1,Kv=("value"in s6)?s6.value:s6.textContent,tw=!0)),r1=Pq(w1,q0),0<r1.length&&(q0=new ZU(q0,g,null,Y,H1),r.push({event:q0,listeners:r1}),$1?q0.data=$1:($1=cB(Y),$1!==null&&(q0.data=$1)))),$1=Bh?Ah(g,Y):Mh(g,Y))q0=Pq(w1,"onBeforeInput"),0<q0.length&&(r1=new ZU("onBeforeInput","beforeinput",null,Y,H1),r.push({event:r1,listeners:q0}),r1.data=$1);YF(r,g,w1,Y,H1)}PM(r,x)})}function Nf(g,x,Y){return{instance:g,listener:x,currentTarget:Y}}function Pq(g,x){for(var Y=x+"Capture",G=[];g!==null;){var U=g,Z=U.stateNode;if(U=U.tag,U!==5&&U!==26&&U!==27||Z===null||(U=Ff(g,Y),U!=null&&G.unshift(Nf(g,U,Z)),U=Ff(g,x),U!=null&&G.push(Nf(g,U,Z))),g.tag===3)return G;g=g.return}return[]}function vF(g){if(g===null)return null;do g=g.return;while(g&&g.tag!==5&&g.tag!==27);return g?g:null}function tU(g,x,Y,G,U){for(var Z=x._reactName,l=[];Y!==null&&Y!==G;){var N=Y,P=N.alternate,w1=N.stateNode;if(N=N.tag,P!==null&&P===G)break;N!==5&&N!==26&&N!==27||w1===null||(P=w1,U?(w1=Ff(Y,Z),w1!=null&&l.unshift(Nf(Y,w1,P))):U||(w1=Ff(Y,Z),w1!=null&&l.push(Nf(Y,w1,P)))),Y=Y.return}l.length!==0&&g.push({event:x,listeners:l})}function eU(g){return(typeof g==="string"?g:""+g).replace(JF,`
`).replace(GF,"")}function uM(g,x){return x=eU(x),eU(g)===x?!0:!1}function v5(g,x,Y,G,U,Z){switch(Y){case"children":typeof G==="string"?x==="body"||x==="textarea"&&G===""||Bb(g,G):(typeof G==="number"||typeof G==="bigint")&&x!=="body"&&Bb(g,""+G);break;case"className":rx(g,"class",G);break;case"tabIndex":rx(g,"tabindex",G);break;case"dir":case"role":case"viewBox":case"width":case"height":rx(g,Y,G);break;case"style":_B(g,G,Z);break;case"data":if(x!=="object"){rx(g,"data",G);break}case"src":case"href":if(G===""&&(x!=="a"||Y!=="href")){g.removeAttribute(Y);break}if(G==null||typeof G==="function"||typeof G==="symbol"||typeof G==="boolean"){g.removeAttribute(Y);break}G=zq(""+G),g.setAttribute(Y,G);break;case"action":case"formAction":if(typeof G==="function"){g.setAttribute(Y,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof Z==="function"&&(Y==="formAction"?(x!=="input"&&v5(g,x,"name",U.name,U,null),v5(g,x,"formEncType",U.formEncType,U,null),v5(g,x,"formMethod",U.formMethod,U,null),v5(g,x,"formTarget",U.formTarget,U,null)):(v5(g,x,"encType",U.encType,U,null),v5(g,x,"method",U.method,U,null),v5(g,x,"target",U.target,U,null)));if(G==null||typeof G==="symbol"||typeof G==="boolean"){g.removeAttribute(Y);break}G=zq(""+G),g.setAttribute(Y,G);break;case"onClick":G!=null&&(g.onclick=s7);break;case"onScroll":G!=null&&u0("scroll",g);break;case"onScrollEnd":G!=null&&u0("scrollend",g);break;case"dangerouslySetInnerHTML":if(G!=null){if(typeof G!=="object"||!("__html"in G))throw Error(y1(61));if(Y=G.__html,Y!=null){if(U.children!=null)throw Error(y1(60));g.innerHTML=Y}}break;case"multiple":g.multiple=G&&typeof G!=="function"&&typeof G!=="symbol";break;case"muted":g.muted=G&&typeof G!=="function"&&typeof G!=="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(G==null||typeof G==="function"||typeof G==="boolean"||typeof G==="symbol"){g.removeAttribute("xlink:href");break}Y=zq(""+G),g.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Y);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":G!=null&&typeof G!=="function"&&typeof G!=="symbol"?g.setAttribute(Y,""+G):g.removeAttribute(Y);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":G&&typeof G!=="function"&&typeof G!=="symbol"?g.setAttribute(Y,""):g.removeAttribute(Y);break;case"capture":case"download":G===!0?g.setAttribute(Y,""):G!==!1&&G!=null&&typeof G!=="function"&&typeof G!=="symbol"?g.setAttribute(Y,G):g.removeAttribute(Y);break;case"cols":case"rows":case"size":case"span":G!=null&&typeof G!=="function"&&typeof G!=="symbol"&&!isNaN(G)&&1<=G?g.setAttribute(Y,G):g.removeAttribute(Y);break;case"rowSpan":case"start":G==null||typeof G==="function"||typeof G==="symbol"||isNaN(G)?g.removeAttribute(Y):g.setAttribute(Y,G);break;case"popover":u0("beforetoggle",g),u0("toggle",g),fq(g,"popover",G);break;case"xlinkActuate":E7(g,"http://www.w3.org/1999/xlink","xlink:actuate",G);break;case"xlinkArcrole":E7(g,"http://www.w3.org/1999/xlink","xlink:arcrole",G);break;case"xlinkRole":E7(g,"http://www.w3.org/1999/xlink","xlink:role",G);break;case"xlinkShow":E7(g,"http://www.w3.org/1999/xlink","xlink:show",G);break;case"xlinkTitle":E7(g,"http://www.w3.org/1999/xlink","xlink:title",G);break;case"xlinkType":E7(g,"http://www.w3.org/1999/xlink","xlink:type",G);break;case"xmlBase":E7(g,"http://www.w3.org/XML/1998/namespace","xml:base",G);break;case"xmlLang":E7(g,"http://www.w3.org/XML/1998/namespace","xml:lang",G);break;case"xmlSpace":E7(g,"http://www.w3.org/XML/1998/namespace","xml:space",G);break;case"is":fq(g,"is",G);break;case"innerText":case"textContent":break;default:if(!(2<Y.length)||Y[0]!=="o"&&Y[0]!=="O"||Y[1]!=="n"&&Y[1]!=="N")Y=EW.get(Y)||Y,fq(g,Y,G)}}function Zv(g,x,Y,G,U,Z){switch(Y){case"style":_B(g,G,Z);break;case"dangerouslySetInnerHTML":if(G!=null){if(typeof G!=="object"||!("__html"in G))throw Error(y1(61));if(Y=G.__html,Y!=null){if(U.children!=null)throw Error(y1(60));g.innerHTML=Y}}break;case"children":typeof G==="string"?Bb(g,G):(typeof G==="number"||typeof G==="bigint")&&Bb(g,""+G);break;case"onScroll":G!=null&&u0("scroll",g);break;case"onScrollEnd":G!=null&&u0("scrollend",g);break;case"onClick":G!=null&&(g.onclick=s7);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!IB.hasOwnProperty(Y))w:{if(Y[0]==="o"&&Y[1]==="n"&&(U=Y.endsWith("Capture"),x=Y.slice(2,U?Y.length-7:void 0),Z=g[N3]||null,Z=Z!=null?Z[Y]:null,typeof Z==="function"&&g.removeEventListener(x,Z,U),typeof G==="function")){typeof Z!=="function"&&Z!==null&&(Y in g?g[Y]=null:g.hasAttribute(Y)&&g.removeAttribute(Y)),g.addEventListener(x,G,U);break w}Y in g?g[Y]=G:G===!0?g.setAttribute(Y,""):fq(g,Y,G)}}}function n2(g,x,Y){switch(x){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":u0("error",g),u0("load",g);var G=!1,U=!1,Z;for(Z in Y)if(Y.hasOwnProperty(Z)){var l=Y[Z];if(l!=null)switch(Z){case"src":G=!0;break;case"srcSet":U=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(y1(137,x));default:v5(g,x,Z,l,Y,null)}}U&&v5(g,x,"srcSet",Y.srcSet,Y,null),G&&v5(g,x,"src",Y.src,Y,null);return;case"input":u0("invalid",g);var N=Z=l=U=null,P=null,w1=null;for(G in Y)if(Y.hasOwnProperty(G)){var H1=Y[G];if(H1!=null)switch(G){case"name":U=H1;break;case"type":l=H1;break;case"checked":P=H1;break;case"defaultChecked":w1=H1;break;case"value":Z=H1;break;case"defaultValue":N=H1;break;case"children":case"dangerouslySetInnerHTML":if(H1!=null)throw Error(y1(137,x));break;default:v5(g,x,G,H1,Y,null)}}$B(g,Z,N,P,w1,l,U,!1);return;case"select":u0("invalid",g),G=l=Z=null;for(U in Y)if(Y.hasOwnProperty(U)&&(N=Y[U],N!=null))switch(U){case"value":Z=N;break;case"defaultValue":l=N;break;case"multiple":G=N;default:v5(g,x,U,N,Y,null)}x=Z,Y=l,g.multiple=!!G,x!=null?Zb(g,!!G,x,!1):Y!=null&&Zb(g,!!G,Y,!0);return;case"textarea":u0("invalid",g),Z=U=G=null;for(l in Y)if(Y.hasOwnProperty(l)&&(N=Y[l],N!=null))switch(l){case"value":G=N;break;case"defaultValue":U=N;break;case"children":Z=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(y1(91));break;default:v5(g,x,l,N,Y,null)}mB(g,G,U,Z);return;case"option":for(P in Y)if(Y.hasOwnProperty(P)&&(G=Y[P],G!=null))switch(P){case"selected":g.selected=G&&typeof G!=="function"&&typeof G!=="symbol";break;default:v5(g,x,P,G,Y,null)}return;case"dialog":u0("beforetoggle",g),u0("toggle",g),u0("cancel",g),u0("close",g);break;case"iframe":case"object":u0("load",g);break;case"video":case"audio":for(G=0;G<Rf.length;G++)u0(Rf[G],g);break;case"image":u0("error",g),u0("load",g);break;case"details":u0("toggle",g);break;case"embed":case"source":case"link":u0("error",g),u0("load",g);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(w1 in Y)if(Y.hasOwnProperty(w1)&&(G=Y[w1],G!=null))switch(w1){case"children":case"dangerouslySetInnerHTML":throw Error(y1(137,x));default:v5(g,x,w1,G,Y,null)}return;default:if(hv(x)){for(H1 in Y)Y.hasOwnProperty(H1)&&(G=Y[H1],G!==void 0&&Zv(g,x,H1,G,Y,void 0));return}}for(N in Y)Y.hasOwnProperty(N)&&(G=Y[N],G!=null&&v5(g,x,N,G,Y,null))}function HF(g,x,Y,G){switch(x){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var U=null,Z=null,l=null,N=null,P=null,w1=null,H1=null;for(u in Y){var r=Y[u];if(Y.hasOwnProperty(u)&&r!=null)switch(u){case"checked":break;case"value":break;case"defaultValue":P=r;default:G.hasOwnProperty(u)||v5(g,x,u,null,G,r)}}for(var z1 in G){var u=G[z1];if(r=Y[z1],G.hasOwnProperty(z1)&&(u!=null||r!=null))switch(z1){case"type":Z=u;break;case"name":U=u;break;case"checked":w1=u;break;case"defaultChecked":H1=u;break;case"value":l=u;break;case"defaultValue":N=u;break;case"children":case"dangerouslySetInnerHTML":if(u!=null)throw Error(y1(137,x));break;default:u!==r&&v5(g,x,z1,u,G,r)}}Ok(g,l,N,P,w1,H1,Z,U);return;case"select":u=l=N=z1=null;for(Z in Y)if(P=Y[Z],Y.hasOwnProperty(Z)&&P!=null)switch(Z){case"value":break;case"multiple":u=P;default:G.hasOwnProperty(Z)||v5(g,x,Z,null,G,P)}for(U in G)if(Z=G[U],P=Y[U],G.hasOwnProperty(U)&&(Z!=null||P!=null))switch(U){case"value":z1=Z;break;case"defaultValue":N=Z;break;case"multiple":l=Z;default:Z!==P&&v5(g,x,U,Z,G,P)}x=N,Y=l,G=u,z1!=null?Zb(g,!!Y,z1,!1):!!G!==!!Y&&(x!=null?Zb(g,!!Y,x,!0):Zb(g,!!Y,Y?[]:"",!1));return;case"textarea":u=z1=null;for(N in Y)if(U=Y[N],Y.hasOwnProperty(N)&&U!=null&&!G.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:v5(g,x,N,null,G,U)}for(l in G)if(U=G[l],Z=Y[l],G.hasOwnProperty(l)&&(U!=null||Z!=null))switch(l){case"value":z1=U;break;case"defaultValue":u=U;break;case"children":break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(y1(91));break;default:U!==Z&&v5(g,x,l,U,G,Z)}jB(g,z1,u);return;case"option":for(var R1 in Y)if(z1=Y[R1],Y.hasOwnProperty(R1)&&z1!=null&&!G.hasOwnProperty(R1))switch(R1){case"selected":g.selected=!1;break;default:v5(g,x,R1,null,G,z1)}for(P in G)if(z1=G[P],u=Y[P],G.hasOwnProperty(P)&&z1!==u&&(z1!=null||u!=null))switch(P){case"selected":g.selected=z1&&typeof z1!=="function"&&typeof z1!=="symbol";break;default:v5(g,x,P,z1,G,u)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var P1 in Y)z1=Y[P1],Y.hasOwnProperty(P1)&&z1!=null&&!G.hasOwnProperty(P1)&&v5(g,x,P1,null,G,z1);for(w1 in G)if(z1=G[w1],u=Y[w1],G.hasOwnProperty(w1)&&z1!==u&&(z1!=null||u!=null))switch(w1){case"children":case"dangerouslySetInnerHTML":if(z1!=null)throw Error(y1(137,x));break;default:v5(g,x,w1,z1,G,u)}return;default:if(hv(x)){for(var s1 in Y)z1=Y[s1],Y.hasOwnProperty(s1)&&z1!==void 0&&!G.hasOwnProperty(s1)&&Zv(g,x,s1,void 0,G,z1);for(H1 in G)z1=G[H1],u=Y[H1],!G.hasOwnProperty(H1)||z1===u||z1===void 0&&u===void 0||Zv(g,x,H1,z1,G,u);return}}for(var f1 in Y)z1=Y[f1],Y.hasOwnProperty(f1)&&z1!=null&&!G.hasOwnProperty(f1)&&v5(g,x,f1,null,G,z1);for(r in G)z1=G[r],u=Y[r],!G.hasOwnProperty(r)||z1===u||z1==null&&u==null||v5(g,x,r,z1,G,u)}function wB(g){switch(g){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function UF(){if(typeof performance.getEntriesByType==="function"){for(var g=0,x=0,Y=performance.getEntriesByType("resource"),G=0;G<Y.length;G++){var U=Y[G],Z=U.transferSize,l=U.initiatorType,N=U.duration;if(Z&&N&&wB(l)){l=0,N=U.responseEnd;for(G+=1;G<Y.length;G++){var P=Y[G],w1=P.startTime;if(w1>N)break;var{transferSize:H1,initiatorType:r}=P;H1&&wB(r)&&(P=P.responseEnd,l+=H1*(P<N?1:(N-w1)/(P-w1)))}if(--G,x+=8*(Z+l)/(U.duration/1000),g++,10<g)break}}if(0<g)return x/g/1e6}return navigator.connection&&(g=navigator.connection.downlink,typeof g==="number")?g:5}function Eq(g){return g.nodeType===9?g:g.ownerDocument}function bB(g){switch(g){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function pM(g,x){if(g===0)switch(x){case"svg":return 1;case"math":return 2;default:return 0}return g===1&&x==="foreignObject"?0:g}function vv(g,x){return g==="textarea"||g==="noscript"||typeof x.children==="string"||typeof x.children==="number"||typeof x.children==="bigint"||typeof x.dangerouslySetInnerHTML==="object"&&x.dangerouslySetInnerHTML!==null&&x.dangerouslySetInnerHTML.__html!=null}function BF(){var g=window.event;if(g&&g.type==="popstate"){if(g===Xk)return!1;return Xk=g,!0}return Xk=null,!1}function XF(g){setTimeout(function(){throw g})}function U8(g){return g==="head"}function fB(g,x){var Y=x,G=0;do{var U=Y.nextSibling;if(g.removeChild(Y),U&&U.nodeType===8)if(Y=U.data,Y==="/$"||Y==="/&"){if(G===0){g.removeChild(U),hb(x);return}G--}else if(Y==="$"||Y==="$?"||Y==="$~"||Y==="$!"||Y==="&")G++;else if(Y==="html")Wf(g.ownerDocument.documentElement);else if(Y==="head"){Y=g.ownerDocument.head,Wf(Y);for(var Z=Y.firstChild;Z;){var{nextSibling:l,nodeName:N}=Z;Z[Pf]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&Z.rel.toLowerCase()==="stylesheet"||Y.removeChild(Z),Z=l}}else Y==="body"&&Wf(g.ownerDocument.body);Y=U}while(Y);hb(x)}function zB(g,x){var Y=g;g=0;do{var G=Y.nextSibling;if(Y.nodeType===1?x?(Y._stashedDisplay=Y.style.display,Y.style.display="none"):(Y.style.display=Y._stashedDisplay||"",Y.getAttribute("style")===""&&Y.removeAttribute("style")):Y.nodeType===3&&(x?(Y._stashedText=Y.nodeValue,Y.nodeValue=""):Y.nodeValue=Y._stashedText||""),G&&G.nodeType===8)if(Y=G.data,Y==="/$")if(g===0)break;else g--;else Y!=="$"&&Y!=="$?"&&Y!=="$~"&&Y!=="$!"||g++;Y=G}while(Y)}function Jv(g){var x=g.firstChild;x&&x.nodeType===10&&(x=x.nextSibling);for(;x;){var Y=x;switch(x=x.nextSibling,Y.nodeName){case"HTML":case"HEAD":case"BODY":Jv(Y),Wv(Y);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(Y.rel.toLowerCase()==="stylesheet")continue}g.removeChild(Y)}}function QF(g,x,Y,G){for(;g.nodeType===1;){var U=Y;if(g.nodeName.toLowerCase()!==x.toLowerCase()){if(!G&&(g.nodeName!=="INPUT"||g.type!=="hidden"))break}else if(!G)if(x==="input"&&g.type==="hidden"){var Z=U.name==null?null:""+U.name;if(U.type==="hidden"&&g.getAttribute("name")===Z)return g}else return g;else if(!g[Pf])switch(x){case"meta":if(!g.hasAttribute("itemprop"))break;return g;case"link":if(Z=g.getAttribute("rel"),Z==="stylesheet"&&g.hasAttribute("data-precedence"))break;else if(Z!==U.rel||g.getAttribute("href")!==(U.href==null||U.href===""?null:U.href)||g.getAttribute("crossorigin")!==(U.crossOrigin==null?null:U.crossOrigin)||g.getAttribute("title")!==(U.title==null?null:U.title))break;return g;case"style":if(g.hasAttribute("data-precedence"))break;return g;case"script":if(Z=g.getAttribute("src"),(Z!==(U.src==null?null:U.src)||g.getAttribute("type")!==(U.type==null?null:U.type)||g.getAttribute("crossorigin")!==(U.crossOrigin==null?null:U.crossOrigin))&&Z&&g.hasAttribute("async")&&!g.hasAttribute("itemprop"))break;return g;default:return g}if(g=L4(g.nextSibling),g===null)break}return null}function VF(g,x,Y){if(x==="")return null;for(;g.nodeType!==3;){if((g.nodeType!==1||g.nodeName!=="INPUT"||g.type!=="hidden")&&!Y)return null;if(g=L4(g.nextSibling),g===null)return null}return g}function aM(g,x){for(;g.nodeType!==8;){if((g.nodeType!==1||g.nodeName!=="INPUT"||g.type!=="hidden")&&!x)return null;if(g=L4(g.nextSibling),g===null)return null}return g}function Gv(g){return g.data==="$?"||g.data==="$~"}function Hv(g){return g.data==="$!"||g.data==="$?"&&g.ownerDocument.readyState!=="loading"}function LF(g,x){var Y=g.ownerDocument;if(g.data==="$~")g._reactRetry=x;else if(g.data!=="$?"||Y.readyState!=="loading")x();else{var G=function(){x(),Y.removeEventListener("DOMContentLoaded",G)};Y.addEventListener("DOMContentLoaded",G),g._reactRetry=G}}function L4(g){for(;g!=null;g=g.nextSibling){var x=g.nodeType;if(x===1||x===3)break;if(x===8){if(x=g.data,x==="$"||x==="$!"||x==="$?"||x==="$~"||x==="&"||x==="F!"||x==="F")break;if(x==="/$"||x==="/&")return null}}return g}function xB(g){g=g.nextSibling;for(var x=0;g;){if(g.nodeType===8){var Y=g.data;if(Y==="/$"||Y==="/&"){if(x===0)return L4(g.nextSibling);x--}else Y!=="$"&&Y!=="$!"&&Y!=="$?"&&Y!=="$~"&&Y!=="&"||x++}g=g.nextSibling}return null}function qB(g){g=g.previousSibling;for(var x=0;g;){if(g.nodeType===8){var Y=g.data;if(Y==="$"||Y==="$!"||Y==="$?"||Y==="$~"||Y==="&"){if(x===0)return g;x--}else Y!=="/$"&&Y!=="/&"||x++}g=g.previousSibling}return null}function rM(g,x,Y){switch(x=Eq(Y),g){case"html":if(g=x.documentElement,!g)throw Error(y1(452));return g;case"head":if(g=x.head,!g)throw Error(y1(453));return g;case"body":if(g=x.body,!g)throw Error(y1(454));return g;default:throw Error(y1(451))}}function Wf(g){for(var x=g.attributes;x.length;)g.removeAttributeNode(x[0]);Wv(g)}function uq(g){return typeof g.getRootNode==="function"?g.getRootNode():g.nodeType===9?g:g.ownerDocument}function WF(){var g=q6.f(),x=ZZ();return g||x}function hF(g){var x=Kb(g);x!==null&&x.tag===5&&x.type==="form"?_A(x):q6.r(g)}function oM(g,x,Y){var G=db;if(G&&typeof x==="string"&&x){var U=M4(x);U='link[rel="'+g+'"][href="'+U+'"]',typeof Y==="string"&&(U+='[crossorigin="'+Y+'"]'),ZB.has(U)||(ZB.add(U),g={rel:g,crossOrigin:Y,href:x},G.querySelector(U)===null&&(x=G.createElement("link"),n2(x,"link",g),I2(x),G.head.appendChild(x)))}}function FF(g){q6.D(g),oM("dns-prefetch",g,null)}function KF(g,x){q6.C(g,x),oM("preconnect",g,x)}function lF(g,x,Y){q6.L(g,x,Y);var G=db;if(G&&g&&x){var U='link[rel="preload"][as="'+M4(x)+'"]';x==="image"?Y&&Y.imageSrcSet?(U+='[imagesrcset="'+M4(Y.imageSrcSet)+'"]',typeof Y.imageSizes==="string"&&(U+='[imagesizes="'+M4(Y.imageSizes)+'"]')):U+='[href="'+M4(g)+'"]':U+='[href="'+M4(g)+'"]';var Z=U;switch(x){case"style":Z=Wb(g);break;case"script":Z=Ob(g)}W4.has(Z)||(g=O5({rel:"preload",href:x==="image"&&Y&&Y.imageSrcSet?void 0:g,as:x},Y),W4.set(Z,g),G.querySelector(U)!==null||x==="style"&&G.querySelector(rf(Z))||x==="script"&&G.querySelector(of(Z))||(x=G.createElement("link"),n2(x,"link",g),I2(x),G.head.appendChild(x)))}}function CF(g,x){q6.m(g,x);var Y=db;if(Y&&g){var G=x&&typeof x.as==="string"?x.as:"script",U='link[rel="modulepreload"][as="'+M4(G)+'"][href="'+M4(g)+'"]',Z=U;switch(G){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":Z=Ob(g)}if(!W4.has(Z)&&(g=O5({rel:"modulepreload",href:g},x),W4.set(Z,g),Y.querySelector(U)===null)){switch(G){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(Y.querySelector(of(Z)))return}G=Y.createElement("link"),n2(G,"link",g),I2(G),Y.head.appendChild(G)}}}function DF(g,x,Y){q6.S(g,x,Y);var G=db;if(G&&g){var U=qb(G).hoistableStyles,Z=Wb(g);x=x||"default";var l=U.get(Z);if(!l){var N={loading:0,preload:null};if(l=G.querySelector(rf(Z)))N.loading=5;else{g=O5({rel:"stylesheet",href:g,"data-precedence":x},Y),(Y=W4.get(Z))&&ZJ(g,Y);var P=l=G.createElement("link");I2(P),n2(P,"link",g),P._p=new Promise(function(w1,H1){P.onload=w1,P.onerror=H1}),P.addEventListener("load",function(){N.loading|=1}),P.addEventListener("error",function(){N.loading|=2}),N.loading|=4,Bq(l,x,G)}l={type:"stylesheet",instance:l,count:1,state:N},U.set(Z,l)}}}function dF(g,x){q6.X(g,x);var Y=db;if(Y&&g){var G=qb(Y).hoistableScripts,U=Ob(g),Z=G.get(U);Z||(Z=Y.querySelector(of(U)),Z||(g=O5({src:g,async:!0},x),(x=W4.get(U))&&YJ(g,x),Z=Y.createElement("script"),I2(Z),n2(Z,"link",g),Y.head.appendChild(Z)),Z={type:"script",instance:Z,count:1,state:null},G.set(U,Z))}}function OF(g,x){q6.M(g,x);var Y=db;if(Y&&g){var G=qb(Y).hoistableScripts,U=Ob(g),Z=G.get(U);Z||(Z=Y.querySelector(of(U)),Z||(g=O5({src:g,async:!0,type:"module"},x),(x=W4.get(U))&&YJ(g,x),Z=Y.createElement("script"),I2(Z),n2(Z,"link",g),Y.head.appendChild(Z)),Z={type:"script",instance:Z,count:1,state:null},G.set(U,Z))}}function YB(g,x,Y,G){var U=(U=w8.current)?uq(U):null;if(!U)throw Error(y1(446));switch(g){case"meta":case"title":return null;case"style":return typeof Y.precedence==="string"&&typeof Y.href==="string"?(x=Wb(Y.href),Y=qb(U).hoistableStyles,G=Y.get(x),G||(G={type:"style",instance:null,count:0,state:null},Y.set(x,G)),G):{type:"void",instance:null,count:0,state:null};case"link":if(Y.rel==="stylesheet"&&typeof Y.href==="string"&&typeof Y.precedence==="string"){g=Wb(Y.href);var Z=qb(U).hoistableStyles,l=Z.get(g);if(l||(U=U.ownerDocument||U,l={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},Z.set(g,l),(Z=U.querySelector(rf(g)))&&!Z._p&&(l.instance=Z,l.state.loading=5),W4.has(g)||(Y={rel:"preload",as:"style",href:Y.href,crossOrigin:Y.crossOrigin,integrity:Y.integrity,media:Y.media,hrefLang:Y.hrefLang,referrerPolicy:Y.referrerPolicy},W4.set(g,Y),Z||yF(U,g,Y,l.state))),x&&G===null)throw Error(y1(528,""));return l}if(x&&G!==null)throw Error(y1(529,""));return null;case"script":return x=Y.async,Y=Y.src,typeof Y==="string"&&x&&typeof x!=="function"&&typeof x!=="symbol"?(x=Ob(Y),Y=qb(U).hoistableScripts,G=Y.get(x),G||(G={type:"script",instance:null,count:0,state:null},Y.set(x,G)),G):{type:"void",instance:null,count:0,state:null};default:throw Error(y1(444,g))}}function Wb(g){return'href="'+M4(g)+'"'}function rf(g){return'link[rel="stylesheet"]['+g+"]"}function nM(g){return O5({},g,{"data-precedence":g.precedence,precedence:null})}function yF(g,x,Y,G){g.querySelector('link[rel="preload"][as="style"]['+x+"]")?G.loading=1:(x=g.createElement("link"),G.preload=x,x.addEventListener("load",function(){return G.loading|=1}),x.addEventListener("error",function(){return G.loading|=2}),n2(x,"link",Y),I2(x),g.head.appendChild(x))}function Ob(g){return'[src="'+M4(g)+'"]'}function of(g){return"script[async]"+g}function kB(g,x,Y){if(x.count++,x.instance===null)switch(x.type){case"style":var G=g.querySelector('style[data-href~="'+M4(Y.href)+'"]');if(G)return x.instance=G,I2(G),G;var U=O5({},Y,{"data-href":Y.href,"data-precedence":Y.precedence,href:null,precedence:null});return G=(g.ownerDocument||g).createElement("style"),I2(G),n2(G,"style",U),Bq(G,Y.precedence,g),x.instance=G;case"stylesheet":U=Wb(Y.href);var Z=g.querySelector(rf(U));if(Z)return x.state.loading|=4,x.instance=Z,I2(Z),Z;G=nM(Y),(U=W4.get(U))&&ZJ(G,U),Z=(g.ownerDocument||g).createElement("link"),I2(Z);var l=Z;return l._p=new Promise(function(N,P){l.onload=N,l.onerror=P}),n2(Z,"link",G),x.state.loading|=4,Bq(Z,Y.precedence,g),x.instance=Z;case"script":if(Z=Ob(Y.src),U=g.querySelector(of(Z)))return x.instance=U,I2(U),U;if(G=Y,U=W4.get(Z))G=O5({},Y),YJ(G,U);return g=g.ownerDocument||g,U=g.createElement("script"),I2(U),n2(U,"link",G),g.head.appendChild(U),x.instance=U;case"void":return null;default:throw Error(y1(443,x.type))}else x.type==="stylesheet"&&(x.state.loading&4)===0&&(G=x.instance,x.state.loading|=4,Bq(G,Y.precedence,g));return x.instance}function Bq(g,x,Y){for(var G=Y.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),U=G.length?G[G.length-1]:null,Z=U,l=0;l<G.length;l++){var N=G[l];if(N.dataset.precedence===x)Z=N;else if(Z!==U)break}Z?Z.parentNode.insertBefore(g,Z.nextSibling):(x=Y.nodeType===9?Y.head:Y,x.insertBefore(g,x.firstChild))}function ZJ(g,x){g.crossOrigin==null&&(g.crossOrigin=x.crossOrigin),g.referrerPolicy==null&&(g.referrerPolicy=x.referrerPolicy),g.title==null&&(g.title=x.title)}function YJ(g,x){g.crossOrigin==null&&(g.crossOrigin=x.crossOrigin),g.referrerPolicy==null&&(g.referrerPolicy=x.referrerPolicy),g.integrity==null&&(g.integrity=x.integrity)}function vB(g,x,Y){if(Aq===null){var G=new Map,U=Aq=new Map;U.set(Y,G)}else U=Aq,G=U.get(Y),G||(G=new Map,U.set(Y,G));if(G.has(g))return G;G.set(g,null),Y=Y.getElementsByTagName(g);for(U=0;U<Y.length;U++){var Z=Y[U];if(!(Z[Pf]||Z[a2]||g==="link"&&Z.getAttribute("rel")==="stylesheet")&&Z.namespaceURI!=="http://www.w3.org/2000/svg"){var l=Z.getAttribute(x)||"";l=g+l;var N=G.get(l);N?N.push(Z):G.set(l,[Z])}}return G}function JB(g,x,Y){g=g.ownerDocument||g,g.head.insertBefore(Y,x==="title"?g.querySelector("head > title"):null)}function RF(g,x,Y){if(Y===1||x.itemProp!=null)return!1;switch(g){case"meta":case"title":return!0;case"style":if(typeof x.precedence!=="string"||typeof x.href!=="string"||x.href==="")break;return!0;case"link":if(typeof x.rel!=="string"||typeof x.href!=="string"||x.href===""||x.onLoad||x.onError)break;switch(x.rel){case"stylesheet":return g=x.disabled,typeof x.precedence==="string"&&g==null;default:return!0}case"script":if(x.async&&typeof x.async!=="function"&&typeof x.async!=="symbol"&&!x.onLoad&&!x.onError&&x.src&&typeof x.src==="string")return!0}return!1}function sM(g){return g.type==="stylesheet"&&(g.state.loading&3)===0?!1:!0}function NF(g,x,Y,G){if(Y.type==="stylesheet"&&(typeof G.media!=="string"||matchMedia(G.media).matches!==!1)&&(Y.state.loading&4)===0){if(Y.instance===null){var U=Wb(G.href),Z=x.querySelector(rf(U));if(Z){x=Z._p,x!==null&&typeof x==="object"&&typeof x.then==="function"&&(g.count++,g=pq.bind(g),x.then(g,g)),Y.state.loading|=4,Y.instance=Z,I2(Z);return}Z=x.ownerDocument||x,G=nM(G),(U=W4.get(U))&&ZJ(G,U),Z=Z.createElement("link"),I2(Z);var l=Z;l._p=new Promise(function(N,P){l.onload=N,l.onerror=P}),n2(Z,"link",G),Y.instance=Z}g.stylesheets===null&&(g.stylesheets=new Map),g.stylesheets.set(Y,x),(x=Y.state.preload)&&(Y.state.loading&3)===0&&(g.count++,Y=pq.bind(g),x.addEventListener("load",Y),x.addEventListener("error",Y))}}function IF(g,x){return g.stylesheets&&g.count===0&&Mq(g,g.stylesheets),0<g.count||0<g.imgCount?function(Y){var G=setTimeout(function(){if(g.stylesheets&&Mq(g,g.stylesheets),g.unsuspend){var Z=g.unsuspend;g.unsuspend=null,Z()}},60000+x);0<g.imgBytes&&Qk===0&&(Qk=62500*UF());var U=setTimeout(function(){if(g.waitingForImages=!1,g.count===0&&(g.stylesheets&&Mq(g,g.stylesheets),g.unsuspend)){var Z=g.unsuspend;g.unsuspend=null,Z()}},(g.imgBytes>Qk?50:800)+x);return g.unsuspend=Y,function(){g.unsuspend=null,clearTimeout(G),clearTimeout(U)}}:null}function pq(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Mq(this,this.stylesheets);else if(this.unsuspend){var g=this.unsuspend;this.unsuspend=null,g()}}}function Mq(g,x){g.stylesheets=null,g.unsuspend!==null&&(g.count++,cq=new Map,x.forEach(SF,g),cq=null,pq.call(g))}function SF(g,x){if(!(x.state.loading&4)){var Y=cq.get(g);if(Y)var G=Y.get(null);else{Y=new Map,cq.set(g,Y);for(var U=g.querySelectorAll("link[data-precedence],style[data-precedence]"),Z=0;Z<U.length;Z++){var l=U[Z];if(l.nodeName==="LINK"||l.getAttribute("media")!=="not all")Y.set(l.dataset.precedence,l),G=l}G&&Y.set(null,G)}U=x.instance,l=U.getAttribute("data-precedence"),Z=Y.get(l)||G,Z===G&&Y.set(null,U),Y.set(l,U),this.count++,G=pq.bind(this),U.addEventListener("load",G),U.addEventListener("error",G),Z?Z.parentNode.insertBefore(U,Z.nextSibling):(g=g.nodeType===9?g.head:g,g.insertBefore(U,g.firstChild)),x.state.loading|=4}}function TF(g,x,Y,G,U,Z,l,N,P){this.tag=1,this.containerInfo=g,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=aY(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=aY(0),this.hiddenUpdates=aY(null),this.identifierPrefix=G,this.onUncaughtError=U,this.onCaughtError=Z,this.onRecoverableError=l,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function iM(g,x,Y,G,U,Z,l,N,P,w1,H1,r){return g=new TF(g,x,Y,l,P,w1,H1,r,N),x=1,Z===!0&&(x|=24),Z=n3(3,null,null,x),g.current=Z,Z.stateNode=g,x=Iv(),x.refCount++,g.pooledCache=x,x.refCount++,Z.memoizedState={element:G,isDehydrated:Y,cache:x},$v(Z),g}function tM(g){if(!g)return gb;return g=gb,g}function eM(g,x,Y,G,U,Z){U=tM(U),G.context===null?G.context=U:G.pendingContext=U,G=g8(x),G.payload={element:Y},Z=Z===void 0?null:Z,Z!==null&&(G.callback=Z),Y=f8(g,G,x),Y!==null&&(R3(Y,g,x),Uf(Y,g,x))}function GB(g,x){if(g=g.memoizedState,g!==null&&g.dehydrated!==null){var Y=g.retryLane;g.retryLane=Y!==0&&Y<x?Y:x}}function kJ(g,x){GB(g,x),(g=g.alternate)&&GB(g,x)}function wX(g){if(g.tag===13||g.tag===31){var x=R9(g,67108864);x!==null&&R3(x,g,67108864),kJ(g,67108864)}}function HB(g){if(g.tag===13||g.tag===31){var x=w4();x=Vv(x);var Y=R9(g,x);Y!==null&&R3(Y,g,x),kJ(g,x)}}function $F(g,x,Y,G){var U=F0.T;F0.T=null;var Z=b5.p;try{b5.p=2,vJ(g,x,Y,G)}finally{b5.p=Z,F0.T=U}}function jF(g,x,Y,G){var U=F0.T;F0.T=null;var Z=b5.p;try{b5.p=8,vJ(g,x,Y,G)}finally{b5.p=Z,F0.T=U}}function vJ(g,x,Y,G){if(aq){var U=Bv(G);if(U===null)Mk(g,x,G,rq,Y),UB(g,G);else if(_F(U,g,x,Y,G))G.stopPropagation();else if(UB(g,G),x&4&&-1<mF.indexOf(g)){for(;U!==null;){var Z=Kb(U);if(Z!==null)switch(Z.tag){case 3:if(Z=Z.stateNode,Z.current.memoizedState.isDehydrated){var l=B9(Z.pendingLanes);if(l!==0){var N=Z;N.pendingLanes|=2;for(N.entangledLanes|=2;l;){var P=1<<31-e3(l);N.entanglements[1]|=P,l&=~P}H7(Z),(w5&6)===0&&(Tq=i3()+500,af(0,!1))}}break;case 31:case 13:N=R9(Z,2),N!==null&&R3(N,Z,2),ZZ(),kJ(Z,2)}if(Z=Bv(G),Z===null&&Mk(g,x,G,rq,Y),Z===U)break;U=Z}U!==null&&G.stopPropagation()}else Mk(g,x,G,null,Y)}}function Bv(g){return g=Fv(g),JJ(g)}function JJ(g){if(rq=null,g=sw(g),g!==null){var x=$f(g);if(x===null)g=null;else{var Y=x.tag;if(Y===13){if(g=VB(x),g!==null)return g;g=null}else if(Y===31){if(g=LB(x),g!==null)return g;g=null}else if(Y===3){if(x.stateNode.current.memoizedState.isDehydrated)return x.tag===3?x.stateNode.containerInfo:null;g=null}else x!==g&&(g=null)}}return rq=g,null}function bX(g){switch(g){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(lW()){case KB:return 2;case lB:return 8;case Wq:case CW:return 32;case CB:return 268435456;default:return 32}default:return 32}}function UB(g,x){switch(g){case"focusin":case"focusout":q8=null;break;case"dragenter":case"dragleave":Z8=null;break;case"mouseover":case"mouseout":Y8=null;break;case"pointerover":case"pointerout":Sf.delete(x.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tf.delete(x.pointerId)}}function wf(g,x,Y,G,U,Z){if(g===null||g.nativeEvent!==Z)return g={blockedOn:x,domEventName:Y,eventSystemFlags:G,nativeEvent:Z,targetContainers:[U]},x!==null&&(x=Kb(x),x!==null&&wX(x)),g;return g.eventSystemFlags|=G,x=g.targetContainers,U!==null&&x.indexOf(U)===-1&&x.push(U),g}function _F(g,x,Y,G,U){switch(x){case"focusin":return q8=wf(q8,g,x,Y,G,U),!0;case"dragenter":return Z8=wf(Z8,g,x,Y,G,U),!0;case"mouseover":return Y8=wf(Y8,g,x,Y,G,U),!0;case"pointerover":var Z=U.pointerId;return Sf.set(Z,wf(Sf.get(Z)||null,g,x,Y,G,U)),!0;case"gotpointercapture":return Z=U.pointerId,Tf.set(Z,wf(Tf.get(Z)||null,g,x,Y,G,U)),!0}return!1}function gX(g){var x=sw(g.target);if(x!==null){var Y=$f(x);if(Y!==null){if(x=Y.tag,x===13){if(x=VB(Y),x!==null){g.blockedOn=x,eH(g.priority,function(){HB(Y)});return}}else if(x===31){if(x=LB(Y),x!==null){g.blockedOn=x,eH(g.priority,function(){HB(Y)});return}}else if(x===3&&Y.stateNode.current.memoizedState.isDehydrated){g.blockedOn=Y.tag===3?Y.stateNode.containerInfo:null;return}}}g.blockedOn=null}function Xq(g){if(g.blockedOn!==null)return!1;for(var x=g.targetContainers;0<x.length;){var Y=Bv(g.nativeEvent);if(Y===null){Y=g.nativeEvent;var G=new Y.constructor(Y.type,Y);Rk=G,Y.target.dispatchEvent(G),Rk=null}else return x=Kb(Y),x!==null&&wX(x),g.blockedOn=Y,!1;x.shift()}return!0}function BB(g,x,Y){Xq(g)&&Y.delete(x)}function PF(){Av=!1,q8!==null&&Xq(q8)&&(q8=null),Z8!==null&&Xq(Z8)&&(Z8=null),Y8!==null&&Xq(Y8)&&(Y8=null),Sf.forEach(BB),Tf.forEach(BB)}function bq(g,x){g.blockedOn===x&&(g.blockedOn=null,Av||(Av=!0,Ew(Pw,PF)))}function AB(g){gq!==g&&(gq=g,Ew(Pw,function(){gq===g&&(gq=null);for(var x=0;x<g.length;x+=3){var Y=g[x],G=g[x+1],U=g[x+2];if(typeof G!=="function")if(JJ(G||Y)===null)continue;else break;var Z=Kb(Y);Z!==null&&(g.splice(x,3),x-=3,ok(Z,{pending:!0,data:U,method:Y.method,action:G},G,U))}}))}function hb(g){function x(P){return bq(P,g)}q8!==null&&bq(q8,g),Z8!==null&&bq(Z8,g),Y8!==null&&bq(Y8,g),Sf.forEach(x),Tf.forEach(x);for(var Y=0;Y<o6.length;Y++){var G=o6[Y];G.blockedOn===g&&(G.blockedOn=null)}for(;0<o6.length&&(Y=o6[0],Y.blockedOn===null);)gX(Y),Y.blockedOn===null&&o6.shift();if(Y=(g.ownerDocument||g).$$reactFormReplay,Y!=null)for(G=0;G<Y.length;G+=3){var U=Y[G],Z=Y[G+1],l=U[N3]||null;if(typeof Z==="function")l||AB(Y);else if(l){var N=null;if(Z&&Z.hasAttribute("formAction")){if(U=Z,l=Z[N3]||null)N=l.formAction;else if(JJ(U)!==null)continue}else N=l.action;typeof N==="function"?Y[G+1]=N:(Y.splice(G,3),G-=3),AB(Y)}}}function fX(){function g(Z){Z.canIntercept&&Z.info==="react-transition"&&Z.intercept({handler:function(){return new Promise(function(l){return U=l})},focusReset:"manual",scroll:"manual"})}function x(){U!==null&&(U(),U=null),G||setTimeout(Y,20)}function Y(){if(!G&&!navigation.transition){var Z=navigation.currentEntry;Z&&Z.url!=null&&navigation.navigate(Z.url,{state:Z.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation==="object"){var G=!1,U=null;return navigation.addEventListener("navigate",g),navigation.addEventListener("navigatesuccess",x),navigation.addEventListener("navigateerror",x),setTimeout(Y,100),function(){G=!0,navigation.removeEventListener("navigate",g),navigation.removeEventListener("navigatesuccess",x),navigation.removeEventListener("navigateerror",x),U!==null&&(U(),U=null)}}}function GJ(g){this._internalRoot=g}function vZ(g){this._internalRoot=g}var oq,XB,O5,VW,ux,bf,ow,hB,Vk,FB,n7,Mv,Lk,Wk,Xv,u6,hk,LW,sH,WW,gf,F0,b5,Q9,Kk,nw=-1,J7,hf,w8,Qq,EY,iH,uY=!1,Ck,Qv,cY,FW,KW,i3,lW,KB,lB,Wq,CW,CB,DW,dW,jf=null,t3=null,e3,OW,yW,px=256,cx=262144,ax=4194304,H8,a2,N3,Fb,Dk,SW,TW,wU,Pf,NB,IB,$W,bU,gU,_W,PW,EW,uW,Rk=null,iw=null,Yb=null,rY=!1,b6,Nk=!1,A9,s6=null,Kv=null,xq=null,O9,sq,Ef,pW,oY,nY,sg,iq,qU,cW,aW,rW,sY,oW,nW,sW,iW,tW,ZU,eW,wh,bh,fh,zh,xh,YU,qh,Zh,Yh,kh,vh,Jh,Gh,Hh,Uh,Cv,vf=null,Bh,uB,kU,vU=!1,tw=!1,Xh,Jf=null,Kf=null,rB=!1,zf,xf,Zq,b4,Kh,ew=null,Ik=null,Gf=null,Sk=!1,wb,iY,iB,tB,eB,wA,lh,Ch,Dh,bA,gA,Tk,Fq,H4,bb=0,dv=0,gb,MU,fb,zb=0,lq=null,Cf=0,B4,A4=0,k8=null,Y7=1,k7="",r2=null,d5=null,o0=!1,b8=null,Q4=!1,$k,jk,N9=null,i7=null,Oh,yh,Rh,U2,Hf=null,Pk=0,Ab=0,kb=null,LU,L9,Cb,Tv,bZ,Dq,W9=null,vb=null,df=0,l9,GA,p6=!1,uk=!1,Mb,dq,g4,V4=null,g2,g6=0,T0=null,J5=null,G2=null,yq=!1,Jb=!1,C9=!1,Rq=0,Of=0,Gb=null,Sh=0,yf,aA,iv,rA,nk,tv,B2=!1,zk,o7=!1,H2=!1,Gk=!1,pU,N2=null,I5=null,O3=!1,E4=null,Zf=8192,sh,ih,w5=0,M5=null,p0=null,c0=0,Z5=0,r3=null,i6=!1,Db=!1,gJ=!1,x6=0,s5=0,G8=0,h9=0,fJ=0,s3=0,Qb=0,Vf=null,y3=null,wv=!1,qZ=0,WM=0,Tq=1/0,$q=null,z8=null,K2=0,x8=null,Vb=null,w6=0,bv=0,gv=null,hM=null,Lf=0,fv=null,mq=null,aw=null,zv=!1,_q=!1,Bk=!1,e6=0,kf,xv,qv,Yf,Rf,kF,wq,JF,GF,Yv=null,kv=null,Xk=null,cM,AF,gB,MF,Uv=null,W4,ZB,q6,db,Aq=null,Qk=0,cq=null,If,aq=!0,rq=null,Av=!1,q8=null,Z8=null,Y8=null,Sf,Tf,o6,mF,gq=null,MB,EF,rw,zX=function(g,x){if(!QB(g))throw Error(y1(299));var Y=!1,G="",U=oA,Z=nA,l=sA;return x!==null&&x!==void 0&&(x.unstable_strictMode===!0&&(Y=!0),x.identifierPrefix!==void 0&&(G=x.identifierPrefix),x.onUncaughtError!==void 0&&(U=x.onUncaughtError),x.onCaughtError!==void 0&&(Z=x.onCaughtError),x.onRecoverableError!==void 0&&(l=x.onRecoverableError)),x=iM(g,1,!1,null,null,Y,G,null,U,Z,l,fX),g[Fb]=x.current,qJ(g),new GJ(x)},xX=function(g,x,Y){if(!QB(g))throw Error(y1(299));var G=!1,U="",Z=oA,l=nA,N=sA,P=null;return Y!==null&&Y!==void 0&&(Y.unstable_strictMode===!0&&(G=!0),Y.identifierPrefix!==void 0&&(U=Y.identifierPrefix),Y.onUncaughtError!==void 0&&(Z=Y.onUncaughtError),Y.onCaughtError!==void 0&&(l=Y.onCaughtError),Y.onRecoverableError!==void 0&&(N=Y.onRecoverableError),Y.formState!==void 0&&(P=Y.formState)),x=iM(g,1,!0,x,Y!=null?Y:null,G,U,P,Z,l,N,fX),x.context=tM(null),Y=x.current,G=w4(),G=Vv(G),U=g8(G),U.callback=null,f8(Y,U,G),Y=G,x.current.lanes=Y,_f(x,Y),H7(x),g[Fb]=x.current,qJ(g),new vZ(x)},qX="19.2.0";var ZX=AY(()=>{dH();oq=o5(Z3(),1),XB=o5(Ex(),1);O5=Object.assign,VW=Symbol.for("react.element"),ux=Symbol.for("react.transitional.element"),bf=Symbol.for("react.portal"),ow=Symbol.for("react.fragment"),hB=Symbol.for("react.strict_mode"),Vk=Symbol.for("react.profiler"),FB=Symbol.for("react.consumer"),n7=Symbol.for("react.context"),Mv=Symbol.for("react.forward_ref"),Lk=Symbol.for("react.suspense"),Wk=Symbol.for("react.suspense_list"),Xv=Symbol.for("react.memo"),u6=Symbol.for("react.lazy"),hk=Symbol.for("react.activity"),LW=Symbol.for("react.memo_cache_sentinel"),sH=Symbol.iterator;WW=Symbol.for("react.client.reference");gf=Array.isArray,F0=oq.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,b5=XB.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q9={pending:!1,data:null,method:null,action:null},Kk=[];J7=G7(null),hf=G7(null),w8=G7(null),Qq=G7(null);Ck=Object.prototype.hasOwnProperty,Qv=Ew,cY=$Y,FW=_Y,KW=mY,i3=Z7,lW=jY,KB=IY,lB=TY,Wq=Pw,CW=SY,CB=NY,DW=void 0,dW=void 0;e3=Math.clz32?Math.clz32:RW,OW=Math.log,yW=Math.LN2;H8=Math.random().toString(36).slice(2),a2="__reactFiber$"+H8,N3="__reactProps$"+H8,Fb="__reactContainer$"+H8,Dk="__reactEvents$"+H8,SW="__reactListeners$"+H8,TW="__reactHandles$"+H8,wU="__reactResources$"+H8,Pf="__reactMarker$"+H8;NB=new Set,IB={};$W=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),bU={},gU={};_W=/[\n"\\]/g;PW=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));EW=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),uW=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;b6=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u");if(b6)try{A9={},Object.defineProperty(A9,"passive",{get:function(){Nk=!0}}),window.addEventListener("test",A9,A9),window.removeEventListener("test",A9,A9)}catch(g){Nk=!1}O9={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(g){return g.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sq=I3(O9),Ef=O5({},O9,{view:0,detail:0}),pW=I3(Ef),iq=O5({},Ef,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lv,button:0,buttons:0,relatedTarget:function(g){return g.relatedTarget===void 0?g.fromElement===g.srcElement?g.toElement:g.fromElement:g.relatedTarget},movementX:function(g){if("movementX"in g)return g.movementX;return g!==sg&&(sg&&g.type==="mousemove"?(oY=g.screenX-sg.screenX,nY=g.screenY-sg.screenY):nY=oY=0,sg=g),oY},movementY:function(g){return"movementY"in g?g.movementY:nY}}),qU=I3(iq),cW=O5({},iq,{dataTransfer:0}),aW=I3(cW),rW=O5({},Ef,{relatedTarget:0}),sY=I3(rW),oW=O5({},O9,{animationName:0,elapsedTime:0,pseudoElement:0}),nW=I3(oW),sW=O5({},O9,{clipboardData:function(g){return"clipboardData"in g?g.clipboardData:window.clipboardData}}),iW=I3(sW),tW=O5({},O9,{data:0}),ZU=I3(tW),eW={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};fh=O5({},Ef,{key:function(g){if(g.key){var x=eW[g.key]||g.key;if(x!=="Unidentified")return x}return g.type==="keypress"?(g=qq(g),g===13?"Enter":String.fromCharCode(g)):g.type==="keydown"||g.type==="keyup"?wh[g.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lv,charCode:function(g){return g.type==="keypress"?qq(g):0},keyCode:function(g){return g.type==="keydown"||g.type==="keyup"?g.keyCode:0},which:function(g){return g.type==="keypress"?qq(g):g.type==="keydown"||g.type==="keyup"?g.keyCode:0}}),zh=I3(fh),xh=O5({},iq,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),YU=I3(xh),qh=O5({},Ef,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lv}),Zh=I3(qh),Yh=O5({},O9,{propertyName:0,elapsedTime:0,pseudoElement:0}),kh=I3(Yh),vh=O5({},iq,{deltaX:function(g){return"deltaX"in g?g.deltaX:("wheelDeltaX"in g)?-g.wheelDeltaX:0},deltaY:function(g){return"deltaY"in g?g.deltaY:("wheelDeltaY"in g)?-g.wheelDeltaY:("wheelDelta"in g)?-g.wheelDelta:0},deltaZ:0,deltaMode:0}),Jh=I3(vh),Gh=O5({},O9,{newState:0,oldState:0}),Hh=I3(Gh),Uh=[9,13,27,32],Cv=b6&&"CompositionEvent"in window;b6&&"documentMode"in document&&(vf=document.documentMode);Bh=b6&&"TextEvent"in window&&!vf,uB=b6&&(!Cv||vf&&8<vf&&11>=vf),kU=String.fromCharCode(32);Xh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};if(b6){if(b6){if(xf="oninput"in document,!xf)Zq=document.createElement("div"),Zq.setAttribute("oninput","return;"),xf=typeof Zq.oninput==="function";zf=xf}else zf=!1;rB=zf&&(!document.documentMode||9<document.documentMode)}b4=typeof Object.is==="function"?Object.is:Fh;Kh=b6&&"documentMode"in document&&11>=document.documentMode;wb={animationend:H9("Animation","AnimationEnd"),animationiteration:H9("Animation","AnimationIteration"),animationstart:H9("Animation","AnimationStart"),transitionrun:H9("Transition","TransitionRun"),transitionstart:H9("Transition","TransitionStart"),transitioncancel:H9("Transition","TransitionCancel"),transitionend:H9("Transition","TransitionEnd")},iY={},iB={};b6&&(iB=document.createElement("div").style,("AnimationEvent"in window)||(delete wb.animationend.animation,delete wb.animationiteration.animation,delete wb.animationstart.animation),("TransitionEvent"in window)||delete wb.transitionend.transition);tB=y9("animationend"),eB=y9("animationiteration"),wA=y9("animationstart"),lh=y9("transitionrun"),Ch=y9("transitionstart"),Dh=y9("transitioncancel"),bA=y9("transitionend"),gA=new Map,Tk="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Tk.push("scrollEnd");Fq=typeof reportError==="function"?reportError:function(g){if(typeof window==="object"&&typeof window.ErrorEvent==="function"){var x=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof g==="object"&&g!==null&&typeof g.message==="string"?String(g.message):String(g),error:g});if(!window.dispatchEvent(x))return}else if(typeof process==="object"&&typeof process.emit==="function"){process.emit("uncaughtException",g);return}console.error(g)},H4=[];gb={};MU=new WeakMap;fb=[],B4=[];$k=Error(y1(519));jk=G7(null);Oh=typeof AbortController<"u"?AbortController:function(){var g=[],x=this.signal={aborted:!1,addEventListener:function(Y,G){g.push(G)}};this.abort=function(){x.aborted=!0,g.forEach(function(Y){return Y()})}},yh=Ew,Rh=Pw,U2={$$typeof:n7,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};LU=F0.S;F0.S=function(g,x){WM=i3(),typeof x==="object"&&x!==null&&typeof x.then==="function"&&Nh(g,x),LU!==null&&LU(g,x)};L9=G7(null);Cb=Error(y1(460)),Tv=Error(y1(474)),bZ=Error(y1(542)),Dq={then:function(){}};l9=JA(!0),GA=JA(!1);Mb=G7(null),dq=G7(0);g4=G7(null);g2=G7(0);yf={readContext:o2,use:fZ,useCallback:n5,useContext:n5,useEffect:n5,useImperativeHandle:n5,useLayoutEffect:n5,useInsertionEffect:n5,useMemo:n5,useReducer:n5,useRef:n5,useState:n5,useDebugValue:n5,useDeferredValue:n5,useTransition:n5,useSyncExternalStore:n5,useId:n5,useHostTransitionStatus:n5,useFormState:n5,useActionState:n5,useOptimistic:n5,useMemoCache:n5,useCacheRefresh:n5};yf.useEffectEvent=n5;aA={readContext:o2,use:fZ,useCallback:function(g,x){return X3().memoizedState=[g,x===void 0?null:x],g},useContext:o2,useEffect:yU,useImperativeHandle:function(g,x,Y){Y=Y!==null&&Y!==void 0?Y.concat([g]):null,Jq(4194308,4,NA.bind(null,x,g),Y)},useLayoutEffect:function(g,x){return Jq(4194308,4,g,x)},useInsertionEffect:function(g,x){Jq(4,2,g,x)},useMemo:function(g,x){var Y=X3();x=x===void 0?null:x;var G=g();if(C9){n6(!0);try{g()}finally{n6(!1)}}return Y.memoizedState=[G,x],G},useReducer:function(g,x,Y){var G=X3();if(Y!==void 0){var U=Y(x);if(C9){n6(!0);try{Y(x)}finally{n6(!1)}}}else U=x;return G.memoizedState=G.baseState=U,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:U},G.queue=g,g=g.dispatch=Eh.bind(null,T0,g),[G.memoizedState,g]},useRef:function(g){var x=X3();return g={current:g},x.memoizedState=g},useState:function(g){g=ak(g);var x=g.queue,Y=uA.bind(null,T0,x);return x.dispatch=Y,[g.memoizedState,Y]},useDebugValue:rv,useDeferredValue:function(g,x){var Y=X3();return ov(Y,g,x)},useTransition:function(){var g=ak(!1);return g=jA.bind(null,T0,g.queue,!0,!1),X3().memoizedState=g,[!1,g]},useSyncExternalStore:function(g,x,Y){var G=T0,U=X3();if(o0){if(Y===void 0)throw Error(y1(407));Y=Y()}else{if(Y=x(),M5===null)throw Error(y1(349));(c0&127)!==0||QA(G,x,Y)}U.memoizedState=Y;var Z={value:Y,getSnapshot:x};return U.queue=Z,yU(LA.bind(null,G,Z,g),[g]),G.flags|=2048,Xb(9,{destroy:void 0},VA.bind(null,G,Z,Y,x),null),Y},useId:function(){var g=X3(),x=M5.identifierPrefix;if(o0){var Y=k7,G=Y7;Y=(G&~(1<<32-e3(G)-1)).toString(32)+Y,x="_"+x+"R_"+Y,Y=Rq++,0<Y&&(x+="H"+Y.toString(32)),x+="_"}else Y=Sh++,x="_"+x+"r_"+Y.toString(32)+"_";return g.memoizedState=x},useHostTransitionStatus:nv,useFormState:DU,useActionState:DU,useOptimistic:function(g){var x=X3();x.memoizedState=x.baseState=g;var Y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return x.queue=Y,x=sv.bind(null,T0,!0,Y),Y.dispatch=x,[g,x]},useMemoCache:pv,useCacheRefresh:function(){return X3().memoizedState=Ph.bind(null,T0)},useEffectEvent:function(g){var x=X3(),Y={impl:g};return x.memoizedState=Y,function(){if((w5&2)!==0)throw Error(y1(440));return Y.impl.apply(void 0,arguments)}}},iv={readContext:o2,use:fZ,useCallback:SA,useContext:o2,useEffect:av,useImperativeHandle:IA,useInsertionEffect:yA,useLayoutEffect:RA,useMemo:TA,useReducer:vq,useRef:dA,useState:function(){return vq(f6)},useDebugValue:rv,useDeferredValue:function(g,x){var Y=f2();return $A(Y,J5.memoizedState,g,x)},useTransition:function(){var g=vq(f6)[0],x=f2().memoizedState;return[typeof g==="boolean"?g:pf(g),x]},useSyncExternalStore:XA,useId:PA,useHostTransitionStatus:nv,useFormState:dU,useActionState:dU,useOptimistic:function(g,x){var Y=f2();return FA(Y,J5,g,x)},useMemoCache:pv,useCacheRefresh:EA};iv.useEffectEvent=OA;rA={readContext:o2,use:fZ,useCallback:SA,useContext:o2,useEffect:av,useImperativeHandle:IA,useInsertionEffect:yA,useLayoutEffect:RA,useMemo:TA,useReducer:gk,useRef:dA,useState:function(){return gk(f6)},useDebugValue:rv,useDeferredValue:function(g,x){var Y=f2();return J5===null?ov(Y,g,x):$A(Y,J5.memoizedState,g,x)},useTransition:function(){var g=gk(f6)[0],x=f2().memoizedState;return[typeof g==="boolean"?g:pf(g),x]},useSyncExternalStore:XA,useId:PA,useHostTransitionStatus:nv,useFormState:OU,useActionState:OU,useOptimistic:function(g,x){var Y=f2();if(J5!==null)return FA(Y,J5,g,x);return Y.baseState=g,[g,Y.queue.dispatch]},useMemoCache:pv,useCacheRefresh:EA};rA.useEffectEvent=OA;nk={enqueueSetState:function(g,x,Y){g=g._reactInternals;var G=w4(),U=g8(G);U.payload=x,Y!==void 0&&Y!==null&&(U.callback=Y),x=f8(g,U,G),x!==null&&(R3(x,g,G),Uf(x,g,G))},enqueueReplaceState:function(g,x,Y){g=g._reactInternals;var G=w4(),U=g8(G);U.tag=1,U.payload=x,Y!==void 0&&Y!==null&&(U.callback=Y),x=f8(g,U,G),x!==null&&(R3(x,g,G),Uf(x,g,G))},enqueueForceUpdate:function(g,x){g=g._reactInternals;var Y=w4(),G=g8(Y);G.tag=2,x!==void 0&&x!==null&&(G.callback=x),x=f8(g,G,Y),x!==null&&(R3(x,g,Y),Uf(x,g,Y))}};tv=Error(y1(461));zk={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};pU=typeof WeakSet==="function"?WeakSet:Set;sh={getCacheForType:function(g){var x=o2(U2),Y=x.data.get(g);return Y===void 0&&(Y=g(),x.data.set(g,Y)),Y},cacheSignal:function(){return o2(U2).controller.signal}},ih=typeof WeakMap==="function"?WeakMap:Map;for(Yf=0;Yf<Tk.length;Yf++)kf=Tk[Yf],xv=kf.toLowerCase(),qv=kf[0].toUpperCase()+kf.slice(1),u4(xv,"on"+qv);u4(tB,"onAnimationEnd");u4(eB,"onAnimationIteration");u4(wA,"onAnimationStart");u4("dblclick","onDoubleClick");u4("focusin","onFocus");u4("focusout","onBlur");u4(lh,"onTransitionRun");u4(Ch,"onTransitionStart");u4(Dh,"onTransitionCancel");u4(bA,"onTransitionEnd");Ub("onMouseEnter",["mouseout","mouseover"]);Ub("onMouseLeave",["mouseout","mouseover"]);Ub("onPointerEnter",["pointerout","pointerover"]);Ub("onPointerLeave",["pointerout","pointerover"]);d9("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));d9("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));d9("onBeforeInput",["compositionend","keypress","textInput","paste"]);d9("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));d9("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));d9("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));Rf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kF=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Rf));wq="_reactListening"+Math.random().toString(36).slice(2);JF=/\r\n?/g,GF=/\u0000|\uFFFD/g;cM=typeof setTimeout==="function"?setTimeout:void 0,AF=typeof clearTimeout==="function"?clearTimeout:void 0,gB=typeof Promise==="function"?Promise:void 0,MF=typeof queueMicrotask==="function"?queueMicrotask:typeof gB<"u"?function(g){return gB.resolve(null).then(g).catch(XF)}:cM;W4=new Map,ZB=new Set;q6=b5.d;b5.d={f:WF,r:hF,D:FF,C:KF,L:lF,m:CF,X:dF,S:DF,M:OF};db=typeof document>"u"?null:document;If={$$typeof:n7,Provider:null,Consumer:null,_currentValue:Q9,_currentValue2:Q9,_threadCount:0};Sf=new Map,Tf=new Map,o6=[],mF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");vZ.prototype.render=GJ.prototype.render=function(g){var x=this._internalRoot;if(x===null)throw Error(y1(409));var Y=x.current,G=w4();eM(Y,G,g,x,null,null)};vZ.prototype.unmount=GJ.prototype.unmount=function(){var g=this._internalRoot;if(g!==null){this._internalRoot=null;var x=g.containerInfo;eM(g.current,2,null,g,null,null),ZZ(),x[Fb]=null}};vZ.prototype.unstable_scheduleHydration=function(g){if(g){var x=RB();g={blockedOn:null,target:g,priority:x};for(var Y=0;Y<o6.length&&x!==0&&x<o6[Y].priority;Y++);o6.splice(Y,0,g),Y===0&&gX(g)}};MB=oq.version;if(MB!=="19.2.0")throw Error(y1(527,MB,"19.2.0"));b5.findDOMNode=function(g){var x=g._reactInternals;if(x===void 0){if(typeof g.render==="function")throw Error(y1(188));throw g=Object.keys(g).join(","),Error(y1(268,g))}return g=QW(x),g=g!==null?WB(g):null,g=g===null?null:g.stateNode,g};EF={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:F0,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){if(rw=__REACT_DEVTOOLS_GLOBAL_HOOK__,!rw.isDisabled&&rw.supportsFiber)try{jf=rw.inject(EF),t3=rw}catch(g){}}});var UJ=Nx((Il,kX)=>{ZX();function YX(){if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!=="function")return;try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(YX)}catch(g){console.error(g)}}YX(),kX.exports=HJ});var hJ=Nx((LJ,WJ)=>{(function(g,x){typeof LJ==="object"&&typeof WJ<"u"?WJ.exports=x():typeof define==="function"&&define.amd?define(x):(g=typeof globalThis<"u"?globalThis:g||self,g.maplibregl=x())})(LJ,function(){var g={},x={};function Y(U,Z,l){if(x[U]=l,U!=="index")return;var N="var sharedModule = {}; ("+x.shared+")(sharedModule); ("+x.worker+")(sharedModule);",P={};if(x.shared(P),x.index(g,P),typeof window<"u")g.setWorkerUrl(window.URL.createObjectURL(new Blob([N],{type:"text/javascript"})));return g}Y("shared",["exports"],function(U){function Z(w,f,q,v){return new(q||(q=Promise))(function(H,M){function A(h){try{W(v.next(h))}catch(K){M(K)}}function Q(h){try{W(v.throw(h))}catch(K){M(K)}}function W(h){var K;h.done?H(h.value):(K=h.value,K instanceof q?K:new q(function(D){D(K)})).then(A,Q)}W((v=v.apply(w,f||[])).next())})}function l(w,f){this.x=w,this.y=f}function N(w){return w&&w.__esModule&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w}var P,w1;typeof SuppressedError=="function"&&SuppressedError,l.prototype={clone(){return new l(this.x,this.y)},add(w){return this.clone()._add(w)},sub(w){return this.clone()._sub(w)},multByPoint(w){return this.clone()._multByPoint(w)},divByPoint(w){return this.clone()._divByPoint(w)},mult(w){return this.clone()._mult(w)},div(w){return this.clone()._div(w)},rotate(w){return this.clone()._rotate(w)},rotateAround(w,f){return this.clone()._rotateAround(w,f)},matMult(w){return this.clone()._matMult(w)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(w){return this.x===w.x&&this.y===w.y},dist(w){return Math.sqrt(this.distSqr(w))},distSqr(w){let f=w.x-this.x,q=w.y-this.y;return f*f+q*q},angle(){return Math.atan2(this.y,this.x)},angleTo(w){return Math.atan2(this.y-w.y,this.x-w.x)},angleWith(w){return this.angleWithSep(w.x,w.y)},angleWithSep(w,f){return Math.atan2(this.x*f-this.y*w,this.x*w+this.y*f)},_matMult(w){let f=w[2]*this.x+w[3]*this.y;return this.x=w[0]*this.x+w[1]*this.y,this.y=f,this},_add(w){return this.x+=w.x,this.y+=w.y,this},_sub(w){return this.x-=w.x,this.y-=w.y,this},_mult(w){return this.x*=w,this.y*=w,this},_div(w){return this.x/=w,this.y/=w,this},_multByPoint(w){return this.x*=w.x,this.y*=w.y,this},_divByPoint(w){return this.x/=w.x,this.y/=w.y,this},_unit(){return this._div(this.mag()),this},_perp(){let w=this.y;return this.y=this.x,this.x=-w,this},_rotate(w){let f=Math.cos(w),q=Math.sin(w),v=q*this.x+f*this.y;return this.x=f*this.x-q*this.y,this.y=v,this},_rotateAround(w,f){let q=Math.cos(w),v=Math.sin(w),H=f.y+v*(this.x-f.x)+q*(this.y-f.y);return this.x=f.x+q*(this.x-f.x)-v*(this.y-f.y),this.y=H,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:l},l.convert=function(w){if(w instanceof l)return w;if(Array.isArray(w))return new l(+w[0],+w[1]);if(w.x!==void 0&&w.y!==void 0)return new l(+w.x,+w.y);throw Error("Expected [x, y] or {x, y} point format")};var H1=function(){if(w1)return P;function w(f,q,v,H){this.cx=3*f,this.bx=3*(v-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*q,this.by=3*(H-q)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=q,this.p2x=v,this.p2y=H}return w1=1,P=w,w.prototype={sampleCurveX:function(f){return((this.ax*f+this.bx)*f+this.cx)*f},sampleCurveY:function(f){return((this.ay*f+this.by)*f+this.cy)*f},sampleCurveDerivativeX:function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},solveCurveX:function(f,q){if(q===void 0&&(q=0.000001),f<0)return 0;if(f>1)return 1;for(var v=f,H=0;H<8;H++){var M=this.sampleCurveX(v)-f;if(Math.abs(M)<q)return v;var A=this.sampleCurveDerivativeX(v);if(Math.abs(A)<0.000001)break;v-=M/A}var Q=0,W=1;for(v=f,H=0;H<20&&(M=this.sampleCurveX(v),!(Math.abs(M-f)<q));H++)f>M?Q=v:W=v,v=0.5*(W-Q)+Q;return v},solve:function(f,q){return this.sampleCurveY(this.solveCurveX(f,q))}},P}(),r=N(H1);let z1,u;function R1(){return z1==null&&(z1=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),z1}function P1(){if(u==null&&(u=!1,R1())){let f=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(f){for(let v=0;v<25;v++){let H=4*v;f.fillStyle=`rgb(${H},${H+1},${H+2})`,f.fillRect(v%5,Math.floor(v/5),1,1)}let q=f.getImageData(0,0,5,5).data;for(let v=0;v<100;v++)if(v%4!=3&&q[v]!==v){u=!0;break}}}return u||!1}var s1=0.000001,f1=typeof Float32Array<"u"?Float32Array:Array;function Y1(){var w=new f1(9);return f1!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[5]=0,w[6]=0,w[7]=0),w[0]=1,w[4]=1,w[8]=1,w}function B1(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function F1(){var w=new f1(3);return f1!=Float32Array&&(w[0]=0,w[1]=0,w[2]=0),w}function i1(w){var f=w[0],q=w[1],v=w[2];return Math.sqrt(f*f+q*q+v*v)}function k0(w,f,q){var v=new f1(3);return v[0]=w,v[1]=f,v[2]=q,v}function r1(w,f,q){return w[0]=f[0]+q[0],w[1]=f[1]+q[1],w[2]=f[2]+q[2],w}function $1(w,f,q){return w[0]=f[0]*q,w[1]=f[1]*q,w[2]=f[2]*q,w}function q0(w,f,q){var v=f[0],H=f[1],M=f[2],A=q[0],Q=q[1],W=q[2];return w[0]=H*W-M*Q,w[1]=M*A-v*W,w[2]=v*Q-H*A,w}var G0,T5=i1;function i5(w,f,q){var v=f[0],H=f[1],M=f[2],A=f[3];return w[0]=q[0]*v+q[4]*H+q[8]*M+q[12]*A,w[1]=q[1]*v+q[5]*H+q[9]*M+q[13]*A,w[2]=q[2]*v+q[6]*H+q[10]*M+q[14]*A,w[3]=q[3]*v+q[7]*H+q[11]*M+q[15]*A,w}function X5(){var w=new f1(4);return f1!=Float32Array&&(w[0]=0,w[1]=0,w[2]=0),w[3]=1,w}function A2(w,f,q,v){var H=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",M=Math.PI/360;f*=M,v*=M,q*=M;var A=Math.sin(f),Q=Math.cos(f),W=Math.sin(q),h=Math.cos(q),K=Math.sin(v),D=Math.cos(v);switch(H){case"xyz":w[0]=A*h*D+Q*W*K,w[1]=Q*W*D-A*h*K,w[2]=Q*h*K+A*W*D,w[3]=Q*h*D-A*W*K;break;case"xzy":w[0]=A*h*D-Q*W*K,w[1]=Q*W*D-A*h*K,w[2]=Q*h*K+A*W*D,w[3]=Q*h*D+A*W*K;break;case"yxz":w[0]=A*h*D+Q*W*K,w[1]=Q*W*D-A*h*K,w[2]=Q*h*K-A*W*D,w[3]=Q*h*D+A*W*K;break;case"yzx":w[0]=A*h*D+Q*W*K,w[1]=Q*W*D+A*h*K,w[2]=Q*h*K-A*W*D,w[3]=Q*h*D-A*W*K;break;case"zxy":w[0]=A*h*D-Q*W*K,w[1]=Q*W*D+A*h*K,w[2]=Q*h*K+A*W*D,w[3]=Q*h*D-A*W*K;break;case"zyx":w[0]=A*h*D-Q*W*K,w[1]=Q*W*D+A*h*K,w[2]=Q*h*K-A*W*D,w[3]=Q*h*D+A*W*K;break;default:throw Error("Unknown angle order "+H)}return w}function y5(){var w=new f1(2);return f1!=Float32Array&&(w[0]=0,w[1]=0),w}function C0(w,f){var q=new f1(2);return q[0]=w,q[1]=f,q}F1(),G0=new f1(4),f1!=Float32Array&&(G0[0]=0,G0[1]=0,G0[2]=0,G0[3]=0),F1(),k0(1,0,0),k0(0,1,0),X5(),X5(),Y1(),y5();let J0=8192;function b0(w,f,q){return f*(J0/(w.tileSize*Math.pow(2,q-w.tileID.overscaledZ)))}function W5(w,f){return(w%f+f)%f}function Q5(w,f,q){return w*(1-q)+f*q}function R5(w){if(w<=0)return 0;if(w>=1)return 1;let f=w*w,q=f*w;return 4*(w<0.5?q:3*(w-f)+q-0.75)}function s2(w,f,q,v){let H=new r(w,f,q,v);return(M)=>H.solve(M)}let Z0=s2(0.25,0.1,0.25,1);function U0(w,f,q){return Math.min(q,Math.max(f,w))}function P0(w,f,q){let v=q-f,H=((w-f)%v+v)%v+f;return H===f?q:H}function s0(w,...f){for(let q of f)for(let v in q)w[v]=q[v];return w}let j0=1;function a0(w,f,q){let v={};for(let H in w)v[H]=f.call(this,w[H],H,w);return v}function M2(w,f,q){let v={};for(let H in w)f.call(this,w[H],H,w)&&(v[H]=w[H]);return v}function h5(w){return Array.isArray(w)?w.map(h5):typeof w=="object"&&w?a0(w,h5):w}let d2={};function r0(w){d2[w]||(typeof console<"u"&&console.warn(w),d2[w]=!0)}function g5(w,f,q){return(q.y-w.y)*(f.x-w.x)>(f.y-w.y)*(q.x-w.x)}function i2(w){return typeof WorkerGlobalScope<"u"&&w!==void 0&&w instanceof WorkerGlobalScope}let z4=null;function Q3(w){if(z4==null){let f=w.navigator?w.navigator.userAgent:null;z4=!!w.safari||!(!f||!(/\b(iPad|iPhone|iPod)\b/.test(f)||f.match("Safari")&&!f.match("Chrome")))}return z4}function O2(w){return typeof ImageBitmap<"u"&&w instanceof ImageBitmap}let x4="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function E5(w,f,q,v,H){return Z(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw Error("VideoFrame not supported");let M=new VideoFrame(w,{timestamp:0});try{let A=M==null?void 0:M.format;if(!A||!A.startsWith("BGR")&&!A.startsWith("RGB"))throw Error(`Unrecognized format ${A}`);let Q=A.startsWith("BGR"),W=new Uint8ClampedArray(v*H*4);if(yield M.copyTo(W,function(h,K,D,$,R){let _=4*Math.max(-K,0),j=(Math.max(0,D)-D)*$*4+_,o=4*$,t=Math.max(0,K),U1=Math.max(0,D);return{rect:{x:t,y:U1,width:Math.min(h.width,K+$)-t,height:Math.min(h.height,D+R)-U1},layout:[{offset:j,stride:o}]}}(w,f,q,v,H)),Q)for(let h=0;h<W.length;h+=4){let K=W[h];W[h]=W[h+2],W[h+2]=K}return W}finally{M.close()}})}let T3,Y3;function u5(w,f,q,v){return w.addEventListener(f,q,v),{unsubscribe:()=>{w.removeEventListener(f,q,v)}}}function t2(w){return w*Math.PI/180}function e2(w){return w/Math.PI*180}let c4={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},$3={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},V3="AbortError";function I(){return Error(V3)}let S={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function m(w){return S.REGISTERED_PROTOCOLS[w.substring(0,w.indexOf("://"))]}let e="global-dispatcher";class b1 extends Error{constructor(w,f,q,v){super(`AJAXError: ${f} (${w}): ${q}`),this.status=w,this.statusText=f,this.url=q,this.body=v}}let J1=()=>i2(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,A1=function(w,f){if(/:\/\//.test(w.url)&&!/^https?:|^file:/.test(w.url)){let v=m(w.url);if(v)return v(w,f);if(i2(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:w,targetMapId:e},f)}if(!(/^file:/.test(q=w.url)||/^file:/.test(J1())&&!/^\w+:/.test(q))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(v,H){return Z(this,void 0,void 0,function*(){let M=new Request(v.url,{method:v.method||"GET",body:v.body,credentials:v.credentials,headers:v.headers,cache:v.cache,referrer:J1(),signal:H.signal}),A,Q;v.type!=="json"||M.headers.has("Accept")||M.headers.set("Accept","application/json");try{A=yield fetch(M)}catch(h){throw new b1(0,h.message,v.url,new Blob)}if(!A.ok){let h=yield A.blob();throw new b1(A.status,A.statusText,v.url,h)}Q=v.type==="arrayBuffer"||v.type==="image"?A.arrayBuffer():v.type==="json"?A.json():A.text();let W=yield Q;if(H.signal.aborted)throw I();return{data:W,cacheControl:A.headers.get("Cache-Control"),expires:A.headers.get("Expires")}})}(w,f);if(i2(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:w,mustQueue:!0,targetMapId:e},f)}var q;return function(v,H){return new Promise((M,A)=>{var Q;let W=new XMLHttpRequest;W.open(v.method||"GET",v.url,!0),v.type!=="arrayBuffer"&&v.type!=="image"||(W.responseType="arraybuffer");for(let h in v.headers)W.setRequestHeader(h,v.headers[h]);v.type==="json"&&(W.responseType="text",((Q=v.headers)===null||Q===void 0?void 0:Q.Accept)||W.setRequestHeader("Accept","application/json")),W.withCredentials=v.credentials==="include",W.onerror=()=>{A(Error(W.statusText))},W.onload=()=>{if(!H.signal.aborted)if((W.status>=200&&W.status<300||W.status===0)&&W.response!==null){let h=W.response;if(v.type==="json")try{h=JSON.parse(W.response)}catch(K){return void A(K)}M({data:h,cacheControl:W.getResponseHeader("Cache-Control"),expires:W.getResponseHeader("Expires")})}else{let h=new Blob([W.response],{type:W.getResponseHeader("Content-Type")});A(new b1(W.status,W.statusText,v.url,h))}},H.signal.addEventListener("abort",()=>{W.abort(),A(I())}),W.send(v.body)})}(w,f)};function v1(w){if(!w||w.indexOf("://")<=0||w.indexOf("data:image/")===0||w.indexOf("blob:")===0)return!0;let f=new URL(w),q=window.location;return f.protocol===q.protocol&&f.host===q.host}function X1(w,f,q){q[w]&&q[w].indexOf(f)!==-1||(q[w]=q[w]||[],q[w].push(f))}function l1(w,f,q){if(q&&q[w]){let v=q[w].indexOf(f);v!==-1&&q[w].splice(v,1)}}class C1{constructor(w,f={}){s0(this,f),this.type=w}}class m1 extends C1{constructor(w,f={}){super("error",s0({error:w},f))}}class w0{on(w,f){return this._listeners=this._listeners||{},X1(w,f,this._listeners),{unsubscribe:()=>{this.off(w,f)}}}off(w,f){return l1(w,f,this._listeners),l1(w,f,this._oneTimeListeners),this}once(w,f){return f?(this._oneTimeListeners=this._oneTimeListeners||{},X1(w,f,this._oneTimeListeners),this):new Promise((q)=>this.once(w,q))}fire(w,f){typeof w=="string"&&(w=new C1(w,f||{}));let q=w.type;if(this.listens(q)){w.target=this;let v=this._listeners&&this._listeners[q]?this._listeners[q].slice():[];for(let A of v)A.call(this,w);let H=this._oneTimeListeners&&this._oneTimeListeners[q]?this._oneTimeListeners[q].slice():[];for(let A of H)l1(q,A,this._oneTimeListeners),A.call(this,w);let M=this._eventedParent;M&&(s0(w,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),M.fire(w))}else w instanceof m1&&console.error(w.error);return this}listens(w){return this._listeners&&this._listeners[w]&&this._listeners[w].length>0||this._oneTimeListeners&&this._oneTimeListeners[w]&&this._oneTimeListeners[w].length>0||this._eventedParent&&this._eventedParent.listens(w)}setEventedParent(w,f){return this._eventedParent=w,this._eventedParentData=f,this}}var M1={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:0.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:0.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:0.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:0.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:0.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:0.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:0.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};let y0=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function i0(w,f){let q={};for(let v in w)v!=="ref"&&(q[v]=w[v]);return y0.forEach((v)=>{v in f&&(q[v]=f[v])}),q}function N1(w,f){if(Array.isArray(w)){if(!Array.isArray(f)||w.length!==f.length)return!1;for(let q=0;q<w.length;q++)if(!N1(w[q],f[q]))return!1;return!0}if(typeof w=="object"&&w!==null&&f!==null){if(typeof f!="object")return!1;if(Object.keys(w).length!==Object.keys(f).length)return!1;for(let q in w)if(!N1(w[q],f[q]))return!1;return!0}return w===f}function v0(w,f){w.push(f)}function M0(w,f,q){v0(q,{command:"addSource",args:[w,f[w]]})}function e0(w,f,q){v0(f,{command:"removeSource",args:[w]}),q[w]=!0}function F5(w,f,q,v){e0(w,q,v),M0(w,f,q)}function m0(w,f,q){let v;for(v in w[q])if(Object.prototype.hasOwnProperty.call(w[q],v)&&v!=="data"&&!N1(w[q][v],f[q][v]))return!1;for(v in f[q])if(Object.prototype.hasOwnProperty.call(f[q],v)&&v!=="data"&&!N1(w[q][v],f[q][v]))return!1;return!0}function D0(w,f,q,v,H,M){w=w||{},f=f||{};for(let A in w)Object.prototype.hasOwnProperty.call(w,A)&&(N1(w[A],f[A])||q.push({command:M,args:[v,A,f[A],H]}));for(let A in f)Object.prototype.hasOwnProperty.call(f,A)&&!Object.prototype.hasOwnProperty.call(w,A)&&(N1(w[A],f[A])||q.push({command:M,args:[v,A,f[A],H]}))}function z5(w){return w.id}function L0(w,f){return w[f.id]=f,w}class d1{constructor(w,f,q,v){this.message=(w?`${w}: `:"")+q,v&&(this.identifier=v),f!=null&&f.__line__&&(this.line=f.__line__)}}function w3(w,...f){for(let q of f)for(let v in q)w[v]=q[v];return w}class V5 extends Error{constructor(w,f){super(f),this.message=f,this.key=w}}class T2{constructor(w,f=[]){this.parent=w,this.bindings={};for(let[q,v]of f)this.bindings[q]=v}concat(w){return new T2(this,w)}get(w){if(this.bindings[w])return this.bindings[w];if(this.parent)return this.parent.get(w);throw Error(`${w} not found in scope.`)}has(w){return!!this.bindings[w]||!!this.parent&&this.parent.has(w)}}let b3={kind:"null"},u1={kind:"number"},R0={kind:"string"},l0={kind:"boolean"},L3={kind:"color"},Q8={kind:"projectionDefinition"},F4={kind:"object"},X0={kind:"value"},A7={kind:"collator"},k6={kind:"formatted"},v6={kind:"padding"},V8={kind:"colorArray"},M7={kind:"numberArray"},L8={kind:"resolvedImage"},K4={kind:"variableAnchorOffsetCollection"};function $2(w,f){return{kind:"array",itemType:w,N:f}}function N0(w){if(w.kind==="array"){let f=N0(w.itemType);return typeof w.N=="number"?`array<${f}, ${w.N}>`:w.itemType.kind==="value"?"array":`array<${f}>`}return w.kind}let kz=[b3,u1,R0,l0,L3,Q8,k6,F4,$2(X0),v6,M7,V8,L8,K4];function X7(w,f){if(f.kind==="error")return null;if(w.kind==="array"){if(f.kind==="array"&&(f.N===0&&f.itemType.kind==="value"||!X7(w.itemType,f.itemType))&&(typeof w.N!="number"||w.N===f.N))return null}else{if(w.kind===f.kind)return null;if(w.kind==="value"){for(let q of kz)if(!X7(q,f))return null}}return`Expected ${N0(w)} but found ${N0(f)} instead.`}function a4(w,f){return f.some((q)=>q.kind===w.kind)}function l4(w,f){return f.some((q)=>q==="null"?w===null:q==="array"?Array.isArray(w):q==="object"?w&&!Array.isArray(w)&&typeof w=="object":q===typeof w)}function C4(w,f){return w.kind==="array"&&f.kind==="array"?w.itemType.kind===f.itemType.kind&&typeof w.N=="number":w.kind===f.kind}let Sb=0.96422,Tb=0.82521,$b=0.13793103448275862,Q7=0.20689655172413793,vz=3*Q7*Q7,VZ=Q7*Q7*Q7,LZ=Math.PI/180,WZ=180/Math.PI;function Jz(w){return(w%=360)<0&&(w+=360),w}function Gz([w,f,q,v]){let H,M,A=T9((0.2225045*(w=jb(w))+0.7168786*(f=jb(f))+0.0606169*(q=jb(q)))/1);w===f&&f===q?H=M=A:(H=T9((0.4360747*w+0.3850649*f+0.1430804*q)/Sb),M=T9((0.0139322*w+0.0971045*f+0.7141733*q)/Tb));let Q=116*A-16;return[Q<0?0:Q,500*(H-A),200*(A-M),v]}function jb(w){return w<=0.04045?w/12.92:Math.pow((w+0.055)/1.055,2.4)}function T9(w){return w>VZ?Math.pow(w,0.3333333333333333):w/vz+$b}function J6([w,f,q,v]){let H=(w+16)/116,M=isNaN(f)?H:H+f/500,A=isNaN(q)?H:H-q/200;return H=1*j9(H),M=Sb*j9(M),A=Tb*j9(A),[$9(3.1338561*M-1.6168667*H-0.4906146*A),$9(-0.9787684*M+1.9161415*H+0.033454*A),$9(0.0719453*M-0.2289914*H+1.4052427*A),v]}function $9(w){return(w=w<=0.00304?12.92*w:1.055*Math.pow(w,0.4166666666666667)-0.055)<0?0:w>1?1:w}function j9(w){return w>Q7?w*w*w:vz*(w-$b)}let W8=Object.hasOwn||function(w,f){return Object.prototype.hasOwnProperty.call(w,f)};function G6(w,f){return W8(w,f)?w[f]:void 0}function h8(w){return parseInt(w.padEnd(2,w),16)/255}function mb(w,f){return r4(f?w/100:w,0,1)}function r4(w,f,q){return Math.min(Math.max(f,w),q)}function _b(w){return!w.some(Number.isNaN)}let q4={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function K0(w,f,q){return w+q*(f-w)}function W3(w,f,q){return w.map((v,H)=>K0(v,f[H],q))}class h0{constructor(w,f,q,v=1,H=!0){this.r=w,this.g=f,this.b=q,this.a=v,H||(this.r*=v,this.g*=v,this.b*=v,v||this.overwriteGetter("rgb",[w,f,q,v]))}static parse(w){if(w instanceof h0)return w;if(typeof w!="string")return;let f=function(q){if((q=q.toLowerCase().trim())==="transparent")return[0,0,0,0];let v=G6(q4,q);if(v){let[M,A,Q]=v;return[M/255,A/255,Q/255,1]}if(q.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(q)){let M=q.length<6?1:2,A=1;return[h8(q.slice(A,A+=M)),h8(q.slice(A,A+=M)),h8(q.slice(A,A+=M)),h8(q.slice(A,A+M)||"ff")]}if(q.startsWith("rgb")){let M=q.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(M){let[A,Q,W,h,K,D,$,R,_,j,o,t]=M,U1=[h||" ",$||" ",j].join("");if(U1==="  "||U1==="  /"||U1===",,"||U1===",,,"){let g1=[W,D,_].join(""),G1=g1==="%%%"?100:g1===""?255:0;if(G1){let h1=[r4(+Q/G1,0,1),r4(+K/G1,0,1),r4(+R/G1,0,1),o?mb(+o,t):1];if(_b(h1))return h1}}return}}let H=q.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(H){let[M,A,Q,W,h,K,D,$,R]=H,_=[Q||" ",h||" ",D].join("");if(_==="  "||_==="  /"||_===",,"||_===",,,"){let j=[+A,r4(+W,0,100),r4(+K,0,100),$?mb(+$,R):1];if(_b(j))return function([o,t,U1,g1]){function G1(h1){let K1=(h1+o/30)%12,j1=t*Math.min(U1,1-U1);return U1-j1*Math.max(-1,Math.min(K1-3,9-K1,1))}return o=Jz(o),t/=100,U1/=100,[G1(0),G1(8),G1(4),g1]}(j)}}}(w);return f?new h0(...f,!1):void 0}get rgb(){let{r:w,g:f,b:q,a:v}=this,H=v||1/0;return this.overwriteGetter("rgb",[w/H,f/H,q/H,v])}get hcl(){return this.overwriteGetter("hcl",function(w){let[f,q,v,H]=Gz(w),M=Math.sqrt(q*q+v*v);return[Math.round(1e4*M)?Jz(Math.atan2(v,q)*WZ):NaN,M,f,H]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Gz(this.rgb))}overwriteGetter(w,f){return Object.defineProperty(this,w,{value:f}),f}toString(){let[w,f,q,v]=this.rgb;return`rgba(${[w,f,q].map((H)=>Math.round(255*H)).join(",")},${v})`}static interpolate(w,f,q,v="rgb"){switch(v){case"rgb":{let[H,M,A,Q]=W3(w.rgb,f.rgb,q);return new h0(H,M,A,Q,!1)}case"hcl":{let[H,M,A,Q]=w.hcl,[W,h,K,D]=f.hcl,$,R;if(isNaN(H)||isNaN(W))isNaN(H)?isNaN(W)?$=NaN:($=W,A!==1&&A!==0||(R=h)):($=H,K!==1&&K!==0||(R=M));else{let U1=W-H;W>H&&U1>180?U1-=360:W<H&&H-W>180&&(U1+=360),$=H+q*U1}let[_,j,o,t]=function([U1,g1,G1,h1]){return U1=isNaN(U1)?0:U1*LZ,J6([G1,Math.cos(U1)*g1,Math.sin(U1)*g1,h1])}([$,R!=null?R:K0(M,h,q),K0(A,K,q),K0(Q,D,q)]);return new h0(_,j,o,t,!1)}case"lab":{let[H,M,A,Q]=J6(W3(w.lab,f.lab,q));return new h0(H,M,A,Q,!1)}}}}h0.black=new h0(0,0,0,1),h0.white=new h0(1,1,1,1),h0.transparent=new h0(0,0,0,0),h0.red=new h0(1,0,0,1);class F8{constructor(w,f,q){this.sensitivity=w?f?"variant":"case":f?"accent":"base",this.locale=q,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(w,f){return this.collator.compare(w,f)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}let Hz=["bottom","center","top"];class V7{constructor(w,f,q,v,H,M){this.text=w,this.image=f,this.scale=q,this.fontStack=v,this.textColor=H,this.verticalAlign=M}}class X2{constructor(w){this.sections=w}static fromString(w){return new X2([new V7(w,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((w)=>w.text.length!==0||w.image&&w.image.name.length!==0)}static factory(w){return w instanceof X2?w:X2.fromString(w)}toString(){return this.sections.length===0?"":this.sections.map((w)=>w.text).join("")}}class z2{constructor(w){this.values=w.slice()}static parse(w){if(w instanceof z2)return w;if(typeof w=="number")return new z2([w,w,w,w]);if(Array.isArray(w)&&!(w.length<1||w.length>4)){for(let f of w)if(typeof f!="number")return;switch(w.length){case 1:w=[w[0],w[0],w[0],w[0]];break;case 2:w=[w[0],w[1],w[0],w[1]];break;case 3:w=[w[0],w[1],w[2],w[1]]}return new z2(w)}}toString(){return JSON.stringify(this.values)}static interpolate(w,f,q){return new z2(W3(w.values,f.values,q))}}class y2{constructor(w){this.values=w.slice()}static parse(w){if(w instanceof y2)return w;if(typeof w=="number")return new y2([w]);if(Array.isArray(w)){for(let f of w)if(typeof f!="number")return;return new y2(w)}}toString(){return JSON.stringify(this.values)}static interpolate(w,f,q){return new y2(W3(w.values,f.values,q))}}class p5{constructor(w){this.values=w.slice()}static parse(w){if(w instanceof p5)return w;if(typeof w=="string"){let q=h0.parse(w);if(!q)return;return new p5([q])}if(!Array.isArray(w))return;let f=[];for(let q of w){if(typeof q!="string")return;let v=h0.parse(q);if(!v)return;f.push(v)}return new p5(f)}toString(){return JSON.stringify(this.values)}static interpolate(w,f,q,v="rgb"){let H=[];if(w.values.length!=f.values.length)throw Error(`colorArray: Arrays have mismatched length (${w.values.length} vs. ${f.values.length}), cannot interpolate.`);for(let M=0;M<w.values.length;M++)H.push(h0.interpolate(w.values[M],f.values[M],q,v));return new p5(H)}}class x5 extends Error{constructor(w){super(w),this.name="RuntimeError"}toJSON(){return this.message}}let Uz=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Q2{constructor(w){this.values=w.slice()}static parse(w){if(w instanceof Q2)return w;if(Array.isArray(w)&&!(w.length<1)&&w.length%2==0){for(let f=0;f<w.length;f+=2){let q=w[f],v=w[f+1];if(typeof q!="string"||!Uz.has(q))return;if(!Array.isArray(v)||v.length!==2||typeof v[0]!="number"||typeof v[1]!="number")return}return new Q2(w)}}toString(){return JSON.stringify(this.values)}static interpolate(w,f,q){let v=w.values,H=f.values;if(v.length!==H.length)throw new x5(`Cannot interpolate values of different length. from: ${w.toString()}, to: ${f.toString()}`);let M=[];for(let A=0;A<v.length;A+=2){if(v[A]!==H[A])throw new x5(`Cannot interpolate values containing mismatched anchors. from[${A}]: ${v[A]}, to[${A}]: ${H[A]}`);M.push(v[A]);let[Q,W]=v[A+1],[h,K]=H[A+1];M.push([K0(Q,h,q),K0(W,K,q)])}return new Q2(M)}}class V2{constructor(w){this.name=w.name,this.available=w.available}toString(){return this.name}static fromString(w){return w?new V2({name:w,available:!1}):null}}class g3{constructor(w,f,q){this.from=w,this.to=f,this.transition=q}static interpolate(w,f,q){return new g3(w,f,q)}static parse(w){return w instanceof g3?w:Array.isArray(w)&&w.length===3&&typeof w[0]=="string"&&typeof w[1]=="string"&&typeof w[2]=="number"?new g3(w[0],w[1],w[2]):typeof w=="object"&&typeof w.from=="string"&&typeof w.to=="string"&&typeof w.transition=="number"?new g3(w.from,w.to,w.transition):typeof w=="string"?new g3(w,w,1):void 0}}function Pb(w,f,q,v){return typeof w=="number"&&w>=0&&w<=255&&typeof f=="number"&&f>=0&&f<=255&&typeof q=="number"&&q>=0&&q<=255?v===void 0||typeof v=="number"&&v>=0&&v<=1?null:`Invalid rgba value [${[w,f,q,v].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof v=="number"?[w,f,q,v]:[w,f,q]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function H6(w){if(w===null||typeof w=="string"||typeof w=="boolean"||typeof w=="number"||w instanceof g3||w instanceof h0||w instanceof F8||w instanceof X2||w instanceof z2||w instanceof y2||w instanceof p5||w instanceof Q2||w instanceof V2)return!0;if(Array.isArray(w)){for(let f of w)if(!H6(f))return!1;return!0}if(typeof w=="object"){for(let f in w)if(!H6(w[f]))return!1;return!0}return!1}function H5(w){if(w===null)return b3;if(typeof w=="string")return R0;if(typeof w=="boolean")return l0;if(typeof w=="number")return u1;if(w instanceof h0)return L3;if(w instanceof g3)return Q8;if(w instanceof F8)return A7;if(w instanceof X2)return k6;if(w instanceof z2)return v6;if(w instanceof y2)return M7;if(w instanceof p5)return V8;if(w instanceof Q2)return K4;if(w instanceof V2)return L8;if(Array.isArray(w)){let f=w.length,q;for(let v of w){let H=H5(v);if(q){if(q===H)continue;q=X0;break}q=H}return $2(q||X0,f)}return F4}function t0(w){let f=typeof w;return w===null?"":f==="string"||f==="number"||f==="boolean"?String(w):w instanceof h0||w instanceof g3||w instanceof X2||w instanceof z2||w instanceof y2||w instanceof p5||w instanceof Q2||w instanceof V2?w.toString():JSON.stringify(w)}class D4{constructor(w,f){this.type=w,this.value=f}static parse(w,f){if(w.length!==2)return f.error(`'literal' expression requires exactly one argument, but found ${w.length-1} instead.`);if(!H6(w[1]))return f.error("invalid value");let q=w[1],v=H5(q),H=f.expectedType;return v.kind!=="array"||v.N!==0||!H||H.kind!=="array"||typeof H.N=="number"&&H.N!==0||(v=H),new D4(v,q)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}let $0={string:R0,number:u1,boolean:l0,object:F4};class H0{constructor(w,f){this.type=w,this.args=f}static parse(w,f){if(w.length<2)return f.error("Expected at least one argument.");let q,v=1,H=w[0];if(H==="array"){let A,Q;if(w.length>2){let W=w[1];if(typeof W!="string"||!(W in $0)||W==="object")return f.error('The item type argument of "array" must be one of string, number, boolean',1);A=$0[W],v++}else A=X0;if(w.length>3){if(w[2]!==null&&(typeof w[2]!="number"||w[2]<0||w[2]!==Math.floor(w[2])))return f.error('The length argument to "array" must be a positive integer literal',2);Q=w[2],v++}q=$2(A,Q)}else{if(!$0[H])throw Error(`Types doesn't contain name = ${H}`);q=$0[H]}let M=[];for(;v<w.length;v++){let A=f.parse(w[v],v,X0);if(!A)return null;M.push(A)}return new H0(q,M)}evaluate(w){for(let f=0;f<this.args.length;f++){let q=this.args[f].evaluate(w);if(!X7(this.type,H5(q)))return q;if(f===this.args.length-1)throw new x5(`Expected value to be of type ${N0(this.type)}, but found ${N0(H5(q))} instead.`)}throw Error()}eachChild(w){this.args.forEach(w)}outputDefined(){return this.args.every((w)=>w.outputDefined())}}let m9={"to-boolean":l0,"to-color":L3,"to-number":u1,"to-string":R0};class d0{constructor(w,f){this.type=w,this.args=f}static parse(w,f){if(w.length<2)return f.error("Expected at least one argument.");let q=w[0];if(!m9[q])throw Error(`Can't parse ${q} as it is not part of the known types`);if((q==="to-boolean"||q==="to-string")&&w.length!==2)return f.error("Expected one argument.");let v=m9[q],H=[];for(let M=1;M<w.length;M++){let A=f.parse(w[M],M,X0);if(!A)return null;H.push(A)}return new d0(v,H)}evaluate(w){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(w));case"color":{let f,q;for(let v of this.args){if(f=v.evaluate(w),q=null,f instanceof h0)return f;if(typeof f=="string"){let H=w.parseColor(f);if(H)return H}else if(Array.isArray(f)&&(q=f.length<3||f.length>4?`Invalid rgba value ${JSON.stringify(f)}: expected an array containing either three or four numeric values.`:Pb(f[0],f[1],f[2],f[3]),!q))return new h0(f[0]/255,f[1]/255,f[2]/255,f[3])}throw new x5(q||`Could not parse color from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"padding":{let f;for(let q of this.args){f=q.evaluate(w);let v=z2.parse(f);if(v)return v}throw new x5(`Could not parse padding from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"numberArray":{let f;for(let q of this.args){f=q.evaluate(w);let v=y2.parse(f);if(v)return v}throw new x5(`Could not parse numberArray from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"colorArray":{let f;for(let q of this.args){f=q.evaluate(w);let v=p5.parse(f);if(v)return v}throw new x5(`Could not parse colorArray from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"variableAnchorOffsetCollection":{let f;for(let q of this.args){f=q.evaluate(w);let v=Q2.parse(f);if(v)return v}throw new x5(`Could not parse variableAnchorOffsetCollection from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"number":{let f=null;for(let q of this.args){if(f=q.evaluate(w),f===null)return 0;let v=Number(f);if(!isNaN(v))return v}throw new x5(`Could not convert ${JSON.stringify(f)} to number.`)}case"formatted":return X2.fromString(t0(this.args[0].evaluate(w)));case"resolvedImage":return V2.fromString(t0(this.args[0].evaluate(w)));case"projectionDefinition":return this.args[0].evaluate(w);default:return t0(this.args[0].evaluate(w))}}eachChild(w){this.args.forEach(w)}outputDefined(){return this.args.every((w)=>w.outputDefined())}}let Eb=["Unknown","Point","LineString","Polygon"];class j3{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Eb[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(w){let f=this._parseColorCache.get(w);return f||(f=h0.parse(w),this._parseColorCache.set(w,f)),f}}class U6{constructor(w,f,q=[],v,H=new T2,M=[]){this.registry=w,this.path=q,this.key=q.map((A)=>`[${A}]`).join(""),this.scope=H,this.errors=M,this.expectedType=v,this._isConstant=f}parse(w,f,q,v,H={}){return f?this.concat(f,q,v)._parse(w,H):this._parse(w,H)}_parse(w,f){function q(v,H,M){return M==="assert"?new H0(H,[v]):M==="coerce"?new d0(H,[v]):v}if(w!==null&&typeof w!="string"&&typeof w!="boolean"&&typeof w!="number"||(w=["literal",w]),Array.isArray(w)){if(w.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let v=w[0];if(typeof v!="string")return this.error(`Expression name must be a string, but found ${typeof v} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let H=this.registry[v];if(H){let M=H.parse(w,this);if(!M)return null;if(this.expectedType){let A=this.expectedType,Q=M.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||Q.kind!=="value"){if(A.kind==="projectionDefinition"&&["string","array"].includes(Q.kind)||["color","formatted","resolvedImage"].includes(A.kind)&&["value","string"].includes(Q.kind)||["padding","numberArray"].includes(A.kind)&&["value","number","array"].includes(Q.kind)||A.kind==="colorArray"&&["value","string","array"].includes(Q.kind)||A.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(Q.kind))M=q(M,A,f.typeAnnotation||"coerce");else if(this.checkSubtype(A,Q))return null}else M=q(M,A,f.typeAnnotation||"assert")}if(!(M instanceof D4)&&M.type.kind!=="resolvedImage"&&this._isConstant(M)){let A=new j3;try{M=new D4(M.type,M.evaluate(A))}catch(Q){return this.error(Q.message),null}}return M}return this.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(w===void 0?"'undefined' value invalid. Use null instead.":typeof w=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof w} instead.`)}concat(w,f,q){let v=typeof w=="number"?this.path.concat(w):this.path,H=q?this.scope.concat(q):this.scope;return new U6(this.registry,this._isConstant,v,f||null,H,this.errors)}error(w,...f){let q=`${this.key}${f.map((v)=>`[${v}]`).join("")}`;this.errors.push(new V5(q,w))}checkSubtype(w,f){let q=X7(w,f);return q&&this.error(q),q}}class L7{constructor(w,f){this.type=f.type,this.bindings=[].concat(w),this.result=f}evaluate(w){return this.result.evaluate(w)}eachChild(w){for(let f of this.bindings)w(f[1]);w(this.result)}static parse(w,f){if(w.length<4)return f.error(`Expected at least 3 arguments, but found ${w.length-1} instead.`);let q=[];for(let H=1;H<w.length-1;H+=2){let M=w[H];if(typeof M!="string")return f.error(`Expected string, but found ${typeof M} instead.`,H);if(/[^a-zA-Z0-9_]/.test(M))return f.error("Variable names must contain only alphanumeric characters or '_'.",H);let A=f.parse(w[H+1],H+1);if(!A)return null;q.push([M,A])}let v=f.parse(w[w.length-1],w.length-1,f.expectedType,q);return v?new L7(q,v):null}outputDefined(){return this.result.outputDefined()}}class K8{constructor(w,f){this.type=f.type,this.name=w,this.boundExpression=f}static parse(w,f){if(w.length!==2||typeof w[1]!="string")return f.error("'var' expression requires exactly one string literal argument.");let q=w[1];return f.scope.has(q)?new K8(q,f.scope.get(q)):f.error(`Unknown variable "${q}". Make sure "${q}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(w){return this.boundExpression.evaluate(w)}eachChild(){}outputDefined(){return!1}}class l8{constructor(w,f,q){this.type=w,this.index=f,this.input=q}static parse(w,f){if(w.length!==3)return f.error(`Expected 2 arguments, but found ${w.length-1} instead.`);let q=f.parse(w[1],1,u1),v=f.parse(w[2],2,$2(f.expectedType||X0));return q&&v?new l8(v.type.itemType,q,v):null}evaluate(w){let f=this.index.evaluate(w),q=this.input.evaluate(w);if(f<0)throw new x5(`Array index out of bounds: ${f} < 0.`);if(f>=q.length)throw new x5(`Array index out of bounds: ${f} > ${q.length-1}.`);if(f!==Math.floor(f))throw new x5(`Array index must be an integer, but found ${f} instead.`);return q[f]}eachChild(w){w(this.index),w(this.input)}outputDefined(){return!1}}class C8{constructor(w,f){this.type=l0,this.needle=w,this.haystack=f}static parse(w,f){if(w.length!==3)return f.error(`Expected 2 arguments, but found ${w.length-1} instead.`);let q=f.parse(w[1],1,X0),v=f.parse(w[2],2,X0);return q&&v?a4(q.type,[l0,R0,u1,b3,X0])?new C8(q,v):f.error(`Expected first argument to be of type boolean, string, number or null, but found ${N0(q.type)} instead`):null}evaluate(w){let f=this.needle.evaluate(w),q=this.haystack.evaluate(w);if(!q)return!1;if(!l4(f,["boolean","string","number","null"]))throw new x5(`Expected first argument to be of type boolean, string, number or null, but found ${N0(H5(f))} instead.`);if(!l4(q,["string","array"]))throw new x5(`Expected second argument to be of type array or string, but found ${N0(H5(q))} instead.`);return q.indexOf(f)>=0}eachChild(w){w(this.needle),w(this.haystack)}outputDefined(){return!0}}class _9{constructor(w,f,q){this.type=u1,this.needle=w,this.haystack=f,this.fromIndex=q}static parse(w,f){if(w.length<=2||w.length>=5)return f.error(`Expected 2 or 3 arguments, but found ${w.length-1} instead.`);let q=f.parse(w[1],1,X0),v=f.parse(w[2],2,X0);if(!q||!v)return null;if(!a4(q.type,[l0,R0,u1,b3,X0]))return f.error(`Expected first argument to be of type boolean, string, number or null, but found ${N0(q.type)} instead`);if(w.length===4){let H=f.parse(w[3],3,u1);return H?new _9(q,v,H):null}return new _9(q,v)}evaluate(w){let f=this.needle.evaluate(w),q=this.haystack.evaluate(w);if(!l4(f,["boolean","string","number","null"]))throw new x5(`Expected first argument to be of type boolean, string, number or null, but found ${N0(H5(f))} instead.`);let v;if(this.fromIndex&&(v=this.fromIndex.evaluate(w)),l4(q,["string"])){let H=q.indexOf(f,v);return H===-1?-1:[...q.slice(0,H)].length}if(l4(q,["array"]))return q.indexOf(f,v);throw new x5(`Expected second argument to be of type array or string, but found ${N0(H5(q))} instead.`)}eachChild(w){w(this.needle),w(this.haystack),this.fromIndex&&w(this.fromIndex)}outputDefined(){return!1}}class D8{constructor(w,f,q,v,H,M){this.inputType=w,this.type=f,this.input=q,this.cases=v,this.outputs=H,this.otherwise=M}static parse(w,f){if(w.length<5)return f.error(`Expected at least 4 arguments, but found only ${w.length-1}.`);if(w.length%2!=1)return f.error("Expected an even number of arguments.");let q,v;f.expectedType&&f.expectedType.kind!=="value"&&(v=f.expectedType);let H={},M=[];for(let W=2;W<w.length-1;W+=2){let h=w[W],K=w[W+1];Array.isArray(h)||(h=[h]);let D=f.concat(W);if(h.length===0)return D.error("Expected at least one branch label.");for(let R of h){if(typeof R!="number"&&typeof R!="string")return D.error("Branch labels must be numbers or strings.");if(typeof R=="number"&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof R=="number"&&Math.floor(R)!==R)return D.error("Numeric branch labels must be integer values.");if(q){if(D.checkSubtype(q,H5(R)))return null}else q=H5(R);if(H[String(R)]!==void 0)return D.error("Branch labels must be unique.");H[String(R)]=M.length}let $=f.parse(K,W,v);if(!$)return null;v=v||$.type,M.push($)}let A=f.parse(w[1],1,X0);if(!A)return null;let Q=f.parse(w[w.length-1],w.length-1,v);return Q?A.type.kind!=="value"&&f.concat(1).checkSubtype(q,A.type)?null:new D8(q,v,A,H,M,Q):null}evaluate(w){let f=this.input.evaluate(w);return(H5(f)===this.inputType&&this.outputs[this.cases[f]]||this.otherwise).evaluate(w)}eachChild(w){w(this.input),this.outputs.forEach(w),w(this.otherwise)}outputDefined(){return this.outputs.every((w)=>w.outputDefined())&&this.otherwise.outputDefined()}}class P9{constructor(w,f,q){this.type=w,this.branches=f,this.otherwise=q}static parse(w,f){if(w.length<4)return f.error(`Expected at least 3 arguments, but found only ${w.length-1}.`);if(w.length%2!=0)return f.error("Expected an odd number of arguments.");let q;f.expectedType&&f.expectedType.kind!=="value"&&(q=f.expectedType);let v=[];for(let M=1;M<w.length-1;M+=2){let A=f.parse(w[M],M,l0);if(!A)return null;let Q=f.parse(w[M+1],M+1,q);if(!Q)return null;v.push([A,Q]),q=q||Q.type}let H=f.parse(w[w.length-1],w.length-1,q);if(!H)return null;if(!q)throw Error("Can't infer output type");return new P9(q,v,H)}evaluate(w){for(let[f,q]of this.branches)if(f.evaluate(w))return q.evaluate(w);return this.otherwise.evaluate(w)}eachChild(w){for(let[f,q]of this.branches)w(f),w(q);w(this.otherwise)}outputDefined(){return this.branches.every(([w,f])=>f.outputDefined())&&this.otherwise.outputDefined()}}class m3{constructor(w,f,q,v){this.type=w,this.input=f,this.beginIndex=q,this.endIndex=v}static parse(w,f){if(w.length<=2||w.length>=5)return f.error(`Expected 2 or 3 arguments, but found ${w.length-1} instead.`);let q=f.parse(w[1],1,X0),v=f.parse(w[2],2,u1);if(!q||!v)return null;if(!a4(q.type,[$2(X0),R0,X0]))return f.error(`Expected first argument to be of type array or string, but found ${N0(q.type)} instead`);if(w.length===4){let H=f.parse(w[3],3,u1);return H?new m3(q.type,q,v,H):null}return new m3(q.type,q,v)}evaluate(w){let f=this.input.evaluate(w),q=this.beginIndex.evaluate(w),v;if(this.endIndex&&(v=this.endIndex.evaluate(w)),l4(f,["string"]))return[...f].slice(q,v).join("");if(l4(f,["array"]))return f.slice(q,v);throw new x5(`Expected first argument to be of type array or string, but found ${N0(H5(f))} instead.`)}eachChild(w){w(this.input),w(this.beginIndex),this.endIndex&&w(this.endIndex)}outputDefined(){return!1}}function t5(w,f){let q=w.length-1,v,H,M=0,A=q,Q=0;for(;M<=A;)if(Q=Math.floor((M+A)/2),v=w[Q],H=w[Q+1],v<=f){if(Q===q||f<H)return Q;M=Q+1}else{if(!(v>f))throw new x5("Input is not a number.");A=Q-1}return 0}class o4{constructor(w,f,q){this.type=w,this.input=f,this.labels=[],this.outputs=[];for(let[v,H]of q)this.labels.push(v),this.outputs.push(H)}static parse(w,f){if(w.length-1<4)return f.error(`Expected at least 4 arguments, but found only ${w.length-1}.`);if((w.length-1)%2!=0)return f.error("Expected an even number of arguments.");let q=f.parse(w[1],1,u1);if(!q)return null;let v=[],H=null;f.expectedType&&f.expectedType.kind!=="value"&&(H=f.expectedType);for(let M=1;M<w.length;M+=2){let A=M===1?-1/0:w[M],Q=w[M+1],W=M,h=M+1;if(typeof A!="number")return f.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',W);if(v.length&&v[v.length-1][0]>=A)return f.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',W);let K=f.parse(Q,h,H);if(!K)return null;H=H||K.type,v.push([A,K])}return new o4(H,q,v)}evaluate(w){let f=this.labels,q=this.outputs;if(f.length===1)return q[0].evaluate(w);let v=this.input.evaluate(w);if(v<=f[0])return q[0].evaluate(w);let H=f.length;return v>=f[H-1]?q[H-1].evaluate(w):q[t5(f,v)].evaluate(w)}eachChild(w){w(this.input);for(let f of this.outputs)w(f)}outputDefined(){return this.outputs.every((w)=>w.outputDefined())}}function Bz(w){return w&&w.__esModule&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w}var B6,e5,Az=function(){if(e5)return B6;function w(f,q,v,H){this.cx=3*f,this.bx=3*(v-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*q,this.by=3*(H-q)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=q,this.p2x=v,this.p2y=H}return e5=1,B6=w,w.prototype={sampleCurveX:function(f){return((this.ax*f+this.bx)*f+this.cx)*f},sampleCurveY:function(f){return((this.ay*f+this.by)*f+this.cy)*f},sampleCurveDerivativeX:function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},solveCurveX:function(f,q){if(q===void 0&&(q=0.000001),f<0)return 0;if(f>1)return 1;for(var v=f,H=0;H<8;H++){var M=this.sampleCurveX(v)-f;if(Math.abs(M)<q)return v;var A=this.sampleCurveDerivativeX(v);if(Math.abs(A)<0.000001)break;v-=M/A}var Q=0,W=1;for(v=f,H=0;H<20&&(M=this.sampleCurveX(v),!(Math.abs(M-f)<q));H++)f>M?Q=v:W=v,v=0.5*(W-Q)+Q;return v},solve:function(f,q){return this.sampleCurveY(this.solveCurveX(f,q))}},B6}(),ub=Bz(Az);class j2{constructor(w,f,q,v,H){this.type=w,this.operator=f,this.interpolation=q,this.input=v,this.labels=[],this.outputs=[];for(let[M,A]of H)this.labels.push(M),this.outputs.push(A)}static interpolationFactor(w,f,q,v){let H=0;if(w.name==="exponential")H=E9(f,w.base,q,v);else if(w.name==="linear")H=E9(f,1,q,v);else if(w.name==="cubic-bezier"){let M=w.controlPoints;H=new ub(M[0],M[1],M[2],M[3]).solve(E9(f,1,q,v))}return H}static parse(w,f){let[q,v,H,...M]=w;if(!Array.isArray(v)||v.length===0)return f.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){let W=v[1];if(typeof W!="number")return f.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:W}}else{if(v[0]!=="cubic-bezier")return f.error(`Unknown interpolation type ${String(v[0])}`,1,0);{let W=v.slice(1);if(W.length!==4||W.some((h)=>typeof h!="number"||h<0||h>1))return f.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:W}}}if(w.length-1<4)return f.error(`Expected at least 4 arguments, but found only ${w.length-1}.`);if((w.length-1)%2!=0)return f.error("Expected an even number of arguments.");if(H=f.parse(H,2,u1),!H)return null;let A=[],Q=null;q!=="interpolate-hcl"&&q!=="interpolate-lab"||f.expectedType==V8?f.expectedType&&f.expectedType.kind!=="value"&&(Q=f.expectedType):Q=L3;for(let W=0;W<M.length;W+=2){let h=M[W],K=M[W+1],D=W+3,$=W+4;if(typeof h!="number")return f.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(A.length&&A[A.length-1][0]>=h)return f.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);let R=f.parse(K,$,Q);if(!R)return null;Q=Q||R.type,A.push([h,R])}return C4(Q,u1)||C4(Q,Q8)||C4(Q,L3)||C4(Q,v6)||C4(Q,M7)||C4(Q,V8)||C4(Q,K4)||C4(Q,$2(u1))?new j2(Q,q,v,H,A):f.error(`Type ${N0(Q)} is not interpolatable.`)}evaluate(w){let f=this.labels,q=this.outputs;if(f.length===1)return q[0].evaluate(w);let v=this.input.evaluate(w);if(v<=f[0])return q[0].evaluate(w);let H=f.length;if(v>=f[H-1])return q[H-1].evaluate(w);let M=t5(f,v),A=j2.interpolationFactor(this.interpolation,v,f[M],f[M+1]),Q=q[M].evaluate(w),W=q[M+1].evaluate(w);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return K0(Q,W,A);case"color":return h0.interpolate(Q,W,A);case"padding":return z2.interpolate(Q,W,A);case"colorArray":return p5.interpolate(Q,W,A);case"numberArray":return y2.interpolate(Q,W,A);case"variableAnchorOffsetCollection":return Q2.interpolate(Q,W,A);case"array":return W3(Q,W,A);case"projectionDefinition":return g3.interpolate(Q,W,A)}case"interpolate-hcl":switch(this.type.kind){case"color":return h0.interpolate(Q,W,A,"hcl");case"colorArray":return p5.interpolate(Q,W,A,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return h0.interpolate(Q,W,A,"lab");case"colorArray":return p5.interpolate(Q,W,A,"lab")}}}eachChild(w){w(this.input);for(let f of this.outputs)w(f)}outputDefined(){return this.outputs.every((w)=>w.outputDefined())}}function E9(w,f,q,v){let H=v-q,M=w-q;return H===0?0:f===1?M/H:(Math.pow(f,M)-1)/(Math.pow(f,H)-1)}let m2={color:h0.interpolate,number:K0,padding:z2.interpolate,numberArray:y2.interpolate,colorArray:p5.interpolate,variableAnchorOffsetCollection:Q2.interpolate,array:W3};class W7{constructor(w,f){this.type=w,this.args=f}static parse(w,f){if(w.length<2)return f.error("Expected at least one argument.");let q=null,v=f.expectedType;v&&v.kind!=="value"&&(q=v);let H=[];for(let A of w.slice(1)){let Q=f.parse(A,1+H.length,q,void 0,{typeAnnotation:"omit"});if(!Q)return null;q=q||Q.type,H.push(Q)}if(!q)throw Error("No output type");let M=v&&H.some((A)=>X7(v,A.type));return new W7(M?X0:q,H)}evaluate(w){let f,q=null,v=0;for(let H of this.args)if(v++,q=H.evaluate(w),q&&q instanceof V2&&!q.available&&(f||(f=q.name),q=null,v===this.args.length&&(q=f)),q!==null)break;return q}eachChild(w){this.args.forEach(w)}outputDefined(){return this.args.every((w)=>w.outputDefined())}}function u9(w,f){return w==="=="||w==="!="?f.kind==="boolean"||f.kind==="string"||f.kind==="number"||f.kind==="null"||f.kind==="value":f.kind==="string"||f.kind==="number"||f.kind==="value"}function pb(w,f,q,v){return v.compare(f,q)===0}function h7(w,f,q){let v=w!=="=="&&w!=="!=";return class H{constructor(M,A,Q){this.type=l0,this.lhs=M,this.rhs=A,this.collator=Q,this.hasUntypedArgument=M.type.kind==="value"||A.type.kind==="value"}static parse(M,A){if(M.length!==3&&M.length!==4)return A.error("Expected two or three arguments.");let Q=M[0],W=A.parse(M[1],1,X0);if(!W)return null;if(!u9(Q,W.type))return A.concat(1).error(`"${Q}" comparisons are not supported for type '${N0(W.type)}'.`);let h=A.parse(M[2],2,X0);if(!h)return null;if(!u9(Q,h.type))return A.concat(2).error(`"${Q}" comparisons are not supported for type '${N0(h.type)}'.`);if(W.type.kind!==h.type.kind&&W.type.kind!=="value"&&h.type.kind!=="value")return A.error(`Cannot compare types '${N0(W.type)}' and '${N0(h.type)}'.`);v&&(W.type.kind==="value"&&h.type.kind!=="value"?W=new H0(h.type,[W]):W.type.kind!=="value"&&h.type.kind==="value"&&(h=new H0(W.type,[h])));let K=null;if(M.length===4){if(W.type.kind!=="string"&&h.type.kind!=="string"&&W.type.kind!=="value"&&h.type.kind!=="value")return A.error("Cannot use collator to compare non-string types.");if(K=A.parse(M[3],3,A7),!K)return null}return new H(W,h,K)}evaluate(M){let A=this.lhs.evaluate(M),Q=this.rhs.evaluate(M);if(v&&this.hasUntypedArgument){let W=H5(A),h=H5(Q);if(W.kind!==h.kind||W.kind!=="string"&&W.kind!=="number")throw new x5(`Expected arguments for "${w}" to be (string, string) or (number, number), but found (${W.kind}, ${h.kind}) instead.`)}if(this.collator&&!v&&this.hasUntypedArgument){let W=H5(A),h=H5(Q);if(W.kind!=="string"||h.kind!=="string")return f(M,A,Q)}return this.collator?q(M,A,Q,this.collator.evaluate(M)):f(M,A,Q)}eachChild(M){M(this.lhs),M(this.rhs),this.collator&&M(this.collator)}outputDefined(){return!0}}}let p9=h7("==",function(w,f,q){return f===q},pb),c9=h7("!=",function(w,f,q){return f!==q},function(w,f,q,v){return!pb(0,f,q,v)}),_3=h7("<",function(w,f,q){return f<q},function(w,f,q,v){return v.compare(f,q)<0}),cb=h7(">",function(w,f,q){return f>q},function(w,f,q,v){return v.compare(f,q)>0}),a9=h7("<=",function(w,f,q){return f<=q},function(w,f,q,v){return v.compare(f,q)<=0}),hZ=h7(">=",function(w,f,q){return f>=q},function(w,f,q,v){return v.compare(f,q)>=0});class F7{constructor(w,f,q){this.type=A7,this.locale=q,this.caseSensitive=w,this.diacriticSensitive=f}static parse(w,f){if(w.length!==2)return f.error("Expected one argument.");let q=w[1];if(typeof q!="object"||Array.isArray(q))return f.error("Collator options argument must be an object.");let v=f.parse(q["case-sensitive"]!==void 0&&q["case-sensitive"],1,l0);if(!v)return null;let H=f.parse(q["diacritic-sensitive"]!==void 0&&q["diacritic-sensitive"],1,l0);if(!H)return null;let M=null;return q.locale&&(M=f.parse(q.locale,1,R0),!M)?null:new F7(v,H,M)}evaluate(w){return new F8(this.caseSensitive.evaluate(w),this.diacriticSensitive.evaluate(w),this.locale?this.locale.evaluate(w):null)}eachChild(w){w(this.caseSensitive),w(this.diacriticSensitive),this.locale&&w(this.locale)}outputDefined(){return!1}}class ab{constructor(w,f,q,v,H){this.type=R0,this.number=w,this.locale=f,this.currency=q,this.minFractionDigits=v,this.maxFractionDigits=H}static parse(w,f){if(w.length!==3)return f.error("Expected two arguments.");let q=f.parse(w[1],1,u1);if(!q)return null;let v=w[2];if(typeof v!="object"||Array.isArray(v))return f.error("NumberFormat options argument must be an object.");let H=null;if(v.locale&&(H=f.parse(v.locale,1,R0),!H))return null;let M=null;if(v.currency&&(M=f.parse(v.currency,1,R0),!M))return null;let A=null;if(v["min-fraction-digits"]&&(A=f.parse(v["min-fraction-digits"],1,u1),!A))return null;let Q=null;return v["max-fraction-digits"]&&(Q=f.parse(v["max-fraction-digits"],1,u1),!Q)?null:new ab(q,H,M,A,Q)}evaluate(w){return new Intl.NumberFormat(this.locale?this.locale.evaluate(w):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(w):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(w):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(w):void 0}).format(this.number.evaluate(w))}eachChild(w){w(this.number),this.locale&&w(this.locale),this.currency&&w(this.currency),this.minFractionDigits&&w(this.minFractionDigits),this.maxFractionDigits&&w(this.maxFractionDigits)}outputDefined(){return!1}}class d8{constructor(w){this.type=k6,this.sections=w}static parse(w,f){if(w.length<2)return f.error("Expected at least one argument.");let q=w[1];if(!Array.isArray(q)&&typeof q=="object")return f.error("First argument must be an image or text section.");let v=[],H=!1;for(let M=1;M<=w.length-1;++M){let A=w[M];if(H&&typeof A=="object"&&!Array.isArray(A)){H=!1;let Q=null;if(A["font-scale"]&&(Q=f.parse(A["font-scale"],1,u1),!Q))return null;let W=null;if(A["text-font"]&&(W=f.parse(A["text-font"],1,$2(R0)),!W))return null;let h=null;if(A["text-color"]&&(h=f.parse(A["text-color"],1,L3),!h))return null;let K=null;if(A["vertical-align"]){if(typeof A["vertical-align"]=="string"&&!Hz.includes(A["vertical-align"]))return f.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${A["vertical-align"]}' instead.`);if(K=f.parse(A["vertical-align"],1,R0),!K)return null}let D=v[v.length-1];D.scale=Q,D.font=W,D.textColor=h,D.verticalAlign=K}else{let Q=f.parse(w[M],1,X0);if(!Q)return null;let W=Q.type.kind;if(W!=="string"&&W!=="value"&&W!=="null"&&W!=="resolvedImage")return f.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");H=!0,v.push({content:Q,scale:null,font:null,textColor:null,verticalAlign:null})}}return new d8(v)}evaluate(w){return new X2(this.sections.map((f)=>{let q=f.content.evaluate(w);return H5(q)===L8?new V7("",q,null,null,null,f.verticalAlign?f.verticalAlign.evaluate(w):null):new V7(t0(q),null,f.scale?f.scale.evaluate(w):null,f.font?f.font.evaluate(w).join(","):null,f.textColor?f.textColor.evaluate(w):null,f.verticalAlign?f.verticalAlign.evaluate(w):null)}))}eachChild(w){for(let f of this.sections)w(f.content),f.scale&&w(f.scale),f.font&&w(f.font),f.textColor&&w(f.textColor),f.verticalAlign&&w(f.verticalAlign)}outputDefined(){return!1}}class rb{constructor(w){this.type=L8,this.input=w}static parse(w,f){if(w.length!==2)return f.error("Expected two arguments.");let q=f.parse(w[1],1,R0);return q?new rb(q):f.error("No image name provided.")}evaluate(w){let f=this.input.evaluate(w),q=V2.fromString(f);return q&&w.availableImages&&(q.available=w.availableImages.indexOf(f)>-1),q}eachChild(w){w(this.input)}outputDefined(){return!1}}class ob{constructor(w){this.type=u1,this.input=w}static parse(w,f){if(w.length!==2)return f.error(`Expected 1 argument, but found ${w.length-1} instead.`);let q=f.parse(w[1],1);return q?q.type.kind!=="array"&&q.type.kind!=="string"&&q.type.kind!=="value"?f.error(`Expected argument of type string or array, but found ${N0(q.type)} instead.`):new ob(q):null}evaluate(w){let f=this.input.evaluate(w);if(typeof f=="string")return[...f].length;if(Array.isArray(f))return f.length;throw new x5(`Expected value to be of type string or array, but found ${N0(H5(f))} instead.`)}eachChild(w){w(this.input)}outputDefined(){return!1}}let k3=8192;function Mz(w,f){let q=(180+w[0])/360,v=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+w[1]*Math.PI/360)))/360,H=Math.pow(2,f.z);return[Math.round(q*H*k3),Math.round(v*H*k3)]}function r9(w,f){let q=Math.pow(2,f.z);return[(H=(w[0]/k3+f.x)/q,360*H-180),(v=(w[1]/k3+f.y)/q,360/Math.PI*Math.atan(Math.exp((180-360*v)*Math.PI/180))-90)];var v,H}function A6(w,f){w[0]=Math.min(w[0],f[0]),w[1]=Math.min(w[1],f[1]),w[2]=Math.max(w[2],f[0]),w[3]=Math.max(w[3],f[1])}function O8(w,f){return!(w[0]<=f[0]||w[2]>=f[2]||w[1]<=f[1]||w[3]>=f[3])}function Xz(w,f,q){let v=w[0]-f[0],H=w[1]-f[1],M=w[0]-q[0],A=w[1]-q[1];return v*A-M*H==0&&v*M<=0&&H*A<=0}function o9(w,f,q,v){return(H=[v[0]-q[0],v[1]-q[1]])[0]*(M=[f[0]-w[0],f[1]-w[1]])[1]-H[1]*M[0]!=0&&!(!nb(w,f,q,v)||!nb(q,v,w,f));var H,M}function FZ(w,f,q){for(let v of q)for(let H=0;H<v.length-1;++H)if(o9(w,f,v[H],v[H+1]))return!0;return!1}function M6(w,f,q=!1){let v=!1;for(let Q of f)for(let W=0;W<Q.length-1;W++){if(Xz(w,Q[W],Q[W+1]))return q;(M=Q[W])[1]>(H=w)[1]!=(A=Q[W+1])[1]>H[1]&&H[0]<(A[0]-M[0])*(H[1]-M[1])/(A[1]-M[1])+M[0]&&(v=!v)}var H,M,A;return v}function KZ(w,f){for(let q of f)if(M6(w,q))return!0;return!1}function Qz(w,f){for(let q of w)if(!M6(q,f))return!1;for(let q=0;q<w.length-1;++q)if(FZ(w[q],w[q+1],f))return!1;return!0}function Vz(w,f){for(let q of f)if(Qz(w,q))return!0;return!1}function nb(w,f,q,v){let H=v[0]-q[0],M=v[1]-q[1],A=(w[0]-q[0])*M-H*(w[1]-q[1]),Q=(f[0]-q[0])*M-H*(f[1]-q[1]);return A>0&&Q<0||A<0&&Q>0}function n9(w,f,q){let v=[];for(let H=0;H<w.length;H++){let M=[];for(let A=0;A<w[H].length;A++){let Q=Mz(w[H][A],q);A6(f,Q),M.push(Q)}v.push(M)}return v}function Lz(w,f,q){let v=[];for(let H=0;H<w.length;H++){let M=n9(w[H],f,q);v.push(M)}return v}function Wz(w,f,q,v){if(w[0]<q[0]||w[0]>q[2]){let H=0.5*v,M=w[0]-q[0]>H?-v:q[0]-w[0]>H?v:0;M===0&&(M=w[0]-q[2]>H?-v:q[2]-w[0]>H?v:0),w[0]+=M}A6(f,w)}function hz(w,f,q,v){let H=Math.pow(2,v.z)*k3,M=[v.x*k3,v.y*k3],A=[];for(let Q of w)for(let W of Q){let h=[W.x+M[0],W.y+M[1]];Wz(h,f,q,H),A.push(h)}return A}function Fz(w,f,q,v){let H=Math.pow(2,v.z)*k3,M=[v.x*k3,v.y*k3],A=[];for(let W of w){let h=[];for(let K of W){let D=[K.x+M[0],K.y+M[1]];A6(f,D),h.push(D)}A.push(h)}if(f[2]-f[0]<=H/2){(Q=f)[0]=Q[1]=1/0,Q[2]=Q[3]=-1/0;for(let W of A)for(let h of W)Wz(h,f,q,H)}var Q;return A}class Z4{constructor(w,f){this.type=l0,this.geojson=w,this.geometries=f}static parse(w,f){if(w.length!==2)return f.error(`'within' expression requires exactly one argument, but found ${w.length-1} instead.`);if(H6(w[1])){let q=w[1];if(q.type==="FeatureCollection"){let v=[];for(let H of q.features){let{type:M,coordinates:A}=H.geometry;M==="Polygon"&&v.push(A),M==="MultiPolygon"&&v.push(...A)}if(v.length)return new Z4(q,{type:"MultiPolygon",coordinates:v})}else if(q.type==="Feature"){let v=q.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Z4(q,q.geometry)}else if(q.type==="Polygon"||q.type==="MultiPolygon")return new Z4(q,q)}return f.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(w){if(w.geometry()!=null&&w.canonicalID()!=null){if(w.geometryType()==="Point")return function(f,q){let v=[1/0,1/0,-1/0,-1/0],H=[1/0,1/0,-1/0,-1/0],M=f.canonicalID();if(q.type==="Polygon"){let A=n9(q.coordinates,H,M),Q=hz(f.geometry(),v,H,M);if(!O8(v,H))return!1;for(let W of Q)if(!M6(W,A))return!1}if(q.type==="MultiPolygon"){let A=Lz(q.coordinates,H,M),Q=hz(f.geometry(),v,H,M);if(!O8(v,H))return!1;for(let W of Q)if(!KZ(W,A))return!1}return!0}(w,this.geometries);if(w.geometryType()==="LineString")return function(f,q){let v=[1/0,1/0,-1/0,-1/0],H=[1/0,1/0,-1/0,-1/0],M=f.canonicalID();if(q.type==="Polygon"){let A=n9(q.coordinates,H,M),Q=Fz(f.geometry(),v,H,M);if(!O8(v,H))return!1;for(let W of Q)if(!Qz(W,A))return!1}if(q.type==="MultiPolygon"){let A=Lz(q.coordinates,H,M),Q=Fz(f.geometry(),v,H,M);if(!O8(v,H))return!1;for(let W of Q)if(!Vz(W,A))return!1}return!0}(w,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Kz=class{constructor(w=[],f=(q,v)=>q<v?-1:q>v?1:0){if(this.data=w,this.length=this.data.length,this.compare=f,this.length>0)for(let q=(this.length>>1)-1;q>=0;q--)this._down(q)}push(w){this.data.push(w),this._up(this.length++)}pop(){if(this.length===0)return;let w=this.data[0],f=this.data.pop();return--this.length>0&&(this.data[0]=f,this._down(0)),w}peek(){return this.data[0]}_up(w){let{data:f,compare:q}=this,v=f[w];for(;w>0;){let H=w-1>>1,M=f[H];if(q(v,M)>=0)break;f[w]=M,w=H}f[w]=v}_down(w){let{data:f,compare:q}=this,v=this.length>>1,H=f[w];for(;w<v;){let M=1+(w<<1),A=M+1;if(A<this.length&&q(f[A],f[M])<0&&(M=A),q(f[M],H)>=0)break;f[w]=f[M],w=M}f[w]=H}};function lz(w,f,q=0,v=w.length-1,H=lZ){for(;v>q;){if(v-q>600){let W=v-q+1,h=f-q+1,K=Math.log(W),D=0.5*Math.exp(2*K/3),$=0.5*Math.sqrt(K*D*(W-D)/W)*(h-W/2<0?-1:1);lz(w,f,Math.max(q,Math.floor(f-h*D/W+$)),Math.min(v,Math.floor(f+(W-h)*D/W+$)),H)}let M=w[f],A=q,Q=v;for(y8(w,q,f),H(w[v],M)>0&&y8(w,q,v);A<Q;){for(y8(w,A,Q),A++,Q--;H(w[A],M)<0;)A++;for(;H(w[Q],M)>0;)Q--}H(w[q],M)===0?y8(w,q,Q):(Q++,y8(w,Q,v)),Q<=f&&(q=Q+1),f<=Q&&(v=Q-1)}}function y8(w,f,q){let v=w[f];w[f]=w[q],w[q]=v}function lZ(w,f){return w<f?-1:w>f?1:0}function X6(w,f){if(w.length<=1)return[w];let q=[],v,H;for(let M of w){let A=CZ(M);A!==0&&(M.area=Math.abs(A),H===void 0&&(H=A<0),H===A<0?(v&&q.push(v),v=[M]):v.push(M))}if(v&&q.push(v),f>1)for(let M=0;M<q.length;M++)q[M].length<=f||(lz(q[M],f,1,q[M].length-1,Cz),q[M]=q[M].slice(0,f));return q}function Cz(w,f){return f.area-w.area}function CZ(w){let f=0;for(let q,v,H=0,M=w.length,A=M-1;H<M;A=H++)q=w[H],v=w[A],f+=(v.x-q.x)*(q.y+v.y);return f}let Dz=0.0033528106647474805,sb=Dz*(2-Dz),ib=Math.PI/180;class s9{constructor(w){let f=6378.137*ib*1000,q=Math.cos(w*ib),v=1/(1-sb*(1-q*q)),H=Math.sqrt(v);this.kx=f*H*q,this.ky=f*H*v*(1-sb)}distance(w,f){let q=this.wrap(w[0]-f[0])*this.kx,v=(w[1]-f[1])*this.ky;return Math.sqrt(q*q+v*v)}pointOnLine(w,f){let q,v,H,M,A=1/0;for(let Q=0;Q<w.length-1;Q++){let W=w[Q][0],h=w[Q][1],K=this.wrap(w[Q+1][0]-W)*this.kx,D=(w[Q+1][1]-h)*this.ky,$=0;K===0&&D===0||($=(this.wrap(f[0]-W)*this.kx*K+(f[1]-h)*this.ky*D)/(K*K+D*D),$>1?(W=w[Q+1][0],h=w[Q+1][1]):$>0&&(W+=K/this.kx*$,h+=D/this.ky*$)),K=this.wrap(f[0]-W)*this.kx,D=(f[1]-h)*this.ky;let R=K*K+D*D;R<A&&(A=R,q=W,v=h,H=Q,M=$)}return{point:[q,v],index:H,t:Math.max(0,Math.min(1,M))}}wrap(w){for(;w<-180;)w+=360;for(;w>180;)w-=360;return w}}function dz(w,f){return f[0]-w[0]}function i9(w){return w[1]-w[0]+1}function Y4(w,f){return w[1]>=w[0]&&w[1]<f}function tb(w,f){if(w[0]>w[1])return[null,null];let q=i9(w);if(f){if(q===2)return[w,null];let H=Math.floor(q/2);return[[w[0],w[0]+H],[w[0]+H,w[1]]]}if(q===1)return[w,null];let v=Math.floor(q/2)-1;return[[w[0],w[0]+v],[w[0]+v+1,w[1]]]}function t9(w,f){if(!Y4(f,w.length))return[1/0,1/0,-1/0,-1/0];let q=[1/0,1/0,-1/0,-1/0];for(let v=f[0];v<=f[1];++v)A6(q,w[v]);return q}function eb(w){let f=[1/0,1/0,-1/0,-1/0];for(let q of w)for(let v of q)A6(f,v);return f}function wg(w){return w[0]!==-1/0&&w[1]!==-1/0&&w[2]!==1/0&&w[3]!==1/0}function E0(w,f,q){if(!wg(w)||!wg(f))return NaN;let v=0,H=0;return w[2]<f[0]&&(v=f[0]-w[2]),w[0]>f[2]&&(v=w[0]-f[2]),w[1]>f[3]&&(H=w[1]-f[3]),w[3]<f[1]&&(H=f[1]-w[3]),q.distance([0,0],[v,H])}function n4(w,f,q){let v=q.pointOnLine(f,w);return q.distance(w,v.point)}function e9(w,f,q,v,H){let M=Math.min(n4(w,[q,v],H),n4(f,[q,v],H)),A=Math.min(n4(q,[w,f],H),n4(v,[w,f],H));return Math.min(M,A)}function Oz(w,f,q,v,H){if(!Y4(f,w.length)||!Y4(v,q.length))return 1/0;let M=1/0;for(let A=f[0];A<f[1];++A){let Q=w[A],W=w[A+1];for(let h=v[0];h<v[1];++h){let K=q[h],D=q[h+1];if(o9(Q,W,K,D))return 0;M=Math.min(M,e9(Q,W,K,D,H))}}return M}function yz(w,f,q,v,H){if(!Y4(f,w.length)||!Y4(v,q.length))return NaN;let M=1/0;for(let A=f[0];A<=f[1];++A)for(let Q=v[0];Q<=v[1];++Q)if(M=Math.min(M,H.distance(w[A],q[Q])),M===0)return M;return M}function Rz(w,f,q){if(M6(w,f,!0))return 0;let v=1/0;for(let H of f){let M=H[0],A=H[H.length-1];if(M!==A&&(v=Math.min(v,n4(w,[A,M],q)),v===0))return v;let Q=q.pointOnLine(H,w);if(v=Math.min(v,q.distance(w,Q.point)),v===0)return v}return v}function Nz(w,f,q,v){if(!Y4(f,w.length))return NaN;for(let M=f[0];M<=f[1];++M)if(M6(w[M],q,!0))return 0;let H=1/0;for(let M=f[0];M<f[1];++M){let A=w[M],Q=w[M+1];for(let W of q)for(let h=0,K=W.length,D=K-1;h<K;D=h++){let $=W[D],R=W[h];if(o9(A,Q,$,R))return 0;H=Math.min(H,e9(A,Q,$,R,v))}}return H}function bg(w,f){for(let q of w)for(let v of q)if(M6(v,f,!0))return!0;return!1}function Iz(w,f,q,v=1/0){let H=eb(w),M=eb(f);if(v!==1/0&&E0(H,M,q)>=v)return v;if(O8(H,M)){if(bg(w,f))return 0}else if(bg(f,w))return 0;let A=1/0;for(let Q of w)for(let W=0,h=Q.length,K=h-1;W<h;K=W++){let D=Q[K],$=Q[W];for(let R of f)for(let _=0,j=R.length,o=j-1;_<j;o=_++){let t=R[o],U1=R[_];if(o9(D,$,t,U1))return 0;A=Math.min(A,e9(D,$,t,U1,q))}}return A}function gg(w,f,q,v,H,M){if(!M)return;let A=E0(t9(v,M),H,q);A<f&&w.push([A,M,[0,0]])}function R8(w,f,q,v,H,M,A){if(!M||!A)return;let Q=E0(t9(v,M),t9(H,A),q);Q<f&&w.push([Q,M,A])}function N8(w,f,q,v,H=1/0){let M=Math.min(v.distance(w[0],q[0][0]),H);if(M===0)return M;let A=new Kz([[0,[0,w.length-1],[0,0]]],dz),Q=eb(q);for(;A.length>0;){let W=A.pop();if(W[0]>=M)continue;let h=W[1],K=f?50:100;if(i9(h)<=K){if(!Y4(h,w.length))return NaN;if(f){let D=Nz(w,h,q,v);if(isNaN(D)||D===0)return D;M=Math.min(M,D)}else for(let D=h[0];D<=h[1];++D){let $=Rz(w[D],q,v);if(M=Math.min(M,$),M===0)return 0}}else{let D=tb(h,f);gg(A,M,v,w,Q,D[0]),gg(A,M,v,w,Q,D[1])}}return M}function I8(w,f,q,v,H,M=1/0){let A=Math.min(M,H.distance(w[0],q[0]));if(A===0)return A;let Q=new Kz([[0,[0,w.length-1],[0,q.length-1]]],dz);for(;Q.length>0;){let W=Q.pop();if(W[0]>=A)continue;let h=W[1],K=W[2],D=f?50:100,$=v?50:100;if(i9(h)<=D&&i9(K)<=$){if(!Y4(h,w.length)&&Y4(K,q.length))return NaN;let R;if(f&&v)R=Oz(w,h,q,K,H),A=Math.min(A,R);else if(f&&!v){let _=w.slice(h[0],h[1]+1);for(let j=K[0];j<=K[1];++j)if(R=n4(q[j],_,H),A=Math.min(A,R),A===0)return A}else if(!f&&v){let _=q.slice(K[0],K[1]+1);for(let j=h[0];j<=h[1];++j)if(R=n4(w[j],_,H),A=Math.min(A,R),A===0)return A}else R=yz(w,h,q,K,H),A=Math.min(A,R)}else{let R=tb(h,f),_=tb(K,v);R8(Q,A,H,w,q,R[0],_[0]),R8(Q,A,H,w,q,R[0],_[1]),R8(Q,A,H,w,q,R[1],_[0]),R8(Q,A,H,w,q,R[1],_[1])}}return A}function ww(w){return w.type==="MultiPolygon"?w.coordinates.map((f)=>({type:"Polygon",coordinates:f})):w.type==="MultiLineString"?w.coordinates.map((f)=>({type:"LineString",coordinates:f})):w.type==="MultiPoint"?w.coordinates.map((f)=>({type:"Point",coordinates:f})):[w]}class s4{constructor(w,f){this.type=u1,this.geojson=w,this.geometries=f}static parse(w,f){if(w.length!==2)return f.error(`'distance' expression requires exactly one argument, but found ${w.length-1} instead.`);if(H6(w[1])){let q=w[1];if(q.type==="FeatureCollection")return new s4(q,q.features.map((v)=>ww(v.geometry)).flat());if(q.type==="Feature")return new s4(q,ww(q.geometry));if("type"in q&&"coordinates"in q)return new s4(q,ww(q))}return f.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(w){if(w.geometry()!=null&&w.canonicalID()!=null){if(w.geometryType()==="Point")return function(f,q){let v=f.geometry(),H=v.flat().map((Q)=>r9([Q.x,Q.y],f.canonical));if(v.length===0)return NaN;let M=new s9(H[0][1]),A=1/0;for(let Q of q){switch(Q.type){case"Point":A=Math.min(A,I8(H,!1,[Q.coordinates],!1,M,A));break;case"LineString":A=Math.min(A,I8(H,!1,Q.coordinates,!0,M,A));break;case"Polygon":A=Math.min(A,N8(H,!1,Q.coordinates,M,A))}if(A===0)return A}return A}(w,this.geometries);if(w.geometryType()==="LineString")return function(f,q){let v=f.geometry(),H=v.flat().map((Q)=>r9([Q.x,Q.y],f.canonical));if(v.length===0)return NaN;let M=new s9(H[0][1]),A=1/0;for(let Q of q){switch(Q.type){case"Point":A=Math.min(A,I8(H,!0,[Q.coordinates],!1,M,A));break;case"LineString":A=Math.min(A,I8(H,!0,Q.coordinates,!0,M,A));break;case"Polygon":A=Math.min(A,N8(H,!0,Q.coordinates,M,A))}if(A===0)return A}return A}(w,this.geometries);if(w.geometryType()==="Polygon")return function(f,q){let v=f.geometry();if(v.length===0||v[0].length===0)return NaN;let H=X6(v,0).map((Q)=>Q.map((W)=>W.map((h)=>r9([h.x,h.y],f.canonical)))),M=new s9(H[0][0][0][1]),A=1/0;for(let Q of q)for(let W of H){switch(Q.type){case"Point":A=Math.min(A,N8([Q.coordinates],!1,W,M,A));break;case"LineString":A=Math.min(A,N8(Q.coordinates,!0,W,M,A));break;case"Polygon":A=Math.min(A,Iz(W,Q.coordinates,M,A))}if(A===0)return A}return A}(w,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Q6{constructor(w){this.type=X0,this.key=w}static parse(w,f){if(w.length!==2)return f.error(`Expected 1 argument, but found ${w.length-1} instead.`);let q=w[1];return q==null?f.error("Global state property must be defined."):typeof q!="string"?f.error(`Global state property must be string, but found ${typeof w[1]} instead.`):new Q6(q)}evaluate(w){var f;let q=(f=w.globals)===null||f===void 0?void 0:f.globalState;return q&&Object.keys(q).length!==0?G6(q,this.key):null}eachChild(){}outputDefined(){return!1}}let K7={"==":p9,"!=":c9,">":cb,"<":_3,">=":hZ,"<=":a9,array:H0,at:l8,boolean:H0,case:P9,coalesce:W7,collator:F7,format:d8,image:rb,in:C8,"index-of":_9,interpolate:j2,"interpolate-hcl":j2,"interpolate-lab":j2,length:ob,let:L7,literal:D4,match:D8,number:H0,"number-format":ab,object:H0,slice:m3,step:o4,string:H0,"to-boolean":d0,"to-color":d0,"to-number":d0,"to-string":d0,var:K8,within:Z4,distance:s4,"global-state":Q6};class v3{constructor(w,f,q,v){this.name=w,this.type=f,this._evaluate=q,this.args=v}evaluate(w){return this._evaluate(w,this.args)}eachChild(w){this.args.forEach(w)}outputDefined(){return!1}static parse(w,f){let q=w[0],v=v3.definitions[q];if(!v)return f.error(`Unknown expression "${q}". If you wanted a literal array, use ["literal", [...]].`,0);let H=Array.isArray(v)?v[0]:v.type,M=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,A=M.filter(([W])=>!Array.isArray(W)||W.length===w.length-1),Q=null;for(let[W,h]of A){Q=new U6(f.registry,S8,f.path,null,f.scope);let K=[],D=!1;for(let $=1;$<w.length;$++){let R=w[$],_=Array.isArray(W)?W[$-1]:W.type,j=Q.parse(R,1+K.length,_);if(!j){D=!0;break}K.push(j)}if(!D)if(Array.isArray(W)&&W.length!==K.length)Q.error(`Expected ${W.length} arguments, but found ${K.length} instead.`);else{for(let $=0;$<K.length;$++){let R=Array.isArray(W)?W[$]:W.type,_=K[$];Q.concat($+1).checkSubtype(R,_.type)}if(Q.errors.length===0)return new v3(q,H,h,K)}}if(A.length===1)f.errors.push(...Q.errors);else{let W=(A.length?A:M).map(([K])=>{return D=K,Array.isArray(D)?`(${D.map(N0).join(", ")})`:`(${N0(D.type)}...)`;var D}).join(" | "),h=[];for(let K=1;K<w.length;K++){let D=f.parse(w[K],1+h.length);if(!D)return null;h.push(N0(D.type))}f.error(`Expected arguments of type ${W}, but found (${h.join(", ")}) instead.`)}return null}static register(w,f){v3.definitions=f;for(let q in f)w[q]=v3}}function fg(w,[f,q,v,H]){f=f.evaluate(w),q=q.evaluate(w),v=v.evaluate(w);let M=H?H.evaluate(w):1,A=Pb(f,q,v,M);if(A)throw new x5(A);return new h0(f/255,q/255,v/255,M,!1)}function zg(w,f){return w in f}function bw(w,f){let q=f[w];return q===void 0?null:q}function i4(w){return{type:w}}function S8(w){if(w instanceof K8)return S8(w.boundExpression);if(w instanceof v3&&w.name==="error")return!1;if(w instanceof F7)return!1;if(w instanceof Z4)return!1;if(w instanceof s4)return!1;if(w instanceof Q6)return!1;let f=w instanceof d0||w instanceof H0,q=!0;return w.eachChild((v)=>{q=f?q&&S8(v):q&&v instanceof D4}),!!q&&T8(w)&&$8(w,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function T8(w){if(w instanceof v3){if(w.name==="get"&&w.args.length===1)return!1;if(w.name==="feature-state")return!1;if(w.name==="has"&&w.args.length===1)return!1;if(w.name==="properties"||w.name==="geometry-type"||w.name==="id")return!1;if(/^filter-/.test(w.name))return!1}if(w instanceof Z4)return!1;if(w instanceof s4)return!1;let f=!0;return w.eachChild((q)=>{f&&!T8(q)&&(f=!1)}),f}function V6(w){if(w instanceof v3&&w.name==="feature-state")return!1;let f=!0;return w.eachChild((q)=>{f&&!V6(q)&&(f=!1)}),f}function $8(w,f){if(w instanceof v3&&f.indexOf(w.name)>=0)return!1;let q=!0;return w.eachChild((v)=>{q&&!$8(v,f)&&(q=!1)}),q}function xg(w){return{result:"success",value:w}}function l7(w){return{result:"error",value:w}}function C7(w){return w["property-type"]==="data-driven"||w["property-type"]==="cross-faded-data-driven"}function qg(w){return!!w.expression&&w.expression.parameters.indexOf("zoom")>-1}function gw(w){return!!w.expression&&w.expression.interpolated}function I0(w){return w instanceof Number?"number":w instanceof String?"string":w instanceof Boolean?"boolean":Array.isArray(w)?"array":w===null?"null":typeof w}function D7(w){return typeof w=="object"&&w!==null&&!Array.isArray(w)&&H5(w)===F4}function Sz(w){return w}function Zg(w,f){let q=w.stops&&typeof w.stops[0][0]=="object",v=q||!(q||w.property!==void 0),H=w.type||(gw(f)?"exponential":"interval"),M=function(K){switch(K.type){case"color":return h0.parse;case"padding":return z2.parse;case"numberArray":return y2.parse;case"colorArray":return p5.parse;default:return null}}(f);if(M&&((w=w3({},w)).stops&&(w.stops=w.stops.map((K)=>[K[0],M(K[1])])),w.default=M(w.default?w.default:f.default)),w.colorSpace&&(A=w.colorSpace)!=="rgb"&&A!=="hcl"&&A!=="lab")throw Error(`Unknown color space: "${w.colorSpace}"`);var A;let Q=function(K){switch(K){case"exponential":return Yg;case"interval":return $z;case"categorical":return Tz;case"identity":return fw;default:throw Error(`Unknown function type "${K}"`)}}(H),W,h;if(H==="categorical"){W=Object.create(null);for(let K of w.stops)W[K[0]]=K[1];h=typeof w.stops[0][0]}if(q){let K={},D=[];for(let _=0;_<w.stops.length;_++){let j=w.stops[_],o=j[0].zoom;K[o]===void 0&&(K[o]={zoom:o,type:w.type,property:w.property,default:w.default,stops:[]},D.push(o)),K[o].stops.push([j[0].value,j[1]])}let $=[];for(let _ of D)$.push([K[_].zoom,Zg(K[_],f)]);let R={name:"linear"};return{kind:"composite",interpolationType:R,interpolationFactor:j2.interpolationFactor.bind(void 0,R),zoomStops:$.map((_)=>_[0]),evaluate:({zoom:_},j)=>Yg({stops:$,base:w.base},f,_).evaluate(_,j)}}if(v){let K=H==="exponential"?{name:"exponential",base:w.base!==void 0?w.base:1}:null;return{kind:"camera",interpolationType:K,interpolationFactor:j2.interpolationFactor.bind(void 0,K),zoomStops:w.stops.map((D)=>D[0]),evaluate:({zoom:D})=>Q(w,f,D,W,h)}}return{kind:"source",evaluate(K,D){let $=D&&D.properties?D.properties[w.property]:void 0;return $===void 0?L6(w.default,f.default):Q(w,f,$,W,h)}}}function L6(w,f,q){return w!==void 0?w:f!==void 0?f:q!==void 0?q:void 0}function Tz(w,f,q,v,H){return L6(typeof q===H?v[q]:void 0,w.default,f.default)}function $z(w,f,q){if(I0(q)!=="number")return L6(w.default,f.default);let v=w.stops.length;if(v===1)return w.stops[0][1];if(q<=w.stops[0][0])return w.stops[0][1];if(q>=w.stops[v-1][0])return w.stops[v-1][1];let H=t5(w.stops.map((M)=>M[0]),q);return w.stops[H][1]}function Yg(w,f,q){let v=w.base!==void 0?w.base:1;if(I0(q)!=="number")return L6(w.default,f.default);let H=w.stops.length;if(H===1)return w.stops[0][1];if(q<=w.stops[0][0])return w.stops[0][1];if(q>=w.stops[H-1][0])return w.stops[H-1][1];let M=t5(w.stops.map((K)=>K[0]),q),A=function(K,D,$,R){let _=R-$,j=K-$;return _===0?0:D===1?j/_:(Math.pow(D,j)-1)/(Math.pow(D,_)-1)}(q,v,w.stops[M][0],w.stops[M+1][0]),Q=w.stops[M][1],W=w.stops[M+1][1],h=m2[f.type]||Sz;return typeof Q.evaluate=="function"?{evaluate(...K){let D=Q.evaluate.apply(void 0,K),$=W.evaluate.apply(void 0,K);if(D!==void 0&&$!==void 0)return h(D,$,A,w.colorSpace)}}:h(Q,W,A,w.colorSpace)}function fw(w,f,q){switch(f.type){case"color":q=h0.parse(q);break;case"formatted":q=X2.fromString(q.toString());break;case"resolvedImage":q=V2.fromString(q.toString());break;case"padding":q=z2.parse(q);break;case"colorArray":q=p5.parse(q);break;case"numberArray":q=y2.parse(q);break;default:I0(q)===f.type||f.type==="enum"&&f.values[q]||(q=void 0)}return L6(q,w.default,f.default)}v3.register(K7,{error:[{kind:"error"},[R0],(w,[f])=>{throw new x5(f.evaluate(w))}],typeof:[R0,[X0],(w,[f])=>N0(H5(f.evaluate(w)))],"to-rgba":[$2(u1,4),[L3],(w,[f])=>{let[q,v,H,M]=f.evaluate(w).rgb;return[255*q,255*v,255*H,M]}],rgb:[L3,[u1,u1,u1],fg],rgba:[L3,[u1,u1,u1,u1],fg],has:{type:l0,overloads:[[[R0],(w,[f])=>zg(f.evaluate(w),w.properties())],[[R0,F4],(w,[f,q])=>zg(f.evaluate(w),q.evaluate(w))]]},get:{type:X0,overloads:[[[R0],(w,[f])=>bw(f.evaluate(w),w.properties())],[[R0,F4],(w,[f,q])=>bw(f.evaluate(w),q.evaluate(w))]]},"feature-state":[X0,[R0],(w,[f])=>bw(f.evaluate(w),w.featureState||{})],properties:[F4,[],(w)=>w.properties()],"geometry-type":[R0,[],(w)=>w.geometryType()],id:[X0,[],(w)=>w.id()],zoom:[u1,[],(w)=>w.globals.zoom],"heatmap-density":[u1,[],(w)=>w.globals.heatmapDensity||0],elevation:[u1,[],(w)=>w.globals.elevation||0],"line-progress":[u1,[],(w)=>w.globals.lineProgress||0],accumulated:[X0,[],(w)=>w.globals.accumulated===void 0?null:w.globals.accumulated],"+":[u1,i4(u1),(w,f)=>{let q=0;for(let v of f)q+=v.evaluate(w);return q}],"*":[u1,i4(u1),(w,f)=>{let q=1;for(let v of f)q*=v.evaluate(w);return q}],"-":{type:u1,overloads:[[[u1,u1],(w,[f,q])=>f.evaluate(w)-q.evaluate(w)],[[u1],(w,[f])=>-f.evaluate(w)]]},"/":[u1,[u1,u1],(w,[f,q])=>f.evaluate(w)/q.evaluate(w)],"%":[u1,[u1,u1],(w,[f,q])=>f.evaluate(w)%q.evaluate(w)],ln2:[u1,[],()=>Math.LN2],pi:[u1,[],()=>Math.PI],e:[u1,[],()=>Math.E],"^":[u1,[u1,u1],(w,[f,q])=>Math.pow(f.evaluate(w),q.evaluate(w))],sqrt:[u1,[u1],(w,[f])=>Math.sqrt(f.evaluate(w))],log10:[u1,[u1],(w,[f])=>Math.log(f.evaluate(w))/Math.LN10],ln:[u1,[u1],(w,[f])=>Math.log(f.evaluate(w))],log2:[u1,[u1],(w,[f])=>Math.log(f.evaluate(w))/Math.LN2],sin:[u1,[u1],(w,[f])=>Math.sin(f.evaluate(w))],cos:[u1,[u1],(w,[f])=>Math.cos(f.evaluate(w))],tan:[u1,[u1],(w,[f])=>Math.tan(f.evaluate(w))],asin:[u1,[u1],(w,[f])=>Math.asin(f.evaluate(w))],acos:[u1,[u1],(w,[f])=>Math.acos(f.evaluate(w))],atan:[u1,[u1],(w,[f])=>Math.atan(f.evaluate(w))],min:[u1,i4(u1),(w,f)=>Math.min(...f.map((q)=>q.evaluate(w)))],max:[u1,i4(u1),(w,f)=>Math.max(...f.map((q)=>q.evaluate(w)))],abs:[u1,[u1],(w,[f])=>Math.abs(f.evaluate(w))],round:[u1,[u1],(w,[f])=>{let q=f.evaluate(w);return q<0?-Math.round(-q):Math.round(q)}],floor:[u1,[u1],(w,[f])=>Math.floor(f.evaluate(w))],ceil:[u1,[u1],(w,[f])=>Math.ceil(f.evaluate(w))],"filter-==":[l0,[R0,X0],(w,[f,q])=>w.properties()[f.value]===q.value],"filter-id-==":[l0,[X0],(w,[f])=>w.id()===f.value],"filter-type-==":[l0,[R0],(w,[f])=>w.geometryType()===f.value],"filter-<":[l0,[R0,X0],(w,[f,q])=>{let v=w.properties()[f.value],H=q.value;return typeof v==typeof H&&v<H}],"filter-id-<":[l0,[X0],(w,[f])=>{let q=w.id(),v=f.value;return typeof q==typeof v&&q<v}],"filter->":[l0,[R0,X0],(w,[f,q])=>{let v=w.properties()[f.value],H=q.value;return typeof v==typeof H&&v>H}],"filter-id->":[l0,[X0],(w,[f])=>{let q=w.id(),v=f.value;return typeof q==typeof v&&q>v}],"filter-<=":[l0,[R0,X0],(w,[f,q])=>{let v=w.properties()[f.value],H=q.value;return typeof v==typeof H&&v<=H}],"filter-id-<=":[l0,[X0],(w,[f])=>{let q=w.id(),v=f.value;return typeof q==typeof v&&q<=v}],"filter->=":[l0,[R0,X0],(w,[f,q])=>{let v=w.properties()[f.value],H=q.value;return typeof v==typeof H&&v>=H}],"filter-id->=":[l0,[X0],(w,[f])=>{let q=w.id(),v=f.value;return typeof q==typeof v&&q>=v}],"filter-has":[l0,[X0],(w,[f])=>(f.value in w.properties())],"filter-has-id":[l0,[],(w)=>w.id()!==null&&w.id()!==void 0],"filter-type-in":[l0,[$2(R0)],(w,[f])=>f.value.indexOf(w.geometryType())>=0],"filter-id-in":[l0,[$2(X0)],(w,[f])=>f.value.indexOf(w.id())>=0],"filter-in-small":[l0,[R0,$2(X0)],(w,[f,q])=>q.value.indexOf(w.properties()[f.value])>=0],"filter-in-large":[l0,[R0,$2(X0)],(w,[f,q])=>function(v,H,M,A){for(;M<=A;){let Q=M+A>>1;if(H[Q]===v)return!0;H[Q]>v?A=Q-1:M=Q+1}return!1}(w.properties()[f.value],q.value,0,q.value.length-1)],all:{type:l0,overloads:[[[l0,l0],(w,[f,q])=>f.evaluate(w)&&q.evaluate(w)],[i4(l0),(w,f)=>{for(let q of f)if(!q.evaluate(w))return!1;return!0}]]},any:{type:l0,overloads:[[[l0,l0],(w,[f,q])=>f.evaluate(w)||q.evaluate(w)],[i4(l0),(w,f)=>{for(let q of f)if(q.evaluate(w))return!0;return!1}]]},"!":[l0,[l0],(w,[f])=>!f.evaluate(w)],"is-supported-script":[l0,[R0],(w,[f])=>{let q=w.globals&&w.globals.isSupportedScript;return!q||q(f.evaluate(w))}],upcase:[R0,[R0],(w,[f])=>f.evaluate(w).toUpperCase()],downcase:[R0,[R0],(w,[f])=>f.evaluate(w).toLowerCase()],concat:[R0,i4(X0),(w,f)=>f.map((q)=>t0(q.evaluate(w))).join("")],"resolved-locale":[R0,[A7],(w,[f])=>f.evaluate(w).resolvedLocale()]});class j8{constructor(w,f,q){this.expression=w,this._warningHistory={},this._evaluator=new j3,this._defaultValue=f?function(v){if(v.type==="color"&&D7(v.default))return new h0(0,0,0,0);switch(v.type){case"color":return h0.parse(v.default)||null;case"padding":return z2.parse(v.default)||null;case"numberArray":return y2.parse(v.default)||null;case"colorArray":return p5.parse(v.default)||null;case"variableAnchorOffsetCollection":return Q2.parse(v.default)||null;case"projectionDefinition":return g3.parse(v.default)||null;default:return v.default===void 0?null:v.default}}(f):null,this._enumValues=f&&f.type==="enum"?f.values:null,this._globalState=q}evaluateWithoutErrorHandling(w,f,q,v,H,M){return this._globalState&&(w=W6(w,this._globalState)),this._evaluator.globals=w,this._evaluator.feature=f,this._evaluator.featureState=q,this._evaluator.canonical=v,this._evaluator.availableImages=H||null,this._evaluator.formattedSection=M,this.expression.evaluate(this._evaluator)}evaluate(w,f,q,v,H,M){this._globalState&&(w=W6(w,this._globalState)),this._evaluator.globals=w,this._evaluator.feature=f||null,this._evaluator.featureState=q||null,this._evaluator.canonical=v,this._evaluator.availableImages=H||null,this._evaluator.formattedSection=M||null;try{let A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new x5(`Expected value to be one of ${Object.keys(this._enumValues).map((Q)=>JSON.stringify(Q)).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(A.message)),this._defaultValue}}}function zw(w){return Array.isArray(w)&&w.length>0&&typeof w[0]=="string"&&w[0]in K7}function xw(w,f,q){let v=new U6(K7,S8,[],f?function(M){let A={color:L3,string:R0,number:u1,enum:R0,boolean:l0,formatted:k6,padding:v6,numberArray:M7,colorArray:V8,projectionDefinition:Q8,resolvedImage:L8,variableAnchorOffsetCollection:K4};return M.type==="array"?$2(A[M.value]||X0,M.length):A[M.type]}(f):void 0),H=v.parse(w,void 0,void 0,void 0,f&&f.type==="string"?{typeAnnotation:"coerce"}:void 0);return H?xg(new j8(H,f,q)):l7(v.errors)}class m8{constructor(w,f,q){this.kind=w,this._styleExpression=f,this.isStateDependent=w!=="constant"&&!V6(f.expression),this.globalStateRefs=Zw(f.expression),this._globalState=q}evaluateWithoutErrorHandling(w,f,q,v,H,M){return this._globalState&&(w=W6(w,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(w,f,q,v,H,M)}evaluate(w,f,q,v,H,M){return this._globalState&&(w=W6(w,this._globalState)),this._styleExpression.evaluate(w,f,q,v,H,M)}}class qw{constructor(w,f,q,v,H){this.kind=w,this.zoomStops=q,this._styleExpression=f,this.isStateDependent=w!=="camera"&&!V6(f.expression),this.globalStateRefs=Zw(f.expression),this.interpolationType=v,this._globalState=H}evaluateWithoutErrorHandling(w,f,q,v,H,M){return this._globalState&&(w=W6(w,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(w,f,q,v,H,M)}evaluate(w,f,q,v,H,M){return this._globalState&&(w=W6(w,this._globalState)),this._styleExpression.evaluate(w,f,q,v,H,M)}interpolationFactor(w,f,q){return this.interpolationType?j2.interpolationFactor(this.interpolationType,w,f,q):0}}function jz(w,f,q){let v=xw(w,f,q);if(v.result==="error")return v;let H=v.value.expression,M=T8(H);if(!M&&!C7(f))return l7([new V5("","data expressions not supported")]);let A=$8(H,["zoom"]);if(!A&&!qg(f))return l7([new V5("","zoom expressions not supported")]);let Q=P8(H);return Q||A?Q instanceof V5?l7([Q]):Q instanceof j2&&!gw(f)?l7([new V5("",'"interpolate" expressions cannot be used with this property')]):xg(Q?new qw(M?"camera":"composite",v.value,Q.labels,Q instanceof j2?Q.interpolation:void 0,q):new m8(M?"constant":"source",v.value,q)):l7([new V5("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class _8{constructor(w,f){this._parameters=w,this._specification=f,w3(this,Zg(this._parameters,this._specification))}static deserialize(w){return new _8(w._parameters,w._specification)}static serialize(w){return{_parameters:w._parameters,_specification:w._specification}}}function P8(w){let f=null;if(w instanceof L7)f=P8(w.result);else if(w instanceof W7){for(let q of w.args)if(f=P8(q),f)break}else(w instanceof o4||w instanceof j2)&&w.input instanceof v3&&w.input.name==="zoom"&&(f=w);return f instanceof V5||w.eachChild((q)=>{let v=P8(q);v instanceof V5?f=v:!f&&v?f=new V5("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):f&&v&&f!==v&&(f=new V5("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),f}function Zw(w,f=new Set){return w instanceof Q6&&f.add(w.key),w.eachChild((q)=>{Zw(q,f)}),f}function W6(w,f){let{zoom:q,heatmapDensity:v,elevation:H,lineProgress:M,isSupportedScript:A,accumulated:Q}=w!=null?w:{};return{zoom:q,heatmapDensity:v,elevation:H,lineProgress:M,isSupportedScript:A,accumulated:Q,globalState:f}}function Yw(w){if(w===!0||w===!1)return!0;if(!Array.isArray(w)||w.length===0)return!1;switch(w[0]){case"has":return w.length>=2&&w[1]!=="$id"&&w[1]!=="$type";case"in":return w.length>=3&&(typeof w[1]!="string"||Array.isArray(w[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return w.length!==3||Array.isArray(w[1])||Array.isArray(w[2]);case"any":case"all":for(let f of w.slice(1))if(!Yw(f)&&typeof f!="boolean")return!1;return!0;default:return!0}}let mz={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function h6(w,f){if(w==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Yw(w)||(w=kw(w));let q=xw(w,mz,f);if(q.result==="error")throw Error(q.value.map((v)=>`${v.key}: ${v.message}`).join(", "));return{filter:(v,H,M)=>q.value.evaluate(v,H,{},M),needGeometry:_z(w),getGlobalStateRefs:()=>Zw(q.value.expression)}}function DZ(w,f){return w<f?-1:w>f?1:0}function _z(w){if(!Array.isArray(w))return!1;if(w[0]==="within"||w[0]==="distance")return!0;for(let f=1;f<w.length;f++)if(_z(w[f]))return!0;return!1}function kw(w){if(!w)return!0;let f=w[0];return w.length<=1?f!=="any":f==="=="?kg(w[1],w[2],"=="):f==="!="?F6(kg(w[1],w[2],"==")):f==="<"||f===">"||f==="<="||f===">="?kg(w[1],w[2],f):f==="any"?(q=w.slice(1),["any"].concat(q.map(kw))):f==="all"?["all"].concat(w.slice(1).map(kw)):f==="none"?["all"].concat(w.slice(1).map(kw).map(F6)):f==="in"?vg(w[1],w.slice(2)):f==="!in"?F6(vg(w[1],w.slice(2))):f==="has"?Jg(w[1]):f!=="!has"||F6(Jg(w[1]));var q}function kg(w,f,q){switch(w){case"$type":return[`filter-type-${q}`,f];case"$id":return[`filter-id-${q}`,f];default:return[`filter-${q}`,w,f]}}function vg(w,f){if(f.length===0)return!1;switch(w){case"$type":return["filter-type-in",["literal",f]];case"$id":return["filter-id-in",["literal",f]];default:return f.length>200&&!f.some((q)=>typeof q!=typeof f[0])?["filter-in-large",w,["literal",f.sort(DZ)]]:["filter-in-small",w,["literal",f]]}}function Jg(w){switch(w){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",w]}}function F6(w){return["!",w]}function E8(w){let f=typeof w;if(f==="number"||f==="boolean"||f==="string"||w==null)return JSON.stringify(w);if(Array.isArray(w)){let H="[";for(let M of w)H+=`${E8(M)},`;return`${H}]`}let q=Object.keys(w).sort(),v="{";for(let H=0;H<q.length;H++)v+=`${JSON.stringify(q[H])}:${E8(w[q[H]])},`;return`${v}}`}function Gg(w){let f="";for(let q of y0)f+=`/${E8(w[q])}`;return f}function vw(w){let f=w.value;return f?[new d1(w.key,f,"constants have been deprecated as of v8")]:[]}function U5(w){return w instanceof Number||w instanceof String||w instanceof Boolean?w.valueOf():w}function d7(w){if(Array.isArray(w))return w.map(d7);if(w instanceof Object&&!(w instanceof Number||w instanceof String||w instanceof Boolean)){let f={};for(let q in w)f[q]=d7(w[q]);return f}return U5(w)}function h3(w){let{key:f,value:q}=w,v=w.valueSpec||{},H=w.objectElementValidators||{},M=w.style,A=w.styleSpec,Q=w.validateSpec,W=[],h=I0(q);if(h!=="object")return[new d1(f,q,`object expected, ${h} found`)];for(let K in q){let D=K.split(".")[0],$=G6(v,D)||v["*"],R;if(G6(H,D))R=H[D];else if(G6(v,D))R=Q;else if(H["*"])R=H["*"];else{if(!v["*"]){W.push(new d1(f,q[K],`unknown property "${K}"`));continue}R=Q}W=W.concat(R({key:(f?`${f}.`:f)+K,value:q[K],valueSpec:$,style:M,styleSpec:A,object:q,objectKey:K,validateSpec:Q},q))}for(let K in v)H[K]||v[K].required&&v[K].default===void 0&&q[K]===void 0&&W.push(new d1(f,q,`missing required property "${K}"`));return W}function Hg(w){let{value:f,valueSpec:q,style:v,styleSpec:H,key:M}=w,A=w.arrayElementValidator||w.validateSpec;if(I0(f)!=="array")return[new d1(M,f,`array expected, ${I0(f)} found`)];if(q.length&&f.length!==q.length)return[new d1(M,f,`array length ${q.length} expected, length ${f.length} found`)];if(q["min-length"]&&f.length<q["min-length"])return[new d1(M,f,`array length at least ${q["min-length"]} expected, length ${f.length} found`)];let Q={type:q.value,values:q.values};H.$version<7&&(Q.function=q.function),I0(q.value)==="object"&&(Q=q.value);let W=[];for(let h=0;h<f.length;h++)W=W.concat(A({array:f,arrayIndex:h,value:f[h],valueSpec:Q,validateSpec:w.validateSpec,style:v,styleSpec:H,key:`${M}[${h}]`}));return W}function Jw(w){let{key:f,value:q,valueSpec:v}=w,H=I0(q);return H==="number"&&q!=q&&(H="NaN"),H!=="number"?[new d1(f,q,`number expected, ${H} found`)]:("minimum"in v)&&q<v.minimum?[new d1(f,q,`${q} is less than the minimum value ${v.minimum}`)]:("maximum"in v)&&q>v.maximum?[new d1(f,q,`${q} is greater than the maximum value ${v.maximum}`)]:[]}function Pz(w){let f=w.valueSpec,q=U5(w.value.type),v,H,M,A={},Q=q!=="categorical"&&w.value.property===void 0,W=!Q,h=I0(w.value.stops)==="array"&&I0(w.value.stops[0])==="array"&&I0(w.value.stops[0][0])==="object",K=h3({key:w.key,value:w.value,valueSpec:w.styleSpec.function,validateSpec:w.validateSpec,style:w.style,styleSpec:w.styleSpec,objectElementValidators:{stops:function(R){if(q==="identity")return[new d1(R.key,R.value,'identity function may not have a "stops" property')];let _=[],j=R.value;return _=_.concat(Hg({key:R.key,value:j,valueSpec:R.valueSpec,validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec,arrayElementValidator:D})),I0(j)==="array"&&j.length===0&&_.push(new d1(R.key,j,"array must have at least one stop")),_},default:function(R){return R.validateSpec({key:R.key,value:R.value,valueSpec:f,validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec})}}});return q==="identity"&&Q&&K.push(new d1(w.key,w.value,'missing required property "property"')),q==="identity"||w.value.stops||K.push(new d1(w.key,w.value,'missing required property "stops"')),q==="exponential"&&w.valueSpec.expression&&!gw(w.valueSpec)&&K.push(new d1(w.key,w.value,"exponential functions not supported")),w.styleSpec.$version>=8&&(W&&!C7(w.valueSpec)?K.push(new d1(w.key,w.value,"property functions not supported")):Q&&!qg(w.valueSpec)&&K.push(new d1(w.key,w.value,"zoom functions not supported"))),q!=="categorical"&&!h||w.value.property!==void 0||K.push(new d1(w.key,w.value,'"property" property is required')),K;function D(R){let _=[],j=R.value,o=R.key;if(I0(j)!=="array")return[new d1(o,j,`array expected, ${I0(j)} found`)];if(j.length!==2)return[new d1(o,j,`array length 2 expected, length ${j.length} found`)];if(h){if(I0(j[0])!=="object")return[new d1(o,j,`object expected, ${I0(j[0])} found`)];if(j[0].zoom===void 0)return[new d1(o,j,"object stop key must have zoom")];if(j[0].value===void 0)return[new d1(o,j,"object stop key must have value")];if(M&&M>U5(j[0].zoom))return[new d1(o,j[0].zoom,"stop zoom values must appear in ascending order")];U5(j[0].zoom)!==M&&(M=U5(j[0].zoom),H=void 0,A={}),_=_.concat(h3({key:`${o}[0]`,value:j[0],valueSpec:{zoom:{}},validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec,objectElementValidators:{zoom:Jw,value:$}}))}else _=_.concat($({key:`${o}[0]`,value:j[0],validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec},j));return zw(d7(j[1]))?_.concat([new d1(`${o}[1]`,j[1],"expressions are not allowed in function stops.")]):_.concat(R.validateSpec({key:`${o}[1]`,value:j[1],valueSpec:f,validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec}))}function $(R,_){let j=I0(R.value),o=U5(R.value),t=R.value!==null?R.value:_;if(v){if(j!==v)return[new d1(R.key,t,`${j} stop domain type must match previous stop domain type ${v}`)]}else v=j;if(j!=="number"&&j!=="string"&&j!=="boolean")return[new d1(R.key,t,"stop domain value must be a number, string, or boolean")];if(j!=="number"&&q!=="categorical"){let U1=`number expected, ${j} found`;return C7(f)&&q===void 0&&(U1+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new d1(R.key,t,U1)]}return q!=="categorical"||j!=="number"||isFinite(o)&&Math.floor(o)===o?q!=="categorical"&&j==="number"&&H!==void 0&&o<H?[new d1(R.key,t,"stop domain values must appear in ascending order")]:(H=o,q==="categorical"&&(o in A)?[new d1(R.key,t,"stop domain values must be unique")]:(A[o]=!0,[])):[new d1(R.key,t,`integer expected, found ${o}`)]}}function K6(w){let f=(w.expressionContext==="property"?jz:xw)(d7(w.value),w.valueSpec);if(f.result==="error")return f.value.map((v)=>new d1(`${w.key}${v.key}`,w.value,v.message));let q=f.value.expression||f.value._styleExpression.expression;if(w.expressionContext==="property"&&w.propertyKey==="text-font"&&!q.outputDefined())return[new d1(w.key,w.value,`Invalid data expression for "${w.propertyKey}". Output values must be contained as literals within the expression.`)];if(w.expressionContext==="property"&&w.propertyType==="layout"&&!V6(q))return[new d1(w.key,w.value,'"feature-state" data expressions are not supported with layout properties.')];if(w.expressionContext==="filter"&&!V6(q))return[new d1(w.key,w.value,'"feature-state" data expressions are not supported with filters.')];if(w.expressionContext&&w.expressionContext.indexOf("cluster")===0){if(!$8(q,["zoom","feature-state"]))return[new d1(w.key,w.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(w.expressionContext==="cluster-initial"&&!T8(q))return[new d1(w.key,w.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Gw(w){let{key:f,value:q}=w,v=I0(q);return v!=="string"?[new d1(f,q,`color expected, ${v} found`)]:h0.parse(String(q))?[]:[new d1(f,q,`color expected, "${q}" found`)]}function l6(w){let{key:f,value:q,valueSpec:v}=w,H=[];return Array.isArray(v.values)?v.values.indexOf(U5(q))===-1&&H.push(new d1(f,q,`expected one of [${v.values.join(", ")}], ${JSON.stringify(q)} found`)):Object.keys(v.values).indexOf(U5(q))===-1&&H.push(new d1(f,q,`expected one of [${Object.keys(v.values).join(", ")}], ${JSON.stringify(q)} found`)),H}function C6(w){return Yw(d7(w.value))?K6(w3({},w,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ez(w)}function Ez(w){let{value:f,key:q}=w;if(I0(f)!=="array")return[new d1(q,f,`array expected, ${I0(f)} found`)];let v=w.styleSpec,H,M=[];if(f.length<1)return[new d1(q,f,"filter array must have at least 1 element")];switch(M=M.concat(l6({key:`${q}[0]`,value:f[0],valueSpec:v.filter_operator,style:w.style,styleSpec:w.styleSpec})),U5(f[0])){case"<":case"<=":case">":case">=":f.length>=2&&U5(f[1])==="$type"&&M.push(new d1(q,f,`"$type" cannot be use with operator "${f[0]}"`));case"==":case"!=":f.length!==3&&M.push(new d1(q,f,`filter array for operator "${f[0]}" must have 3 elements`));case"in":case"!in":f.length>=2&&(H=I0(f[1]),H!=="string"&&M.push(new d1(`${q}[1]`,f[1],`string expected, ${H} found`)));for(let A=2;A<f.length;A++)H=I0(f[A]),U5(f[1])==="$type"?M=M.concat(l6({key:`${q}[${A}]`,value:f[A],valueSpec:v.geometry_type,style:w.style,styleSpec:w.styleSpec})):H!=="string"&&H!=="number"&&H!=="boolean"&&M.push(new d1(`${q}[${A}]`,f[A],`string, number, or boolean expected, ${H} found`));break;case"any":case"all":case"none":for(let A=1;A<f.length;A++)M=M.concat(Ez({key:`${q}[${A}]`,value:f[A],style:w.style,styleSpec:w.styleSpec}));break;case"has":case"!has":H=I0(f[1]),f.length!==2?M.push(new d1(q,f,`filter array for "${f[0]}" operator must have 2 elements`)):H!=="string"&&M.push(new d1(`${q}[1]`,f[1],`string expected, ${H} found`))}return M}function Ug(w,f){let{key:q,validateSpec:v,style:H,styleSpec:M,value:A,objectKey:Q}=w,W=M[`${f}_${w.layerType}`];if(!W)return[];let h=Q.match(/^(.*)-transition$/);if(f==="paint"&&h&&W[h[1]]&&W[h[1]].transition)return v({key:q,value:A,valueSpec:M.transition,style:H,styleSpec:M});let K=w.valueSpec||W[Q];if(!K)return[new d1(q,A,`unknown property "${Q}"`)];let D;if(I0(A)==="string"&&C7(K)&&!K.tokens&&(D=/^{([^}]+)}$/.exec(A)))return[new d1(q,A,`"${Q}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(D[1])} }\`.`)];let $=[];return w.layerType==="symbol"&&(Q==="text-field"&&H&&!H.glyphs&&$.push(new d1(q,A,'use of "text-field" requires a style "glyphs" property')),Q==="text-font"&&D7(d7(A))&&U5(A.type)==="identity"&&$.push(new d1(q,A,'"text-font" does not support identity functions'))),$.concat(v({key:w.key,value:A,valueSpec:K,style:H,styleSpec:M,expressionContext:"property",propertyType:f,propertyKey:Q}))}function Bg(w){return Ug(w,"paint")}function Ag(w){return Ug(w,"layout")}function Mg(w){let f=[],q=w.value,v=w.key,H=w.style,M=w.styleSpec;if(I0(q)!=="object")return[new d1(v,q,`object expected, ${I0(q)} found`)];q.type||q.ref||f.push(new d1(v,q,'either "type" or "ref" is required'));let A=U5(q.type),Q=U5(q.ref);if(q.id){let W=U5(q.id);for(let h=0;h<w.arrayIndex;h++){let K=H.layers[h];U5(K.id)===W&&f.push(new d1(v,q.id,`duplicate layer id "${q.id}", previously used at line ${K.id.__line__}`))}}if("ref"in q){let W;["type","source","source-layer","filter","layout"].forEach((h)=>{h in q&&f.push(new d1(v,q[h],`"${h}" is prohibited for ref layers`))}),H.layers.forEach((h)=>{U5(h.id)===Q&&(W=h)}),W?W.ref?f.push(new d1(v,q.ref,"ref cannot reference another ref layer")):A=U5(W.type):f.push(new d1(v,q.ref,`ref layer "${Q}" not found`))}else if(A!=="background")if(q.source){let W=H.sources&&H.sources[q.source],h=W&&U5(W.type);W?h==="vector"&&A==="raster"?f.push(new d1(v,q.source,`layer "${q.id}" requires a raster source`)):h!=="raster-dem"&&A==="hillshade"||h!=="raster-dem"&&A==="color-relief"?f.push(new d1(v,q.source,`layer "${q.id}" requires a raster-dem source`)):h==="raster"&&A!=="raster"?f.push(new d1(v,q.source,`layer "${q.id}" requires a vector source`)):h!=="vector"||q["source-layer"]?h==="raster-dem"&&A!=="hillshade"&&A!=="color-relief"?f.push(new d1(v,q.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):A!=="line"||!q.paint||!q.paint["line-gradient"]||h==="geojson"&&W.lineMetrics||f.push(new d1(v,q,`layer "${q.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):f.push(new d1(v,q,`layer "${q.id}" must specify a "source-layer"`)):f.push(new d1(v,q.source,`source "${q.source}" not found`))}else f.push(new d1(v,q,'missing required property "source"'));return f=f.concat(h3({key:v,value:q,valueSpec:M.layer,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":()=>[],type:()=>w.validateSpec({key:`${v}.type`,value:q.type,valueSpec:M.layer.type,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,object:q,objectKey:"type"}),filter:C6,layout:(W)=>h3({layer:q,key:W.key,value:W.value,style:W.style,styleSpec:W.styleSpec,validateSpec:W.validateSpec,objectElementValidators:{"*":(h)=>Ag(w3({layerType:A},h))}}),paint:(W)=>h3({layer:q,key:W.key,value:W.value,style:W.style,styleSpec:W.styleSpec,validateSpec:W.validateSpec,objectElementValidators:{"*":(h)=>Bg(w3({layerType:A},h))}})}})),f}function d4(w){let{value:f,key:q}=w,v=I0(f);return v!=="string"?[new d1(q,f,`string expected, ${v} found`)]:[]}let D6={promoteId:function({key:w,value:f}){if(I0(f)==="string")return d4({key:w,value:f});{let q=[];for(let v in f)q.push(...d4({key:`${w}.${v}`,value:f[v]}));return q}}};function uz(w){let{value:f,key:q,styleSpec:v,style:H,validateSpec:M}=w;if(!f.type)return[new d1(q,f,'"type" is required')];let A=U5(f.type),Q;switch(A){case"vector":case"raster":return Q=h3({key:q,value:f,valueSpec:v[`source_${A.replace("-","_")}`],style:w.style,styleSpec:v,objectElementValidators:D6,validateSpec:M}),Q;case"raster-dem":return Q=function(W){var h;let K=(h=W.sourceName)!==null&&h!==void 0?h:"",D=W.value,$=W.styleSpec,R=$.source_raster_dem,_=W.style,j=[],o=I0(D);if(D===void 0)return j;if(o!=="object")return j.push(new d1("source_raster_dem",D,`object expected, ${o} found`)),j;let t=U5(D.encoding)==="custom",U1=["redFactor","greenFactor","blueFactor","baseShift"],g1=W.value.encoding?`"${W.value.encoding}"`:"Default";for(let G1 in D)!t&&U1.includes(G1)?j.push(new d1(G1,D[G1],`In "${K}": "${G1}" is only valid when "encoding" is set to "custom". ${g1} encoding found`)):R[G1]?j=j.concat(W.validateSpec({key:G1,value:D[G1],valueSpec:R[G1],validateSpec:W.validateSpec,style:_,styleSpec:$})):j.push(new d1(G1,D[G1],`unknown property "${G1}"`));return j}({sourceName:q,value:f,style:w.style,styleSpec:v,validateSpec:M}),Q;case"geojson":if(Q=h3({key:q,value:f,valueSpec:v.source_geojson,style:H,styleSpec:v,validateSpec:M,objectElementValidators:D6}),f.cluster)for(let W in f.clusterProperties){let[h,K]=f.clusterProperties[W],D=typeof h=="string"?[h,["accumulated"],["get",W]]:h;Q.push(...K6({key:`${q}.${W}.map`,value:K,expressionContext:"cluster-map"})),Q.push(...K6({key:`${q}.${W}.reduce`,value:D,expressionContext:"cluster-reduce"}))}return Q;case"video":return h3({key:q,value:f,valueSpec:v.source_video,style:H,validateSpec:M,styleSpec:v});case"image":return h3({key:q,value:f,valueSpec:v.source_image,style:H,validateSpec:M,styleSpec:v});case"canvas":return[new d1(q,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return l6({key:`${q}.type`,value:f.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function pz(w){let{value:f,styleSpec:q}=w,v=q.light,H=w.style,M=[],A=I0(f);if(f===void 0)return M;if(A!=="object")return M=M.concat([new d1("light",f,`object expected, ${A} found`)]),M;for(let Q in f){let W=Q.match(/^(.*)-transition$/);M=M.concat(W&&v[W[1]]&&v[W[1]].transition?w.validateSpec({key:Q,value:f[Q],valueSpec:q.transition,validateSpec:w.validateSpec,style:H,styleSpec:q}):v[Q]?w.validateSpec({key:Q,value:f[Q],valueSpec:v[Q],validateSpec:w.validateSpec,style:H,styleSpec:q}):[new d1(Q,f[Q],`unknown property "${Q}"`)])}return M}function cz(w){let{value:f,styleSpec:q}=w,v=q.sky,H=w.style,M=I0(f);if(f===void 0)return[];if(M!=="object")return[new d1("sky",f,`object expected, ${M} found`)];let A=[];for(let Q in f)A=A.concat(v[Q]?w.validateSpec({key:Q,value:f[Q],valueSpec:v[Q],style:H,styleSpec:q}):[new d1(Q,f[Q],`unknown property "${Q}"`)]);return A}function az(w){let{value:f,styleSpec:q}=w,v=q.terrain,H=w.style,M=[],A=I0(f);if(f===void 0)return M;if(A!=="object")return M=M.concat([new d1("terrain",f,`object expected, ${A} found`)]),M;for(let Q in f)M=M.concat(v[Q]?w.validateSpec({key:Q,value:f[Q],valueSpec:v[Q],validateSpec:w.validateSpec,style:H,styleSpec:q}):[new d1(Q,f[Q],`unknown property "${Q}"`)]);return M}function rz(w){let f=[],q=w.value,v=w.key;if(Array.isArray(q)){let H=[],M=[];for(let A in q)q[A].id&&H.includes(q[A].id)&&f.push(new d1(v,q,`all the sprites' ids must be unique, but ${q[A].id} is duplicated`)),H.push(q[A].id),q[A].url&&M.includes(q[A].url)&&f.push(new d1(v,q,`all the sprites' URLs must be unique, but ${q[A].url} is duplicated`)),M.push(q[A].url),f=f.concat(h3({key:`${v}[${A}]`,value:q[A],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:w.validateSpec}));return f}return d4({key:v,value:q})}function Xg(w){return f=w.value,Boolean(f)&&f.constructor===Object?[]:[new d1(w.key,w.value,`object expected, ${I0(w.value)} found`)];var f}let d6={"*":()=>[],array:Hg,boolean:function(w){let{value:f,key:q}=w,v=I0(f);return v!=="boolean"?[new d1(q,f,`boolean expected, ${v} found`)]:[]},number:Jw,color:Gw,constants:vw,enum:l6,filter:C6,function:Pz,layer:Mg,object:h3,source:uz,light:pz,sky:cz,terrain:az,projection:function(w){let{value:f,styleSpec:q}=w,v=q.projection,H=w.style,M=I0(f);if(f===void 0)return[];if(M!=="object")return[new d1("projection",f,`object expected, ${M} found`)];let A=[];for(let Q in f)A=A.concat(v[Q]?w.validateSpec({key:Q,value:f[Q],valueSpec:v[Q],style:H,styleSpec:q}):[new d1(Q,f[Q],`unknown property "${Q}"`)]);return A},projectionDefinition:function(w){let{key:f,value:q}=w;q=q instanceof String?q.valueOf():q;let v=I0(q);return v!=="array"||function(H){return Array.isArray(H)&&H.length===3&&typeof H[0]=="string"&&typeof H[1]=="string"&&typeof H[2]=="number"}(q)||function(H){return!!["interpolate","step","literal"].includes(H[0])}(q)?["array","string"].includes(v)?[]:[new d1(f,q,`projection expected, invalid type "${v}" found`)]:[new d1(f,q,`projection expected, invalid array ${JSON.stringify(q)} found`)]},string:d4,formatted:function(w){return d4(w).length===0?[]:K6(w)},resolvedImage:function(w){return d4(w).length===0?[]:K6(w)},padding:function(w){let{key:f,value:q}=w;if(I0(q)==="array"){if(q.length<1||q.length>4)return[new d1(f,q,`padding requires 1 to 4 values; ${q.length} values found`)];let v={type:"number"},H=[];for(let M=0;M<q.length;M++)H=H.concat(w.validateSpec({key:`${f}[${M}]`,value:q[M],validateSpec:w.validateSpec,valueSpec:v}));return H}return Jw({key:f,value:q,valueSpec:{}})},numberArray:function(w){let{key:f,value:q}=w;if(I0(q)==="array"){let v={type:"number"};if(q.length<1)return[new d1(f,q,"array length at least 1 expected, length 0 found")];let H=[];for(let M=0;M<q.length;M++)H=H.concat(w.validateSpec({key:`${f}[${M}]`,value:q[M],validateSpec:w.validateSpec,valueSpec:v}));return H}return Jw({key:f,value:q,valueSpec:{}})},colorArray:function(w){let{key:f,value:q}=w;if(I0(q)==="array"){if(q.length<1)return[new d1(f,q,"array length at least 1 expected, length 0 found")];let v=[];for(let H=0;H<q.length;H++)v=v.concat(Gw({key:`${f}[${H}]`,value:q[H]}));return v}return Gw({key:f,value:q})},variableAnchorOffsetCollection:function(w){let{key:f,value:q}=w,v=I0(q),H=w.styleSpec;if(v!=="array"||q.length<1||q.length%2!=0)return[new d1(f,q,"variableAnchorOffsetCollection requires a non-empty array of even length")];let M=[];for(let A=0;A<q.length;A+=2)M=M.concat(l6({key:`${f}[${A}]`,value:q[A],valueSpec:H.layout_symbol["text-anchor"]})),M=M.concat(Hg({key:`${f}[${A+1}]`,value:q[A+1],valueSpec:{length:2,value:"number"},validateSpec:w.validateSpec,style:w.style,styleSpec:H}));return M},sprite:rz,state:Xg};function t4(w){let{value:f,valueSpec:q,styleSpec:v}=w;return w.validateSpec=t4,q.expression&&D7(U5(f))?Pz(w):q.expression&&zw(d7(f))?K6(w):q.type&&d6[q.type]?d6[q.type](w):h3(w3({},w,{valueSpec:q.type?v[q.type]:q}))}function _2(w){let{value:f,key:q}=w,v=d4(w);return v.length||(f.indexOf("{fontstack}")===-1&&v.push(new d1(q,f,'"glyphs" url must include a "{fontstack}" token')),f.indexOf("{range}")===-1&&v.push(new d1(q,f,'"glyphs" url must include a "{range}" token'))),v}function L2(w,f=M1){let q=[];return q=q.concat(t4({key:"",value:w,valueSpec:f.$root,styleSpec:f,style:w,validateSpec:t4,objectElementValidators:{glyphs:_2,"*":()=>[]}})),w.constants&&(q=q.concat(vw({key:"constants",value:w.constants}))),Qg(q)}function J3(w){return function(f){return w(Object.assign({},f,{validateSpec:t4}))}}function Qg(w){return[].concat(w).sort((f,q)=>f.line-q.line)}function F3(w){return function(...f){return Qg(w.apply(this,f))}}L2.source=F3(J3(uz)),L2.sprite=F3(J3(rz)),L2.glyphs=F3(J3(_2)),L2.light=F3(J3(pz)),L2.sky=F3(J3(cz)),L2.terrain=F3(J3(az)),L2.state=F3(J3(Xg)),L2.layer=F3(J3(Mg)),L2.filter=F3(J3(C6)),L2.paintProperty=F3(J3(Bg)),L2.layoutProperty=F3(J3(Ag));let P3=L2,Vg=P3.light,Lg=P3.sky,oz=P3.paintProperty,Hw=P3.layoutProperty;function Wg(w,f){let q=!1;if(f&&f.length)for(let v of f)w.fire(new m1(Error(v.message))),q=!0;return q}class k4{constructor(w,f,q){let v=this.cells=[];if(w instanceof ArrayBuffer){this.arrayBuffer=w;let M=new Int32Array(this.arrayBuffer);w=M[0],this.d=(f=M[1])+2*(q=M[2]);for(let Q=0;Q<this.d*this.d;Q++){let W=M[3+Q],h=M[3+Q+1];v.push(W===h?null:M.subarray(W,h))}let A=M[3+v.length+1];this.keys=M.subarray(M[3+v.length],A),this.bboxes=M.subarray(A),this.insert=this._insertReadonly}else{this.d=f+2*q;for(let M=0;M<this.d*this.d;M++)v.push([]);this.keys=[],this.bboxes=[]}this.n=f,this.extent=w,this.padding=q,this.scale=f/w,this.uid=0;let H=q/f*w;this.min=-H,this.max=w+H}insert(w,f,q,v,H){this._forEachCell(f,q,v,H,this._insertCell,this.uid++,void 0,void 0),this.keys.push(w),this.bboxes.push(f),this.bboxes.push(q),this.bboxes.push(v),this.bboxes.push(H)}_insertReadonly(){throw Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(w,f,q,v,H,M){this.cells[H].push(M)}query(w,f,q,v,H){let M=this.min,A=this.max;if(w<=M&&f<=M&&A<=q&&A<=v&&!H)return Array.prototype.slice.call(this.keys);{let Q=[];return this._forEachCell(w,f,q,v,this._queryCell,Q,{},H),Q}}_queryCell(w,f,q,v,H,M,A,Q){let W=this.cells[H];if(W!==null){let h=this.keys,K=this.bboxes;for(let D=0;D<W.length;D++){let $=W[D];if(A[$]===void 0){let R=4*$;(Q?Q(K[R+0],K[R+1],K[R+2],K[R+3]):w<=K[R+2]&&f<=K[R+3]&&q>=K[R+0]&&v>=K[R+1])?(A[$]=!0,M.push(h[$])):A[$]=!1}}}}_forEachCell(w,f,q,v,H,M,A,Q){let W=this._convertToCellCoord(w),h=this._convertToCellCoord(f),K=this._convertToCellCoord(q),D=this._convertToCellCoord(v);for(let $=W;$<=K;$++)for(let R=h;R<=D;R++){let _=this.d*R+$;if((!Q||Q(this._convertFromCellCoord($),this._convertFromCellCoord(R),this._convertFromCellCoord($+1),this._convertFromCellCoord(R+1)))&&H.call(this,w,f,q,v,_,M,A,Q))return}}_convertFromCellCoord(w){return(w-this.padding)/this.scale}_convertToCellCoord(w){return Math.max(0,Math.min(this.d-1,Math.floor(w*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let w=this.cells,f=3+this.cells.length+1+1,q=0;for(let M=0;M<this.cells.length;M++)q+=this.cells[M].length;let v=new Int32Array(f+q+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;let H=f;for(let M=0;M<w.length;M++){let A=w[M];v[3+M]=H,v.set(A,H),H+=A.length}return v[3+w.length]=H,v.set(this.keys,H),H+=this.keys.length,v[3+w.length+1]=H,v.set(this.bboxes,H),H+=this.bboxes.length,v.buffer}static serialize(w,f){let q=w.toArrayBuffer();return f&&f.push(q),{buffer:q}}static deserialize(w){return new k4(w.buffer)}}let O4={};function o1(w,f,q={}){if(O4[w])throw Error(`${w} is already registered.`);Object.defineProperty(f,"_classRegistryKey",{value:w,writeable:!1}),O4[w]={klass:f,omit:q.omit||[],shallow:q.shallow||[]}}o1("Object",Object),o1("Set",Set),o1("TransferableGridIndex",k4),o1("Color",h0),o1("Error",Error),o1("AJAXError",b1),o1("ResolvedImage",V2),o1("StylePropertyFunction",_8),o1("StyleExpression",j8,{omit:["_evaluator"]}),o1("ZoomDependentExpression",qw),o1("ZoomConstantExpression",m8),o1("CompoundExpression",v3,{omit:["_evaluate"]});for(let w in K7)K7[w]._classRegistryKey||o1(`Expression_${w}`,K7[w]);function nz(w){return w&&typeof ArrayBuffer<"u"&&(w instanceof ArrayBuffer||w.constructor&&w.constructor.name==="ArrayBuffer")}function e4(w){return w.$name||w.constructor._classRegistryKey}function hg(w){return!function(f){if(f===null||typeof f!="object")return!1;let q=e4(f);return!(!q||q==="Object")}(w)&&(w==null||typeof w=="boolean"||typeof w=="number"||typeof w=="string"||w instanceof Boolean||w instanceof Number||w instanceof String||w instanceof Date||w instanceof RegExp||w instanceof Blob||w instanceof Error||nz(w)||O2(w)||ArrayBuffer.isView(w)||w instanceof ImageData)}function O6(w,f){if(hg(w))return(nz(w)||O2(w))&&f&&f.push(w),ArrayBuffer.isView(w)&&f&&f.push(w.buffer),w instanceof ImageData&&f&&f.push(w.data.buffer),w;if(Array.isArray(w)){let M=[];for(let A of w)M.push(O6(A,f));return M}if(typeof w!="object")throw Error("can't serialize object of type "+typeof w);let q=e4(w);if(!q)throw Error(`can't serialize object of unregistered class ${w.constructor.name}`);if(!O4[q])throw Error(`${q} is not registered.`);let{klass:v}=O4[q],H=v.serialize?v.serialize(w,f):{};if(v.serialize){if(f&&H===f[f.length-1])throw Error("statically serialized object won't survive transfer of $name property")}else{for(let M in w){if(!w.hasOwnProperty(M))continue;if(O4[q].omit.indexOf(M)>=0)continue;let A=w[M];H[M]=O4[q].shallow.indexOf(M)>=0?A:O6(A,f)}w instanceof Error&&(H.message=w.message)}if(H.$name)throw Error("$name property is reserved for worker serialization logic.");return q!=="Object"&&(H.$name=q),H}function w7(w){if(hg(w))return w;if(Array.isArray(w))return w.map(w7);if(typeof w!="object")throw Error("can't deserialize object of type "+typeof w);let f=e4(w)||"Object";if(!O4[f])throw Error(`can't deserialize unregistered class ${f}`);let{klass:q}=O4[f];if(!q)throw Error(`can't deserialize unregistered class ${f}`);if(q.deserialize)return q.deserialize(w);let v=Object.create(q.prototype);for(let H of Object.keys(w)){if(H==="$name")continue;let M=w[H];v[H]=O4[f].shallow.indexOf(H)>=0?M:w7(M)}return v}class u8{constructor(){this.first=!0}update(w,f){let q=Math.floor(w);return this.first?(this.first=!1,this.lastIntegerZoom=q,this.lastIntegerZoomTime=0,this.lastZoom=w,this.lastFloorZoom=q,!0):(this.lastFloorZoom>q?(this.lastIntegerZoom=q+1,this.lastIntegerZoomTime=f):this.lastFloorZoom<q&&(this.lastIntegerZoom=q,this.lastIntegerZoomTime=f),w!==this.lastZoom&&(this.lastZoom=w,this.lastFloorZoom=q,!0))}}let O0={"Latin-1 Supplement":(w)=>w>=128&&w<=255,"Hangul Jamo":(w)=>w>=4352&&w<=4607,Khmer:(w)=>w>=6016&&w<=6143,"General Punctuation":(w)=>w>=8192&&w<=8303,"Letterlike Symbols":(w)=>w>=8448&&w<=8527,"Number Forms":(w)=>w>=8528&&w<=8591,"Miscellaneous Technical":(w)=>w>=8960&&w<=9215,"Control Pictures":(w)=>w>=9216&&w<=9279,"Optical Character Recognition":(w)=>w>=9280&&w<=9311,"Enclosed Alphanumerics":(w)=>w>=9312&&w<=9471,"Geometric Shapes":(w)=>w>=9632&&w<=9727,"Miscellaneous Symbols":(w)=>w>=9728&&w<=9983,"Miscellaneous Symbols and Arrows":(w)=>w>=11008&&w<=11263,"Ideographic Description Characters":(w)=>w>=12272&&w<=12287,"CJK Symbols and Punctuation":(w)=>w>=12288&&w<=12351,Hiragana:(w)=>w>=12352&&w<=12447,Katakana:(w)=>w>=12448&&w<=12543,Kanbun:(w)=>w>=12688&&w<=12703,"CJK Strokes":(w)=>w>=12736&&w<=12783,"Enclosed CJK Letters and Months":(w)=>w>=12800&&w<=13055,"CJK Compatibility":(w)=>w>=13056&&w<=13311,"Yijing Hexagram Symbols":(w)=>w>=19904&&w<=19967,"CJK Unified Ideographs":(w)=>w>=19968&&w<=40959,"Hangul Syllables":(w)=>w>=44032&&w<=55215,"Private Use Area":(w)=>w>=57344&&w<=63743,"Vertical Forms":(w)=>w>=65040&&w<=65055,"CJK Compatibility Forms":(w)=>w>=65072&&w<=65103,"Small Form Variants":(w)=>w>=65104&&w<=65135,"Halfwidth and Fullwidth Forms":(w)=>w>=65280&&w<=65519};function y6(w){for(let f of w)if(c8(f.charCodeAt(0)))return!0;return!1}function sz(w){for(let f of w)if(!Fg(f.charCodeAt(0)))return!1;return!0}function p8(w){let f=w.map((q)=>{try{return new RegExp(`\\p{sc=${q}}`,"u").source}catch(v){return null}}).filter((q)=>q);return new RegExp(f.join("|"),"u")}let iz=p8(["Arab","Dupl","Mong","Ougr","Syrc"]);function Fg(w){return!iz.test(String.fromCodePoint(w))}let Uw=p8(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function c8(w){return!(w!==746&&w!==747&&(w<4352||!(O0["CJK Compatibility Forms"](w)&&!(w>=65097&&w<=65103)||O0["CJK Compatibility"](w)||O0["CJK Strokes"](w)||!(!O0["CJK Symbols and Punctuation"](w)||w>=12296&&w<=12305||w>=12308&&w<=12319||w===12336)||O0["Enclosed CJK Letters and Months"](w)||O0["Ideographic Description Characters"](w)||O0.Kanbun(w)||O0.Katakana(w)&&w!==12540||!(!O0["Halfwidth and Fullwidth Forms"](w)||w===65288||w===65289||w===65293||w>=65306&&w<=65310||w===65339||w===65341||w===65343||w>=65371&&w<=65503||w===65507||w>=65512&&w<=65519)||!(!O0["Small Form Variants"](w)||w>=65112&&w<=65118||w>=65123&&w<=65126)||O0["Vertical Forms"](w)||O0["Yijing Hexagram Symbols"](w)||/\p{sc=Cans}/u.test(String.fromCodePoint(w))||/\p{sc=Hang}/u.test(String.fromCodePoint(w))||Uw.test(String.fromCodePoint(w)))))}function tz(w){return!(c8(w)||function(f){return!!(O0["Latin-1 Supplement"](f)&&(f===167||f===169||f===174||f===177||f===188||f===189||f===190||f===215||f===247)||O0["General Punctuation"](f)&&(f===8214||f===8224||f===8225||f===8240||f===8241||f===8251||f===8252||f===8258||f===8263||f===8264||f===8265||f===8273)||O0["Letterlike Symbols"](f)||O0["Number Forms"](f)||O0["Miscellaneous Technical"](f)&&(f>=8960&&f<=8967||f>=8972&&f<=8991||f>=8996&&f<=9000||f===9003||f>=9085&&f<=9114||f>=9150&&f<=9165||f===9167||f>=9169&&f<=9179||f>=9186&&f<=9215)||O0["Control Pictures"](f)&&f!==9251||O0["Optical Character Recognition"](f)||O0["Enclosed Alphanumerics"](f)||O0["Geometric Shapes"](f)||O0["Miscellaneous Symbols"](f)&&!(f>=9754&&f<=9759)||O0["Miscellaneous Symbols and Arrows"](f)&&(f>=11026&&f<=11055||f>=11088&&f<=11097||f>=11192&&f<=11243)||O0["CJK Symbols and Punctuation"](f)||O0.Katakana(f)||O0["Private Use Area"](f)||O0["CJK Compatibility Forms"](f)||O0["Small Form Variants"](f)||O0["Halfwidth and Fullwidth Forms"](f)||f===8734||f===8756||f===8757||f>=9984&&f<=10087||f>=10102&&f<=10131||f===65532||f===65533)}(w))}let Kg=p8(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function ez(w){return Kg.test(String.fromCodePoint(w))}function wx(w,f){return!(!f&&ez(w)||w>=2304&&w<=3583||w>=3840&&w<=4255||O0.Khmer(w))}function dZ(w){for(let f of w)if(ez(f.charCodeAt(0)))return!0;return!1}let v4=new class{constructor(){this.TIMEOUT=5000,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(w){this.pluginStatus=w.pluginStatus,this.pluginURL=w.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(w){if(v4.isParsed())throw Error("RTL text plugin already registered.");this.applyArabicShaping=w.applyArabicShaping,this.processBidirectionalText=w.processBidirectionalText,this.processStyledBidirectionalText=w.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(w,f){return Z(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(w.pluginStatus!=="loading")return this.setState(w),w;let q=w.pluginURL,v=new Promise((M)=>{this.loadScriptResolve=M});f(q);let H=new Promise((M)=>setTimeout(()=>M(),this.TIMEOUT));if(yield Promise.race([v,H]),this.isParsed()){let M={pluginStatus:"loaded",pluginURL:q};return this.setState(M),M}throw this.setState({pluginStatus:"error",pluginURL:""}),Error(`RTL Text Plugin failed to import scripts from ${q}`)})}};class n0{constructor(w,f){this.isSupportedScript=bx,this.zoom=w,f?(this.now=f.now||0,this.fadeDuration=f.fadeDuration||0,this.zoomHistory=f.zoomHistory||new u8,this.transition=f.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new u8,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let w=this.zoom,f=w-Math.floor(w),q=this.crossFadingFactor();return w>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:f+(1-f)*q}:{fromScale:0.5,toScale:1,t:1-(1-q)*f}}}function bx(w){return function(f,q){for(let v of f)if(!wx(v.charCodeAt(0),q))return!1;return!0}(w,v4.getRTLTextPluginStatus()==="loaded")}class R6{constructor(w,f,q){this.property=w,this.value=f,this.expression=function(v,H,M){if(D7(v))return new _8(v,H);if(zw(v)){let A=jz(v,H,M);if(A.result==="error")throw Error(A.value.map((Q)=>`${Q.key}: ${Q.message}`).join(", "));return A.value}{let A=v;return H.type==="color"&&typeof v=="string"?A=h0.parse(v):H.type!=="padding"||typeof v!="number"&&!Array.isArray(v)?H.type!=="numberArray"||typeof v!="number"&&!Array.isArray(v)?H.type!=="colorArray"||typeof v!="string"&&!Array.isArray(v)?H.type==="variableAnchorOffsetCollection"&&Array.isArray(v)?A=Q2.parse(v):H.type==="projectionDefinition"&&typeof v=="string"&&(A=g3.parse(v)):A=p5.parse(v):A=y2.parse(v):A=z2.parse(v),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>A}}}(f===void 0?w.specification.default:f,w.specification,q)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(w,f,q){return this.property.possiblyEvaluate(this,w,f,q)}}class N6{constructor(w,f){this.property=w,this.value=new R6(w,void 0,f)}transitioned(w,f){return new r8(this.property,this.value,f,s0({},w.transition,this.transition),w.now)}untransitioned(){return new r8(this.property,this.value,null,{},0)}}class a8{constructor(w,f){this._properties=w,this._values=Object.create(w.defaultTransitionablePropertyValues),this._globalState=f}getValue(w){return h5(this._values[w].value.value)}setValue(w,f){Object.prototype.hasOwnProperty.call(this._values,w)||(this._values[w]=new N6(this._values[w].property,this._globalState)),this._values[w].value=new R6(this._values[w].property,f===null?void 0:h5(f),this._globalState)}getTransition(w){return h5(this._values[w].transition)}setTransition(w,f){Object.prototype.hasOwnProperty.call(this._values,w)||(this._values[w]=new N6(this._values[w].property,this._globalState)),this._values[w].transition=h5(f)||void 0}serialize(){let w={};for(let f of Object.keys(this._values)){let q=this.getValue(f);q!==void 0&&(w[f]=q);let v=this.getTransition(f);v!==void 0&&(w[`${f}-transition`]=v)}return w}transitioned(w,f){let q=new o8(this._properties);for(let v of Object.keys(this._values))q._values[v]=this._values[v].transitioned(w,f._values[v]);return q}untransitioned(){let w=new o8(this._properties);for(let f of Object.keys(this._values))w._values[f]=this._values[f].untransitioned();return w}}class r8{constructor(w,f,q,v,H){this.property=w,this.value=f,this.begin=H+v.delay||0,this.end=this.begin+v.duration||0,w.specification.transition&&(v.delay||v.duration)&&(this.prior=q)}possiblyEvaluate(w,f,q){let v=w.now||0,H=this.value.possiblyEvaluate(w,f,q),M=this.prior;if(M){if(v>this.end)return this.prior=null,H;if(this.value.isDataDriven())return this.prior=null,H;if(v<this.begin)return M.possiblyEvaluate(w,f,q);{let A=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(M.possiblyEvaluate(w,f,q),H,R5(A))}}return H}}class o8{constructor(w){this._properties=w,this._values=Object.create(w.defaultTransitioningPropertyValues)}possiblyEvaluate(w,f,q){let v=new O7(this._properties);for(let H of Object.keys(this._values))v._values[H]=this._values[H].possiblyEvaluate(w,f,q);return v}hasTransition(){for(let w of Object.keys(this._values))if(this._values[w].prior)return!0;return!1}}class n8{constructor(w,f){this._properties=w,this._values=Object.create(w.defaultPropertyValues),this._globalState=f}hasValue(w){return this._values[w].value!==void 0}getValue(w){return h5(this._values[w].value)}setValue(w,f){this._values[w]=new R6(this._values[w].property,f===null?void 0:h5(f),this._globalState)}serialize(){let w={};for(let f of Object.keys(this._values)){let q=this.getValue(f);q!==void 0&&(w[f]=q)}return w}possiblyEvaluate(w,f,q){let v=new O7(this._properties);for(let H of Object.keys(this._values))v._values[H]=this._values[H].possiblyEvaluate(w,f,q);return v}}class K3{constructor(w,f,q){this.property=w,this.value=f,this.parameters=q}isConstant(){return this.value.kind==="constant"}constantOr(w){return this.value.kind==="constant"?this.value.value:w}evaluate(w,f,q,v){return this.property.evaluate(this.value,this.parameters,w,f,q,v)}}class O7{constructor(w){this._properties=w,this._values=Object.create(w.defaultPossiblyEvaluatedValues)}get(w){return this._values[w]}}class e1{constructor(w){this.specification=w}possiblyEvaluate(w,f){if(w.isDataDriven())throw Error("Value should not be data driven");return w.expression.evaluate(f)}interpolate(w,f,q){let v=m2[this.specification.type];return v?v(w,f,q):w}}class Y0{constructor(w,f){this.specification=w,this.overrides=f}possiblyEvaluate(w,f,q,v){return new K3(this,w.expression.kind==="constant"||w.expression.kind==="camera"?{kind:"constant",value:w.expression.evaluate(f,null,{},q,v)}:w.expression,f)}interpolate(w,f,q){if(w.value.kind!=="constant"||f.value.kind!=="constant")return w;if(w.value.value===void 0||f.value.value===void 0)return new K3(this,{kind:"constant",value:void 0},w.parameters);let v=m2[this.specification.type];if(v){let H=v(w.value.value,f.value.value,q);return new K3(this,{kind:"constant",value:H},w.parameters)}return w}evaluate(w,f,q,v,H,M){return w.kind==="constant"?w.value:w.evaluate(f,q,v,H,M)}}class y7 extends Y0{possiblyEvaluate(w,f,q,v){if(w.value===void 0)return new K3(this,{kind:"constant",value:void 0},f);if(w.expression.kind==="constant"){let H=w.expression.evaluate(f,null,{},q,v),M=w.property.specification.type==="resolvedImage"&&typeof H!="string"?H.name:H,A=this._calculate(M,M,M,f);return new K3(this,{kind:"constant",value:A},f)}if(w.expression.kind==="camera"){let H=this._calculate(w.expression.evaluate({zoom:f.zoom-1}),w.expression.evaluate({zoom:f.zoom}),w.expression.evaluate({zoom:f.zoom+1}),f);return new K3(this,{kind:"constant",value:H},f)}return new K3(this,w.expression,f)}evaluate(w,f,q,v,H,M){if(w.kind==="source"){let A=w.evaluate(f,q,v,H,M);return this._calculate(A,A,A,f)}return w.kind==="composite"?this._calculate(w.evaluate({zoom:Math.floor(f.zoom)-1},q,v),w.evaluate({zoom:Math.floor(f.zoom)},q,v),w.evaluate({zoom:Math.floor(f.zoom)+1},q,v),f):w.value}_calculate(w,f,q,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:w,to:f}:{from:q,to:f}}interpolate(w){return w}}class s8{constructor(w){this.specification=w}possiblyEvaluate(w,f,q,v){if(w.value!==void 0){if(w.expression.kind==="constant"){let H=w.expression.evaluate(f,null,{},q,v);return this._calculate(H,H,H,f)}return this._calculate(w.expression.evaluate(new n0(Math.floor(f.zoom-1),f)),w.expression.evaluate(new n0(Math.floor(f.zoom),f)),w.expression.evaluate(new n0(Math.floor(f.zoom+1),f)),f)}}_calculate(w,f,q,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:w,to:f}:{from:q,to:f}}interpolate(w){return w}}class R7{constructor(w){this.specification=w}possiblyEvaluate(w,f,q,v){return!!w.expression.evaluate(f,null,{},q,v)}interpolate(){return!1}}class W2{constructor(w){this.properties=w,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let f in w){let q=w[f];q.specification.overridable&&this.overridableProperties.push(f);let v=this.defaultPropertyValues[f]=new R6(q,void 0,void 0),H=this.defaultTransitionablePropertyValues[f]=new N6(q,void 0);this.defaultTransitioningPropertyValues[f]=H.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=v.possiblyEvaluate({})}}}o1("DataDrivenProperty",Y0),o1("DataConstantProperty",e1),o1("CrossFadedDataDrivenProperty",y7),o1("CrossFadedProperty",s8),o1("ColorRampProperty",R7);let gx="-transition";class G3 extends w0{constructor(w,f,q){if(super(),this.id=w.id,this.type=w.type,this._globalState=q,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},w.type!=="custom"&&(this.metadata=w.metadata,this.minzoom=w.minzoom,this.maxzoom=w.maxzoom,w.type!=="background"&&(this.source=w.source,this.sourceLayer=w["source-layer"],this.filter=w.filter,this._featureFilter=h6(w.filter,q)),f.layout&&(this._unevaluatedLayout=new n8(f.layout,q)),f.paint)){this._transitionablePaint=new a8(f.paint,q);for(let v in w.paint)this.setPaintProperty(v,w.paint[v],{validate:!1});for(let v in w.layout)this.setLayoutProperty(v,w.layout[v],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new O7(f.paint)}}setFilter(w){this.filter=w,this._featureFilter=h6(w,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(w){return w==="visibility"?this.visibility:this._unevaluatedLayout.getValue(w)}getLayoutAffectingGlobalStateRefs(){let w=new Set;if(this._unevaluatedLayout)for(let f in this._unevaluatedLayout._values){let q=this._unevaluatedLayout._values[f];for(let v of q.getGlobalStateRefs())w.add(v)}for(let f of this._featureFilter.getGlobalStateRefs())w.add(f);return w}getPaintAffectingGlobalStateRefs(){var w;let f=new globalThis.Map;if(this._transitionablePaint)for(let q in this._transitionablePaint._values){let v=this._transitionablePaint._values[q].value;for(let H of v.getGlobalStateRefs()){let M=(w=f.get(H))!==null&&w!==void 0?w:[];M.push({name:q,value:v.value}),f.set(H,M)}}return f}setLayoutProperty(w,f,q={}){f!=null&&this._validate(Hw,`layers.${this.id}.layout.${w}`,w,f,q)||(w!=="visibility"?this._unevaluatedLayout.setValue(w,f):this.visibility=f)}getPaintProperty(w){return w.endsWith(gx)?this._transitionablePaint.getTransition(w.slice(0,-11)):this._transitionablePaint.getValue(w)}setPaintProperty(w,f,q={}){if(f!=null&&this._validate(oz,`layers.${this.id}.paint.${w}`,w,f,q))return!1;if(w.endsWith(gx))return this._transitionablePaint.setTransition(w.slice(0,-11),f||void 0),!1;{let v=this._transitionablePaint._values[w],H=v.property.specification["property-type"]==="cross-faded-data-driven",M=v.value.isDataDriven(),A=v.value;this._transitionablePaint.setValue(w,f),this._handleSpecialPaintPropertyUpdate(w);let Q=this._transitionablePaint._values[w].value;return Q.isDataDriven()||M||H||this._handleOverridablePaintPropertyUpdate(w,A,Q)}}_handleSpecialPaintPropertyUpdate(w){}_handleOverridablePaintPropertyUpdate(w,f,q){return!1}isHidden(w,f=!1){return!!(this.minzoom&&w<(f?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&w>=this.maxzoom)||this.visibility==="none"}updateTransitions(w){this._transitioningPaint=this._transitionablePaint.transitioned(w,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(w,f){w.getCrossfadeParameters&&(this._crossfadeParameters=w.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(w,void 0,f)),this.paint=this._transitioningPaint.possiblyEvaluate(w,void 0,f)}serialize(){let w={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(w.layout=w.layout||{},w.layout.visibility=this.visibility),M2(w,(f,q)=>!(f===void 0||q==="layout"&&!Object.keys(f).length||q==="paint"&&!Object.keys(f).length))}_validate(w,f,q,v,H={}){return(!H||H.validate!==!1)&&Wg(this,w.call(P3,{key:f,layerType:this.type,objectKey:q,value:v,styleSpec:M1,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let w in this.paint._values){let f=this.paint.get(w);if(f instanceof K3&&C7(f.property.specification)&&(f.value.kind==="source"||f.value.kind==="composite")&&f.value.isStateDependent)return!0}return!1}}let lg;var fx={get paint(){return lg=lg||new W2({"raster-opacity":new e1(M1.paint_raster["raster-opacity"]),"raster-hue-rotate":new e1(M1.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new e1(M1.paint_raster["raster-brightness-min"]),"raster-brightness-max":new e1(M1.paint_raster["raster-brightness-max"]),"raster-saturation":new e1(M1.paint_raster["raster-saturation"]),"raster-contrast":new e1(M1.paint_raster["raster-contrast"]),"raster-resampling":new e1(M1.paint_raster["raster-resampling"]),"raster-fade-duration":new e1(M1.paint_raster["raster-fade-duration"])})}};class N7 extends G3{constructor(w,f){super(w,fx,f)}}let zx={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class I6{constructor(w,f){this._structArray=w,this._pos1=f*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class B5{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(w,f){return w._trim(),f&&(w.isTransferred=!0,f.push(w.arrayBuffer)),{length:w.length,arrayBuffer:w.arrayBuffer}}static deserialize(w){let f=Object.create(this.prototype);return f.arrayBuffer=w.arrayBuffer,f.length=w.length,f.capacity=w.arrayBuffer.byteLength/f.bytesPerElement,f._refreshViews(),f}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(w){this.reserve(w),this.length=w}reserve(w){if(w>this.capacity){this.capacity=Math.max(w,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let f=this.uint8;this._refreshViews(),f&&this.uint8.set(f)}}_refreshViews(){throw Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function K5(w,f=1){let q=0,v=0;return{members:w.map((H)=>{let M=zx[H.type].BYTES_PER_ELEMENT,A=q=xx(q,Math.max(f,M)),Q=H.components||1;return v=Math.max(v,M),q+=M*Q,{name:H.name,type:H.type,components:Q,offset:A}}),size:xx(q,Math.max(v,f)),alignment:f}}function xx(w,f){return Math.ceil(w/f)*f}class I7 extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(w,f){let q=this.length;return this.resize(q+1),this.emplace(q,w,f)}emplace(w,f,q){let v=2*w;return this.int16[v+0]=f,this.int16[v+1]=q,w}}I7.prototype.bytesPerElement=4,o1("StructArrayLayout2i4",I7);class E3 extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(w,f,q){let v=this.length;return this.resize(v+1),this.emplace(v,w,f,q)}emplace(w,f,q,v){let H=3*w;return this.int16[H+0]=f,this.int16[H+1]=q,this.int16[H+2]=v,w}}E3.prototype.bytesPerElement=6,o1("StructArrayLayout3i6",E3);class i8 extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(w,f,q,v){let H=this.length;return this.resize(H+1),this.emplace(H,w,f,q,v)}emplace(w,f,q,v,H){let M=4*w;return this.int16[M+0]=f,this.int16[M+1]=q,this.int16[M+2]=v,this.int16[M+3]=H,w}}i8.prototype.bytesPerElement=8,o1("StructArrayLayout4i8",i8);class S6 extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(w,f,q,v,H,M){let A=this.length;return this.resize(A+1),this.emplace(A,w,f,q,v,H,M)}emplace(w,f,q,v,H,M,A){let Q=6*w;return this.int16[Q+0]=f,this.int16[Q+1]=q,this.int16[Q+2]=v,this.int16[Q+3]=H,this.int16[Q+4]=M,this.int16[Q+5]=A,w}}S6.prototype.bytesPerElement=12,o1("StructArrayLayout2i4i12",S6);class t8 extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(w,f,q,v,H,M){let A=this.length;return this.resize(A+1),this.emplace(A,w,f,q,v,H,M)}emplace(w,f,q,v,H,M,A){let Q=4*w,W=8*w;return this.int16[Q+0]=f,this.int16[Q+1]=q,this.uint8[W+4]=v,this.uint8[W+5]=H,this.uint8[W+6]=M,this.uint8[W+7]=A,w}}t8.prototype.bytesPerElement=8,o1("StructArrayLayout2i4ub8",t8);class y4 extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(w,f){let q=this.length;return this.resize(q+1),this.emplace(q,w,f)}emplace(w,f,q){let v=2*w;return this.float32[v+0]=f,this.float32[v+1]=q,w}}y4.prototype.bytesPerElement=8,o1("StructArrayLayout2f8",y4);class Bw extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(w,f,q,v,H,M,A,Q,W,h){let K=this.length;return this.resize(K+1),this.emplace(K,w,f,q,v,H,M,A,Q,W,h)}emplace(w,f,q,v,H,M,A,Q,W,h,K){let D=10*w;return this.uint16[D+0]=f,this.uint16[D+1]=q,this.uint16[D+2]=v,this.uint16[D+3]=H,this.uint16[D+4]=M,this.uint16[D+5]=A,this.uint16[D+6]=Q,this.uint16[D+7]=W,this.uint16[D+8]=h,this.uint16[D+9]=K,w}}Bw.prototype.bytesPerElement=20,o1("StructArrayLayout10ui20",Bw);class S7 extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(w,f,q,v,H,M,A,Q){let W=this.length;return this.resize(W+1),this.emplace(W,w,f,q,v,H,M,A,Q)}emplace(w,f,q,v,H,M,A,Q,W){let h=8*w;return this.uint16[h+0]=f,this.uint16[h+1]=q,this.uint16[h+2]=v,this.uint16[h+3]=H,this.uint16[h+4]=M,this.uint16[h+5]=A,this.uint16[h+6]=Q,this.uint16[h+7]=W,w}}S7.prototype.bytesPerElement=16,o1("StructArrayLayout8ui16",S7);class b7 extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(w,f,q,v,H,M,A,Q,W,h,K,D){let $=this.length;return this.resize($+1),this.emplace($,w,f,q,v,H,M,A,Q,W,h,K,D)}emplace(w,f,q,v,H,M,A,Q,W,h,K,D,$){let R=12*w;return this.int16[R+0]=f,this.int16[R+1]=q,this.int16[R+2]=v,this.int16[R+3]=H,this.uint16[R+4]=M,this.uint16[R+5]=A,this.uint16[R+6]=Q,this.uint16[R+7]=W,this.int16[R+8]=h,this.int16[R+9]=K,this.int16[R+10]=D,this.int16[R+11]=$,w}}b7.prototype.bytesPerElement=24,o1("StructArrayLayout4i4ui4i24",b7);class Aw extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(w,f,q){let v=this.length;return this.resize(v+1),this.emplace(v,w,f,q)}emplace(w,f,q,v){let H=3*w;return this.float32[H+0]=f,this.float32[H+1]=q,this.float32[H+2]=v,w}}Aw.prototype.bytesPerElement=12,o1("StructArrayLayout3f12",Aw);class e8 extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(w){let f=this.length;return this.resize(f+1),this.emplace(f,w)}emplace(w,f){return this.uint32[1*w+0]=f,w}}e8.prototype.bytesPerElement=4,o1("StructArrayLayout1ul4",e8);class g7 extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(w,f,q,v,H,M,A,Q,W){let h=this.length;return this.resize(h+1),this.emplace(h,w,f,q,v,H,M,A,Q,W)}emplace(w,f,q,v,H,M,A,Q,W,h){let K=10*w,D=5*w;return this.int16[K+0]=f,this.int16[K+1]=q,this.int16[K+2]=v,this.int16[K+3]=H,this.int16[K+4]=M,this.int16[K+5]=A,this.uint32[D+3]=Q,this.uint16[K+8]=W,this.uint16[K+9]=h,w}}g7.prototype.bytesPerElement=20,o1("StructArrayLayout6i1ul2ui20",g7);class Mw extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(w,f,q,v,H,M){let A=this.length;return this.resize(A+1),this.emplace(A,w,f,q,v,H,M)}emplace(w,f,q,v,H,M,A){let Q=6*w;return this.int16[Q+0]=f,this.int16[Q+1]=q,this.int16[Q+2]=v,this.int16[Q+3]=H,this.int16[Q+4]=M,this.int16[Q+5]=A,w}}Mw.prototype.bytesPerElement=12,o1("StructArrayLayout2i2i2i12",Mw);class Xw extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(w,f,q,v,H){let M=this.length;return this.resize(M+1),this.emplace(M,w,f,q,v,H)}emplace(w,f,q,v,H,M){let A=4*w,Q=8*w;return this.float32[A+0]=f,this.float32[A+1]=q,this.float32[A+2]=v,this.int16[Q+6]=H,this.int16[Q+7]=M,w}}Xw.prototype.bytesPerElement=16,o1("StructArrayLayout2f1f2i16",Xw);class w9 extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(w,f,q,v,H,M){let A=this.length;return this.resize(A+1),this.emplace(A,w,f,q,v,H,M)}emplace(w,f,q,v,H,M,A){let Q=16*w,W=4*w,h=8*w;return this.uint8[Q+0]=f,this.uint8[Q+1]=q,this.float32[W+1]=v,this.float32[W+2]=H,this.int16[h+6]=M,this.int16[h+7]=A,w}}w9.prototype.bytesPerElement=16,o1("StructArrayLayout2ub2f2i16",w9);class b9 extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(w,f,q){let v=this.length;return this.resize(v+1),this.emplace(v,w,f,q)}emplace(w,f,q,v){let H=3*w;return this.uint16[H+0]=f,this.uint16[H+1]=q,this.uint16[H+2]=v,w}}b9.prototype.bytesPerElement=6,o1("StructArrayLayout3ui6",b9);class b extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(w,f,q,v,H,M,A,Q,W,h,K,D,$,R,_,j,o){let t=this.length;return this.resize(t+1),this.emplace(t,w,f,q,v,H,M,A,Q,W,h,K,D,$,R,_,j,o)}emplace(w,f,q,v,H,M,A,Q,W,h,K,D,$,R,_,j,o,t){let U1=24*w,g1=12*w,G1=48*w;return this.int16[U1+0]=f,this.int16[U1+1]=q,this.uint16[U1+2]=v,this.uint16[U1+3]=H,this.uint32[g1+2]=M,this.uint32[g1+3]=A,this.uint32[g1+4]=Q,this.uint16[U1+10]=W,this.uint16[U1+11]=h,this.uint16[U1+12]=K,this.float32[g1+7]=D,this.float32[g1+8]=$,this.uint8[G1+36]=R,this.uint8[G1+37]=_,this.uint8[G1+38]=j,this.uint32[g1+10]=o,this.int16[U1+22]=t,w}}b.prototype.bytesPerElement=48,o1("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",b);class z extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(w,f,q,v,H,M,A,Q,W,h,K,D,$,R,_,j,o,t,U1,g1,G1,h1,K1,j1,T1,_1,t1,c1){let a1=this.length;return this.resize(a1+1),this.emplace(a1,w,f,q,v,H,M,A,Q,W,h,K,D,$,R,_,j,o,t,U1,g1,G1,h1,K1,j1,T1,_1,t1,c1)}emplace(w,f,q,v,H,M,A,Q,W,h,K,D,$,R,_,j,o,t,U1,g1,G1,h1,K1,j1,T1,_1,t1,c1,a1){let S1=32*w,E1=16*w;return this.int16[S1+0]=f,this.int16[S1+1]=q,this.int16[S1+2]=v,this.int16[S1+3]=H,this.int16[S1+4]=M,this.int16[S1+5]=A,this.int16[S1+6]=Q,this.int16[S1+7]=W,this.uint16[S1+8]=h,this.uint16[S1+9]=K,this.uint16[S1+10]=D,this.uint16[S1+11]=$,this.uint16[S1+12]=R,this.uint16[S1+13]=_,this.uint16[S1+14]=j,this.uint16[S1+15]=o,this.uint16[S1+16]=t,this.uint16[S1+17]=U1,this.uint16[S1+18]=g1,this.uint16[S1+19]=G1,this.uint16[S1+20]=h1,this.uint16[S1+21]=K1,this.uint16[S1+22]=j1,this.uint32[E1+12]=T1,this.float32[E1+13]=_1,this.float32[E1+14]=t1,this.uint16[S1+30]=c1,this.uint16[S1+31]=a1,w}}z.prototype.bytesPerElement=64,o1("StructArrayLayout8i15ui1ul2f2ui64",z);class k extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(w){let f=this.length;return this.resize(f+1),this.emplace(f,w)}emplace(w,f){return this.float32[1*w+0]=f,w}}k.prototype.bytesPerElement=4,o1("StructArrayLayout1f4",k);class J extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(w,f,q){let v=this.length;return this.resize(v+1),this.emplace(v,w,f,q)}emplace(w,f,q,v){let H=3*w;return this.uint16[6*w+0]=f,this.float32[H+1]=q,this.float32[H+2]=v,w}}J.prototype.bytesPerElement=12,o1("StructArrayLayout1ui2f12",J);class B extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(w,f,q){let v=this.length;return this.resize(v+1),this.emplace(v,w,f,q)}emplace(w,f,q,v){let H=4*w;return this.uint32[2*w+0]=f,this.uint16[H+2]=q,this.uint16[H+3]=v,w}}B.prototype.bytesPerElement=8,o1("StructArrayLayout1ul2ui8",B);class X extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(w,f){let q=this.length;return this.resize(q+1),this.emplace(q,w,f)}emplace(w,f,q){let v=2*w;return this.uint16[v+0]=f,this.uint16[v+1]=q,w}}X.prototype.bytesPerElement=4,o1("StructArrayLayout2ui4",X);class V extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(w){let f=this.length;return this.resize(f+1),this.emplace(f,w)}emplace(w,f){return this.uint16[1*w+0]=f,w}}V.prototype.bytesPerElement=2,o1("StructArrayLayout1ui2",V);class L extends B5{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(w,f,q,v){let H=this.length;return this.resize(H+1),this.emplace(H,w,f,q,v)}emplace(w,f,q,v,H){let M=4*w;return this.float32[M+0]=f,this.float32[M+1]=q,this.float32[M+2]=v,this.float32[M+3]=H,w}}L.prototype.bytesPerElement=16,o1("StructArrayLayout4f16",L);class F extends I6{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new l(this.anchorPointX,this.anchorPointY)}}F.prototype.size=20;class C extends g7{get(w){return new F(this,w)}}o1("CollisionBoxArray",C);class O extends I6{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(w){this._structArray.uint8[this._pos1+37]=w}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(w){this._structArray.uint8[this._pos1+38]=w}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(w){this._structArray.uint32[this._pos4+10]=w}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}O.prototype.size=48;class d extends b{get(w){return new O(this,w)}}o1("PlacedSymbolArray",d);class y extends I6{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(w){this._structArray.uint32[this._pos4+12]=w}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}y.prototype.size=64;class T extends z{get(w){return new y(this,w)}}o1("SymbolInstanceArray",T);class E extends k{getoffsetX(w){return this.float32[1*w+0]}}o1("GlyphOffsetArray",E);class p extends E3{getx(w){return this.int16[3*w+0]}gety(w){return this.int16[3*w+1]}gettileUnitDistanceFromAnchor(w){return this.int16[3*w+2]}}o1("SymbolLineVertexArray",p);class s extends I6{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}s.prototype.size=12;class c extends J{get(w){return new s(this,w)}}o1("TextAnchorOffsetArray",c);class Z1 extends I6{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Z1.prototype.size=8;class a extends B{get(w){return new Z1(this,w)}}o1("FeatureIndexArray",a);class x1 extends I7{}class i extends I7{}class n extends I7{}class q1 extends S6{}class V1 extends t8{}class W1 extends y4{}class L1 extends Bw{}class Q1 extends S7{}class O1 extends b7{}class I1 extends Aw{}class D1 extends e8{}class n1 extends Mw{}class B0 extends w9{}class W0 extends b9{}class q5 extends X{}let f5=K5([{name:"a_pos",components:2,type:"Int16"}],4),{members:$5}=f5;class V0{constructor(w=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=w}prepareSegment(w,f,q,v){let H=this.segments[this.segments.length-1];return w>V0.MAX_VERTEX_ARRAY_LENGTH&&r0(`Max vertices per segment is ${V0.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${w}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${V0.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!H||H.vertexLength+w>V0.MAX_VERTEX_ARRAY_LENGTH||H.sortKey!==v?this.createNewSegment(f,q,v):H}createNewSegment(w,f,q){let v={vertexOffset:w.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0,vaos:{}};return q!==void 0&&(v.sortKey=q),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(v),v}getOrCreateLatestSegment(w,f,q){return this.prepareSegment(0,w,f,q)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(let w of this.segments)for(let f in w.vaos)w.vaos[f].destroy()}static simpleSegment(w,f,q,v){return new V0([{vertexOffset:w,primitiveOffset:f,vertexLength:q,primitiveLength:v,vaos:{},sortKey:0}])}}function c5(w,f){return 256*(w=U0(Math.floor(w),0,255))+U0(Math.floor(f),0,255)}V0.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,o1("SegmentVector",V0);let A5=K5([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),h2=K5([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var N5,j5,f3,l3={exports:{}},T7={exports:{}},$7={exports:{}},R4=function(){if(f3)return l3.exports;f3=1;var w=(N5||(N5=1,T7.exports=function(q,v){var H,M,A,Q,W,h,K,D;for(M=q.length-(H=3&q.length),A=v,W=3432918353,h=461845907,D=0;D<M;)K=255&q.charCodeAt(D)|(255&q.charCodeAt(++D))<<8|(255&q.charCodeAt(++D))<<16|(255&q.charCodeAt(++D))<<24,++D,A=27492+(65535&(Q=5*(65535&(A=(A^=K=(65535&(K=(K=(65535&K)*W+(((K>>>16)*W&65535)<<16)&4294967295)<<15|K>>>17))*h+(((K>>>16)*h&65535)<<16)&4294967295)<<13|A>>>19))+((5*(A>>>16)&65535)<<16)&4294967295))+((58964+(Q>>>16)&65535)<<16);switch(K=0,H){case 3:K^=(255&q.charCodeAt(D+2))<<16;case 2:K^=(255&q.charCodeAt(D+1))<<8;case 1:A^=K=(65535&(K=(K=(65535&(K^=255&q.charCodeAt(D)))*W+(((K>>>16)*W&65535)<<16)&4294967295)<<15|K>>>17))*h+(((K>>>16)*h&65535)<<16)&4294967295}return A^=q.length,A=2246822507*(65535&(A^=A>>>16))+((2246822507*(A>>>16)&65535)<<16)&4294967295,A=3266489909*(65535&(A^=A>>>13))+((3266489909*(A>>>16)&65535)<<16)&4294967295,(A^=A>>>16)>>>0}),T7.exports),f=(j5||(j5=1,$7.exports=function(q,v){for(var H,M=q.length,A=v^M,Q=0;M>=4;)H=1540483477*(65535&(H=255&q.charCodeAt(Q)|(255&q.charCodeAt(++Q))<<8|(255&q.charCodeAt(++Q))<<16|(255&q.charCodeAt(++Q))<<24))+((1540483477*(H>>>16)&65535)<<16),A=1540483477*(65535&A)+((1540483477*(A>>>16)&65535)<<16)^(H=1540483477*(65535&(H^=H>>>24))+((1540483477*(H>>>16)&65535)<<16)),M-=4,++Q;switch(M){case 3:A^=(255&q.charCodeAt(Q+2))<<16;case 2:A^=(255&q.charCodeAt(Q+1))<<8;case 1:A=1540483477*(65535&(A^=255&q.charCodeAt(Q)))+((1540483477*(A>>>16)&65535)<<16)}return A=1540483477*(65535&(A^=A>>>13))+((1540483477*(A>>>16)&65535)<<16),(A^=A>>>15)>>>0}),$7.exports);return l3.exports=w,l3.exports.murmur3=w,l3.exports.murmur2=f,l3.exports}(),T6=N(R4);class j7{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(w,f,q,v){this.ids.push(Qw(w)),this.positions.push(f,q,v)}getPositions(w){if(!this.indexed)throw Error("Trying to get index, but feature positions are not indexed");let f=Qw(w),q=0,v=this.ids.length-1;for(;q<v;){let M=q+v>>1;this.ids[M]>=f?v=M:q=M+1}let H=[];for(;this.ids[q]===f;)H.push({index:this.positions[3*q],start:this.positions[3*q+1],end:this.positions[3*q+2]}),q++;return H}static serialize(w,f){let q=new Float64Array(w.ids),v=new Uint32Array(w.positions);return P2(q,v,0,q.length-1),f&&f.push(q.buffer,v.buffer),{ids:q,positions:v}}static deserialize(w){let f=new j7;return f.ids=w.ids,f.positions=w.positions,f.indexed=!0,f}}function Qw(w){let f=+w;return!isNaN(f)&&f<=Number.MAX_SAFE_INTEGER?f:T6(String(w))}function P2(w,f,q,v){for(;q<v;){let H=w[q+v>>1],M=q-1,A=v+1;for(;;){do M++;while(w[M]<H);do A--;while(w[A]>H);if(M>=A)break;H3(w,M,A),H3(f,3*M,3*A),H3(f,3*M+1,3*A+1),H3(f,3*M+2,3*A+2)}A-q<v-A?(P2(w,f,q,A),q=A+1):(P2(w,f,A+1,v),v=A)}}function H3(w,f,q){let v=w[f];w[f]=w[q],w[q]=v}o1("FeaturePositionMap",j7);class E2{constructor(w,f){this.gl=w.gl,this.location=f}}class N4 extends E2{constructor(w,f){super(w,f),this.current=0}set(w){this.current!==w&&(this.current=w,this.gl.uniform1f(this.location,w))}}class x2 extends E2{constructor(w,f){super(w,f),this.current=[0,0,0,0]}set(w){w[0]===this.current[0]&&w[1]===this.current[1]&&w[2]===this.current[2]&&w[3]===this.current[3]||(this.current=w,this.gl.uniform4f(this.location,w[0],w[1],w[2],w[3]))}}class m5 extends E2{constructor(w,f){super(w,f),this.current=h0.transparent}set(w){w.r===this.current.r&&w.g===this.current.g&&w.b===this.current.b&&w.a===this.current.a||(this.current=w,this.gl.uniform4f(this.location,w.r,w.g,w.b,w.a))}}let u2=new Float32Array(16);function a5(w){return[c5(255*w.r,255*w.g),c5(255*w.b,255*w.a)]}class f7{constructor(w,f,q){this.value=w,this.uniformNames=f.map((v)=>`u_${v}`),this.type=q}setUniform(w,f,q){w.set(q.constantOr(this.value))}getBinding(w,f,q){return this.type==="color"?new m5(w,f):new N4(w,f)}}class z7{constructor(w,f){this.uniformNames=f.map((q)=>`u_${q}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(w,f){this.pixelRatioFrom=f.pixelRatio,this.pixelRatioTo=w.pixelRatio,this.patternFrom=f.tlbr,this.patternTo=w.tlbr}setConstantDashPositions(w,f){this.dashTo=[0,w.y,w.height,w.width],this.dashFrom=[0,f.y,f.height,f.width]}setUniform(w,f,q,v){let H=null;v==="u_pattern_to"?H=this.patternTo:v==="u_pattern_from"?H=this.patternFrom:v==="u_dasharray_to"?H=this.dashTo:v==="u_dasharray_from"?H=this.dashFrom:v==="u_pixel_ratio_to"?H=this.pixelRatioTo:v==="u_pixel_ratio_from"&&(H=this.pixelRatioFrom),H!==null&&w.set(H)}getBinding(w,f,q){return q.substr(0,9)==="u_pattern"||q.substr(0,12)==="u_dasharray_"?new x2(w,f):new N4(w,f)}}class J4{constructor(w,f,q,v){this.expression=w,this.type=q,this.maxValue=0,this.paintVertexAttributes=f.map((H)=>({name:`a_${H}`,type:"Float32",components:q==="color"?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(w,f,q){let v=this.paintVertexArray.length,H=this.expression.evaluate(new n0(0,q),f,{},q.canonical,[],q.formattedSection);this.paintVertexArray.resize(w),this._setPaintValue(v,w,H)}updatePaintArray(w,f,q,v,H){let M=this.expression.evaluate(new n0(0,H),q,v);this._setPaintValue(w,f,M)}_setPaintValue(w,f,q){if(this.type==="color"){let v=a5(q);for(let H=w;H<f;H++)this.paintVertexArray.emplace(H,v[0],v[1])}else{for(let v=w;v<f;v++)this.paintVertexArray.emplace(v,q);this.maxValue=Math.max(this.maxValue,Math.abs(q))}}upload(w){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=w.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class C3{constructor(w,f,q,v,H,M){this.expression=w,this.uniformNames=f.map((A)=>`u_${A}_t`),this.type=q,this.useIntegerZoom=v,this.zoom=H,this.maxValue=0,this.paintVertexAttributes=f.map((A)=>({name:`a_${A}`,type:"Float32",components:q==="color"?4:2,offset:0})),this.paintVertexArray=new M}populatePaintArray(w,f,q){let v=this.expression.evaluate(new n0(this.zoom,q),f,{},q.canonical,[],q.formattedSection),H=this.expression.evaluate(new n0(this.zoom+1,q),f,{},q.canonical,[],q.formattedSection),M=this.paintVertexArray.length;this.paintVertexArray.resize(w),this._setPaintValue(M,w,v,H)}updatePaintArray(w,f,q,v,H){let M=this.expression.evaluate(new n0(this.zoom,H),q,v),A=this.expression.evaluate(new n0(this.zoom+1,H),q,v);this._setPaintValue(w,f,M,A)}_setPaintValue(w,f,q,v){if(this.type==="color"){let H=a5(q),M=a5(v);for(let A=w;A<f;A++)this.paintVertexArray.emplace(A,H[0],H[1],M[0],M[1])}else{for(let H=w;H<f;H++)this.paintVertexArray.emplace(H,q,v);this.maxValue=Math.max(this.maxValue,Math.abs(q),Math.abs(v))}}upload(w){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=w.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(w,f){let q=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,v=U0(this.expression.interpolationFactor(q,this.zoom,this.zoom+1),0,1);w.set(v)}getBinding(w,f,q){return new N4(w,f)}}class I4{constructor(w,f,q,v,H,M){this.expression=w,this.type=f,this.useIntegerZoom=q,this.zoom=v,this.layerId=M,this.zoomInPaintVertexArray=new H,this.zoomOutPaintVertexArray=new H}populatePaintArray(w,f,q){let v=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(w),this.zoomOutPaintVertexArray.resize(w),this._setPaintValues(v,w,this.getPositionIds(f),q)}updatePaintArray(w,f,q,v,H){this._setPaintValues(w,f,this.getPositionIds(q),H)}_setPaintValues(w,f,q,v){let H=this.getPositions(v);if(!H||!q)return;let M=H[q.min],A=H[q.mid],Q=H[q.max];if(M&&A&&Q)for(let W=w;W<f;W++)this.emplace(this.zoomInPaintVertexArray,W,A,M),this.emplace(this.zoomOutPaintVertexArray,W,A,Q)}upload(w){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){let f=this.getVertexAttributes();this.zoomInPaintVertexBuffer=w.createVertexBuffer(this.zoomInPaintVertexArray,f,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=w.createVertexBuffer(this.zoomOutPaintVertexArray,f,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Cg extends I4{getPositions(w){return w.imagePositions}getPositionIds(w){return w.patterns&&w.patterns[this.layerId]}getVertexAttributes(){return A5.members}emplace(w,f,q,v){w.emplace(f,q.tlbr[0],q.tlbr[1],q.tlbr[2],q.tlbr[3],v.tlbr[0],v.tlbr[1],v.tlbr[2],v.tlbr[3],q.pixelRatio,v.pixelRatio)}}class S4 extends I4{getPositions(w){return w.dashPositions}getPositionIds(w){return w.dashes&&w.dashes[this.layerId]}getVertexAttributes(){return h2.members}emplace(w,f,q,v){w.emplace(f,0,q.y,q.height,q.width,0,v.y,v.height,v.width)}}class Vw{constructor(w,f,q){this.binders={},this._buffers=[];let v=[];for(let H in w.paint._values){if(!q(H))continue;let M=w.paint.get(H);if(!(M instanceof K3&&C7(M.property.specification)))continue;let A=qx(H,w.type),Q=M.value,W=M.property.specification.type,h=M.property.useIntegerZoom,K=M.property.specification["property-type"],D=K==="cross-faded"||K==="cross-faded-data-driven";if(Q.kind==="constant")this.binders[H]=D?new z7(Q.value,A):new f7(Q.value,A,W),v.push(`/u_${H}`);else if(Q.kind==="source"||D){let $=Lw(H,W,"source");this.binders[H]=D?H==="line-dasharray"?new S4(Q,W,h,f,$,w.id):new Cg(Q,W,h,f,$,w.id):new J4(Q,A,W,$),v.push(`/a_${H}`)}else{let $=Lw(H,W,"composite");this.binders[H]=new C3(Q,A,W,h,f,$),v.push(`/z_${H}`)}}this.cacheKey=v.sort().join("")}getMaxValue(w){let f=this.binders[w];return f instanceof J4||f instanceof C3?f.maxValue:0}populatePaintArrays(w,f,q){for(let v in this.binders){let H=this.binders[v];(H instanceof J4||H instanceof C3||H instanceof I4)&&H.populatePaintArray(w,f,q)}}setConstantPatternPositions(w,f){for(let q in this.binders){let v=this.binders[q];v instanceof z7&&v.setConstantPatternPositions(w,f)}}setConstantDashPositions(w,f){for(let q in this.binders){let v=this.binders[q];v instanceof z7&&v.setConstantDashPositions(w,f)}}updatePaintArrays(w,f,q,v,H){let M=!1;for(let A in w){let Q=f.getPositions(A);for(let W of Q){let h=q.feature(W.index);for(let K in this.binders){let D=this.binders[K];if((D instanceof J4||D instanceof C3||D instanceof I4)&&D.expression.isStateDependent===!0){let $=v.paint.get(K);D.expression=$.value,D.updatePaintArray(W.start,W.end,h,w[A],H),M=!0}}}}return M}defines(){let w=[];for(let f in this.binders){let q=this.binders[f];(q instanceof f7||q instanceof z7)&&w.push(...q.uniformNames.map((v)=>`#define HAS_UNIFORM_${v}`))}return w}getBinderAttributes(){let w=[];for(let f in this.binders){let q=this.binders[f];if(q instanceof J4||q instanceof C3)for(let v=0;v<q.paintVertexAttributes.length;v++)w.push(q.paintVertexAttributes[v].name);else if(q instanceof I4){let v=q.getVertexAttributes();for(let H of v)w.push(H.name)}}return w}getBinderUniforms(){let w=[];for(let f in this.binders){let q=this.binders[f];if(q instanceof f7||q instanceof z7||q instanceof C3)for(let v of q.uniformNames)w.push(v)}return w}getPaintVertexBuffers(){return this._buffers}getUniforms(w,f){let q=[];for(let v in this.binders){let H=this.binders[v];if(H instanceof f7||H instanceof z7||H instanceof C3){for(let M of H.uniformNames)if(f[M]){let A=H.getBinding(w,f[M],M);q.push({name:M,property:v,binding:A})}}}return q}setUniforms(w,f,q,v){for(let{name:H,property:M,binding:A}of f)this.binders[M].setUniform(A,v,q.get(M),H)}updatePaintBuffers(w){this._buffers=[];for(let f in this.binders){let q=this.binders[f];if(w&&q instanceof I4){let v=w.fromScale===2?q.zoomInPaintVertexBuffer:q.zoomOutPaintVertexBuffer;v&&this._buffers.push(v)}else(q instanceof J4||q instanceof C3)&&q.paintVertexBuffer&&this._buffers.push(q.paintVertexBuffer)}}upload(w){for(let f in this.binders){let q=this.binders[f];(q instanceof J4||q instanceof C3||q instanceof I4)&&q.upload(w)}this.updatePaintBuffers()}destroy(){for(let w in this.binders){let f=this.binders[w];(f instanceof J4||f instanceof C3||f instanceof I4)&&f.destroy()}}}class T4{constructor(w,f,q=()=>!0){this.programConfigurations={};for(let v of w)this.programConfigurations[v.id]=new Vw(v,f,q);this.needsUpload=!1,this._featureMap=new j7,this._bufferOffset=0}populatePaintArrays(w,f,q,v){for(let H in this.programConfigurations)this.programConfigurations[H].populatePaintArrays(w,f,v);f.id!==void 0&&this._featureMap.add(f.id,q,this._bufferOffset,w),this._bufferOffset=w,this.needsUpload=!0}updatePaintArrays(w,f,q,v){for(let H of q)this.needsUpload=this.programConfigurations[H.id].updatePaintArrays(w,this._featureMap,f,H,v)||this.needsUpload}get(w){return this.programConfigurations[w]}upload(w){if(this.needsUpload){for(let f in this.programConfigurations)this.programConfigurations[f].upload(w);this.needsUpload=!1}}destroy(){for(let w in this.programConfigurations)this.programConfigurations[w].destroy()}}function qx(w,f){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[w]||[w.replace(`${f}-`,"").replace(/-/g,"_")]}function Lw(w,f,q){let v={color:{source:y4,composite:L},number:{source:k,composite:y4}},H=function(M){return{"line-pattern":{source:L1,composite:L1},"fill-pattern":{source:L1,composite:L1},"fill-extrusion-pattern":{source:L1,composite:L1},"line-dasharray":{source:Q1,composite:Q1}}[M]}(w);return H&&H[q]||v[f][q]}o1("ConstantBinder",f7),o1("CrossFadedConstantBinder",z7),o1("SourceExpressionBinder",J4),o1("CrossFadedPatternBinder",Cg),o1("CrossFadedDasharrayBinder",S4),o1("CompositeExpressionBinder",C3),o1("ProgramConfiguration",Vw,{omit:["_buffers"]}),o1("ProgramConfigurationSet",T4);let Ww=Math.pow(2,14)-1,hw=-Ww-1;function g9(w){let f=J0/w.extent,q=w.loadGeometry();for(let v=0;v<q.length;v++){let H=q[v];for(let M=0;M<H.length;M++){let A=H[M],Q=Math.round(A.x*f),W=Math.round(A.y*f);A.x=U0(Q,hw,Ww),A.y=U0(W,hw,Ww),(Q<A.x||Q>A.x+1||W<A.y||W>A.y+1)&&r0("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return q}function f9(w,f){return{type:w.type,id:w.id,properties:w.properties,geometry:f?g9(w):[]}}let yJ=-32768;function hQ(w,f,q,v,H){w.emplaceBack(yJ+8*f+v,yJ+8*q+H)}class Zx{constructor(w){this.zoom=w.zoom,this.overscaling=w.overscaling,this.layers=w.layers,this.layerIds=this.layers.map((f)=>f.id),this.index=w.index,this.hasDependencies=!1,this.layoutVertexArray=new i,this.indexArray=new W0,this.segments=new V0,this.programConfigurations=new T4(w.layers,w.zoom),this.stateDependentLayerIds=this.layers.filter((f)=>f.isStateDependent()).map((f)=>f.id)}populate(w,f,q){let v=this.layers[0],H=[],M=null,A=!1,Q=v.type==="heatmap";if(v.type==="circle"){let h=v;M=h.layout.get("circle-sort-key"),A=!M.isConstant(),Q=Q||h.paint.get("circle-pitch-alignment")==="map"}let W=Q?f.subdivisionGranularity.circle:1;for(let{feature:h,id:K,index:D,sourceLayerIndex:$}of w){let R=this.layers[0]._featureFilter.needGeometry,_=f9(h,R);if(!this.layers[0]._featureFilter.filter(new n0(this.zoom),_,q))continue;let j=A?M.evaluate(_,{},q):void 0,o={id:K,properties:h.properties,type:h.type,sourceLayerIndex:$,index:D,geometry:R?_.geometry:g9(h),patterns:{},sortKey:j};H.push(o)}A&&H.sort((h,K)=>h.sortKey-K.sortKey);for(let h of H){let{geometry:K,index:D,sourceLayerIndex:$}=h,R=w[D].feature;this.addFeature(h,K,D,q,W),f.featureIndex.insert(R,K,D,$,this.index)}}update(w,f,q){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(w,f,this.stateDependentLayers,{imagePositions:q})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(w){this.uploaded||(this.layoutVertexBuffer=w.createVertexBuffer(this.layoutVertexArray,$5),this.indexBuffer=w.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(w),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(w,f,q,v,H=1){let M;switch(H){case 1:M=[0,7];break;case 3:M=[0,2,5,7];break;case 5:M=[0,1,3,4,6,7];break;case 7:M=[0,1,2,3,4,5,6,7];break;default:throw Error(`Invalid circle bucket granularity: ${H}; valid values are 1, 3, 5, 7.`)}let A=M.length;for(let Q of f)for(let W of Q){let{x:h,y:K}=W;if(h<0||h>=J0||K<0||K>=J0)continue;let D=this.segments.prepareSegment(A*A,this.layoutVertexArray,this.indexArray,w.sortKey),$=D.vertexLength;for(let R=0;R<A;R++)for(let _=0;_<A;_++)hQ(this.layoutVertexArray,h,K,M[_],M[R]);for(let R=0;R<A-1;R++)for(let _=0;_<A-1;_++){let j=$+R*A+_,o=$+(R+1)*A+_;this.indexArray.emplaceBack(j,o+1,j+1),this.indexArray.emplaceBack(j,o,o+1)}D.vertexLength+=A*A,D.primitiveLength+=(A-1)*(A-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,w,q,{imagePositions:{},canonical:v})}}function RJ(w,f){for(let q=0;q<w.length;q++)if(Fw(f,w[q]))return!0;for(let q=0;q<f.length;q++)if(Fw(w,f[q]))return!0;return!!OZ(w,f)}function Yx(w,f,q){return!!Fw(w,f)||!!yZ(f,w,q)}function NJ(w,f){if(w.length===1)return SJ(f,w[0]);for(let q=0;q<f.length;q++){let v=f[q];for(let H=0;H<v.length;H++)if(Fw(w,v[H]))return!0}for(let q=0;q<w.length;q++)if(SJ(f,w[q]))return!0;for(let q=0;q<f.length;q++)if(OZ(w,f[q]))return!0;return!1}function FQ(w,f,q){if(w.length>1){if(OZ(w,f))return!0;for(let v=0;v<f.length;v++)if(yZ(f[v],w,q))return!0}for(let v=0;v<w.length;v++)if(yZ(w[v],f,q))return!0;return!1}function OZ(w,f){if(w.length===0||f.length===0)return!1;for(let q=0;q<w.length-1;q++){let v=w[q],H=w[q+1];for(let M=0;M<f.length-1;M++)if(KQ(v,H,f[M],f[M+1]))return!0}return!1}function KQ(w,f,q,v){return g5(w,q,v)!==g5(f,q,v)&&g5(w,f,q)!==g5(w,f,v)}function yZ(w,f,q){let v=q*q;if(f.length===1)return w.distSqr(f[0])<v;for(let H=1;H<f.length;H++)if(IJ(w,f[H-1],f[H])<v)return!0;return!1}function IJ(w,f,q){let v=f.distSqr(q);if(v===0)return w.distSqr(f);let H=((w.x-f.x)*(q.x-f.x)+(w.y-f.y)*(q.y-f.y))/v;return w.distSqr(H<0?f:H>1?q:q.sub(f)._mult(H)._add(f))}function SJ(w,f){let q,v,H,M=!1;for(let A=0;A<w.length;A++){q=w[A];for(let Q=0,W=q.length-1;Q<q.length;W=Q++)v=q[Q],H=q[W],v.y>f.y!=H.y>f.y&&f.x<(H.x-v.x)*(f.y-v.y)/(H.y-v.y)+v.x&&(M=!M)}return M}function Fw(w,f){let q=!1;for(let v=0,H=w.length-1;v<w.length;H=v++){let M=w[v],A=w[H];M.y>f.y!=A.y>f.y&&f.x<(A.x-M.x)*(f.y-M.y)/(A.y-M.y)+M.x&&(q=!q)}return q}function lQ(w,f,q){let v=q[0],H=q[2];if(w.x<v.x&&f.x<v.x||w.x>H.x&&f.x>H.x||w.y<v.y&&f.y<v.y||w.y>H.y&&f.y>H.y)return!1;let M=g5(w,f,q[0]);return M!==g5(w,f,q[1])||M!==g5(w,f,q[2])||M!==g5(w,f,q[3])}function Kw(w,f,q){let v=f.paint.get(w).value;return v.kind==="constant"?v.value:q.programConfigurations.get(f.id).getMaxValue(w)}function kx(w){return Math.sqrt(w[0]*w[0]+w[1]*w[1])}function vx(w,f,q,v,H){if(!f[0]&&!f[1])return w;let M=l.convert(f)._mult(H);q==="viewport"&&M._rotate(-v);let A=[];for(let Q=0;Q<w.length;Q++)A.push(w[Q].sub(M));return A}function CQ({queryGeometry:w,size:f},q){return Yx(w,q,f)}function DQ({queryGeometry:w,size:f,transform:q,unwrappedTileID:v,getElevation:H},M){return Yx(w,M,f*(q.projectTileCoordinates(M.x,M.y,v,H).signedDistanceFromCamera/q.cameraToCenterDistance))}function dQ({queryGeometry:w,size:f,transform:q,unwrappedTileID:v,getElevation:H},M){let A=q.projectTileCoordinates(M.x,M.y,v,H).signedDistanceFromCamera,Q=f*(q.cameraToCenterDistance/A);return Yx(w,RZ(M,q,v,H),Q)}function OQ({queryGeometry:w,size:f,transform:q,unwrappedTileID:v,getElevation:H},M){return Yx(w,RZ(M,q,v,H),f)}function TJ({queryGeometry:w,size:f,transform:q,unwrappedTileID:v,getElevation:H,pitchAlignment:M="map",pitchScale:A="map"},Q){let W=M==="map"?A==="map"?CQ:DQ:A==="map"?dQ:OQ,h={queryGeometry:w,size:f,transform:q,unwrappedTileID:v,getElevation:H};for(let K of Q)for(let D of K)if(W(h,D))return!0;return!1}function RZ(w,f,q,v){let H=f.projectTileCoordinates(w.x,w.y,q,v).point;return new l((0.5*H.x+0.5)*f.width,(0.5*-H.y+0.5)*f.height)}let $J,jJ;o1("CircleBucket",Zx,{omit:["layers"]});var yQ={get paint(){return jJ=jJ||new W2({"circle-radius":new Y0(M1.paint_circle["circle-radius"]),"circle-color":new Y0(M1.paint_circle["circle-color"]),"circle-blur":new Y0(M1.paint_circle["circle-blur"]),"circle-opacity":new Y0(M1.paint_circle["circle-opacity"]),"circle-translate":new e1(M1.paint_circle["circle-translate"]),"circle-translate-anchor":new e1(M1.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new e1(M1.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new e1(M1.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Y0(M1.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Y0(M1.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Y0(M1.paint_circle["circle-stroke-opacity"])})},get layout(){return $J=$J||new W2({"circle-sort-key":new Y0(M1.layout_circle["circle-sort-key"])})}};class mJ extends G3{constructor(w,f){super(w,yQ,f)}createBucket(w){return new Zx(w)}queryRadius(w){let f=w;return Kw("circle-radius",this,f)+Kw("circle-stroke-width",this,f)+kx(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:w,feature:f,featureState:q,geometry:v,transform:H,pixelsToTileUnits:M,unwrappedTileID:A,getElevation:Q}){let W=vx(w,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-H.bearingInRadians,M),h=this.paint.get("circle-radius").evaluate(f,q)+this.paint.get("circle-stroke-width").evaluate(f,q),K=this.paint.get("circle-pitch-scale"),D=this.paint.get("circle-pitch-alignment"),$,R;return D==="map"?($=W,R=h*M):($=function(_,j,o,t){return _.map((U1)=>RZ(U1,j,o,t))}(W,H,A,Q),R=h),TJ({queryGeometry:$,size:R,transform:H,unwrappedTileID:A,getElevation:Q,pitchAlignment:D,pitchScale:K},v)}}class NZ extends Zx{}let _J;o1("HeatmapBucket",NZ,{omit:["layers"]});var RQ={get paint(){return _J=_J||new W2({"heatmap-radius":new Y0(M1.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Y0(M1.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new e1(M1.paint_heatmap["heatmap-intensity"]),"heatmap-color":new R7(M1.paint_heatmap["heatmap-color"]),"heatmap-opacity":new e1(M1.paint_heatmap["heatmap-opacity"])})}};function IZ(w,{width:f,height:q},v,H){if(H){if(H instanceof Uint8ClampedArray)H=new Uint8Array(H.buffer);else if(H.length!==f*q*v)throw RangeError(`mismatched image size. expected: ${H.length} but got: ${f*q*v}`)}else H=new Uint8Array(f*q*v);return w.width=f,w.height=q,w.data=H,w}function PJ(w,{width:f,height:q},v){if(f===w.width&&q===w.height)return;let H=IZ({},{width:f,height:q},v);SZ(w,H,{x:0,y:0},{x:0,y:0},{width:Math.min(w.width,f),height:Math.min(w.height,q)},v),w.width=f,w.height=q,w.data=H.data}function SZ(w,f,q,v,H,M){if(H.width===0||H.height===0)return f;if(H.width>w.width||H.height>w.height||q.x>w.width-H.width||q.y>w.height-H.height)throw RangeError("out of range source coordinates for image copy");if(H.width>f.width||H.height>f.height||v.x>f.width-H.width||v.y>f.height-H.height)throw RangeError("out of range destination coordinates for image copy");let A=w.data,Q=f.data;if(A===Q)throw Error("srcData equals dstData, so image is already copied");for(let W=0;W<H.height;W++){let h=((q.y+W)*w.width+q.x)*M,K=((v.y+W)*f.width+v.x)*M;for(let D=0;D<H.width*M;D++)Q[K+D]=A[h+D]}return f}class Dg{constructor(w,f){IZ(this,w,1,f)}resize(w){PJ(this,w,1)}clone(){return new Dg({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(w,f,q,v,H){SZ(w,f,q,v,H,1)}}class U3{constructor(w,f){IZ(this,w,4,f)}resize(w){PJ(this,w,4)}replace(w,f){f?this.data.set(w):this.data=w instanceof Uint8ClampedArray?new Uint8Array(w.buffer):w}clone(){return new U3({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(w,f,q,v,H){SZ(w,f,q,v,H,4)}setPixel(w,f,q){let v=4*(w*this.width+f);this.data[v+0]=Math.round(255*q.r/q.a),this.data[v+1]=Math.round(255*q.g/q.a),this.data[v+2]=Math.round(255*q.b/q.a),this.data[v+3]=Math.round(255*q.a)}}function EJ(w){let f={},q=w.resolution||256,v=w.clips?w.clips.length:1,H=w.image||new U3({width:q,height:v});if(Math.log(q)/Math.LN2%1!=0)throw Error(`width is not a power of 2 - ${q}`);let M=(A,Q,W)=>{f[w.evaluationKey]=W;let h=w.expression.evaluate(f);H.setPixel(A/4/q,Q/4,h)};if(w.clips)for(let A=0,Q=0;A<v;++A,Q+=4*q)for(let W=0,h=0;W<q;W++,h+=4){let K=W/(q-1),{start:D,end:$}=w.clips[A];M(Q,h,D*(1-K)+$*K)}else for(let A=0,Q=0;A<q;A++,Q+=4)M(0,Q,A/(q-1));return H}o1("AlphaImage",Dg),o1("RGBAImage",U3);let TZ="big-fb";class uJ extends G3{createBucket(w){return new NZ(w)}constructor(w,f){super(w,RQ,f),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(w){w==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=EJ({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(TZ)&&this.heatmapFbos.delete(TZ)}queryRadius(w){return Kw("heatmap-radius",this,w)}queryIntersectsFeature({queryGeometry:w,feature:f,featureState:q,geometry:v,transform:H,pixelsToTileUnits:M,unwrappedTileID:A,getElevation:Q}){return TJ({queryGeometry:w,size:this.paint.get("heatmap-radius").evaluate(f,q)*M,transform:H,unwrappedTileID:A,getElevation:Q},v)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let pJ;var NQ={get paint(){return pJ=pJ||new W2({"hillshade-illumination-direction":new e1(M1.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new e1(M1.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new e1(M1.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new e1(M1.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new e1(M1.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new e1(M1.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new e1(M1.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new e1(M1.paint_hillshade["hillshade-method"])})}};class cJ extends G3{constructor(w,f){super(w,NQ,f),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let w=this.paint.get("hillshade-illumination-direction").values,f=this.paint.get("hillshade-illumination-altitude").values,q=this.paint.get("hillshade-highlight-color").values,v=this.paint.get("hillshade-shadow-color").values,H=Math.max(w.length,f.length,q.length,v.length);w=w.concat(Array(H-w.length).fill(w.at(-1))),f=f.concat(Array(H-f.length).fill(f.at(-1))),q=q.concat(Array(H-q.length).fill(q.at(-1))),v=v.concat(Array(H-v.length).fill(v.at(-1)));let M=f.map(t2);return{directionRadians:w.map(t2),altitudeRadians:M,shadowColor:v,highlightColor:q}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let aJ;var IQ={get paint(){return aJ=aJ||new W2({"color-relief-opacity":new e1(M1["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new R7(M1["paint_color-relief"]["color-relief-color"])})}};class Jx{constructor(w,f,q,v){this.context=w,this.format=q,this.texture=w.gl.createTexture(),this.update(f,v)}update(w,f,q){let{width:v,height:H}=w,M=!(this.size&&this.size[0]===v&&this.size[1]===H||q),{context:A}=this,{gl:Q}=A;if(this.useMipmap=Boolean(f&&f.useMipmap),Q.bindTexture(Q.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===Q.RGBA&&(!f||f.premultiply!==!1)),M)this.size=[v,H],w instanceof HTMLImageElement||w instanceof HTMLCanvasElement||w instanceof HTMLVideoElement||w instanceof ImageData||O2(w)?Q.texImage2D(Q.TEXTURE_2D,0,this.format,this.format,Q.UNSIGNED_BYTE,w):Q.texImage2D(Q.TEXTURE_2D,0,this.format,v,H,0,this.format,Q.UNSIGNED_BYTE,w.data);else{let{x:W,y:h}=q||{x:0,y:0};w instanceof HTMLImageElement||w instanceof HTMLCanvasElement||w instanceof HTMLVideoElement||w instanceof ImageData||O2(w)?Q.texSubImage2D(Q.TEXTURE_2D,0,W,h,Q.RGBA,Q.UNSIGNED_BYTE,w):Q.texSubImage2D(Q.TEXTURE_2D,0,W,h,v,H,Q.RGBA,Q.UNSIGNED_BYTE,w.data)}this.useMipmap&&this.isSizePowerOfTwo()&&Q.generateMipmap(Q.TEXTURE_2D),A.pixelStoreUnpackFlipY.setDefault(),A.pixelStoreUnpack.setDefault(),A.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(w,f,q){let{context:v}=this,{gl:H}=v;H.bindTexture(H.TEXTURE_2D,this.texture),q!==H.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(q=H.LINEAR),w!==this.filter&&(H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MAG_FILTER,w),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MIN_FILTER,q||w),this.filter=w),f!==this.wrap&&(H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_S,f),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_T,f),this.wrap=f)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){let{gl:w}=this.context;w.deleteTexture(this.texture),this.texture=null}}class $Z{constructor(w,f,q,v=1,H=1,M=1,A=0){if(this.uid=w,f.height!==f.width)throw RangeError("DEM tiles must be square");if(q&&!["mapbox","terrarium","custom"].includes(q))return void r0(`"${q}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=f.height;let Q=this.dim=f.height-2;switch(this.data=new Uint32Array(f.data.buffer),q){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=0.00390625,this.baseShift=32768;break;case"custom":this.redFactor=v,this.greenFactor=H,this.blueFactor=M,this.baseShift=A;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=0.1,this.baseShift=1e4}for(let W=0;W<Q;W++)this.data[this._idx(-1,W)]=this.data[this._idx(0,W)],this.data[this._idx(Q,W)]=this.data[this._idx(Q-1,W)],this.data[this._idx(W,-1)]=this.data[this._idx(W,0)],this.data[this._idx(W,Q)]=this.data[this._idx(W,Q-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(Q,-1)]=this.data[this._idx(Q-1,0)],this.data[this._idx(-1,Q)]=this.data[this._idx(0,Q-1)],this.data[this._idx(Q,Q)]=this.data[this._idx(Q-1,Q-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let W=0;W<Q;W++)for(let h=0;h<Q;h++){let K=this.get(W,h);K>this.max&&(this.max=K),K<this.min&&(this.min=K)}}get(w,f){let q=new Uint8Array(this.data.buffer),v=4*this._idx(w,f);return this.unpack(q[v],q[v+1],q[v+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(w,f){if(w<-1||w>=this.dim+1||f<-1||f>=this.dim+1)throw RangeError("out of range source coordinates for DEM data");return(f+1)*this.stride+(w+1)}unpack(w,f,q){return w*this.redFactor+f*this.greenFactor+q*this.blueFactor-this.baseShift}pack(w){return rJ(w,this.getUnpackVector())}getPixels(){return new U3({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(w,f,q){if(this.dim!==w.dim)throw Error("dem dimension mismatch");let v=f*this.dim,H=f*this.dim+this.dim,M=q*this.dim,A=q*this.dim+this.dim;switch(f){case-1:v=H-1;break;case 1:H=v+1}switch(q){case-1:M=A-1;break;case 1:A=M+1}let Q=-f*this.dim,W=-q*this.dim;for(let h=M;h<A;h++)for(let K=v;K<H;K++)this.data[this._idx(K,h)]=w.data[this._idx(K+Q,h+W)]}}function rJ(w,f){let q=f[0],v=f[1],H=f[2],M=f[3],A=Math.min(q,v,H),Q=Math.round((w+M)/A);return{r:Math.floor(Q*A/q)%256,g:Math.floor(Q*A/v)%256,b:Math.floor(Q*A/H)%256}}o1("DEMData",$Z);class oJ extends G3{constructor(w,f){super(w,IQ,f)}_createColorRamp(w){let f={elevationStops:[],colorStops:[]},q=this._transitionablePaint._values["color-relief-color"].value.expression;if(q instanceof m8&&q._styleExpression.expression instanceof j2){this.colorRampExpression=q;let M=q._styleExpression.expression;f.elevationStops=M.labels,f.colorStops=[];for(let A of f.elevationStops)f.colorStops.push(M.evaluate({globals:{elevation:A}}))}if(f.elevationStops.length<1&&(f.elevationStops=[0],f.colorStops=[h0.transparent]),f.elevationStops.length<2&&(f.elevationStops.push(f.elevationStops[0]+1),f.colorStops.push(f.colorStops[0])),f.elevationStops.length<=w)return f;let v={elevationStops:[],colorStops:[]},H=(f.elevationStops.length-1)/(w-1);for(let M=0;M<f.elevationStops.length-0.5;M+=H)v.elevationStops.push(f.elevationStops[Math.round(M)]),v.colorStops.push(f.colorStops[Math.round(M)]);return r0(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),v}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(w,f,q){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;let v=this._createColorRamp(f),H=new U3({width:v.colorStops.length,height:1}),M=new U3({width:v.colorStops.length,height:1});for(let A=0;A<v.elevationStops.length;A++){let Q=rJ(v.elevationStops[A],q);M.setPixel(0,A,new h0(Q.r/255,Q.g/255,Q.b/255,1)),H.setPixel(0,A,v.colorStops[A])}return this.colorRampTextures={elevationTexture:new Jx(w,M,w.gl.RGBA),colorTexture:new Jx(w,H,w.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}let SQ=K5([{name:"a_pos",components:2,type:"Int16"}],4),{members:TQ}=SQ;function Gx(w,f,q){let v=q.patternDependencies,H=!1;for(let M of f){let A=M.paint.get(`${w}-pattern`);A.isConstant()||(H=!0);let Q=A.constantOr(null);Q&&(H=!0,v[Q.to]=!0,v[Q.from]=!0)}return H}function jZ(w,f,q,v,H){let{zoom:M}=v,A=H.patternDependencies;for(let Q of f){let W=Q.paint.get(`${w}-pattern`).value;if(W.kind!=="constant"){let h=W.evaluate({zoom:M-1},q,{},H.availableImages),K=W.evaluate({zoom:M},q,{},H.availableImages),D=W.evaluate({zoom:M+1},q,{},H.availableImages);h=h&&h.name?h.name:h,K=K&&K.name?K.name:K,D=D&&D.name?D.name:D,A[h]=!0,A[K]=!0,A[D]=!0,q.patterns[Q.id]={min:h,mid:K,max:D}}}return q}function nJ(w,f,q,v,H){let M;if(H===function(A,Q,W,h){let K=0;for(let D=Q,$=W-h;D<W;D+=h)K+=(A[$]-A[D])*(A[D+1]+A[$+1]),$=D;return K}(w,f,q,v)>0)for(let A=f;A<q;A+=v)M=eJ(A/v|0,w[A],w[A+1],M);else for(let A=q-v;A>=f;A-=v)M=eJ(A/v|0,w[A],w[A+1],M);return M&&lw(M,M.next)&&(Rg(M),M=M.next),M}function z9(w,f){if(!w)return w;f||(f=w);let q,v=w;do if(q=!1,v.steiner||!lw(v,v.next)&&_5(v.prev,v,v.next)!==0)v=v.next;else{if(Rg(v),v=f=v.prev,v===v.next)break;q=!0}while(q||v!==f);return f}function dg(w,f,q,v,H,M,A){if(!w)return;!A&&M&&function(W,h,K,D){let $=W;do $.z===0&&($.z=mZ($.x,$.y,h,K,D)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==W);$.prevZ.nextZ=null,$.prevZ=null,function(R){let _,j=1;do{let o,t=R;R=null;let U1=null;for(_=0;t;){_++;let g1=t,G1=0;for(let K1=0;K1<j&&(G1++,g1=g1.nextZ,g1);K1++);let h1=j;for(;G1>0||h1>0&&g1;)G1!==0&&(h1===0||!g1||t.z<=g1.z)?(o=t,t=t.nextZ,G1--):(o=g1,g1=g1.nextZ,h1--),U1?U1.nextZ=o:R=o,o.prevZ=U1,U1=o;t=g1}U1.nextZ=null,j*=2}while(_>1)}($)}(w,v,H,M);let Q=w;for(;w.prev!==w.next;){let{prev:W,next:h}=w;if(M?jQ(w,v,H,M):$Q(w))f.push(W.i,w.i,h.i),Rg(w),w=h.next,Q=h.next;else if((w=h)===Q){A?A===1?dg(w=mQ(z9(w),f),f,q,v,H,M,2):A===2&&_Q(w,f,q,v,H,M):dg(z9(w),f,q,v,H,M,1);break}}}function $Q(w){let f=w.prev,q=w,v=w.next;if(_5(f,q,v)>=0)return!1;let H=f.x,M=q.x,A=v.x,Q=f.y,W=q.y,h=v.y,K=Math.min(H,M,A),D=Math.min(Q,W,h),$=Math.max(H,M,A),R=Math.max(Q,W,h),_=v.next;for(;_!==f;){if(_.x>=K&&_.x<=$&&_.y>=D&&_.y<=R&&Og(H,Q,M,W,A,h,_.x,_.y)&&_5(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function jQ(w,f,q,v){let H=w.prev,M=w,A=w.next;if(_5(H,M,A)>=0)return!1;let Q=H.x,W=M.x,h=A.x,K=H.y,D=M.y,$=A.y,R=Math.min(Q,W,h),_=Math.min(K,D,$),j=Math.max(Q,W,h),o=Math.max(K,D,$),t=mZ(R,_,f,q,v),U1=mZ(j,o,f,q,v),g1=w.prevZ,G1=w.nextZ;for(;g1&&g1.z>=t&&G1&&G1.z<=U1;){if(g1.x>=R&&g1.x<=j&&g1.y>=_&&g1.y<=o&&g1!==H&&g1!==A&&Og(Q,K,W,D,h,$,g1.x,g1.y)&&_5(g1.prev,g1,g1.next)>=0)return!1;if(g1=g1.prevZ,G1.x>=R&&G1.x<=j&&G1.y>=_&&G1.y<=o&&G1!==H&&G1!==A&&Og(Q,K,W,D,h,$,G1.x,G1.y)&&_5(G1.prev,G1,G1.next)>=0)return!1;G1=G1.nextZ}for(;g1&&g1.z>=t;){if(g1.x>=R&&g1.x<=j&&g1.y>=_&&g1.y<=o&&g1!==H&&g1!==A&&Og(Q,K,W,D,h,$,g1.x,g1.y)&&_5(g1.prev,g1,g1.next)>=0)return!1;g1=g1.prevZ}for(;G1&&G1.z<=U1;){if(G1.x>=R&&G1.x<=j&&G1.y>=_&&G1.y<=o&&G1!==H&&G1!==A&&Og(Q,K,W,D,h,$,G1.x,G1.y)&&_5(G1.prev,G1,G1.next)>=0)return!1;G1=G1.nextZ}return!0}function mQ(w,f){let q=w;do{let v=q.prev,H=q.next.next;!lw(v,H)&&iJ(v,q,q.next,H)&&yg(v,H)&&yg(H,v)&&(f.push(v.i,q.i,H.i),Rg(q),Rg(q.next),q=w=H),q=q.next}while(q!==w);return z9(q)}function _Q(w,f,q,v,H,M){let A=w;do{let Q=A.next.next;for(;Q!==A.prev;){if(A.i!==Q.i&&cQ(A,Q)){let W=tJ(A,Q);return A=z9(A,A.next),W=z9(W,W.next),dg(A,f,q,v,H,M,0),void dg(W,f,q,v,H,M,0)}Q=Q.next}A=A.next}while(A!==w)}function PQ(w,f){let q=w.x-f.x;return q===0&&(q=w.y-f.y,q===0)&&(q=(w.next.y-w.y)/(w.next.x-w.x)-(f.next.y-f.y)/(f.next.x-f.x)),q}function EQ(w,f){let q=function(H,M){let A=M,Q=H.x,W=H.y,h,K=-1/0;if(lw(H,A))return A;do{if(lw(H,A.next))return A.next;if(W<=A.y&&W>=A.next.y&&A.next.y!==A.y){let j=A.x+(W-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(j<=Q&&j>K&&(K=j,h=A.x<A.next.x?A:A.next,j===Q))return h}A=A.next}while(A!==M);if(!h)return null;let D=h,$=h.x,R=h.y,_=1/0;A=h;do{if(Q>=A.x&&A.x>=$&&Q!==A.x&&sJ(W<R?Q:K,W,$,R,W<R?K:Q,W,A.x,A.y)){let j=Math.abs(W-A.y)/(Q-A.x);yg(A,H)&&(j<_||j===_&&(A.x>h.x||A.x===h.x&&uQ(h,A)))&&(h=A,_=j)}A=A.next}while(A!==D);return h}(w,f);if(!q)return f;let v=tJ(q,w);return z9(v,v.next),z9(q,q.next)}function uQ(w,f){return _5(w.prev,w,f.prev)<0&&_5(f.next,w,w.next)<0}function mZ(w,f,q,v,H){return(w=1431655765&((w=858993459&((w=252645135&((w=16711935&((w=(w-q)*H|0)|w<<8))|w<<4))|w<<2))|w<<1))|(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=(f-v)*H|0)|f<<8))|f<<4))|f<<2))|f<<1))<<1}function pQ(w){let f=w,q=w;do(f.x<q.x||f.x===q.x&&f.y<q.y)&&(q=f),f=f.next;while(f!==w);return q}function sJ(w,f,q,v,H,M,A,Q){return(H-A)*(f-Q)>=(w-A)*(M-Q)&&(w-A)*(v-Q)>=(q-A)*(f-Q)&&(q-A)*(M-Q)>=(H-A)*(v-Q)}function Og(w,f,q,v,H,M,A,Q){return!(w===A&&f===Q)&&sJ(w,f,q,v,H,M,A,Q)}function cQ(w,f){return w.next.i!==f.i&&w.prev.i!==f.i&&!function(q,v){let H=q;do{if(H.i!==q.i&&H.next.i!==q.i&&H.i!==v.i&&H.next.i!==v.i&&iJ(H,H.next,q,v))return!0;H=H.next}while(H!==q);return!1}(w,f)&&(yg(w,f)&&yg(f,w)&&function(q,v){let H=q,M=!1,A=(q.x+v.x)/2,Q=(q.y+v.y)/2;do H.y>Q!=H.next.y>Q&&H.next.y!==H.y&&A<(H.next.x-H.x)*(Q-H.y)/(H.next.y-H.y)+H.x&&(M=!M),H=H.next;while(H!==q);return M}(w,f)&&(_5(w.prev,w,f.prev)||_5(w,f.prev,f))||lw(w,f)&&_5(w.prev,w,w.next)>0&&_5(f.prev,f,f.next)>0)}function _5(w,f,q){return(f.y-w.y)*(q.x-f.x)-(f.x-w.x)*(q.y-f.y)}function lw(w,f){return w.x===f.x&&w.y===f.y}function iJ(w,f,q,v){let H=Ux(_5(w,f,q)),M=Ux(_5(w,f,v)),A=Ux(_5(q,v,w)),Q=Ux(_5(q,v,f));return H!==M&&A!==Q||!(H!==0||!Hx(w,q,f))||!(M!==0||!Hx(w,v,f))||!(A!==0||!Hx(q,w,v))||!(Q!==0||!Hx(q,f,v))}function Hx(w,f,q){return f.x<=Math.max(w.x,q.x)&&f.x>=Math.min(w.x,q.x)&&f.y<=Math.max(w.y,q.y)&&f.y>=Math.min(w.y,q.y)}function Ux(w){return w>0?1:w<0?-1:0}function yg(w,f){return _5(w.prev,w,w.next)<0?_5(w,f,w.next)>=0&&_5(w,w.prev,f)>=0:_5(w,f,w.prev)<0||_5(w,w.next,f)<0}function tJ(w,f){let q=_Z(w.i,w.x,w.y),v=_Z(f.i,f.x,f.y),H=w.next,M=f.prev;return w.next=f,f.prev=w,q.next=H,H.prev=q,v.next=q,q.prev=v,M.next=v,v.prev=M,v}function eJ(w,f,q,v){let H=_Z(w,f,q);return v?(H.next=v.next,H.prev=v,v.next.prev=H,v.next=H):(H.prev=H,H.next=H),H}function Rg(w){w.next.prev=w.prev,w.prev.next=w.next,w.prevZ&&(w.prevZ.nextZ=w.nextZ),w.nextZ&&(w.nextZ.prevZ=w.prevZ)}function _Z(w,f,q){return{i:w,x:f,y:q,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class x9{constructor(w,f){if(f>w)throw Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=w,this._minGranularity=f}getGranularityForZoomLevel(w){return Math.max(Math.floor(this._baseZoomGranularity/(1<<w)),this._minGranularity,1)}}class Ng{constructor(w){this.fill=w.fill,this.line=w.line,this.tile=w.tile,this.stencil=w.stencil,this.circle=w.circle}}Ng.noSubdivision=new Ng({fill:new x9(0,0),line:new x9(0,0),tile:new x9(0,0),stencil:new x9(0,0),circle:1}),o1("SubdivisionGranularityExpression",x9),o1("SubdivisionGranularitySetting",Ng);let Cw=-32768,Ig=32767;class wG{constructor(w,f){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=w,this._granularityCellSize=J0/w,this._canonical=f}_getKey(w,f){return(w+=32768)<<16|f+32768}_vertexToIndex(w,f){if(w<-32768||f<-32768||w>32767||f>32767)throw Error("Vertex coordinates are out of signed 16 bit integer range.");let q=0|Math.round(w),v=0|Math.round(f),H=this._getKey(q,v);if(this._vertexDictionary.has(H))return this._vertexDictionary.get(H);let M=this._vertexBuffer.length/2;return this._vertexDictionary.set(H,M),this._vertexBuffer.push(q,v),M}_subdivideTrianglesScanline(w){if(this._granularity<2)return function(v,H){let M=[];for(let A=0;A<H.length;A+=3){let Q=H[A],W=H[A+1],h=H[A+2],K=v[2*Q],D=v[2*Q+1];(v[2*W]-K)*(v[2*h+1]-D)-(v[2*W+1]-D)*(v[2*h]-K)>0?(M.push(Q),M.push(h),M.push(W)):(M.push(Q),M.push(W),M.push(h))}return M}(this._vertexBuffer,w);let f=[],q=w.length;for(let v=0;v<q;v+=3){let H=[w[v+0],w[v+1],w[v+2]],M=[this._vertexBuffer[2*w[v+0]+0],this._vertexBuffer[2*w[v+0]+1],this._vertexBuffer[2*w[v+1]+0],this._vertexBuffer[2*w[v+1]+1],this._vertexBuffer[2*w[v+2]+0],this._vertexBuffer[2*w[v+2]+1]],A=1/0,Q=1/0,W=-1/0,h=-1/0;for(let _=0;_<3;_++){let j=M[2*_],o=M[2*_+1];A=Math.min(A,j),W=Math.max(W,j),Q=Math.min(Q,o),h=Math.max(h,o)}if(A===W||Q===h)continue;let K=Math.floor(A/this._granularityCellSize),D=Math.ceil(W/this._granularityCellSize),$=Math.floor(Q/this._granularityCellSize),R=Math.ceil(h/this._granularityCellSize);if(K!==D||$!==R)for(let _=$;_<R;_++){let j=this._scanlineGenerateVertexRingForCellRow(_,M,H);aQ(this._vertexBuffer,j,f)}else f.push(...H)}return f}_scanlineGenerateVertexRingForCellRow(w,f,q){let v=w*this._granularityCellSize,H=v+this._granularityCellSize,M=[];for(let A=0;A<3;A++){let Q=f[2*A],W=f[2*A+1],h=f[2*(A+1)%6],K=f[(2*(A+1)+1)%6],D=f[2*(A+2)%6],$=f[(2*(A+2)+1)%6],R=h-Q,_=K-W,j=R===0,o=_===0,t=(v-W)/_,U1=(H-W)/_,g1=Math.min(t,U1),G1=Math.max(t,U1);if(!o&&(g1>=1||G1<=0)||o&&(W<v||W>H)){K>=v&&K<=H&&M.push(q[(A+1)%3]);continue}!o&&g1>0&&M.push(this._vertexToIndex(Q+R*g1,W+_*g1));let h1=Q+R*Math.max(g1,0),K1=Q+R*Math.min(G1,1);j||this._generateIntraEdgeVertices(M,Q,W,h,K,h1,K1),!o&&G1<1&&M.push(this._vertexToIndex(Q+R*G1,W+_*G1)),(o||K>=v&&K<=H)&&M.push(q[(A+1)%3]),!o&&(K<=v||K>=H)&&this._generateInterEdgeVertices(M,Q,W,h,K,D,$,K1,v,H)}return M}_generateIntraEdgeVertices(w,f,q,v,H,M,A){let Q=v-f,W=H-q,h=W===0,K=h?Math.min(f,v):Math.min(M,A),D=h?Math.max(f,v):Math.max(M,A),$=Math.floor(K/this._granularityCellSize)+1,R=Math.ceil(D/this._granularityCellSize)-1;if(h?f<v:M<A)for(let _=$;_<=R;_++){let j=_*this._granularityCellSize;w.push(this._vertexToIndex(j,q+W*(j-f)/Q))}else for(let _=R;_>=$;_--){let j=_*this._granularityCellSize;w.push(this._vertexToIndex(j,q+W*(j-f)/Q))}}_generateInterEdgeVertices(w,f,q,v,H,M,A,Q,W,h){let K=H-q,D=M-v,$=A-H,R=(W-H)/$,_=(h-H)/$,j=Math.min(R,_),o=Math.max(R,_),t=v+D*j,U1=Math.floor(Math.min(t,Q)/this._granularityCellSize)+1,g1=Math.ceil(Math.max(t,Q)/this._granularityCellSize)-1,G1=Q<t,h1=$===0;if(h1&&(A===W||A===h))return;if(h1||j>=1||o<=0){let j1=q-A,T1=M+(f-M)*Math.min((W-A)/j1,(h-A)/j1);U1=Math.floor(Math.min(T1,Q)/this._granularityCellSize)+1,g1=Math.ceil(Math.max(T1,Q)/this._granularityCellSize)-1,G1=Q<T1}let K1=K>0?h:W;if(G1)for(let j1=U1;j1<=g1;j1++)w.push(this._vertexToIndex(j1*this._granularityCellSize,K1));else for(let j1=g1;j1>=U1;j1--)w.push(this._vertexToIndex(j1*this._granularityCellSize,K1))}_generateOutline(w){let f=[];for(let q of w){let v=q9(q,this._granularity,!0),H=this._pointArrayToIndices(v),M=[];for(let A=1;A<H.length;A++)M.push(H[A-1]),M.push(H[A]);f.push(M)}return f}_handlePoles(w){let f=!1,q=!1;this._canonical&&(this._canonical.y===0&&(f=!0),this._canonical.y===(1<<this._canonical.z)-1&&(q=!0)),(f||q)&&this._fillPoles(w,f,q)}_ensureNoPoleVertices(){let w=this._vertexBuffer;for(let f=0;f<w.length;f+=2){let q=w[f+1];q===Cw&&(w[f+1]=-32767),q===Ig&&(w[f+1]=32766)}}_generatePoleQuad(w,f,q,v,H,M){v>H!=(M===Cw)?(w.push(f),w.push(q),w.push(this._vertexToIndex(v,M)),w.push(q),w.push(this._vertexToIndex(H,M)),w.push(this._vertexToIndex(v,M))):(w.push(q),w.push(f),w.push(this._vertexToIndex(v,M)),w.push(this._vertexToIndex(H,M)),w.push(q),w.push(this._vertexToIndex(v,M)))}_fillPoles(w,f,q){let v=this._vertexBuffer,H=J0,M=w.length;for(let A=2;A<M;A+=3){let Q=w[A-2],W=w[A-1],h=w[A],K=v[2*Q],D=v[2*Q+1],$=v[2*W],R=v[2*W+1],_=v[2*h],j=v[2*h+1];f&&(D===0&&R===0&&this._generatePoleQuad(w,Q,W,K,$,Cw),R===0&&j===0&&this._generatePoleQuad(w,W,h,$,_,Cw),j===0&&D===0&&this._generatePoleQuad(w,h,Q,_,K,Cw)),q&&(D===H&&R===H&&this._generatePoleQuad(w,Q,W,K,$,Ig),R===H&&j===H&&this._generatePoleQuad(w,W,h,$,_,Ig),j===H&&D===H&&this._generatePoleQuad(w,h,Q,_,K,Ig))}}_initializeVertices(w){for(let f=0;f<w.length;f+=2)this._vertexToIndex(w[f],w[f+1])}subdividePolygonInternal(w,f){if(this._used)throw Error("Subdivision: multiple use not allowed.");this._used=!0;let{flattened:q,holeIndices:v}=function(A){let Q=[],W=[];for(let h of A)if(h.length!==0){h!==A[0]&&Q.push(W.length/2);for(let K=0;K<h.length;K++)W.push(h[K].x),W.push(h[K].y)}return{flattened:W,holeIndices:Q}}(w),H;this._initializeVertices(q);try{let A=function(W,h,K=2){let D=h&&h.length,$=D?h[0]*K:W.length,R=nJ(W,0,$,K,!0),_=[];if(!R||R.next===R.prev)return _;let j,o,t;if(D&&(R=function(U1,g1,G1,h1){let K1=[];for(let j1=0,T1=g1.length;j1<T1;j1++){let _1=nJ(U1,g1[j1]*h1,j1<T1-1?g1[j1+1]*h1:U1.length,h1,!1);_1===_1.next&&(_1.steiner=!0),K1.push(pQ(_1))}K1.sort(PQ);for(let j1=0;j1<K1.length;j1++)G1=EQ(K1[j1],G1);return G1}(W,h,R,K)),W.length>80*K){j=W[0],o=W[1];let U1=j,g1=o;for(let G1=K;G1<$;G1+=K){let h1=W[G1],K1=W[G1+1];h1<j&&(j=h1),K1<o&&(o=K1),h1>U1&&(U1=h1),K1>g1&&(g1=K1)}t=Math.max(U1-j,g1-o),t=t!==0?32767/t:0}return dg(R,_,K,j,o,t,0),_}(q,v),Q=this._convertIndices(q,A);H=this._subdivideTrianglesScanline(Q)}catch(A){console.error(A)}let M=[];return f&&(M=this._generateOutline(w)),this._ensureNoPoleVertices(),this._handlePoles(H),{verticesFlattened:this._vertexBuffer,indicesTriangles:H,indicesLineList:M}}_convertIndices(w,f){let q=[];for(let v=0;v<f.length;v++)q.push(this._vertexToIndex(w[2*f[v]],w[2*f[v]+1]));return q}_pointArrayToIndices(w){let f=[];for(let q=0;q<w.length;q++){let v=w[q];f.push(this._vertexToIndex(v.x,v.y))}return f}}function bG(w,f,q,v=!0){return new wG(q,f).subdividePolygonInternal(w,v)}function q9(w,f,q=!1){if(!w||w.length<1)return[];if(w.length<2)return[];let v=w[0],H=w[w.length-1],M=q&&(v.x!==H.x||v.y!==H.y);if(f<2)return M?[...w,w[0]]:[...w];let A=Math.floor(J0/f),Q=[];Q.push(new l(w[0].x,w[0].y));let W=w.length,h=M?W:W-1;for(let K=0;K<h;K++){let D=w[K],$=K<W-1?w[K+1]:w[0],R=D.x,_=D.y,j=$.x,o=$.y,t=R!==j,U1=_!==o;if(!t&&!U1)continue;let g1=j-R,G1=o-_,h1=Math.abs(g1),K1=Math.abs(G1),j1=R,T1=_;for(;;){let t1=g1>0?(Math.floor(j1/A)+1)*A:(Math.ceil(j1/A)-1)*A,c1=G1>0?(Math.floor(T1/A)+1)*A:(Math.ceil(T1/A)-1)*A,a1=Math.abs(j1-t1),S1=Math.abs(T1-c1),E1=Math.abs(j1-j),Q0=Math.abs(T1-o),A0=t?a1/h1:Number.POSITIVE_INFINITY,g0=U1?S1/K1:Number.POSITIVE_INFINITY;if((E1<=a1||!t)&&(Q0<=S1||!U1))break;if(A0<g0&&t||!U1){j1=t1,T1+=G1*A0;let x0=new l(j1,Math.round(T1));Q[Q.length-1].x===x0.x&&Q[Q.length-1].y===x0.y||Q.push(x0)}else{j1+=g1*g0,T1=c1;let x0=new l(Math.round(j1),T1);Q[Q.length-1].x===x0.x&&Q[Q.length-1].y===x0.y||Q.push(x0)}}let _1=new l(j,o);Q[Q.length-1].x===_1.x&&Q[Q.length-1].y===_1.y||Q.push(_1)}return Q}function aQ(w,f,q){if(f.length===0)throw Error("Subdivision vertex ring is empty.");let v=0,H=w[2*f[0]];for(let W=1;W<f.length;W++){let h=w[2*f[W]];h<H&&(H=h,v=W)}let M=f.length,A=v,Q=(A+1)%M;for(;;){let W=A-1>=0?A-1:M-1,h=(Q+1)%M,K=w[2*f[W]],D=w[2*f[h]],$=w[2*f[A]],R=w[2*f[A]+1],_=w[2*f[Q]+1],j=!1;if(K<D)j=!0;else if(K>D)j=!1;else{let o=_-R,t=-(w[2*f[Q]]-$),U1=R<_?1:-1;((K-$)*o+(w[2*f[W]+1]-R)*t)*U1>((D-$)*o+(w[2*f[h]+1]-R)*t)*U1&&(j=!0)}if(j){let o=f[W],t=f[A],U1=f[Q];o!==t&&o!==U1&&t!==U1&&q.push(U1,t,o),A--,A<0&&(A=M-1)}else{let o=f[h],t=f[A],U1=f[Q];o!==t&&o!==U1&&t!==U1&&q.push(U1,t,o),Q++,Q>=M&&(Q=0)}if(W===h)break}}function gG(w,f,q,v,H,M,A,Q,W){let h=H.length/2,K=A&&Q&&W;if(h<V0.MAX_VERTEX_ARRAY_LENGTH){let D=f.prepareSegment(h,q,v),$=D.vertexLength;for(let j=0;j<M.length;j+=3)v.emplaceBack($+M[j],$+M[j+1],$+M[j+2]);let R,_;D.vertexLength+=h,D.primitiveLength+=M.length/3,K&&(_=A.prepareSegment(h,q,Q),R=_.vertexLength,_.vertexLength+=h);for(let j=0;j<H.length;j+=2)w(H[j],H[j+1]);if(K)for(let j=0;j<W.length;j++){let o=W[j];for(let t=1;t<o.length;t+=2)Q.emplaceBack(R+o[t-1],R+o[t]);_.primitiveLength+=o.length/2}}else(function(D,$,R,_,j,o){let t=[];for(let K1=0;K1<_.length/2;K1++)t.push(-1);let U1={count:0},g1=0,G1=D.getOrCreateLatestSegment($,R),h1=G1.vertexLength;for(let K1=2;K1<j.length;K1+=3){let j1=j[K1-2],T1=j[K1-1],_1=j[K1],t1=t[j1]<g1,c1=t[T1]<g1,a1=t[_1]<g1;G1.vertexLength+((t1?1:0)+(c1?1:0)+(a1?1:0))>V0.MAX_VERTEX_ARRAY_LENGTH&&(G1=D.createNewSegment($,R),g1=U1.count,t1=!0,c1=!0,a1=!0,h1=0);let S1=Sg(t,_,o,U1,j1,t1,G1),E1=Sg(t,_,o,U1,T1,c1,G1),Q0=Sg(t,_,o,U1,_1,a1,G1);R.emplaceBack(h1+S1-g1,h1+E1-g1,h1+Q0-g1),G1.primitiveLength++}})(f,q,v,H,M,w),K&&function(D,$,R,_,j,o){let t=[];for(let K1=0;K1<_.length/2;K1++)t.push(-1);let U1={count:0},g1=0,G1=D.getOrCreateLatestSegment($,R),h1=G1.vertexLength;for(let K1=0;K1<j.length;K1++){let j1=j[K1];for(let T1=1;T1<j[K1].length;T1+=2){let _1=j1[T1-1],t1=j1[T1],c1=t[_1]<g1,a1=t[t1]<g1;G1.vertexLength+((c1?1:0)+(a1?1:0))>V0.MAX_VERTEX_ARRAY_LENGTH&&(G1=D.createNewSegment($,R),g1=U1.count,c1=!0,a1=!0,h1=0);let S1=Sg(t,_,o,U1,_1,c1,G1),E1=Sg(t,_,o,U1,t1,a1,G1);R.emplaceBack(h1+S1-g1,h1+E1-g1),G1.primitiveLength++}}}(A,q,Q,H,W,w),f.forceNewSegmentOnNextPrepare(),A==null||A.forceNewSegmentOnNextPrepare()}function Sg(w,f,q,v,H,M,A){if(M){let Q=v.count;return q(f[2*H],f[2*H+1]),w[H]=v.count,v.count++,A.vertexLength++,Q}return w[H]}class Bx{constructor(w){this.zoom=w.zoom,this.overscaling=w.overscaling,this.layers=w.layers,this.layerIds=this.layers.map((f)=>f.id),this.index=w.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new n,this.indexArray=new W0,this.indexArray2=new q5,this.programConfigurations=new T4(w.layers,w.zoom),this.segments=new V0,this.segments2=new V0,this.stateDependentLayerIds=this.layers.filter((f)=>f.isStateDependent()).map((f)=>f.id)}populate(w,f,q){this.hasDependencies=Gx("fill",this.layers,f);let v=this.layers[0].layout.get("fill-sort-key"),H=!v.isConstant(),M=[];for(let{feature:A,id:Q,index:W,sourceLayerIndex:h}of w){let K=this.layers[0]._featureFilter.needGeometry,D=f9(A,K);if(!this.layers[0]._featureFilter.filter(new n0(this.zoom),D,q))continue;let $=H?v.evaluate(D,{},q,f.availableImages):void 0,R={id:Q,properties:A.properties,type:A.type,sourceLayerIndex:h,index:W,geometry:K?D.geometry:g9(A),patterns:{},sortKey:$};M.push(R)}H&&M.sort((A,Q)=>A.sortKey-Q.sortKey);for(let A of M){let{geometry:Q,index:W,sourceLayerIndex:h}=A;if(this.hasDependencies){let K=jZ("fill",this.layers,A,{zoom:this.zoom},f);this.patternFeatures.push(K)}else this.addFeature(A,Q,W,q,{},f.subdivisionGranularity);f.featureIndex.insert(w[W].feature,Q,W,h,this.index)}}update(w,f,q){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(w,f,this.stateDependentLayers,{imagePositions:q})}addFeatures(w,f,q){for(let v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,f,q,w.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(w){this.uploaded||(this.layoutVertexBuffer=w.createVertexBuffer(this.layoutVertexArray,TQ),this.indexBuffer=w.createIndexBuffer(this.indexArray),this.indexBuffer2=w.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(w),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(w,f,q,v,H,M){for(let A of X6(f,500)){let Q=bG(A,v,M.fill.getGranularityForZoomLevel(v.z)),W=this.layoutVertexArray;gG((h,K)=>{W.emplaceBack(h,K)},this.segments,this.layoutVertexArray,this.indexArray,Q.verticesFlattened,Q.indicesTriangles,this.segments2,this.indexArray2,Q.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,w,q,{imagePositions:H,canonical:v})}}let fG,zG;o1("FillBucket",Bx,{omit:["layers","patternFeatures"]});var rQ={get paint(){return zG=zG||new W2({"fill-antialias":new e1(M1.paint_fill["fill-antialias"]),"fill-opacity":new Y0(M1.paint_fill["fill-opacity"]),"fill-color":new Y0(M1.paint_fill["fill-color"]),"fill-outline-color":new Y0(M1.paint_fill["fill-outline-color"]),"fill-translate":new e1(M1.paint_fill["fill-translate"]),"fill-translate-anchor":new e1(M1.paint_fill["fill-translate-anchor"]),"fill-pattern":new y7(M1.paint_fill["fill-pattern"])})},get layout(){return fG=fG||new W2({"fill-sort-key":new Y0(M1.layout_fill["fill-sort-key"])})}};class xG extends G3{constructor(w,f){super(w,rQ,f)}recalculate(w,f){super.recalculate(w,f);let q=this.paint._values["fill-outline-color"];q.value.kind==="constant"&&q.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(w){return new Bx(w)}queryRadius(){return kx(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:w,geometry:f,transform:q,pixelsToTileUnits:v}){return NJ(vx(w,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-q.bearingInRadians,v),f)}isTileClipped(){return!0}}let oQ=K5([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),nQ=K5([{name:"a_centroid",components:2,type:"Int16"}],4),{members:sQ}=oQ;class Z9{constructor(w,f,q,v,H){this.properties={},this.extent=q,this.type=0,this.id=void 0,this._pbf=w,this._geometry=-1,this._keys=v,this._values=H,w.readFields(iQ,this,f)}loadGeometry(){let w=this._pbf;w.pos=this._geometry;let f=w.readVarint()+w.pos,q=[],v,H=1,M=0,A=0,Q=0;for(;w.pos<f;){if(M<=0){let W=w.readVarint();H=7&W,M=W>>3}if(M--,H===1||H===2)A+=w.readSVarint(),Q+=w.readSVarint(),H===1&&(v&&q.push(v),v=[]),v&&v.push(new l(A,Q));else{if(H!==7)throw Error(`unknown command ${H}`);v&&v.push(v[0].clone())}}return v&&q.push(v),q}bbox(){let w=this._pbf;w.pos=this._geometry;let f=w.readVarint()+w.pos,q=1,v=0,H=0,M=0,A=1/0,Q=-1/0,W=1/0,h=-1/0;for(;w.pos<f;){if(v<=0){let K=w.readVarint();q=7&K,v=K>>3}if(v--,q===1||q===2)H+=w.readSVarint(),M+=w.readSVarint(),H<A&&(A=H),H>Q&&(Q=H),M<W&&(W=M),M>h&&(h=M);else if(q!==7)throw Error(`unknown command ${q}`)}return[A,W,Q,h]}toGeoJSON(w,f,q){let v=this.extent*Math.pow(2,q),H=this.extent*w,M=this.extent*f,A=this.loadGeometry();function Q(D){return[360*(D.x+H)/v-180,360/Math.PI*Math.atan(Math.exp((1-2*(D.y+M)/v)*Math.PI))-90]}function W(D){return D.map(Q)}let h;if(this.type===1){let D=[];for(let R of A)D.push(R[0]);let $=W(D);h=D.length===1?{type:"Point",coordinates:$[0]}:{type:"MultiPoint",coordinates:$}}else if(this.type===2){let D=A.map(W);h=D.length===1?{type:"LineString",coordinates:D[0]}:{type:"MultiLineString",coordinates:D}}else{if(this.type!==3)throw Error("unknown feature type");{let D=function(R){let _=R.length;if(_<=1)return[R];let j=[],o,t;for(let U1=0;U1<_;U1++){let g1=tQ(R[U1]);g1!==0&&(t===void 0&&(t=g1<0),t===g1<0?(o&&j.push(o),o=[R[U1]]):o&&o.push(R[U1]))}return o&&j.push(o),j}(A),$=[];for(let R of D)$.push(R.map(W));h=$.length===1?{type:"Polygon",coordinates:$[0]}:{type:"MultiPolygon",coordinates:$}}}let K={type:"Feature",geometry:h,properties:this.properties};return this.id!=null&&(K.id=this.id),K}}function iQ(w,f,q){w===1?f.id=q.readVarint():w===2?function(v,H){let M=v.readVarint()+v.pos;for(;v.pos<M;){let A=H._keys[v.readVarint()],Q=H._values[v.readVarint()];H.properties[A]=Q}}(q,f):w===3?f.type=q.readVarint():w===4&&(f._geometry=q.pos)}function tQ(w){let f=0;for(let q,v,H=0,M=w.length,A=M-1;H<M;A=H++)q=w[H],v=w[A],f+=(v.x-q.x)*(q.y+v.y);return f}Z9.types=["Unknown","Point","LineString","Polygon"];class PZ{constructor(w,f){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=w,this._keys=[],this._values=[],this._features=[],w.readFields(eQ,this,f),this.length=this._features.length}feature(w){if(w<0||w>=this._features.length)throw Error("feature index out of bounds");this._pbf.pos=this._features[w];let f=this._pbf.readVarint()+this._pbf.pos;return new Z9(this._pbf,f,this.extent,this._keys,this._values)}}function eQ(w,f,q){w===15?f.version=q.readVarint():w===1?f.name=q.readString():w===5?f.extent=q.readVarint():w===2?f._features.push(q.pos):w===3?f._keys.push(q.readString()):w===4&&f._values.push(function(v){let H=null,M=v.readVarint()+v.pos;for(;v.pos<M;){let A=v.readVarint()>>3;H=A===1?v.readString():A===2?v.readFloat():A===3?v.readDouble():A===4?v.readVarint64():A===5?v.readVarint():A===6?v.readSVarint():A===7?v.readBoolean():null}if(H==null)throw Error("unknown feature value");return H}(q))}class EZ{constructor(w,f){this.layers=w.readFields(wV,{},f)}}function wV(w,f,q){if(w===3){let v=new PZ(q,q.readVarint()+q.pos);v.length&&(f[v.name]=v)}}let uZ=Math.pow(2,13);function Tg(w,f,q,v,H,M,A,Q){w.emplaceBack(f,q,2*Math.floor(v*uZ)+A,H*uZ*2,M*uZ*2,Math.round(Q))}class Ax{constructor(w){this.zoom=w.zoom,this.overscaling=w.overscaling,this.layers=w.layers,this.layerIds=this.layers.map((f)=>f.id),this.index=w.index,this.hasDependencies=!1,this.layoutVertexArray=new q1,this.centroidVertexArray=new x1,this.indexArray=new W0,this.programConfigurations=new T4(w.layers,w.zoom),this.segments=new V0,this.stateDependentLayerIds=this.layers.filter((f)=>f.isStateDependent()).map((f)=>f.id)}populate(w,f,q){this.features=[],this.hasDependencies=Gx("fill-extrusion",this.layers,f);for(let{feature:v,id:H,index:M,sourceLayerIndex:A}of w){let Q=this.layers[0]._featureFilter.needGeometry,W=f9(v,Q);if(!this.layers[0]._featureFilter.filter(new n0(this.zoom),W,q))continue;let h={id:H,sourceLayerIndex:A,index:M,geometry:Q?W.geometry:g9(v),properties:v.properties,type:v.type,patterns:{}};this.hasDependencies?this.features.push(jZ("fill-extrusion",this.layers,h,{zoom:this.zoom},f)):this.addFeature(h,h.geometry,M,q,{},f.subdivisionGranularity),f.featureIndex.insert(v,h.geometry,M,A,this.index,!0)}}addFeatures(w,f,q){for(let v of this.features){let{geometry:H}=v;this.addFeature(v,H,v.index,f,q,w.subdivisionGranularity)}}update(w,f,q){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(w,f,this.stateDependentLayers,{imagePositions:q})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(w){this.uploaded||(this.layoutVertexBuffer=w.createVertexBuffer(this.layoutVertexArray,sQ),this.centroidVertexBuffer=w.createVertexBuffer(this.centroidVertexArray,nQ.members,!0),this.indexBuffer=w.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(w),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(w,f,q,v,H,M){for(let A of X6(f,500)){let Q={x:0,y:0,sampleCount:0},W=this.layoutVertexArray.length;this.processPolygon(Q,v,w,A,M);let h=this.layoutVertexArray.length-W,K=Math.floor(Q.x/Q.sampleCount),D=Math.floor(Q.y/Q.sampleCount);for(let $=0;$<h;$++)this.centroidVertexArray.emplaceBack(K,D)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,w,q,{imagePositions:H,canonical:v})}processPolygon(w,f,q,v,H){if(v.length<1)return;if(qG(v[0]))return;for(let K of v)K.length!==0&&bV(w,K);let M={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},A=H.fill.getGranularityForZoomLevel(f.z),Q=Z9.types[q.type]==="Polygon";for(let K of v){if(K.length===0)continue;if(qG(K))continue;let D=q9(K,A,Q);this._generateSideFaces(D,M)}if(!Q)return;let W=bG(v,f,A,!1),h=this.layoutVertexArray;gG((K,D)=>{Tg(h,K,D,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,W.verticesFlattened,W.indicesTriangles)}_generateSideFaces(w,f){let q=0;for(let v=1;v<w.length;v++){let H=w[v],M=w[v-1];if(gV(H,M))continue;f.segment.vertexLength+4>V0.MAX_VERTEX_ARRAY_LENGTH&&(f.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let A=H.sub(M)._perp()._unit(),Q=M.dist(H);q+Q>32768&&(q=0),Tg(this.layoutVertexArray,H.x,H.y,A.x,A.y,0,0,q),Tg(this.layoutVertexArray,H.x,H.y,A.x,A.y,0,1,q),q+=Q,Tg(this.layoutVertexArray,M.x,M.y,A.x,A.y,0,0,q),Tg(this.layoutVertexArray,M.x,M.y,A.x,A.y,0,1,q);let W=f.segment.vertexLength;this.indexArray.emplaceBack(W,W+2,W+1),this.indexArray.emplaceBack(W+1,W+2,W+3),f.segment.vertexLength+=4,f.segment.primitiveLength+=2}}}function bV(w,f){for(let q=0;q<f.length;q++){let v=f[q];q===f.length-1&&f[0].x===v.x&&f[0].y===v.y||(w.x+=v.x,w.y+=v.y,w.sampleCount++)}}function gV(w,f){return w.x===f.x&&(w.x<0||w.x>J0)||w.y===f.y&&(w.y<0||w.y>J0)}function qG(w){return w.every((f)=>f.x<0)||w.every((f)=>f.x>J0)||w.every((f)=>f.y<0)||w.every((f)=>f.y>J0)}let ZG;o1("FillExtrusionBucket",Ax,{omit:["layers","features"]});var fV={get paint(){return ZG=ZG||new W2({"fill-extrusion-opacity":new e1(M1["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Y0(M1["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new e1(M1["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new e1(M1["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new y7(M1["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Y0(M1["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Y0(M1["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new e1(M1["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class YG extends G3{constructor(w,f){super(w,fV,f)}createBucket(w){return new Ax(w)}queryRadius(){return kx(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:w,feature:f,featureState:q,geometry:v,transform:H,pixelsToTileUnits:M,pixelPosMatrix:A}){let Q=vx(w,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-H.bearingInRadians,M),W=this.paint.get("fill-extrusion-height").evaluate(f,q),h=this.paint.get("fill-extrusion-base").evaluate(f,q),K=function($,R){let _=[];for(let j of $){let o=[j.x,j.y,0,1];i5(o,o,R),_.push(new l(o[0]/o[3],o[1]/o[3]))}return _}(Q,A),D=function($,R,_,j){let o=[],t=[],U1=j[8]*R,g1=j[9]*R,G1=j[10]*R,h1=j[11]*R,K1=j[8]*_,j1=j[9]*_,T1=j[10]*_,_1=j[11]*_;for(let t1 of $){let c1=[],a1=[];for(let S1 of t1){let{x:E1,y:Q0}=S1,A0=j[0]*E1+j[4]*Q0+j[12],g0=j[1]*E1+j[5]*Q0+j[13],x0=j[2]*E1+j[6]*Q0+j[14],S0=j[3]*E1+j[7]*Q0+j[15],Z2=x0+G1,P5=S0+h1,z3=A0+K1,p3=g0+j1,B3=x0+T1,w2=S0+_1,l5=new l((A0+U1)/P5,(g0+g1)/P5);l5.z=Z2/P5,c1.push(l5);let Y2=new l(z3/w2,p3/w2);Y2.z=B3/w2,a1.push(Y2)}o.push(c1),t.push(a1)}return[o,t]}(v,h,W,A);return function($,R,_){let j=1/0;NJ(_,R)&&(j=kG(_,R[0]));for(let o=0;o<R.length;o++){let t=R[o],U1=$[o];for(let g1=0;g1<t.length-1;g1++){let G1=t[g1],h1=[G1,t[g1+1],U1[g1+1],U1[g1],G1];RJ(_,h1)&&(j=Math.min(j,kG(_,h1)))}}return j!==1/0&&j}(D[0],D[1],K)}}function $g(w,f){return w.x*f.x+w.y*f.y}function kG(w,f){if(w.length===1){let q=0,v=f[q++],H;for(;!H||v.equals(H);)if(H=f[q++],!H)return 1/0;for(;q<f.length;q++){let M=f[q],A=w[0],Q=H.sub(v),W=M.sub(v),h=A.sub(v),K=$g(Q,Q),D=$g(Q,W),$=$g(W,W),R=$g(h,Q),_=$g(h,W),j=K*$-D*D,o=($*R-D*_)/j,t=(K*_-D*R)/j,U1=v.z*(1-o-t)+H.z*o+M.z*t;if(isFinite(U1))return U1}return 1/0}{let q=1/0;for(let v of f)q=Math.min(q,v.z);return q}}let zV=K5([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:xV}=zV,qV=K5([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:ZV}=qV,YV=Math.cos(Math.PI/180*37.5),vG=Math.pow(2,14)/0.5;class Mx{constructor(w){this.zoom=w.zoom,this.overscaling=w.overscaling,this.layers=w.layers,this.layerIds=this.layers.map((f)=>f.id),this.index=w.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((f)=>{this.gradients[f.id]={}}),this.layoutVertexArray=new V1,this.layoutVertexArray2=new W1,this.indexArray=new W0,this.programConfigurations=new T4(w.layers,w.zoom),this.segments=new V0,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((f)=>f.isStateDependent()).map((f)=>f.id)}populate(w,f,q){this.hasDependencies=Gx("line",this.layers,f)||this.hasLineDasharray(this.layers);let v=this.layers[0].layout.get("line-sort-key"),H=!v.isConstant(),M=[];for(let{feature:A,id:Q,index:W,sourceLayerIndex:h}of w){let K=this.layers[0]._featureFilter.needGeometry,D=f9(A,K);if(!this.layers[0]._featureFilter.filter(new n0(this.zoom),D,q))continue;let $=H?v.evaluate(D,{},q):void 0,R={id:Q,properties:A.properties,type:A.type,sourceLayerIndex:h,index:W,geometry:K?D.geometry:g9(A),patterns:{},dashes:{},sortKey:$};M.push(R)}H&&M.sort((A,Q)=>A.sortKey-Q.sortKey);for(let A of M){let{geometry:Q,index:W,sourceLayerIndex:h}=A;this.hasDependencies?(Gx("line",this.layers,f)?jZ("line",this.layers,A,{zoom:this.zoom},f):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,A,this.zoom,f),this.patternFeatures.push(A)):this.addFeature(A,Q,W,q,{},{},f.subdivisionGranularity),f.featureIndex.insert(w[W].feature,Q,W,h,this.index)}}update(w,f,q,v){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(w,f,this.stateDependentLayers,{imagePositions:q,dashPositions:v})}addFeatures(w,f,q,v){for(let H of this.patternFeatures)this.addFeature(H,H.geometry,H.index,f,q,v,w.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(w){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=w.createVertexBuffer(this.layoutVertexArray2,ZV)),this.layoutVertexBuffer=w.createVertexBuffer(this.layoutVertexArray,xV),this.indexBuffer=w.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(w),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(w){if(w.properties&&Object.prototype.hasOwnProperty.call(w.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(w.properties,"mapbox_clip_end"))return{start:+w.properties.mapbox_clip_start,end:+w.properties.mapbox_clip_end}}addFeature(w,f,q,v,H,M,A){let Q=this.layers[0].layout,W=Q.get("line-join").evaluate(w,{}),h=Q.get("line-cap"),K=Q.get("line-miter-limit"),D=Q.get("line-round-limit");this.lineClips=this.lineFeatureClips(w);for(let $ of f)this.addLine($,w,W,h,K,D,v,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,w,q,{imagePositions:H,dashPositions:M,canonical:v})}addLine(w,f,q,v,H,M,A,Q){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,w=q9(w,A?Q.line.getGranularityForZoomLevel(A.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let U1=0;U1<w.length-1;U1++)this.totalDistance+=w[U1].dist(w[U1+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let W=Z9.types[f.type]==="Polygon",h=w.length;for(;h>=2&&w[h-1].equals(w[h-2]);)h--;let K=0;for(;K<h-1&&w[K].equals(w[K+1]);)K++;if(h<(W?3:2))return;q==="bevel"&&(H=1.05);let D=this.overscaling<=16?122880/(512*this.overscaling):0,$=this.segments.prepareSegment(10*h,this.layoutVertexArray,this.indexArray),R,_,j,o,t;this.e1=this.e2=-1,W&&(R=w[h-2],t=w[K].sub(R)._unit()._perp());for(let U1=K;U1<h;U1++){if(j=U1===h-1?W?w[K+1]:void 0:w[U1+1],j&&w[U1].equals(j))continue;t&&(o=t),R&&(_=R),R=w[U1],t=j?j.sub(R)._unit()._perp():o,o=o||t;let g1=o.add(t);g1.x===0&&g1.y===0||g1._unit();let G1=o.x*t.x+o.y*t.y,h1=g1.x*t.x+g1.y*t.y,K1=h1!==0?1/h1:1/0,j1=2*Math.sqrt(2-2*h1),T1=h1<YV&&_&&j,_1=o.x*t.y-o.y*t.x>0;if(T1&&U1>K){let a1=R.dist(_);if(a1>2*D){let S1=R.sub(R.sub(_)._mult(D/a1)._round());this.updateDistance(_,S1),this.addCurrentVertex(S1,o,0,0,$),_=S1}}let t1=_&&j,c1=t1?q:W?"butt":v;if(t1&&c1==="round"&&(K1<M?c1="miter":K1<=2&&(c1="fakeround")),c1==="miter"&&K1>H&&(c1="bevel"),c1==="bevel"&&(K1>2&&(c1="flipbevel"),K1<H&&(c1="miter")),_&&this.updateDistance(_,R),c1==="miter")g1._mult(K1),this.addCurrentVertex(R,g1,0,0,$);else if(c1==="flipbevel"){if(K1>100)g1=t.mult(-1);else{let a1=K1*o.add(t).mag()/o.sub(t).mag();g1._perp()._mult(a1*(_1?-1:1))}this.addCurrentVertex(R,g1,0,0,$),this.addCurrentVertex(R,g1.mult(-1),0,0,$)}else if(c1==="bevel"||c1==="fakeround"){let a1=-Math.sqrt(K1*K1-1),S1=_1?a1:0,E1=_1?0:a1;if(_&&this.addCurrentVertex(R,o,S1,E1,$),c1==="fakeround"){let Q0=Math.round(180*j1/Math.PI/20);for(let A0=1;A0<Q0;A0++){let g0=A0/Q0;if(g0!==0.5){let S0=g0-0.5;g0+=g0*S0*(g0-1)*((1.0904+G1*(G1*(3.55645-1.43519*G1)-3.2452))*S0*S0+(0.848013+G1*(0.215638*G1-1.06021)))}let x0=t.sub(o)._mult(g0)._add(o)._unit()._mult(_1?-1:1);this.addHalfVertex(R,x0.x,x0.y,!1,_1,0,$)}}j&&this.addCurrentVertex(R,t,-S1,-E1,$)}else if(c1==="butt")this.addCurrentVertex(R,g1,0,0,$);else if(c1==="square"){let a1=_?1:-1;this.addCurrentVertex(R,g1,a1,a1,$)}else c1==="round"&&(_&&(this.addCurrentVertex(R,o,0,0,$),this.addCurrentVertex(R,o,1,1,$,!0)),j&&(this.addCurrentVertex(R,t,-1,-1,$,!0),this.addCurrentVertex(R,t,0,0,$)));if(T1&&U1<h-1){let a1=R.dist(j);if(a1>2*D){let S1=R.add(j.sub(R)._mult(D/a1)._round());this.updateDistance(R,S1),this.addCurrentVertex(S1,t,0,0,$),R=S1}}}}addCurrentVertex(w,f,q,v,H,M=!1){let A=f.y*v-f.x,Q=-f.y-f.x*v;this.addHalfVertex(w,f.x+f.y*q,f.y-f.x*q,M,!1,q,H),this.addHalfVertex(w,A,Q,M,!0,-v,H),this.distance>vG/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(w,f,q,v,H,M))}addHalfVertex({x:w,y:f},q,v,H,M,A,Q){let W=0.5*(this.lineClips?this.scaledDistance*(vG-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((w<<1)+(H?1:0),(f<<1)+(M?1:0),Math.round(63*q)+128,Math.round(63*v)+128,1+(A===0?0:A<0?-1:1)|(63&W)<<2,W>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);let h=Q.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,h,this.e2),Q.primitiveLength++),M?this.e2=h:this.e1=h}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(w,f){this.distance+=w.dist(f),this.updateScaledDistance()}hasLineDasharray(w){for(let f of w){let q=f.paint.get("line-dasharray");if(q&&!q.isConstant())return!0}return!1}addLineDashDependencies(w,f,q,v){for(let H of w){let M=H.paint.get("line-dasharray");if(!M||M.value.kind==="constant")continue;let A=H.layout.get("line-cap")==="round",Q={dasharray:M.value.evaluate({zoom:q-1},f,{}),round:A},W={dasharray:M.value.evaluate({zoom:q},f,{}),round:A},h={dasharray:M.value.evaluate({zoom:q+1},f,{}),round:A},K=`${Q.dasharray.join(",")},${Q.round}`,D=`${W.dasharray.join(",")},${W.round}`,$=`${h.dasharray.join(",")},${h.round}`;v.dashDependencies[K]=Q,v.dashDependencies[D]=W,v.dashDependencies[$]=h,f.dashes[H.id]={min:K,mid:D,max:$}}}}let JG,GG;o1("LineBucket",Mx,{omit:["layers","patternFeatures"]});var HG={get paint(){return GG=GG||new W2({"line-opacity":new Y0(M1.paint_line["line-opacity"]),"line-color":new Y0(M1.paint_line["line-color"]),"line-translate":new e1(M1.paint_line["line-translate"]),"line-translate-anchor":new e1(M1.paint_line["line-translate-anchor"]),"line-width":new Y0(M1.paint_line["line-width"]),"line-gap-width":new Y0(M1.paint_line["line-gap-width"]),"line-offset":new Y0(M1.paint_line["line-offset"]),"line-blur":new Y0(M1.paint_line["line-blur"]),"line-dasharray":new y7(M1.paint_line["line-dasharray"]),"line-pattern":new y7(M1.paint_line["line-pattern"]),"line-gradient":new R7(M1.paint_line["line-gradient"])})},get layout(){return JG=JG||new W2({"line-cap":new e1(M1.layout_line["line-cap"]),"line-join":new Y0(M1.layout_line["line-join"]),"line-miter-limit":new e1(M1.layout_line["line-miter-limit"]),"line-round-limit":new e1(M1.layout_line["line-round-limit"]),"line-sort-key":new Y0(M1.layout_line["line-sort-key"])})}};class UG extends Y0{possiblyEvaluate(w,f){return f=new n0(Math.floor(f.zoom),{now:f.now,fadeDuration:f.fadeDuration,zoomHistory:f.zoomHistory,transition:f.transition}),super.possiblyEvaluate(w,f)}evaluate(w,f,q,v){return f=s0({},f,{zoom:Math.floor(f.zoom)}),super.evaluate(w,f,q,v)}}let Xx;class BG extends G3{constructor(w,f){super(w,HG,f),this.gradientVersion=0,Xx||(Xx=new UG(HG.paint.properties["line-width"].specification),Xx.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(w){if(w==="line-gradient"){let f=this.gradientExpression();this.stepInterpolant=!!function(q){return q._styleExpression!==void 0}(f)&&f._styleExpression.expression instanceof o4,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(w,f){super.recalculate(w,f),this.paint._values["line-floorwidth"]=Xx.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,w)}createBucket(w){return new Mx(w)}queryRadius(w){let f=w,q=AG(Kw("line-width",this,f),Kw("line-gap-width",this,f)),v=Kw("line-offset",this,f);return q/2+Math.abs(v)+kx(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:w,feature:f,featureState:q,geometry:v,transform:H,pixelsToTileUnits:M}){let A=vx(w,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-H.bearingInRadians,M),Q=M/2*AG(this.paint.get("line-width").evaluate(f,q),this.paint.get("line-gap-width").evaluate(f,q)),W=this.paint.get("line-offset").evaluate(f,q);return W&&(v=function(h,K){let D=[];for(let $=0;$<h.length;$++){let R=h[$],_=[];for(let j=0;j<R.length;j++){let o=R[j-1],t=R[j],U1=R[j+1],g1=j===0?new l(0,0):t.sub(o)._unit()._perp(),G1=j===R.length-1?new l(0,0):U1.sub(t)._unit()._perp(),h1=g1._add(G1)._unit(),K1=h1.x*G1.x+h1.y*G1.y;K1!==0&&h1._mult(1/K1),_.push(h1._mult(K)._add(t))}D.push(_)}return D}(v,W*M)),function(h,K,D){for(let $=0;$<K.length;$++){let R=K[$];if(h.length>=3){for(let _=0;_<R.length;_++)if(Fw(h,R[_]))return!0}if(FQ(h,R,D))return!0}return!1}(A,v,Q)}isTileClipped(){return!0}}function AG(w,f){return f>0?f+2*w:w}let kV=K5([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),vV=K5([{name:"a_projected_pos",components:3,type:"Float32"}],4);K5([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let JV=K5([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);K5([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let MG=K5([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),GV=K5([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function HV(w,f,q){return w.sections.forEach((v)=>{v.text=function(H,M,A){let Q=M.layout.get("text-transform").evaluate(A,{});return Q==="uppercase"?H=H.toLocaleUpperCase():Q==="lowercase"&&(H=H.toLocaleLowerCase()),v4.applyArabicShaping&&(H=v4.applyArabicShaping(H)),H}(v.text,f,q)}),w}K5([{name:"triangle",components:3,type:"Uint16"}]),K5([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),K5([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),K5([{type:"Float32",name:"offsetX"}]),K5([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),K5([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);let jg={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var q2=24;let pZ=4294967296,XG=1/pZ,QG=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class Qx{constructor(w=new Uint8Array(16)){this.buf=ArrayBuffer.isView(w)?w:new Uint8Array(w),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(w,f,q=this.length){for(;this.pos<q;){let v=this.readVarint(),H=v>>3,M=this.pos;this.type=7&v,w(H,f,this),this.pos===M&&this.skip(v)}return f}readMessage(w,f){return this.readFields(w,f,this.readVarint()+this.pos)}readFixed32(){let w=this.dataView.getUint32(this.pos,!0);return this.pos+=4,w}readSFixed32(){let w=this.dataView.getInt32(this.pos,!0);return this.pos+=4,w}readFixed64(){let w=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*pZ;return this.pos+=8,w}readSFixed64(){let w=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*pZ;return this.pos+=8,w}readFloat(){let w=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,w}readDouble(){let w=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,w}readVarint(w){let f=this.buf,q,v;return v=f[this.pos++],q=127&v,v<128?q:(v=f[this.pos++],q|=(127&v)<<7,v<128?q:(v=f[this.pos++],q|=(127&v)<<14,v<128?q:(v=f[this.pos++],q|=(127&v)<<21,v<128?q:(v=f[this.pos],q|=(15&v)<<28,function(H,M,A){let Q=A.buf,W,h;if(h=Q[A.pos++],W=(112&h)>>4,h<128)return Dw(H,W,M);if(h=Q[A.pos++],W|=(127&h)<<3,h<128)return Dw(H,W,M);if(h=Q[A.pos++],W|=(127&h)<<10,h<128)return Dw(H,W,M);if(h=Q[A.pos++],W|=(127&h)<<17,h<128)return Dw(H,W,M);if(h=Q[A.pos++],W|=(127&h)<<24,h<128)return Dw(H,W,M);if(h=Q[A.pos++],W|=(1&h)<<31,h<128)return Dw(H,W,M);throw Error("Expected varint not more than 10 bytes")}(q,w,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){let w=this.readVarint();return w%2==1?(w+1)/-2:w/2}readBoolean(){return Boolean(this.readVarint())}readString(){let w=this.readVarint()+this.pos,f=this.pos;return this.pos=w,w-f>=12&&QG?QG.decode(this.buf.subarray(f,w)):function(q,v,H){let M="",A=v;for(;A<H;){let Q=q[A],W,h,K,D=null,$=Q>239?4:Q>223?3:Q>191?2:1;if(A+$>H)break;$===1?Q<128&&(D=Q):$===2?(W=q[A+1],(192&W)==128&&(D=(31&Q)<<6|63&W,D<=127&&(D=null))):$===3?(W=q[A+1],h=q[A+2],(192&W)==128&&(192&h)==128&&(D=(15&Q)<<12|(63&W)<<6|63&h,(D<=2047||D>=55296&&D<=57343)&&(D=null))):$===4&&(W=q[A+1],h=q[A+2],K=q[A+3],(192&W)==128&&(192&h)==128&&(192&K)==128&&(D=(15&Q)<<18|(63&W)<<12|(63&h)<<6|63&K,(D<=65535||D>=1114112)&&(D=null))),D===null?(D=65533,$=1):D>65535&&(D-=65536,M+=String.fromCharCode(D>>>10&1023|55296),D=56320|1023&D),M+=String.fromCharCode(D),A+=$}return M}(this.buf,f,w)}readBytes(){let w=this.readVarint()+this.pos,f=this.buf.subarray(this.pos,w);return this.pos=w,f}readPackedVarint(w=[],f){let q=this.readPackedEnd();for(;this.pos<q;)w.push(this.readVarint(f));return w}readPackedSVarint(w=[]){let f=this.readPackedEnd();for(;this.pos<f;)w.push(this.readSVarint());return w}readPackedBoolean(w=[]){let f=this.readPackedEnd();for(;this.pos<f;)w.push(this.readBoolean());return w}readPackedFloat(w=[]){let f=this.readPackedEnd();for(;this.pos<f;)w.push(this.readFloat());return w}readPackedDouble(w=[]){let f=this.readPackedEnd();for(;this.pos<f;)w.push(this.readDouble());return w}readPackedFixed32(w=[]){let f=this.readPackedEnd();for(;this.pos<f;)w.push(this.readFixed32());return w}readPackedSFixed32(w=[]){let f=this.readPackedEnd();for(;this.pos<f;)w.push(this.readSFixed32());return w}readPackedFixed64(w=[]){let f=this.readPackedEnd();for(;this.pos<f;)w.push(this.readFixed64());return w}readPackedSFixed64(w=[]){let f=this.readPackedEnd();for(;this.pos<f;)w.push(this.readSFixed64());return w}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(w){let f=7&w;if(f===0)for(;this.buf[this.pos++]>127;);else if(f===2)this.pos=this.readVarint()+this.pos;else if(f===5)this.pos+=4;else{if(f!==1)throw Error(`Unimplemented type: ${f}`);this.pos+=8}}writeTag(w,f){this.writeVarint(w<<3|f)}realloc(w){let f=this.length||16;for(;f<this.pos+w;)f*=2;if(f!==this.length){let q=new Uint8Array(f);q.set(this.buf),this.buf=q,this.dataView=new DataView(q.buffer),this.length=f}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(w){this.realloc(4),this.dataView.setInt32(this.pos,w,!0),this.pos+=4}writeSFixed32(w){this.realloc(4),this.dataView.setInt32(this.pos,w,!0),this.pos+=4}writeFixed64(w){this.realloc(8),this.dataView.setInt32(this.pos,-1&w,!0),this.dataView.setInt32(this.pos+4,Math.floor(w*XG),!0),this.pos+=8}writeSFixed64(w){this.realloc(8),this.dataView.setInt32(this.pos,-1&w,!0),this.dataView.setInt32(this.pos+4,Math.floor(w*XG),!0),this.pos+=8}writeVarint(w){(w=+w||0)>268435455||w<0?function(f,q){let v,H;if(f>=0?(v=f%4294967296|0,H=f/4294967296|0):(v=~(-f%4294967296),H=~(-f/4294967296),4294967295^v?v=v+1|0:(v=0,H=H+1|0)),f>=18446744073709552000||f<-18446744073709552000)throw Error("Given varint doesn't fit into 10 bytes");q.realloc(10),function(M,A,Q){Q.buf[Q.pos++]=127&M|128,M>>>=7,Q.buf[Q.pos++]=127&M|128,M>>>=7,Q.buf[Q.pos++]=127&M|128,M>>>=7,Q.buf[Q.pos++]=127&M|128,Q.buf[Q.pos]=127&(M>>>=7)}(v,0,q),function(M,A){let Q=(7&M)<<4;A.buf[A.pos++]|=Q|((M>>>=3)?128:0),M&&(A.buf[A.pos++]=127&M|((M>>>=7)?128:0),M&&(A.buf[A.pos++]=127&M|((M>>>=7)?128:0),M&&(A.buf[A.pos++]=127&M|((M>>>=7)?128:0),M&&(A.buf[A.pos++]=127&M|((M>>>=7)?128:0),M&&(A.buf[A.pos++]=127&M)))))}(H,q)}(w,this):(this.realloc(4),this.buf[this.pos++]=127&w|(w>127?128:0),w<=127||(this.buf[this.pos++]=127&(w>>>=7)|(w>127?128:0),w<=127||(this.buf[this.pos++]=127&(w>>>=7)|(w>127?128:0),w<=127||(this.buf[this.pos++]=w>>>7&127))))}writeSVarint(w){this.writeVarint(w<0?2*-w-1:2*w)}writeBoolean(w){this.writeVarint(+w)}writeString(w){w=String(w),this.realloc(4*w.length),this.pos++;let f=this.pos;this.pos=function(v,H,M){for(let A,Q,W=0;W<H.length;W++){if(A=H.charCodeAt(W),A>55295&&A<57344){if(!Q){A>56319||W+1===H.length?(v[M++]=239,v[M++]=191,v[M++]=189):Q=A;continue}if(A<56320){v[M++]=239,v[M++]=191,v[M++]=189,Q=A;continue}A=Q-55296<<10|A-56320|65536,Q=null}else Q&&(v[M++]=239,v[M++]=191,v[M++]=189,Q=null);A<128?v[M++]=A:(A<2048?v[M++]=A>>6|192:(A<65536?v[M++]=A>>12|224:(v[M++]=A>>18|240,v[M++]=A>>12&63|128),v[M++]=A>>6&63|128),v[M++]=63&A|128)}return M}(this.buf,w,this.pos);let q=this.pos-f;q>=128&&VG(f,q,this),this.pos=f-1,this.writeVarint(q),this.pos+=q}writeFloat(w){this.realloc(4),this.dataView.setFloat32(this.pos,w,!0),this.pos+=4}writeDouble(w){this.realloc(8),this.dataView.setFloat64(this.pos,w,!0),this.pos+=8}writeBytes(w){let f=w.length;this.writeVarint(f),this.realloc(f);for(let q=0;q<f;q++)this.buf[this.pos++]=w[q]}writeRawMessage(w,f){this.pos++;let q=this.pos;w(f,this);let v=this.pos-q;v>=128&&VG(q,v,this),this.pos=q-1,this.writeVarint(v),this.pos+=v}writeMessage(w,f,q){this.writeTag(w,2),this.writeRawMessage(f,q)}writePackedVarint(w,f){f.length&&this.writeMessage(w,UV,f)}writePackedSVarint(w,f){f.length&&this.writeMessage(w,BV,f)}writePackedBoolean(w,f){f.length&&this.writeMessage(w,XV,f)}writePackedFloat(w,f){f.length&&this.writeMessage(w,AV,f)}writePackedDouble(w,f){f.length&&this.writeMessage(w,MV,f)}writePackedFixed32(w,f){f.length&&this.writeMessage(w,QV,f)}writePackedSFixed32(w,f){f.length&&this.writeMessage(w,VV,f)}writePackedFixed64(w,f){f.length&&this.writeMessage(w,LV,f)}writePackedSFixed64(w,f){f.length&&this.writeMessage(w,WV,f)}writeBytesField(w,f){this.writeTag(w,2),this.writeBytes(f)}writeFixed32Field(w,f){this.writeTag(w,5),this.writeFixed32(f)}writeSFixed32Field(w,f){this.writeTag(w,5),this.writeSFixed32(f)}writeFixed64Field(w,f){this.writeTag(w,1),this.writeFixed64(f)}writeSFixed64Field(w,f){this.writeTag(w,1),this.writeSFixed64(f)}writeVarintField(w,f){this.writeTag(w,0),this.writeVarint(f)}writeSVarintField(w,f){this.writeTag(w,0),this.writeSVarint(f)}writeStringField(w,f){this.writeTag(w,2),this.writeString(f)}writeFloatField(w,f){this.writeTag(w,5),this.writeFloat(f)}writeDoubleField(w,f){this.writeTag(w,1),this.writeDouble(f)}writeBooleanField(w,f){this.writeVarintField(w,+f)}}function Dw(w,f,q){return q?4294967296*f+(w>>>0):4294967296*(f>>>0)+(w>>>0)}function VG(w,f,q){let v=f<=16383?1:f<=2097151?2:f<=268435455?3:Math.floor(Math.log(f)/(7*Math.LN2));q.realloc(v);for(let H=q.pos-1;H>=w;H--)q.buf[H+v]=q.buf[H]}function UV(w,f){for(let q=0;q<w.length;q++)f.writeVarint(w[q])}function BV(w,f){for(let q=0;q<w.length;q++)f.writeSVarint(w[q])}function AV(w,f){for(let q=0;q<w.length;q++)f.writeFloat(w[q])}function MV(w,f){for(let q=0;q<w.length;q++)f.writeDouble(w[q])}function XV(w,f){for(let q=0;q<w.length;q++)f.writeBoolean(w[q])}function QV(w,f){for(let q=0;q<w.length;q++)f.writeFixed32(w[q])}function VV(w,f){for(let q=0;q<w.length;q++)f.writeSFixed32(w[q])}function LV(w,f){for(let q=0;q<w.length;q++)f.writeFixed64(w[q])}function WV(w,f){for(let q=0;q<w.length;q++)f.writeSFixed64(w[q])}function hV(w,f,q){w===1&&q.readMessage(FV,f)}function FV(w,f,q){if(w===3){let{id:v,bitmap:H,width:M,height:A,left:Q,top:W,advance:h}=q.readMessage(KV,{});f.push({id:v,bitmap:new Dg({width:M+6,height:A+6},H),metrics:{width:M,height:A,left:Q,top:W,advance:h}})}}function KV(w,f,q){w===1?f.id=q.readVarint():w===2?f.bitmap=q.readBytes():w===3?f.width=q.readVarint():w===4?f.height=q.readVarint():w===5?f.left=q.readSVarint():w===6?f.top=q.readSVarint():w===7&&(f.advance=q.readVarint())}function LG(w){let f=0,q=0;for(let A of w)f+=A.w*A.h,q=Math.max(q,A.w);w.sort((A,Q)=>Q.h-A.h);let v=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(f/0.95)),q),h:1/0}],H=0,M=0;for(let A of w)for(let Q=v.length-1;Q>=0;Q--){let W=v[Q];if(!(A.w>W.w||A.h>W.h)){if(A.x=W.x,A.y=W.y,M=Math.max(M,A.y+A.h),H=Math.max(H,A.x+A.w),A.w===W.w&&A.h===W.h){let h=v.pop();h&&Q<v.length&&(v[Q]=h)}else A.h===W.h?(W.x+=A.w,W.w-=A.w):A.w===W.w?(W.y+=A.h,W.h-=A.h):(v.push({x:W.x+A.w,y:W.y,w:W.w-A.w,h:A.h}),W.y+=A.h,W.h-=A.h);break}}return{w:H,h:M,fill:f/(H*M)||0}}class Vx{constructor(w,{pixelRatio:f,version:q,stretchX:v,stretchY:H,content:M,textFitWidth:A,textFitHeight:Q}){this.paddedRect=w,this.pixelRatio=f,this.stretchX=v,this.stretchY=H,this.content=M,this.version=q,this.textFitWidth=A,this.textFitHeight=Q}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class cZ{constructor(w,f){let q={},v={};this.haveRenderCallbacks=[];let H=[];this.addImages(w,q,H),this.addImages(f,v,H);let{w:M,h:A}=LG(H),Q=new U3({width:M||1,height:A||1});for(let W in w){let h=w[W],K=q[W].paddedRect;U3.copy(h.data,Q,{x:0,y:0},{x:K.x+1,y:K.y+1},h.data)}for(let W in f){let h=f[W],K=v[W].paddedRect,D=K.x+1,$=K.y+1,R=h.data.width,_=h.data.height;U3.copy(h.data,Q,{x:0,y:0},{x:D,y:$},h.data),U3.copy(h.data,Q,{x:0,y:_-1},{x:D,y:$-1},{width:R,height:1}),U3.copy(h.data,Q,{x:0,y:0},{x:D,y:$+_},{width:R,height:1}),U3.copy(h.data,Q,{x:R-1,y:0},{x:D-1,y:$},{width:1,height:_}),U3.copy(h.data,Q,{x:0,y:0},{x:D+R,y:$},{width:1,height:_})}this.image=Q,this.iconPositions=q,this.patternPositions=v}addImages(w,f,q){for(let v in w){let H=w[v],M={x:0,y:0,w:H.data.width+2,h:H.data.height+2};q.push(M),f[v]=new Vx(M,H),H.hasRenderCallback&&this.haveRenderCallbacks.push(v)}}patchUpdatedImages(w,f){w.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let q in w.updatedImages)this.patchUpdatedImage(this.iconPositions[q],w.getImage(q),f),this.patchUpdatedImage(this.patternPositions[q],w.getImage(q),f)}patchUpdatedImage(w,f,q){if(!w||!f)return;if(w.version===f.version)return;w.version=f.version;let[v,H]=w.tl;q.update(f.data,void 0,{x:v,y:H})}}var $6;o1("ImagePosition",Vx),o1("ImageAtlas",cZ),U.ao=void 0,($6=U.ao||(U.ao={}))[$6.none=0]="none",$6[$6.horizontal=1]="horizontal",$6[$6.vertical=2]="vertical",$6[$6.horizontalOnly=3]="horizontalOnly";class mg{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(w,f,q){let v=new mg;return v.scale=w||1,v.fontStack=f,v.verticalAlign=q||"bottom",v}static forImage(w,f){let q=new mg;return q.imageName=w,q.verticalAlign=f||"bottom",q}}class dw{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(w,f){let q=new dw;for(let v=0;v<w.sections.length;v++){let H=w.sections[v];H.image?q.addImageSection(H):q.addTextSection(H,f)}return q}length(){return this.text.length}getSection(w){return this.sections[this.sectionIndex[w]]}getSectionIndex(w){return this.sectionIndex[w]}getCharCode(w){return this.text.charCodeAt(w)}verticalizePunctuation(){this.text=function(w){let f="";for(let q=0;q<w.length;q++){let v=w.charCodeAt(q+1)||null,H=w.charCodeAt(q-1)||null;f+=v&&tz(v)&&!jg[w[q+1]]||H&&tz(H)&&!jg[w[q-1]]||!jg[w[q]]?w[q]:jg[w[q]]}return f}(this.text)}trim(){let w=0;for(let q=0;q<this.text.length&&Wx[this.text.charCodeAt(q)];q++)w++;let f=this.text.length;for(let q=this.text.length-1;q>=0&&q>=w&&Wx[this.text.charCodeAt(q)];q--)f--;this.text=this.text.substring(w,f),this.sectionIndex=this.sectionIndex.slice(w,f)}substring(w,f){let q=new dw;return q.text=this.text.substring(w,f),q.sectionIndex=this.sectionIndex.slice(w,f),q.sections=this.sections,q}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((w,f)=>Math.max(w,this.sections[f].scale),0)}getMaxImageSize(w){let f=0,q=0;for(let v=0;v<this.length();v++){let H=this.getSection(v);if(H.imageName){let M=w[H.imageName];if(!M)continue;let A=M.displaySize;f=Math.max(f,A[0]),q=Math.max(q,A[1])}}return{maxImageWidth:f,maxImageHeight:q}}addTextSection(w,f){this.text+=w.text,this.sections.push(mg.forText(w.scale,w.fontStack||f,w.verticalAlign));let q=this.sections.length-1;for(let v=0;v<w.text.length;++v)this.sectionIndex.push(q)}addImageSection(w){let f=w.image?w.image.name:"";if(f.length===0)return void r0("Can't add FormattedSection with an empty image.");let q=this.getNextImageSectionCharCode();q?(this.text+=String.fromCharCode(q),this.sections.push(mg.forImage(f,w.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):r0("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Lx(w,f,q,v,H,M,A,Q,W,h,K,D,$,R,_){let j=dw.fromFeature(w,H),o;D===U.ao.vertical&&j.verticalizePunctuation();let{processBidirectionalText:t,processStyledBidirectionalText:U1}=v4;if(t&&j.sections.length===1){o=[];let h1=t(j.toString(),aZ(j,h,M,f,v,R));for(let K1 of h1){let j1=new dw;j1.text=K1,j1.sections=j.sections;for(let T1=0;T1<K1.length;T1++)j1.sectionIndex.push(0);o.push(j1)}}else if(U1){o=[];let h1=U1(j.text,j.sectionIndex,aZ(j,h,M,f,v,R));for(let K1 of h1){let j1=new dw;j1.text=K1[0],j1.sectionIndex=K1[1],j1.sections=j.sections,o.push(j1)}}else o=function(h1,K1){let j1=[],T1=h1.text,_1=0;for(let t1 of K1)j1.push(h1.substring(_1,t1)),_1=t1;return _1<T1.length&&j1.push(h1.substring(_1,T1.length)),j1}(j,aZ(j,h,M,f,v,R));let g1=[],G1={positionedLines:g1,text:j.toString(),top:K[1],bottom:K[1],left:K[0],right:K[0],writingMode:D,iconsInText:!1,verticalizable:!1};return function(h1,K1,j1,T1,_1,t1,c1,a1,S1,E1,Q0,A0){let g0=0,x0=0,S0=0,Z2=0,P5=a1==="right"?1:a1==="left"?0:0.5,z3=q2/A0,p3=0;for(let l5 of _1){l5.trim();let Y2=l5.getMaxScale(),x3={positionedGlyphs:[],lineOffset:0};h1.positionedLines[p3]=x3;let F2=x3.positionedGlyphs,q3=0;if(!l5.length()){x0+=t1,++p3;continue}let c3=dV(T1,l5,z3);for(let A3=0;A3<l5.length();A3++){let b2=l5.getSection(A3),v2=l5.getSectionIndex(A3),J2=l5.getCharCode(A3),r5=OV(S1,Q0,J2),k5;if(b2.imageName){if(h1.iconsInText=!0,b2.scale=b2.scale*z3,k5=RV(b2,r5,Y2,c3,T1),!k5)continue;q3=Math.max(q3,k5.imageOffset)}else if(k5=yV(b2,J2,r5,c3,K1,j1),!k5)continue;let{rect:$4,metrics:Rw,baselineOffset:j4}=k5;F2.push({glyph:J2,imageName:b2.imageName,x:g0,y:x0+j4+-17,vertical:r5,scale:b2.scale,fontStack:b2.fontStack,sectionIndex:v2,metrics:Rw,rect:$4}),r5?(h1.verticalizable=!0,g0+=(b2.imageName?Rw.advance:q2)*b2.scale+E1):g0+=Rw.advance*b2.scale+E1}F2.length!==0&&(S0=Math.max(g0-E1,S0),NV(F2,0,F2.length-1,P5)),g0=0,x3.lineOffset=Math.max(q3,(Y2-1)*q2);let k2=t1*Y2+q3;x0+=k2,Z2=Math.max(k2,Z2),++p3}let{horizontalAlign:B3,verticalAlign:w2}=rZ(c1);(function(l5,Y2,x3,F2,q3,c3,k2,A3,b2){let v2=(Y2-x3)*q3,J2=0;J2=c3!==k2?-A3*F2- -17:-F2*b2*k2+0.5*k2;for(let r5 of l5)for(let k5 of r5.positionedGlyphs)k5.x+=v2,k5.y+=J2})(h1.positionedLines,P5,B3,w2,S0,Z2,t1,x0,_1.length),h1.top+=-w2*x0,h1.bottom=h1.top+x0,h1.left+=-B3*S0,h1.right=h1.left+S0}(G1,f,q,v,o,A,Q,W,D,h,$,_),!function(h1){for(let K1 of h1)if(K1.positionedGlyphs.length!==0)return!1;return!0}(g1)&&G1}let Wx={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},lV={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},CV={40:!0};function WG(w,f,q,v,H,M){if(f.imageName){let A=v[f.imageName];return A?A.displaySize[0]*f.scale*q2/M+H:0}{let A=q[f.fontStack],Q=A&&A[w];return Q?Q.metrics.advance*f.scale+H:0}}function hG(w,f,q,v){let H=Math.pow(w-f,2);return v?w<f?H/2:2*H:H+Math.abs(q)*q}function DV(w,f,q){let v=0;return w===10&&(v-=1e4),q&&(v+=150),w!==40&&w!==65288||(v+=50),f!==41&&f!==65289||(v+=50),v}function FG(w,f,q,v,H,M){let A=null,Q=hG(f,q,H,M);for(let W of v){let h=hG(f-W.x,q,H,M)+W.badness;h<=Q&&(A=W,Q=h)}return{index:w,x:f,priorBreak:A,badness:Q}}function KG(w){return w?KG(w.priorBreak).concat(w.index):[]}function aZ(w,f,q,v,H,M){if(!w)return[];let A=[],Q=function(D,$,R,_,j,o){let t=0;for(let U1=0;U1<D.length();U1++){let g1=D.getSection(U1);t+=WG(D.getCharCode(U1),g1,_,j,$,o)}return t/Math.max(1,Math.ceil(t/R))}(w,f,q,v,H,M),W=w.text.indexOf("​")>=0,h=0;for(let D=0;D<w.length();D++){let $=w.getSection(D),R=w.getCharCode(D);if(Wx[R]||(h+=WG(R,$,v,H,f,M)),D<w.length()-1){let _=!((K=R)<11904)&&(!!O0["CJK Compatibility Forms"](K)||!!O0["CJK Compatibility"](K)||!!O0["CJK Strokes"](K)||!!O0["CJK Symbols and Punctuation"](K)||!!O0["Enclosed CJK Letters and Months"](K)||!!O0["Halfwidth and Fullwidth Forms"](K)||!!O0["Ideographic Description Characters"](K)||!!O0["Vertical Forms"](K)||Uw.test(String.fromCodePoint(K)));(lV[R]||_||$.imageName||D!==w.length()-2&&CV[w.getCharCode(D+1)])&&A.push(FG(D+1,h,Q,A,DV(R,w.getCharCode(D+1),_&&W),!1))}}var K;return KG(FG(w.length(),h,Q,A,0,!0))}function rZ(w){let f=0.5,q=0.5;switch(w){case"right":case"top-right":case"bottom-right":f=1;break;case"left":case"top-left":case"bottom-left":f=0}switch(w){case"bottom":case"bottom-right":case"bottom-left":q=1;break;case"top":case"top-right":case"top-left":q=0}return{horizontalAlign:f,verticalAlign:q}}function dV(w,f,q){let v=f.getMaxScale()*q2,{maxImageWidth:H,maxImageHeight:M}=f.getMaxImageSize(w),A=Math.max(v,M*q);return{verticalLineContentWidth:Math.max(v,H*q),horizontalLineContentHeight:A}}function lG(w){switch(w){case"top":return 0;case"center":return 0.5;default:return 1}}function OV(w,f,q){return!(w===U.ao.horizontal||!f&&!c8(q)||f&&(Wx[q]||(v=q,/\p{sc=Arab}/u.test(String.fromCodePoint(v)))));var v}function yV(w,f,q,v,H,M){let A=M[w.fontStack],Q=function(h,K,D,$){if(h&&h.rect)return h;let R=K[D.fontStack],_=R&&R[$];return _?{rect:null,metrics:_.metrics}:null}(A&&A[f],H,w,f);if(Q===null)return null;let W;if(q)W=v.verticalLineContentWidth-w.scale*q2;else{let h=lG(w.verticalAlign);W=(v.horizontalLineContentHeight-w.scale*q2)*h}return{rect:Q.rect,metrics:Q.metrics,baselineOffset:W}}function RV(w,f,q,v,H){let M=H[w.imageName];if(!M)return null;let{paddedRect:A,displaySize:Q}=M,W={width:Q[0],height:Q[1],left:1,top:-3,advance:f?Q[1]:Q[0]},h;if(f)h=v.verticalLineContentWidth-Q[1]*w.scale;else{let K=lG(w.verticalAlign);h=(v.horizontalLineContentHeight-Q[1]*w.scale)*K}return{rect:A,metrics:W,baselineOffset:h,imageOffset:(f?Q[0]:Q[1])*w.scale-q2*q}}function NV(w,f,q,v){if(v===0)return;let H=w[q],M=(w[q].x+H.metrics.advance*H.scale)*v;for(let A=f;A<=q;A++)w[A].x-=M}function IV(w,f,q){let{horizontalAlign:v,verticalAlign:H}=rZ(q),M=f[0]-w.displaySize[0]*v,A=f[1]-w.displaySize[1]*H;return{image:w,top:A,bottom:A+w.displaySize[1],left:M,right:M+w.displaySize[0]}}function CG(w){var f,q;let{left:v,top:H}=w,M=w.right-v,A=w.bottom-H,Q=(f=w.image.textFitWidth)!==null&&f!==void 0?f:"stretchOrShrink",W=(q=w.image.textFitHeight)!==null&&q!==void 0?q:"stretchOrShrink",h=(w.image.content[2]-w.image.content[0])/(w.image.content[3]-w.image.content[1]);if(W==="proportional"){if(Q==="stretchOnly"&&M/A<h||Q==="proportional"){let K=Math.ceil(A*h);v*=K/M,M=K}}else if(Q==="proportional"&&W==="stretchOnly"&&h!==0&&M/A>h){let K=Math.ceil(M/h);H*=K/A,A=K}return{x1:v,y1:H,x2:v+M,y2:H+A}}function DG(w,f,q,v,H,M){let A=w.image,Q;if(A.content){let o=A.content,t=A.pixelRatio||1;Q=[o[0]/t,o[1]/t,A.displaySize[0]-o[2]/t,A.displaySize[1]-o[3]/t]}let W=f.left*M,h=f.right*M,K,D,$,R;q==="width"||q==="both"?(R=H[0]+W-v[3],D=H[0]+h+v[1]):(R=H[0]+(W+h-A.displaySize[0])/2,D=R+A.displaySize[0]);let _=f.top*M,j=f.bottom*M;return q==="height"||q==="both"?(K=H[1]+_-v[0],$=H[1]+j+v[2]):(K=H[1]+(_+j-A.displaySize[1])/2,$=K+A.displaySize[1]),{image:A,top:K,right:D,bottom:$,left:R,collisionPadding:Q}}let m7=128,j6=32640;function dG(w,f){let{expression:q}=f;if(q.kind==="constant")return{kind:"constant",layoutSize:q.evaluate(new n0(w+1))};if(q.kind==="source")return{kind:"source"};{let{zoomStops:v,interpolationType:H}=q,M=0;for(;M<v.length&&v[M]<=w;)M++;M=Math.max(0,M-1);let A=M;for(;A<v.length&&v[A]<w+1;)A++;A=Math.min(v.length-1,A);let Q=v[M],W=v[A];return q.kind==="composite"?{kind:"composite",minZoom:Q,maxZoom:W,interpolationType:H}:{kind:"camera",minZoom:Q,maxZoom:W,minSize:q.evaluate(new n0(Q)),maxSize:q.evaluate(new n0(W)),interpolationType:H}}}function oZ(w,f,q){let v="never",H=w.get(f);return H?v=H:w.get(q)&&(v="always"),v}let SV=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function hx(w,f,q,v,H,M,A,Q,W,h,K,D,$){let R=Q?Math.min(j6,Math.round(Q[0])):0,_=Q?Math.min(j6,Math.round(Q[1])):0;w.emplaceBack(f,q,Math.round(32*v),Math.round(32*H),M,A,(R<<1)+(W?1:0),_,16*h,16*K,256*D,256*$)}function nZ(w,f,q){w.emplaceBack(f.x,f.y,q),w.emplaceBack(f.x,f.y,q),w.emplaceBack(f.x,f.y,q),w.emplaceBack(f.x,f.y,q)}function TV(w){for(let f of w.sections)if(dZ(f.text))return!0;return!1}class Fx{constructor(w){this.layoutVertexArray=new O1,this.indexArray=new W0,this.programConfigurations=w,this.segments=new V0,this.dynamicLayoutVertexArray=new I1,this.opacityVertexArray=new D1,this.hasVisibleVertices=!1,this.placedSymbolArray=new d}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(w,f,q,v){this.isEmpty()||(q&&(this.layoutVertexBuffer=w.createVertexBuffer(this.layoutVertexArray,kV.members),this.indexBuffer=w.createIndexBuffer(this.indexArray,f),this.dynamicLayoutVertexBuffer=w.createVertexBuffer(this.dynamicLayoutVertexArray,vV.members,!0),this.opacityVertexBuffer=w.createVertexBuffer(this.opacityVertexArray,SV,!0),this.opacityVertexBuffer.itemSize=1),(q||v)&&this.programConfigurations.upload(w))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}o1("SymbolBuffers",Fx);class Kx{constructor(w,f,q){this.layoutVertexArray=new w,this.layoutAttributes=f,this.indexArray=new q,this.segments=new V0,this.collisionVertexArray=new B0}upload(w){this.layoutVertexBuffer=w.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=w.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=w.createVertexBuffer(this.collisionVertexArray,JV.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}o1("CollisionBuffers",Kx);class Y9{constructor(w){this.collisionBoxArray=w.collisionBoxArray,this.zoom=w.zoom,this.overscaling=Q3(globalThis)?Math.min(w.overscaling,128):w.overscaling,this.layers=w.layers,this.layerIds=this.layers.map((M)=>M.id),this.index=w.index,this.pixelRatio=w.pixelRatio,this.sourceLayerIndex=w.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];let f=this.layers[0]._unevaluatedLayout._values;this.textSizeData=dG(this.zoom,f["text-size"]),this.iconSizeData=dG(this.zoom,f["icon-size"]);let q=this.layers[0].layout,v=q.get("symbol-sort-key"),H=q.get("symbol-z-order");this.canOverlap=oZ(q,"text-overlap","text-allow-overlap")!=="never"||oZ(q,"icon-overlap","icon-allow-overlap")!=="never"||q.get("text-ignore-placement")||q.get("icon-ignore-placement"),this.sortFeaturesByKey=H!=="viewport-y"&&!v.isConstant(),this.sortFeaturesByY=(H==="viewport-y"||H==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,q.get("symbol-placement")==="point"&&(this.writingModes=q.get("text-writing-mode").map((M)=>U.ao[M])),this.stateDependentLayerIds=this.layers.filter((M)=>M.isStateDependent()).map((M)=>M.id),this.sourceID=w.sourceID}createArrays(){this.text=new Fx(new T4(this.layers,this.zoom,(w)=>/^text/.test(w))),this.icon=new Fx(new T4(this.layers,this.zoom,(w)=>/^icon/.test(w))),this.glyphOffsetArray=new E,this.lineVertexArray=new p,this.symbolInstances=new T,this.textAnchorOffsets=new c}calculateGlyphDependencies(w,f,q,v,H){for(let M=0;M<w.length;M++)if(f[w.charCodeAt(M)]=!0,(q||v)&&H){let A=jg[w.charAt(M)];A&&(f[A.charCodeAt(0)]=!0)}}populate(w,f,q){let v=this.layers[0],H=v.layout,M=H.get("text-font"),A=H.get("text-field"),Q=H.get("icon-image"),W=(A.value.kind!=="constant"||A.value.value instanceof X2&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(M.value.kind!=="constant"||M.value.value.length>0),h=Q.value.kind!=="constant"||!!Q.value.value||Object.keys(Q.parameters).length>0,K=H.get("symbol-sort-key");if(this.features=[],!W&&!h)return;let{iconDependencies:D,glyphDependencies:$,availableImages:R}=f,_=new n0(this.zoom);for(let{feature:j,id:o,index:t,sourceLayerIndex:U1}of w){let g1=v._featureFilter.needGeometry,G1=f9(j,g1);if(!v._featureFilter.filter(_,G1,q))continue;let h1,K1;if(g1||(G1.geometry=g9(j)),W){let T1=v.getValueAndResolveTokens("text-field",G1,q,R),_1=X2.factory(T1),t1=this.hasRTLText=this.hasRTLText||TV(_1);(!t1||v4.getRTLTextPluginStatus()==="unavailable"||t1&&v4.isParsed())&&(h1=HV(_1,v,G1))}if(h){let T1=v.getValueAndResolveTokens("icon-image",G1,q,R);K1=T1 instanceof V2?T1:V2.fromString(T1)}if(!h1&&!K1)continue;let j1=this.sortFeaturesByKey?K.evaluate(G1,{},q):void 0;if(this.features.push({id:o,text:h1,icon:K1,index:t,sourceLayerIndex:U1,geometry:G1.geometry,properties:j.properties,type:Z9.types[j.type],sortKey:j1}),K1&&(D[K1.name]=!0),h1){let T1=M.evaluate(G1,{},q).join(","),_1=H.get("text-rotation-alignment")!=="viewport"&&H.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(U.ao.vertical)>=0;for(let t1 of h1.sections)if(t1.image)D[t1.image.name]=!0;else{let c1=y6(h1.toString()),a1=t1.fontStack||T1,S1=$[a1]=$[a1]||{};this.calculateGlyphDependencies(t1.text,S1,_1,this.allowVerticalPlacement,c1)}}}H.get("symbol-placement")==="line"&&(this.features=function(j){let o={},t={},U1=[],g1=0;function G1(T1){U1.push(j[T1]),g1++}function h1(T1,_1,t1){let c1=t[T1];return delete t[T1],t[_1]=c1,U1[c1].geometry[0].pop(),U1[c1].geometry[0]=U1[c1].geometry[0].concat(t1[0]),c1}function K1(T1,_1,t1){let c1=o[_1];return delete o[_1],o[T1]=c1,U1[c1].geometry[0].shift(),U1[c1].geometry[0]=t1[0].concat(U1[c1].geometry[0]),c1}function j1(T1,_1,t1){let c1=t1?_1[0][_1[0].length-1]:_1[0][0];return`${T1}:${c1.x}:${c1.y}`}for(let T1=0;T1<j.length;T1++){let _1=j[T1],t1=_1.geometry,c1=_1.text?_1.text.toString():null;if(!c1){G1(T1);continue}let a1=j1(c1,t1),S1=j1(c1,t1,!0);if(a1 in t&&S1 in o&&t[a1]!==o[S1]){let E1=K1(a1,S1,t1),Q0=h1(a1,S1,U1[E1].geometry);delete o[a1],delete t[S1],t[j1(c1,U1[Q0].geometry,!0)]=Q0,U1[E1].geometry=null}else a1 in t?h1(a1,S1,t1):(S1 in o)?K1(a1,S1,t1):(G1(T1),o[a1]=g1-1,t[S1]=g1-1)}return U1.filter((T1)=>T1.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((j,o)=>j.sortKey-o.sortKey)}update(w,f,q){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(w,f,this.layers,{imagePositions:q}),this.icon.programConfigurations.updatePaintArrays(w,f,this.layers,{imagePositions:q}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(w){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(w),this.iconCollisionBox.upload(w)),this.text.upload(w,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(w,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(w,f){let q=this.lineVertexArray.length;if(w.segment!==void 0){let v=w.dist(f[w.segment+1]),H=w.dist(f[w.segment]),M={};for(let A=w.segment+1;A<f.length;A++)M[A]={x:f[A].x,y:f[A].y,tileUnitDistanceFromAnchor:v},A<f.length-1&&(v+=f[A+1].dist(f[A]));for(let A=w.segment||0;A>=0;A--)M[A]={x:f[A].x,y:f[A].y,tileUnitDistanceFromAnchor:H},A>0&&(H+=f[A-1].dist(f[A]));for(let A=0;A<f.length;A++){let Q=M[A];this.lineVertexArray.emplaceBack(Q.x,Q.y,Q.tileUnitDistanceFromAnchor)}}return{lineStartIndex:q,lineLength:this.lineVertexArray.length-q}}addSymbols(w,f,q,v,H,M,A,Q,W,h,K,D){let{indexArray:$,layoutVertexArray:R}=w,_=w.segments.prepareSegment(4*f.length,R,$,this.canOverlap?M.sortKey:void 0),j=this.glyphOffsetArray.length,o=_.vertexLength,t=this.allowVerticalPlacement&&A===U.ao.vertical?Math.PI/2:0,U1=M.text&&M.text.sections;for(let g1=0;g1<f.length;g1++){let{tl:G1,tr:h1,bl:K1,br:j1,tex:T1,pixelOffsetTL:_1,pixelOffsetBR:t1,minFontScaleX:c1,minFontScaleY:a1,glyphOffset:S1,isSDF:E1,sectionIndex:Q0}=f[g1],A0=_.vertexLength,g0=S1[1];hx(R,Q.x,Q.y,G1.x,g0+G1.y,T1.x,T1.y,q,E1,_1.x,_1.y,c1,a1),hx(R,Q.x,Q.y,h1.x,g0+h1.y,T1.x+T1.w,T1.y,q,E1,t1.x,_1.y,c1,a1),hx(R,Q.x,Q.y,K1.x,g0+K1.y,T1.x,T1.y+T1.h,q,E1,_1.x,t1.y,c1,a1),hx(R,Q.x,Q.y,j1.x,g0+j1.y,T1.x+T1.w,T1.y+T1.h,q,E1,t1.x,t1.y,c1,a1),nZ(w.dynamicLayoutVertexArray,Q,t),$.emplaceBack(A0,A0+2,A0+1),$.emplaceBack(A0+1,A0+2,A0+3),_.vertexLength+=4,_.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(S1[0]),g1!==f.length-1&&Q0===f[g1+1].sectionIndex||w.programConfigurations.populatePaintArrays(R.length,M,M.index,{imagePositions:{},canonical:D,formattedSection:U1&&U1[Q0]})}w.placedSymbolArray.emplaceBack(Q.x,Q.y,j,this.glyphOffsetArray.length-j,o,W,h,Q.segment,q?q[0]:0,q?q[1]:0,v[0],v[1],A,0,!1,0,K)}_addCollisionDebugVertex(w,f,q,v,H,M){return f.emplaceBack(0,0),w.emplaceBack(q.x,q.y,v,H,Math.round(M.x),Math.round(M.y))}addCollisionDebugVertices(w,f,q,v,H,M,A){let Q=H.segments.prepareSegment(4,H.layoutVertexArray,H.indexArray),W=Q.vertexLength,h=H.layoutVertexArray,K=H.collisionVertexArray,D=A.anchorX,$=A.anchorY;this._addCollisionDebugVertex(h,K,M,D,$,new l(w,f)),this._addCollisionDebugVertex(h,K,M,D,$,new l(q,f)),this._addCollisionDebugVertex(h,K,M,D,$,new l(q,v)),this._addCollisionDebugVertex(h,K,M,D,$,new l(w,v)),Q.vertexLength+=4;let R=H.indexArray;R.emplaceBack(W,W+1),R.emplaceBack(W+1,W+2),R.emplaceBack(W+2,W+3),R.emplaceBack(W+3,W),Q.primitiveLength+=4}addDebugCollisionBoxes(w,f,q,v){for(let H=w;H<f;H++){let M=this.collisionBoxArray.get(H);this.addCollisionDebugVertices(M.x1,M.y1,M.x2,M.y2,v?this.textCollisionBox:this.iconCollisionBox,M.anchorPoint,q)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Kx(n1,MG.members,q5),this.iconCollisionBox=new Kx(n1,MG.members,q5);for(let w=0;w<this.symbolInstances.length;w++){let f=this.symbolInstances.get(w);this.addDebugCollisionBoxes(f.textBoxStartIndex,f.textBoxEndIndex,f,!0),this.addDebugCollisionBoxes(f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f,!0),this.addDebugCollisionBoxes(f.iconBoxStartIndex,f.iconBoxEndIndex,f,!1),this.addDebugCollisionBoxes(f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex,f,!1)}}_deserializeCollisionBoxesForSymbol(w,f,q,v,H,M,A,Q,W){let h={};for(let K=f;K<q;K++){let D=w.get(K);h.textBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},h.textFeatureIndex=D.featureIndex;break}for(let K=v;K<H;K++){let D=w.get(K);h.verticalTextBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},h.verticalTextFeatureIndex=D.featureIndex;break}for(let K=M;K<A;K++){let D=w.get(K);h.iconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},h.iconFeatureIndex=D.featureIndex;break}for(let K=Q;K<W;K++){let D=w.get(K);h.verticalIconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},h.verticalIconFeatureIndex=D.featureIndex;break}return h}deserializeCollisionBoxes(w){this.collisionArrays=[];for(let f=0;f<this.symbolInstances.length;f++){let q=this.symbolInstances.get(f);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(w,q.textBoxStartIndex,q.textBoxEndIndex,q.verticalTextBoxStartIndex,q.verticalTextBoxEndIndex,q.iconBoxStartIndex,q.iconBoxEndIndex,q.verticalIconBoxStartIndex,q.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(w,f){let q=w.placedSymbolArray.get(f),v=q.vertexStartIndex+4*q.numGlyphs;for(let H=q.vertexStartIndex;H<v;H+=4)w.indexArray.emplaceBack(H,H+2,H+1),w.indexArray.emplaceBack(H+1,H+2,H+3)}getSortedSymbolIndexes(w){if(this.sortedAngle===w&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let f=Math.sin(w),q=Math.cos(w),v=[],H=[],M=[];for(let A=0;A<this.symbolInstances.length;++A){M.push(A);let Q=this.symbolInstances.get(A);v.push(0|Math.round(f*Q.anchorX+q*Q.anchorY)),H.push(Q.featureIndex)}return M.sort((A,Q)=>v[A]-v[Q]||H[Q]-H[A]),M}addToSortKeyRanges(w,f){let q=this.sortKeyRanges[this.sortKeyRanges.length-1];q&&q.sortKey===f?q.symbolInstanceEnd=w+1:this.sortKeyRanges.push({sortKey:f,symbolInstanceStart:w,symbolInstanceEnd:w+1})}sortFeatures(w){if(this.sortFeaturesByY&&this.sortedAngle!==w&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(w),this.sortedAngle=w,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let f of this.symbolInstanceIndexes){let q=this.symbolInstances.get(f);this.featureSortOrder.push(q.featureIndex),[q.rightJustifiedTextSymbolIndex,q.centerJustifiedTextSymbolIndex,q.leftJustifiedTextSymbolIndex].forEach((v,H,M)=>{v>=0&&M.indexOf(v)===H&&this.addIndicesForPlacedSymbol(this.text,v)}),q.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,q.verticalPlacedTextSymbolIndex),q.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,q.placedIconSymbolIndex),q.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,q.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let OG,yG;o1("SymbolBucket",Y9,{omit:["layers","collisionBoxArray","features","compareText"]}),Y9.MAX_GLYPHS=65535,Y9.addDynamicAttributes=nZ;var sZ={get paint(){return yG=yG||new W2({"icon-opacity":new Y0(M1.paint_symbol["icon-opacity"]),"icon-color":new Y0(M1.paint_symbol["icon-color"]),"icon-halo-color":new Y0(M1.paint_symbol["icon-halo-color"]),"icon-halo-width":new Y0(M1.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Y0(M1.paint_symbol["icon-halo-blur"]),"icon-translate":new e1(M1.paint_symbol["icon-translate"]),"icon-translate-anchor":new e1(M1.paint_symbol["icon-translate-anchor"]),"text-opacity":new Y0(M1.paint_symbol["text-opacity"]),"text-color":new Y0(M1.paint_symbol["text-color"],{runtimeType:L3,getOverride:(w)=>w.textColor,hasOverride:(w)=>!!w.textColor}),"text-halo-color":new Y0(M1.paint_symbol["text-halo-color"]),"text-halo-width":new Y0(M1.paint_symbol["text-halo-width"]),"text-halo-blur":new Y0(M1.paint_symbol["text-halo-blur"]),"text-translate":new e1(M1.paint_symbol["text-translate"]),"text-translate-anchor":new e1(M1.paint_symbol["text-translate-anchor"])})},get layout(){return OG=OG||new W2({"symbol-placement":new e1(M1.layout_symbol["symbol-placement"]),"symbol-spacing":new e1(M1.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new e1(M1.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Y0(M1.layout_symbol["symbol-sort-key"]),"symbol-z-order":new e1(M1.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new e1(M1.layout_symbol["icon-allow-overlap"]),"icon-overlap":new e1(M1.layout_symbol["icon-overlap"]),"icon-ignore-placement":new e1(M1.layout_symbol["icon-ignore-placement"]),"icon-optional":new e1(M1.layout_symbol["icon-optional"]),"icon-rotation-alignment":new e1(M1.layout_symbol["icon-rotation-alignment"]),"icon-size":new Y0(M1.layout_symbol["icon-size"]),"icon-text-fit":new e1(M1.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new e1(M1.layout_symbol["icon-text-fit-padding"]),"icon-image":new Y0(M1.layout_symbol["icon-image"]),"icon-rotate":new Y0(M1.layout_symbol["icon-rotate"]),"icon-padding":new Y0(M1.layout_symbol["icon-padding"]),"icon-keep-upright":new e1(M1.layout_symbol["icon-keep-upright"]),"icon-offset":new Y0(M1.layout_symbol["icon-offset"]),"icon-anchor":new Y0(M1.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new e1(M1.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new e1(M1.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new e1(M1.layout_symbol["text-rotation-alignment"]),"text-field":new Y0(M1.layout_symbol["text-field"]),"text-font":new Y0(M1.layout_symbol["text-font"]),"text-size":new Y0(M1.layout_symbol["text-size"]),"text-max-width":new Y0(M1.layout_symbol["text-max-width"]),"text-line-height":new e1(M1.layout_symbol["text-line-height"]),"text-letter-spacing":new Y0(M1.layout_symbol["text-letter-spacing"]),"text-justify":new Y0(M1.layout_symbol["text-justify"]),"text-radial-offset":new Y0(M1.layout_symbol["text-radial-offset"]),"text-variable-anchor":new e1(M1.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Y0(M1.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Y0(M1.layout_symbol["text-anchor"]),"text-max-angle":new e1(M1.layout_symbol["text-max-angle"]),"text-writing-mode":new e1(M1.layout_symbol["text-writing-mode"]),"text-rotate":new Y0(M1.layout_symbol["text-rotate"]),"text-padding":new e1(M1.layout_symbol["text-padding"]),"text-keep-upright":new e1(M1.layout_symbol["text-keep-upright"]),"text-transform":new Y0(M1.layout_symbol["text-transform"]),"text-offset":new Y0(M1.layout_symbol["text-offset"]),"text-allow-overlap":new e1(M1.layout_symbol["text-allow-overlap"]),"text-overlap":new e1(M1.layout_symbol["text-overlap"]),"text-ignore-placement":new e1(M1.layout_symbol["text-ignore-placement"]),"text-optional":new e1(M1.layout_symbol["text-optional"])})}};class iZ{constructor(w){if(w.property.overrides===void 0)throw Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=w.property.overrides?w.property.overrides.runtimeType:b3,this.defaultValue=w}evaluate(w){if(w.formattedSection){let f=this.defaultValue.property.overrides;if(f&&f.hasOverride(w.formattedSection))return f.getOverride(w.formattedSection)}return w.feature&&w.featureState?this.defaultValue.evaluate(w.feature,w.featureState):this.defaultValue.property.specification.default}eachChild(w){this.defaultValue.isConstant()||w(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}o1("FormatSectionOverride",iZ,{omit:["defaultValue"]});class lx extends G3{constructor(w,f){super(w,sZ,f)}recalculate(w,f){if(super.recalculate(w,f),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let q=this.layout.get("text-writing-mode");if(q){let v=[];for(let H of q)v.indexOf(H)<0&&v.push(H);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(w,f,q,v){let H=this.layout.get(w).evaluate(f,{},q,v),M=this._unevaluatedLayout._values[w];return M.isDataDriven()||zw(M.value)||!H?H:function(A,Q){return Q.replace(/{([^{}]+)}/g,(W,h)=>A&&(h in A)?String(A[h]):"")}(f.properties,H)}createBucket(w){return new Y9(w)}queryRadius(){return 0}queryIntersectsFeature(){throw Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let w of sZ.paint.overridableProperties){if(!lx.hasPaintOverride(this.layout,w))continue;let f=this.paint.get(w),q=new iZ(f),v=new j8(q,f.property.specification),H=null;H=f.value.kind==="constant"||f.value.kind==="source"?new m8("source",v):new qw("composite",v,f.value.zoomStops),this.paint._values[w]=new K3(f.property,H,f.parameters)}}_handleOverridablePaintPropertyUpdate(w,f,q){return!(!this.layout||f.isDataDriven()||q.isDataDriven())&&lx.hasPaintOverride(this.layout,w)}static hasPaintOverride(w,f){let q=w.get("text-field"),v=sZ.paint.properties[f],H=!1,M=(A)=>{for(let Q of A)if(v.overrides&&v.overrides.hasOverride(Q))return void(H=!0)};if(q.value.kind==="constant"&&q.value.value instanceof X2)M(q.value.value.sections);else if(q.value.kind==="source"||q.value.kind==="composite"){let A=(W)=>{H||(W instanceof D4&&H5(W.value)===k6?M(W.value.sections):W instanceof d8?M(W.sections):W.eachChild(A))},Q=q.value;Q._styleExpression&&A(Q._styleExpression.expression)}return H}}let RG;var $V={get paint(){return RG=RG||new W2({"background-color":new e1(M1.paint_background["background-color"]),"background-pattern":new s8(M1.paint_background["background-pattern"]),"background-opacity":new e1(M1.paint_background["background-opacity"])})}};class NG extends G3{constructor(w,f){super(w,$V,f)}}class IG extends G3{constructor(w,f){super(w,{},f),this.onAdd=(q)=>{this.implementation.onAdd&&this.implementation.onAdd(q,q.painter.context.gl)},this.onRemove=(q)=>{this.implementation.onRemove&&this.implementation.onRemove(q,q.painter.context.gl)},this.implementation=w}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw Error("Custom layers cannot be serialized")}}class SG{constructor(w){this._methodToThrottle=w,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}let jV={once:!0},tZ=6371008.8;class m6{constructor(w,f){if(isNaN(w)||isNaN(f))throw Error(`Invalid LngLat object: (${w}, ${f})`);if(this.lng=+w,this.lat=+f,this.lat>90||this.lat<-90)throw Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new m6(P0(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(w){let f=Math.PI/180,q=this.lat*f,v=w.lat*f,H=Math.sin(q)*Math.sin(v)+Math.cos(q)*Math.cos(v)*Math.cos((w.lng-this.lng)*f);return tZ*Math.acos(Math.min(H,1))}static convert(w){if(w instanceof m6)return w;if(Array.isArray(w)&&(w.length===2||w.length===3))return new m6(Number(w[0]),Number(w[1]));if(!Array.isArray(w)&&typeof w=="object"&&w!==null)return new m6(Number("lng"in w?w.lng:w.lon),Number(w.lat));throw Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}let TG=2*Math.PI*tZ;function $G(w){return TG*Math.cos(w*Math.PI/180)}function jG(w){return(180+w)/360}function mG(w){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+w*Math.PI/360)))/360}function _G(w,f){return w/$G(f)}function eZ(w){return 360/Math.PI*Math.atan(Math.exp((180-360*w)*Math.PI/180))-90}function PG(w,f){return w*$G(eZ(f))}class _g{constructor(w,f,q=0){this.x=+w,this.y=+f,this.z=+q}static fromLngLat(w,f=0){let q=m6.convert(w);return new _g(jG(q.lng),mG(q.lat),_G(f,q.lat))}toLngLat(){return new m6(360*this.x-180,eZ(this.y))}toAltitude(){return PG(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/TG*(w=eZ(this.y),1/Math.cos(w*Math.PI/180));var w}}function EG(w,f,q){var v=2*Math.PI*6378137/256/Math.pow(2,q);return[w*v-2*Math.PI*6378137/2,f*v-2*Math.PI*6378137/2]}class Cx{constructor(w,f,q){if(!function(v,H,M){return!(v<0||v>25||M<0||M>=Math.pow(2,v)||H<0||H>=Math.pow(2,v))}(w,f,q))throw Error(`x=${f}, y=${q}, z=${w} outside of bounds. 0<=x<${Math.pow(2,w)}, 0<=y<${Math.pow(2,w)} 0<=z<=25 `);this.z=w,this.x=f,this.y=q,this.key=Ow(0,w,w,f,q)}equals(w){return this.z===w.z&&this.x===w.x&&this.y===w.y}url(w,f,q){let v=(M=this.y,A=this.z,Q=EG(256*(H=this.x),256*(M=Math.pow(2,A)-M-1),A),W=EG(256*(H+1),256*(M+1),A),Q[0]+","+Q[1]+","+W[0]+","+W[1]);var H,M,A,Q,W;let h=function(K,D,$){let R,_="";for(let j=K;j>0;j--)R=1<<j-1,_+=(D&R?1:0)+($&R?2:0);return _}(this.z,this.x,this.y);return w[(this.x+this.y)%w.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(q==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,f>1?"@2x":"").replace(/{quadkey}/g,h).replace(/{bbox-epsg-3857}/g,v)}isChildOf(w){let f=this.z-w.z;return f>0&&w.x===this.x>>f&&w.y===this.y>>f}getTilePoint(w){let f=Math.pow(2,this.z);return new l((w.x*f-this.x)*J0,(w.y*f-this.y)*J0)}toString(){return`${this.z}/${this.x}/${this.y}`}}class wY{constructor(w,f){this.wrap=w,this.canonical=f,this.key=Ow(w,f.z,f.z,f.x,f.y)}}class u3{constructor(w,f,q,v,H){if(this.terrainRttPosMatrix32f=null,w<q)throw Error(`overscaledZ should be >= z; overscaledZ = ${w}; z = ${q}`);this.overscaledZ=w,this.wrap=f,this.canonical=new Cx(q,+v,+H),this.key=Ow(f,w,q,v,H)}clone(){return new u3(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(w){return this.overscaledZ===w.overscaledZ&&this.wrap===w.wrap&&this.canonical.equals(w.canonical)}scaledTo(w){if(w>this.overscaledZ)throw Error(`targetZ > this.overscaledZ; targetZ = ${w}; overscaledZ = ${this.overscaledZ}`);let f=this.canonical.z-w;return w>this.canonical.z?new u3(w,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new u3(w,this.wrap,w,this.canonical.x>>f,this.canonical.y>>f)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(w,f){if(w>this.overscaledZ)throw Error(`targetZ > this.overscaledZ; targetZ = ${w}; overscaledZ = ${this.overscaledZ}`);let q=this.canonical.z-w;return w>this.canonical.z?Ow(this.wrap*+f,w,this.canonical.z,this.canonical.x,this.canonical.y):Ow(this.wrap*+f,w,w,this.canonical.x>>q,this.canonical.y>>q)}isChildOf(w){if(w.wrap!==this.wrap)return!1;if(this.overscaledZ-w.overscaledZ<=0)return!1;if(w.overscaledZ===0)return this.overscaledZ>0;let f=this.canonical.z-w.canonical.z;return!(f<0)&&w.canonical.x===this.canonical.x>>f&&w.canonical.y===this.canonical.y>>f}children(w){if(this.overscaledZ>=w)return[new u3(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let f=this.canonical.z+1,q=2*this.canonical.x,v=2*this.canonical.y;return[new u3(f,this.wrap,f,q,v),new u3(f,this.wrap,f,q+1,v),new u3(f,this.wrap,f,q,v+1),new u3(f,this.wrap,f,q+1,v+1)]}isLessThan(w){return this.wrap<w.wrap||!(this.wrap>w.wrap)&&(this.overscaledZ<w.overscaledZ||!(this.overscaledZ>w.overscaledZ)&&(this.canonical.x<w.canonical.x||!(this.canonical.x>w.canonical.x)&&this.canonical.y<w.canonical.y))}wrapped(){return new u3(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(w){return new u3(this.overscaledZ,w,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new wY(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(w){return this.canonical.getTilePoint(new _g(w.x-this.wrap,w.y))}}function Ow(w,f,q,v,H){(w*=2)<0&&(w=-1*w-1);let M=1<<q;return(M*M*w+M*H+v).toString(36)+q.toString(36)+f.toString(36)}function Pg(w,f){return f?w.properties[f]:w.id}o1("CanonicalTileID",Cx),o1("OverscaledTileID",u3,{omit:["terrainRttPosMatrix32f"]});class k9{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(w){return this.minX=Math.min(this.minX,w.x),this.minY=Math.min(this.minY,w.y),this.maxX=Math.max(this.maxX,w.x),this.maxY=Math.max(this.maxY,w.y),this}expandBy(w){return this.minX-=w,this.minY-=w,this.maxX+=w,this.maxY+=w,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(w){return this.expandBy(-w)}map(w){let f=new k9;return f.extend(w(new l(this.minX,this.minY))),f.extend(w(new l(this.maxX,this.minY))),f.extend(w(new l(this.minX,this.maxY))),f.extend(w(new l(this.maxX,this.maxY))),f}static fromPoints(w){let f=new k9;for(let q of w)f.extend(q);return f}contains(w){return w.x>=this.minX&&w.x<=this.maxX&&w.y>=this.minY&&w.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(w){return!this.empty()&&!w.empty()&&w.minX>=this.minX&&w.maxX<=this.maxX&&w.minY>=this.minY&&w.maxY<=this.maxY}intersects(w){return!this.empty()&&!w.empty()&&w.minX<=this.maxX&&w.maxX>=this.minX&&w.minY<=this.maxY&&w.maxY>=this.minY}}class bY{constructor(w){this._stringToNumber={},this._numberToString=[];for(let f=0;f<w.length;f++){let q=w[f];this._stringToNumber[q]=f,this._numberToString[f]=q}}encode(w){return this._stringToNumber[w]}decode(w){if(w>=this._numberToString.length)throw Error(`Out of bounds. Index requested n=${w} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[w]}}class gY{constructor(w,f,q,v,H){this.type="Feature",this._vectorTileFeature=w,w._z=f,w._x=q,w._y=v,this.properties=w.properties,this.id=H}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(w){this._geometry=w}toJSON(){let w={geometry:this.geometry};for(let f in this)f!=="_geometry"&&f!=="_vectorTileFeature"&&(w[f]=this[f]);return w}}class fY{constructor(w,f){this.tileID=w,this.x=w.canonical.x,this.y=w.canonical.y,this.z=w.canonical.z,this.grid=new k4(J0,16,0),this.grid3D=new k4(J0,16,0),this.featureIndexArray=new a,this.promoteId=f}insert(w,f,q,v,H,M){let A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(q,v,H);let Q=M?this.grid3D:this.grid;for(let W=0;W<f.length;W++){let h=f[W],K=[1/0,1/0,-1/0,-1/0];for(let D=0;D<h.length;D++){let $=h[D];K[0]=Math.min(K[0],$.x),K[1]=Math.min(K[1],$.y),K[2]=Math.max(K[2],$.x),K[3]=Math.max(K[3],$.y)}K[0]<J0&&K[1]<J0&&K[2]>=0&&K[3]>=0&&Q.insert(A,K[0],K[1],K[2],K[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new EZ(new Qx(this.rawTileData)).layers,this.sourceLayerCoder=new bY(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(w,f,q,v){this.loadVTLayers();let H=w.params,M=J0/w.tileSize/w.scale,A=h6(H.filter,H.globalState),Q=w.queryGeometry,W=w.queryPadding*M,h=k9.fromPoints(Q),K=this.grid.query(h.minX-W,h.minY-W,h.maxX+W,h.maxY+W),D=k9.fromPoints(w.cameraQueryGeometry).expandBy(W),$=this.grid3D.query(D.minX,D.minY,D.maxX,D.maxY,(j,o,t,U1)=>function(g1,G1,h1,K1,j1){for(let _1 of g1)if(G1<=_1.x&&h1<=_1.y&&K1>=_1.x&&j1>=_1.y)return!0;let T1=[new l(G1,h1),new l(G1,j1),new l(K1,j1),new l(K1,h1)];if(g1.length>2){for(let _1 of T1)if(Fw(g1,_1))return!0}for(let _1=0;_1<g1.length-1;_1++)if(lQ(g1[_1],g1[_1+1],T1))return!0;return!1}(w.cameraQueryGeometry,j-W,o-W,t+W,U1+W));for(let j of $)K.push(j);K.sort(mV);let R={},_;for(let j=0;j<K.length;j++){let o=K[j];if(o===_)continue;_=o;let t=this.featureIndexArray.get(o),U1=null;this.loadMatchingFeature(R,t.bucketIndex,t.sourceLayerIndex,t.featureIndex,A,H.layers,H.availableImages,f,q,v,(g1,G1,h1)=>(U1||(U1=g9(g1)),G1.queryIntersectsFeature({queryGeometry:Q,feature:g1,featureState:h1,geometry:U1,zoom:this.z,transform:w.transform,pixelsToTileUnits:M,pixelPosMatrix:w.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:w.getElevation})))}return R}loadMatchingFeature(w,f,q,v,H,M,A,Q,W,h,K){let D=this.bucketLayerIDs[f];if(M&&!D.some((j)=>M.has(j)))return;let $=this.sourceLayerCoder.decode(q),R=this.vtLayers[$].feature(v);if(H.needGeometry){let j=f9(R,!0);if(!H.filter(new n0(this.tileID.overscaledZ),j,this.tileID.canonical))return}else if(!H.filter(new n0(this.tileID.overscaledZ),R))return;let _=this.getId(R,$);for(let j=0;j<D.length;j++){let o=D[j];if(M&&!M.has(o))continue;let t=Q[o];if(!t)continue;let U1={};_&&h&&(U1=h.getState(t.sourceLayer||"_geojsonTileLayer",_));let g1=s0({},W[o]);g1.paint=uG(g1.paint,t.paint,R,U1,A),g1.layout=uG(g1.layout,t.layout,R,U1,A);let G1=!K||K(R,t,U1);if(!G1)continue;let h1=new gY(R,this.z,this.x,this.y,_);h1.layer=g1;let K1=w[o];K1===void 0&&(K1=w[o]=[]),K1.push({featureIndex:v,feature:h1,intersectionZ:G1})}}lookupSymbolFeatures(w,f,q,v,H,M,A,Q){let W={};this.loadVTLayers();let h=h6(H.filterSpec,H.globalState);for(let K of w)this.loadMatchingFeature(W,q,v,K,h,M,A,Q,f);return W}hasLayer(w){for(let f of this.bucketLayerIDs)for(let q of f)if(w===q)return!0;return!1}getId(w,f){var q;let v=w.id;return this.promoteId&&(v=w.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[f]],typeof v=="boolean"&&(v=Number(v)),v===void 0&&((q=w.properties)===null||q===void 0?void 0:q.cluster)&&this.promoteId&&(v=Number(w.properties.cluster_id))),v}}function uG(w,f,q,v,H){return a0(w,(M,A)=>{let Q=f instanceof O7?f.get(A):null;return Q&&Q.evaluate?Q.evaluate(q,v,H):Q})}function mV(w,f){return f-w}function pG(w,f,q,v,H){let M=[];for(let A=0;A<w.length;A++){let Q=w[A],W;for(let h=0;h<Q.length-1;h++){let K=Q[h],D=Q[h+1];K.x<f&&D.x<f||(K.x<f?K=new l(f,K.y+(f-K.x)/(D.x-K.x)*(D.y-K.y))._round():D.x<f&&(D=new l(f,K.y+(f-K.x)/(D.x-K.x)*(D.y-K.y))._round()),K.y<q&&D.y<q||(K.y<q?K=new l(K.x+(q-K.y)/(D.y-K.y)*(D.x-K.x),q)._round():D.y<q&&(D=new l(K.x+(q-K.y)/(D.y-K.y)*(D.x-K.x),q)._round()),K.x>=v&&D.x>=v||(K.x>=v?K=new l(v,K.y+(v-K.x)/(D.x-K.x)*(D.y-K.y))._round():D.x>=v&&(D=new l(v,K.y+(v-K.x)/(D.x-K.x)*(D.y-K.y))._round()),K.y>=H&&D.y>=H||(K.y>=H?K=new l(K.x+(H-K.y)/(D.y-K.y)*(D.x-K.x),H)._round():D.y>=H&&(D=new l(K.x+(H-K.y)/(D.y-K.y)*(D.x-K.x),H)._round()),W&&K.equals(W[W.length-1])||(W=[K],M.push(W)),W.push(D)))))}}return M}o1("FeatureIndex",fY,{omit:["rawTileData","sourceLayerCoder"]});class _6 extends l{constructor(w,f,q,v){super(w,f),this.angle=q,v!==void 0&&(this.segment=v)}clone(){return new _6(this.x,this.y,this.angle,this.segment)}}function cG(w,f,q,v,H){if(f.segment===void 0||q===0)return!0;let M=f,A=f.segment+1,Q=0;for(;Q>-q/2;){if(A--,A<0)return!1;Q-=w[A].dist(M),M=w[A]}Q+=w[A].dist(w[A+1]),A++;let W=[],h=0;for(;Q<q/2;){let K=w[A],D=w[A+1];if(!D)return!1;let $=w[A-1].angleTo(K)-K.angleTo(D);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),W.push({distance:Q,angleDelta:$}),h+=$;Q-W[0].distance>v;)h-=W.shift().angleDelta;if(h>H)return!1;A++,Q+=K.dist(D)}return!0}function aG(w){let f=0;for(let q=0;q<w.length-1;q++)f+=w[q].dist(w[q+1]);return f}function rG(w,f,q){return w?0.6*f*q:0}function oG(w,f){return Math.max(w?w.right-w.left:0,f?f.right-f.left:0)}function _V(w,f,q,v,H,M){let A=rG(q,H,M),Q=oG(q,v)*M,W=0,h=aG(w)/2;for(let K=0;K<w.length-1;K++){let D=w[K],$=w[K+1],R=D.dist($);if(W+R>h){let _=(h-W)/R,j=m2.number(D.x,$.x,_),o=m2.number(D.y,$.y,_),t=new _6(j,o,$.angleTo(D),K);return t._round(),!A||cG(w,t,Q,A,f)?t:void 0}W+=R}}function PV(w,f,q,v,H,M,A,Q,W){let h=rG(v,M,A),K=oG(v,H),D=K*A,$=w[0].x===0||w[0].x===W||w[0].y===0||w[0].y===W;return f-D<f/4&&(f=D+f/4),nG(w,$?f/2*Q%f:(K/2+2*M)*A*Q%f,f,h,q,D,$,!1,W)}function nG(w,f,q,v,H,M,A,Q,W){let h=M/2,K=aG(w),D=0,$=f-q,R=[];for(let _=0;_<w.length-1;_++){let j=w[_],o=w[_+1],t=j.dist(o),U1=o.angleTo(j);for(;$+q<D+t;){$+=q;let g1=($-D)/t,G1=m2.number(j.x,o.x,g1),h1=m2.number(j.y,o.y,g1);if(G1>=0&&G1<W&&h1>=0&&h1<W&&$-h>=0&&$+h<=K){let K1=new _6(G1,h1,U1,_);K1._round(),v&&!cG(w,K1,M,v,H)||R.push(K1)}}D+=t}return Q||R.length||A||(R=nG(w,D/2,q,v,H,M,A,!0,W)),R}function sG(w,f,q,v){let H=[],M=w.image,A=M.pixelRatio,Q=M.paddedRect.w-2,W=M.paddedRect.h-2,h={x1:w.left,y1:w.top,x2:w.right,y2:w.bottom},K=M.stretchX||[[0,Q]],D=M.stretchY||[[0,W]],$=(E1,Q0)=>E1+Q0[1]-Q0[0],R=K.reduce($,0),_=D.reduce($,0),j=Q-R,o=W-_,t=0,U1=R,g1=0,G1=_,h1=0,K1=j,j1=0,T1=o;if(M.content&&v){let E1=M.content,Q0=E1[2]-E1[0],A0=E1[3]-E1[1];(M.textFitWidth||M.textFitHeight)&&(h=CG(w)),t=Dx(K,0,E1[0]),g1=Dx(D,0,E1[1]),U1=Dx(K,E1[0],E1[2]),G1=Dx(D,E1[1],E1[3]),h1=E1[0]-t,j1=E1[1]-g1,K1=Q0-U1,T1=A0-G1}let{x1:_1,y1:t1}=h,c1=h.x2-_1,a1=h.y2-t1,S1=(E1,Q0,A0,g0)=>{let x0=dx(E1.stretch-t,U1,c1,_1),S0=Ox(E1.fixed-h1,K1,E1.stretch,R),Z2=dx(Q0.stretch-g1,G1,a1,t1),P5=Ox(Q0.fixed-j1,T1,Q0.stretch,_),z3=dx(A0.stretch-t,U1,c1,_1),p3=Ox(A0.fixed-h1,K1,A0.stretch,R),B3=dx(g0.stretch-g1,G1,a1,t1),w2=Ox(g0.fixed-j1,T1,g0.stretch,_),l5=new l(x0,Z2),Y2=new l(z3,Z2),x3=new l(z3,B3),F2=new l(x0,B3),q3=new l(S0/A,P5/A),c3=new l(p3/A,w2/A),k2=f*Math.PI/180;if(k2){let v2=Math.sin(k2),J2=Math.cos(k2),r5=[J2,-v2,v2,J2];l5._matMult(r5),Y2._matMult(r5),F2._matMult(r5),x3._matMult(r5)}let A3=E1.stretch+E1.fixed,b2=Q0.stretch+Q0.fixed;return{tl:l5,tr:Y2,bl:F2,br:x3,tex:{x:M.paddedRect.x+1+A3,y:M.paddedRect.y+1+b2,w:A0.stretch+A0.fixed-A3,h:g0.stretch+g0.fixed-b2},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:q3,pixelOffsetBR:c3,minFontScaleX:K1/A/c1,minFontScaleY:T1/A/a1,isSDF:q}};if(v&&(M.stretchX||M.stretchY)){let E1=iG(K,j,R),Q0=iG(D,o,_);for(let A0=0;A0<E1.length-1;A0++){let g0=E1[A0],x0=E1[A0+1];for(let S0=0;S0<Q0.length-1;S0++)H.push(S1(g0,Q0[S0],x0,Q0[S0+1]))}}else H.push(S1({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Q+1},{fixed:0,stretch:W+1}));return H}function Dx(w,f,q){let v=0;for(let H of w)v+=Math.max(f,Math.min(q,H[1]))-Math.max(f,Math.min(q,H[0]));return v}function iG(w,f,q){let v=[{fixed:-1,stretch:0}];for(let[H,M]of w){let A=v[v.length-1];v.push({fixed:H-A.stretch,stretch:A.stretch}),v.push({fixed:H-A.stretch,stretch:A.stretch+(M-H)})}return v.push({fixed:f+1,stretch:q}),v}function dx(w,f,q,v){return w/f*q+v}function Ox(w,f,q,v){return w-f*q/v}o1("Anchor",_6);class Eg{constructor(w,f,q,v,H,M,A,Q,W,h){var K;if(this.boxStartIndex=w.length,W){let{top:D,bottom:$,collisionPadding:R}=M;R&&(D-=R[1],$+=R[3]);let _=$-D;_>0&&(_=Math.max(10,_),this.circleDiameter=_)}else{let D=((K=M.image)===null||K===void 0?void 0:K.content)&&(M.image.textFitWidth||M.image.textFitHeight)?CG(M):{x1:M.left,y1:M.top,x2:M.right,y2:M.bottom};D.y1=D.y1*A-Q[0],D.y2=D.y2*A+Q[2],D.x1=D.x1*A-Q[3],D.x2=D.x2*A+Q[1];let $=M.collisionPadding;if($&&(D.x1-=$[0]*A,D.y1-=$[1]*A,D.x2+=$[2]*A,D.y2+=$[3]*A),h){let R=new l(D.x1,D.y1),_=new l(D.x2,D.y1),j=new l(D.x1,D.y2),o=new l(D.x2,D.y2),t=h*Math.PI/180;R._rotate(t),_._rotate(t),j._rotate(t),o._rotate(t),D.x1=Math.min(R.x,_.x,j.x,o.x),D.x2=Math.max(R.x,_.x,j.x,o.x),D.y1=Math.min(R.y,_.y,j.y,o.y),D.y2=Math.max(R.y,_.y,j.y,o.y)}w.emplaceBack(f.x,f.y,D.x1,D.y1,D.x2,D.y2,q,v,H)}this.boxEndIndex=w.length}}class tG{constructor(w=[],f=(q,v)=>q<v?-1:q>v?1:0){if(this.data=w,this.length=this.data.length,this.compare=f,this.length>0)for(let q=(this.length>>1)-1;q>=0;q--)this._down(q)}push(w){this.data.push(w),this._up(this.length++)}pop(){if(this.length===0)return;let w=this.data[0],f=this.data.pop();return--this.length>0&&(this.data[0]=f,this._down(0)),w}peek(){return this.data[0]}_up(w){let{data:f,compare:q}=this,v=f[w];for(;w>0;){let H=w-1>>1,M=f[H];if(q(v,M)>=0)break;f[w]=M,w=H}f[w]=v}_down(w){let{data:f,compare:q}=this,v=this.length>>1,H=f[w];for(;w<v;){let M=1+(w<<1),A=M+1;if(A<this.length&&q(f[A],f[M])<0&&(M=A),q(f[M],H)>=0)break;f[w]=f[M],w=M}f[w]=H}}function EV(w,f=1,q=!1){let v=k9.fromPoints(w[0]),H=Math.min(v.width(),v.height()),M=H/2,A=new tG([],uV),{minX:Q,minY:W,maxX:h,maxY:K}=v;if(H===0)return new l(Q,W);for(let R=Q;R<h;R+=H)for(let _=W;_<K;_+=H)A.push(new yw(R+M,_+M,M,w));let D=function(R){let _=0,j=0,o=0,t=R[0];for(let U1=0,g1=t.length,G1=g1-1;U1<g1;G1=U1++){let h1=t[U1],K1=t[G1],j1=h1.x*K1.y-K1.x*h1.y;j+=(h1.x+K1.x)*j1,o+=(h1.y+K1.y)*j1,_+=3*j1}return new yw(j/_,o/_,0,R)}(w),$=A.length;for(;A.length;){let R=A.pop();(R.d>D.d||!D.d)&&(D=R,q&&console.log("found best %d after %d probes",Math.round(1e4*R.d)/1e4,$)),R.max-D.d<=f||(M=R.h/2,A.push(new yw(R.p.x-M,R.p.y-M,M,w)),A.push(new yw(R.p.x+M,R.p.y-M,M,w)),A.push(new yw(R.p.x-M,R.p.y+M,M,w)),A.push(new yw(R.p.x+M,R.p.y+M,M,w)),$+=4)}return q&&(console.log(`num probes: ${$}`),console.log(`best distance: ${D.d}`)),D.p}function uV(w,f){return f.max-w.max}function yw(w,f,q,v){this.p=new l(w,f),this.h=q,this.d=function(H,M){let A=!1,Q=1/0;for(let W=0;W<M.length;W++){let h=M[W];for(let K=0,D=h.length,$=D-1;K<D;$=K++){let R=h[K],_=h[$];R.y>H.y!=_.y>H.y&&H.x<(_.x-R.x)*(H.y-R.y)/(_.y-R.y)+R.x&&(A=!A),Q=Math.min(Q,IJ(H,R,_))}}return(A?1:-1)*Math.sqrt(Q)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}var R2;U.aE=void 0,(R2=U.aE||(U.aE={}))[R2.center=1]="center",R2[R2.left=2]="left",R2[R2.right=3]="right",R2[R2.top=4]="top",R2[R2.bottom=5]="bottom",R2[R2["top-left"]=6]="top-left",R2[R2["top-right"]=7]="top-right",R2[R2["bottom-left"]=8]="bottom-left",R2[R2["bottom-right"]=9]="bottom-right";let zY=Number.POSITIVE_INFINITY;function eG(w,f){return f[1]!==zY?function(q,v,H){let M=0,A=0;switch(v=Math.abs(v),H=Math.abs(H),q){case"top-right":case"top-left":case"top":A=H-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-H}switch(q){case"top-right":case"bottom-right":case"right":M=-v;break;case"top-left":case"bottom-left":case"left":M=v}return[M,A]}(w,f[0],f[1]):function(q,v){let H=0,M=0;v<0&&(v=0);let A=v/Math.SQRT2;switch(q){case"top-right":case"top-left":M=A-7;break;case"bottom-right":case"bottom-left":M=7-A;break;case"bottom":M=7-v;break;case"top":M=v-7}switch(q){case"top-right":case"bottom-right":H=-A;break;case"top-left":case"bottom-left":H=A;break;case"left":H=v;break;case"right":H=-v}return[H,M]}(w,f[0])}function wH(w,f,q){var v;let H=w.layout,M=(v=H.get("text-variable-anchor-offset"))===null||v===void 0?void 0:v.evaluate(f,{},q);if(M){let Q=M.values,W=[];for(let h=0;h<Q.length;h+=2){let K=W[h]=Q[h],D=Q[h+1].map(($)=>$*q2);K.startsWith("top")?D[1]-=7:K.startsWith("bottom")&&(D[1]+=7),W[h+1]=D}return new Q2(W)}let A=H.get("text-variable-anchor");if(A){let Q;Q=w._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[H.get("text-radial-offset").evaluate(f,{},q)*q2,zY]:H.get("text-offset").evaluate(f,{},q).map((h)=>h*q2);let W=[];for(let h of A)W.push(h,eG(h,Q));return new Q2(W)}return null}function xY(w){switch(w){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function pV(w,f,q,v,H,M,A,Q,W,h,K,D){let $=M.textMaxSize.evaluate(f,{});$===void 0&&($=A);let R=w.layers[0].layout,_=R.get("icon-offset").evaluate(f,{},K),j=gH(q.horizontal),o=A/24,t=w.tilePixelRatio*o,U1=w.tilePixelRatio*$/24,g1=w.tilePixelRatio*Q,G1=w.tilePixelRatio*R.get("symbol-spacing"),h1=R.get("text-padding")*w.tilePixelRatio,K1=function(A0,g0,x0,S0=1){let Z2=A0.get("icon-padding").evaluate(g0,{},x0),P5=Z2&&Z2.values;return[P5[0]*S0,P5[1]*S0,P5[2]*S0,P5[3]*S0]}(R,f,K,w.tilePixelRatio),j1=R.get("text-max-angle")/180*Math.PI,T1=R.get("text-rotation-alignment")!=="viewport"&&R.get("symbol-placement")!=="point",_1=R.get("icon-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",t1=R.get("symbol-placement"),c1=G1/2,a1=R.get("icon-text-fit"),S1;v&&a1!=="none"&&(w.allowVerticalPlacement&&q.vertical&&(S1=DG(v,q.vertical,a1,R.get("icon-text-fit-padding"),_,o)),j&&(v=DG(v,j,a1,R.get("icon-text-fit-padding"),_,o)));let E1=K?D.line.getGranularityForZoomLevel(K.z):1,Q0=(A0,g0)=>{g0.x<0||g0.x>=J0||g0.y<0||g0.y>=J0||function(x0,S0,Z2,P5,z3,p3,B3,w2,l5,Y2,x3,F2,q3,c3,k2,A3,b2,v2,J2,r5,k5,$4,Rw,j4,rV){let Nw=x0.addToLineVertexArray(S0,Z2),v9,Iw,Sw,Tw,qH=0,ZH=0,YH=0,kH=0,HY=-1,UY=-1,_7={},vH=T6("");if(x0.allowVerticalPlacement&&P5.vertical){let p2=w2.layout.get("text-rotate").evaluate(k5,{},j4)+90;Sw=new Eg(l5,S0,Y2,x3,F2,P5.vertical,q3,c3,k2,p2),B3&&(Tw=new Eg(l5,S0,Y2,x3,F2,B3,b2,v2,k2,p2))}if(z3){let p2=w2.layout.get("icon-rotate").evaluate(k5,{}),a3=w2.layout.get("icon-text-fit")!=="none",J9=sG(z3,p2,Rw,a3),_4=B3?sG(B3,p2,Rw,a3):void 0;Iw=new Eg(l5,S0,Y2,x3,F2,z3,b2,v2,!1,p2),qH=4*J9.length;let G9=x0.iconSizeData,x7=null;G9.kind==="source"?(x7=[m7*w2.layout.get("icon-size").evaluate(k5,{})],x7[0]>j6&&r0(`${x0.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):G9.kind==="composite"&&(x7=[m7*$4.compositeIconSizes[0].evaluate(k5,{},j4),m7*$4.compositeIconSizes[1].evaluate(k5,{},j4)],(x7[0]>j6||x7[1]>j6)&&r0(`${x0.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),x0.addSymbols(x0.icon,J9,x7,r5,J2,k5,U.ao.none,S0,Nw.lineStartIndex,Nw.lineLength,-1,j4),HY=x0.icon.placedSymbolArray.length-1,_4&&(ZH=4*_4.length,x0.addSymbols(x0.icon,_4,x7,r5,J2,k5,U.ao.vertical,S0,Nw.lineStartIndex,Nw.lineLength,-1,j4),UY=x0.icon.placedSymbolArray.length-1)}let JH=Object.keys(P5.horizontal);for(let p2 of JH){let a3=P5.horizontal[p2];if(!v9){vH=T6(a3.text);let _4=w2.layout.get("text-rotate").evaluate(k5,{},j4);v9=new Eg(l5,S0,Y2,x3,F2,a3,q3,c3,k2,_4)}let J9=a3.positionedLines.length===1;if(YH+=bH(x0,S0,a3,p3,w2,k2,k5,A3,Nw,P5.vertical?U.ao.horizontal:U.ao.horizontalOnly,J9?JH:[p2],_7,HY,$4,j4),J9)break}P5.vertical&&(kH+=bH(x0,S0,P5.vertical,p3,w2,k2,k5,A3,Nw,U.ao.vertical,["vertical"],_7,UY,$4,j4));let oV=v9?v9.boxStartIndex:x0.collisionBoxArray.length,nV=v9?v9.boxEndIndex:x0.collisionBoxArray.length,sV=Sw?Sw.boxStartIndex:x0.collisionBoxArray.length,iV=Sw?Sw.boxEndIndex:x0.collisionBoxArray.length,tV=Iw?Iw.boxStartIndex:x0.collisionBoxArray.length,eV=Iw?Iw.boxEndIndex:x0.collisionBoxArray.length,wL=Tw?Tw.boxStartIndex:x0.collisionBoxArray.length,bL=Tw?Tw.boxEndIndex:x0.collisionBoxArray.length,m4=-1,Rx=(p2,a3)=>p2&&p2.circleDiameter?Math.max(p2.circleDiameter,a3):a3;m4=Rx(v9,m4),m4=Rx(Sw,m4),m4=Rx(Iw,m4),m4=Rx(Tw,m4);let GH=m4>-1?1:0;GH&&(m4*=rV/q2),x0.glyphOffsetArray.length>=Y9.MAX_GLYPHS&&r0("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),k5.sortKey!==void 0&&x0.addToSortKeyRanges(x0.symbolInstances.length,k5.sortKey);let gL=wH(w2,k5,j4),[fL,zL]=function(p2,a3){let J9=p2.length,_4=a3==null?void 0:a3.values;if((_4==null?void 0:_4.length)>0)for(let G9=0;G9<_4.length;G9+=2){let x7=_4[G9+1];p2.emplaceBack(U.aE[_4[G9]],x7[0],x7[1])}return[J9,p2.length]}(x0.textAnchorOffsets,gL);x0.symbolInstances.emplaceBack(S0.x,S0.y,_7.right>=0?_7.right:-1,_7.center>=0?_7.center:-1,_7.left>=0?_7.left:-1,_7.vertical||-1,HY,UY,vH,oV,nV,sV,iV,tV,eV,wL,bL,Y2,YH,kH,qH,ZH,GH,0,q3,m4,fL,zL)}(w,g0,A0,q,v,H,S1,w.layers[0],w.collisionBoxArray,f.index,f.sourceLayerIndex,w.index,t,[h1,h1,h1,h1],T1,W,g1,K1,_1,_,f,M,h,K,A)};if(t1==="line")for(let A0 of pG(f.geometry,0,0,J0,J0)){let g0=q9(A0,E1),x0=PV(g0,G1,j1,q.vertical||j,v,24,U1,w.overscaling,J0);for(let S0 of x0)j&&cV(w,j.text,c1,S0)||Q0(g0,S0)}else if(t1==="line-center"){for(let A0 of f.geometry)if(A0.length>1){let g0=q9(A0,E1),x0=_V(g0,j1,q.vertical||j,v,24,U1);x0&&Q0(g0,x0)}}else if(f.type==="Polygon")for(let A0 of X6(f.geometry,0)){let g0=EV(A0,16);Q0(q9(A0[0],E1,!0),new _6(g0.x,g0.y,0))}else if(f.type==="LineString")for(let A0 of f.geometry){let g0=q9(A0,E1);Q0(g0,new _6(g0[0].x,g0[0].y,0))}else if(f.type==="Point")for(let A0 of f.geometry)for(let g0 of A0)Q0([g0],new _6(g0.x,g0.y,0))}function bH(w,f,q,v,H,M,A,Q,W,h,K,D,$,R,_){let j=function(U1,g1,G1,h1,K1,j1,T1,_1){let t1=h1.layout.get("text-rotate").evaluate(j1,{})*Math.PI/180,c1=[];for(let a1 of g1.positionedLines)for(let S1 of a1.positionedGlyphs){if(!S1.rect)continue;let E1=S1.rect||{},Q0=4,A0=!0,g0=1,x0=0,S0=(K1||_1)&&S1.vertical,Z2=S1.metrics.advance*S1.scale/2;if(_1&&g1.verticalizable&&(x0=a1.lineOffset/2-(S1.imageName?-(q2-S1.metrics.width*S1.scale)/2:(S1.scale-1)*q2)),S1.imageName){let v2=T1[S1.imageName];A0=v2.sdf,g0=v2.pixelRatio,Q0=1/g0}let P5=K1?[S1.x+Z2,S1.y]:[0,0],z3=K1?[0,0]:[S1.x+Z2+G1[0],S1.y+G1[1]-x0],p3=[0,0];S0&&(p3=z3,z3=[0,0]);let B3=S1.metrics.isDoubleResolution?2:1,w2=(S1.metrics.left-Q0)*S1.scale-Z2+z3[0],l5=(-S1.metrics.top-Q0)*S1.scale+z3[1],Y2=w2+E1.w/B3*S1.scale/g0,x3=l5+E1.h/B3*S1.scale/g0,F2=new l(w2,l5),q3=new l(Y2,l5),c3=new l(w2,x3),k2=new l(Y2,x3);if(S0){let v2=new l(-Z2,Z2- -17),J2=-Math.PI/2,r5=12-Z2,k5=new l(22-r5,-(S1.imageName?r5:0)),$4=new l(...p3);F2._rotateAround(J2,v2)._add(k5)._add($4),q3._rotateAround(J2,v2)._add(k5)._add($4),c3._rotateAround(J2,v2)._add(k5)._add($4),k2._rotateAround(J2,v2)._add(k5)._add($4)}if(t1){let v2=Math.sin(t1),J2=Math.cos(t1),r5=[J2,-v2,v2,J2];F2._matMult(r5),q3._matMult(r5),c3._matMult(r5),k2._matMult(r5)}let A3=new l(0,0),b2=new l(0,0);c1.push({tl:F2,tr:q3,bl:c3,br:k2,tex:E1,writingMode:g1.writingMode,glyphOffset:P5,sectionIndex:S1.sectionIndex,isSDF:A0,pixelOffsetTL:A3,pixelOffsetBR:b2,minFontScaleX:0,minFontScaleY:0})}return c1}(0,q,Q,H,M,A,v,w.allowVerticalPlacement),o=w.textSizeData,t=null;o.kind==="source"?(t=[m7*H.layout.get("text-size").evaluate(A,{})],t[0]>j6&&r0(`${w.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):o.kind==="composite"&&(t=[m7*R.compositeTextSizes[0].evaluate(A,{},_),m7*R.compositeTextSizes[1].evaluate(A,{},_)],(t[0]>j6||t[1]>j6)&&r0(`${w.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),w.addSymbols(w.text,j,t,Q,M,A,h,f,W.lineStartIndex,W.lineLength,$,_);for(let U1 of K)D[U1]=w.text.placedSymbolArray.length-1;return 4*j.length}function gH(w){for(let f in w)return w[f];return null}function cV(w,f,q,v){let H=w.compareText;if(f in H){let M=H[f];for(let A=M.length-1;A>=0;A--)if(v.dist(M[A])<q)return!0}else H[f]=[];return H[f].push(v),!1}let fH=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class qY{static from(w){if(!(w instanceof ArrayBuffer))throw Error("Data must be an instance of ArrayBuffer.");let[f,q]=new Uint8Array(w,0,2);if(f!==219)throw Error("Data does not appear to be in a KDBush format.");let v=q>>4;if(v!==1)throw Error(`Got v${v} data when expected v1.`);let H=fH[15&q];if(!H)throw Error("Unrecognized array type.");let[M]=new Uint16Array(w,2,1),[A]=new Uint32Array(w,4,1);return new qY(A,M,H,w)}constructor(w,f=64,q=Float64Array,v){if(isNaN(w)||w<0)throw Error(`Unpexpected numItems value: ${w}.`);this.numItems=+w,this.nodeSize=Math.min(Math.max(+f,2),65535),this.ArrayType=q,this.IndexArrayType=w<65536?Uint16Array:Uint32Array;let H=fH.indexOf(this.ArrayType),M=2*w*this.ArrayType.BYTES_PER_ELEMENT,A=w*this.IndexArrayType.BYTES_PER_ELEMENT,Q=(8-A%8)%8;if(H<0)throw Error(`Unexpected typed array class: ${q}.`);v&&v instanceof ArrayBuffer?(this.data=v,this.ids=new this.IndexArrayType(this.data,8,w),this.coords=new this.ArrayType(this.data,8+A+Q,2*w),this._pos=2*w,this._finished=!0):(this.data=new ArrayBuffer(8+M+A+Q),this.ids=new this.IndexArrayType(this.data,8,w),this.coords=new this.ArrayType(this.data,8+A+Q,2*w),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+H]),new Uint16Array(this.data,2,1)[0]=f,new Uint32Array(this.data,4,1)[0]=w)}add(w,f){let q=this._pos>>1;return this.ids[q]=q,this.coords[this._pos++]=w,this.coords[this._pos++]=f,q}finish(){let w=this._pos>>1;if(w!==this.numItems)throw Error(`Added ${w} items when expected ${this.numItems}.`);return ZY(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(w,f,q,v){if(!this._finished)throw Error("Data not yet indexed - call index.finish().");let{ids:H,coords:M,nodeSize:A}=this,Q=[0,H.length-1,0],W=[];for(;Q.length;){let h=Q.pop()||0,K=Q.pop()||0,D=Q.pop()||0;if(K-D<=A){for(let j=D;j<=K;j++){let o=M[2*j],t=M[2*j+1];o>=w&&o<=q&&t>=f&&t<=v&&W.push(H[j])}continue}let $=D+K>>1,R=M[2*$],_=M[2*$+1];R>=w&&R<=q&&_>=f&&_<=v&&W.push(H[$]),(h===0?w<=R:f<=_)&&(Q.push(D),Q.push($-1),Q.push(1-h)),(h===0?q>=R:v>=_)&&(Q.push($+1),Q.push(K),Q.push(1-h))}return W}within(w,f,q){if(!this._finished)throw Error("Data not yet indexed - call index.finish().");let{ids:v,coords:H,nodeSize:M}=this,A=[0,v.length-1,0],Q=[],W=q*q;for(;A.length;){let h=A.pop()||0,K=A.pop()||0,D=A.pop()||0;if(K-D<=M){for(let j=D;j<=K;j++)xH(H[2*j],H[2*j+1],w,f)<=W&&Q.push(v[j]);continue}let $=D+K>>1,R=H[2*$],_=H[2*$+1];xH(R,_,w,f)<=W&&Q.push(v[$]),(h===0?w-q<=R:f-q<=_)&&(A.push(D),A.push($-1),A.push(1-h)),(h===0?w+q>=R:f+q>=_)&&(A.push($+1),A.push(K),A.push(1-h))}return Q}}function ZY(w,f,q,v,H,M){if(H-v<=q)return;let A=v+H>>1;zH(w,f,A,v,H,M),ZY(w,f,q,v,A-1,1-M),ZY(w,f,q,A+1,H,1-M)}function zH(w,f,q,v,H,M){for(;H>v;){if(H-v>600){let h=H-v+1,K=q-v+1,D=Math.log(h),$=0.5*Math.exp(2*D/3),R=0.5*Math.sqrt(D*$*(h-$)/h)*(K-h/2<0?-1:1);zH(w,f,q,Math.max(v,Math.floor(q-K*$/h+R)),Math.min(H,Math.floor(q+(h-K)*$/h+R)),M)}let A=f[2*q+M],Q=v,W=H;for(ug(w,f,v,q),f[2*H+M]>A&&ug(w,f,v,H);Q<W;){for(ug(w,f,Q,W),Q++,W--;f[2*Q+M]<A;)Q++;for(;f[2*W+M]>A;)W--}f[2*v+M]===A?ug(w,f,v,W):(W++,ug(w,f,W,H)),W<=q&&(v=W+1),q<=W&&(H=W-1)}}function ug(w,f,q,v){YY(w,q,v),YY(f,2*q,2*v),YY(f,2*q+1,2*v+1)}function YY(w,f,q){let v=w[f];w[f]=w[q],w[q]=v}function xH(w,f,q,v){let H=w-q,M=f-v;return H*H+M*M}var kY;U.cx=void 0,(kY=U.cx||(U.cx={})).create="create",kY.load="load",kY.fullLoad="fullLoad";let yx=null,pg=[],vY=16.666666666666668,JY="loadTime",GY="fullLoadTime",aV={mark(w){performance.mark(w)},frame(w){let f=w;yx!=null&&pg.push(f-yx),yx=f},clearMetrics(){yx=null,pg=[],performance.clearMeasures(JY),performance.clearMeasures(GY);for(let w in U.cx)performance.clearMarks(U.cx[w])},getPerformanceMetrics(){performance.measure(JY,U.cx.create,U.cx.load),performance.measure(GY,U.cx.create,U.cx.fullLoad);let w=performance.getEntriesByName(JY)[0].duration,f=performance.getEntriesByName(GY)[0].duration,q=pg.length,v=1/(pg.reduce((M,A)=>M+A,0)/q/1000),H=pg.filter((M)=>M>vY).reduce((M,A)=>M+(A-vY)/vY,0);return{loadTime:w,fullLoadTime:f,fps:v,percentDroppedFrames:H/(q+H)*100,totalFrames:q}}};U.$=J0,U.A=f1,U.B=function([w,f,q]){return f+=90,f*=Math.PI/180,q*=Math.PI/180,{x:w*Math.cos(f)*Math.sin(q),y:w*Math.sin(f)*Math.sin(q),z:w*Math.cos(q)}},U.C=m2,U.D=e1,U.E=w0,U.F=n0,U.G=Lg,U.H=Q3,U.I=Vx,U.J=class{constructor(w,f){this.target=w,this.mapId=f,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new SG(()=>this.process()),this.subscription=u5(this.target,"message",(q)=>this.receive(q),!1),this.globalScope=i2(self)?w:window}registerMessageHandler(w,f){this.messageHandlers[w]=f}sendAsync(w,f){return new Promise((q,v)=>{let H=Math.round(1000000000000000000*Math.random()).toString(36).substring(0,10),M=f?u5(f.signal,"abort",()=>{M==null||M.unsubscribe(),delete this.resolveRejects[H];let W={id:H,type:"<cancel>",origin:location.origin,targetMapId:w.targetMapId,sourceMapId:this.mapId};this.target.postMessage(W)},jV):null;this.resolveRejects[H]={resolve:(W)=>{M==null||M.unsubscribe(),q(W)},reject:(W)=>{M==null||M.unsubscribe(),v(W)}};let A=[],Q=Object.assign(Object.assign({},w),{id:H,sourceMapId:this.mapId,origin:location.origin,data:O6(w.data,A)});this.target.postMessage(Q,{transfer:A})})}receive(w){let f=w.data,q=f.id;if(!(f.origin!=="file://"&&location.origin!=="file://"&&f.origin!=="resource://android"&&location.origin!=="resource://android"&&f.origin!==location.origin||f.targetMapId&&this.mapId!==f.targetMapId)){if(f.type==="<cancel>"){delete this.tasks[q];let v=this.abortControllers[q];return delete this.abortControllers[q],void(v&&v.abort())}if(i2(self)||f.mustQueue)return this.tasks[q]=f,this.taskQueue.push(q),void this.invoker.trigger();this.processTask(q,f)}}process(){if(this.taskQueue.length===0)return;let w=this.taskQueue.shift(),f=this.tasks[w];delete this.tasks[w],this.taskQueue.length>0&&this.invoker.trigger(),f&&this.processTask(w,f)}processTask(w,f){return Z(this,void 0,void 0,function*(){if(f.type==="<response>"){let H=this.resolveRejects[w];if(delete this.resolveRejects[w],!H)return;return void(f.error?H.reject(w7(f.error)):H.resolve(w7(f.data)))}if(!this.messageHandlers[f.type])return void this.completeTask(w,Error(`Could not find a registered handler for ${f.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));let q=w7(f.data),v=new AbortController;this.abortControllers[w]=v;try{let H=yield this.messageHandlers[f.type](f.sourceMapId,q,v);this.completeTask(w,null,H)}catch(H){this.completeTask(w,H)}})}completeTask(w,f,q){let v=[];delete this.abortControllers[w];let H={id:w,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:f?O6(f):null,data:O6(q,v)};this.target.postMessage(H,{transfer:v})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},U.K=e,U.L=function(){var w=new f1(16);return f1!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0),w[0]=1,w[5]=1,w[10]=1,w[15]=1,w},U.M=function(w,f,q){var v,H,M,A,Q,W,h,K,D,$,R,_,j=q[0],o=q[1],t=q[2];return f===w?(w[12]=f[0]*j+f[4]*o+f[8]*t+f[12],w[13]=f[1]*j+f[5]*o+f[9]*t+f[13],w[14]=f[2]*j+f[6]*o+f[10]*t+f[14],w[15]=f[3]*j+f[7]*o+f[11]*t+f[15]):(H=f[1],M=f[2],A=f[3],Q=f[4],W=f[5],h=f[6],K=f[7],D=f[8],$=f[9],R=f[10],_=f[11],w[0]=v=f[0],w[1]=H,w[2]=M,w[3]=A,w[4]=Q,w[5]=W,w[6]=h,w[7]=K,w[8]=D,w[9]=$,w[10]=R,w[11]=_,w[12]=v*j+Q*o+D*t+f[12],w[13]=H*j+W*o+$*t+f[13],w[14]=M*j+h*o+R*t+f[14],w[15]=A*j+K*o+_*t+f[15]),w},U.N=function(w,f,q){var v=q[0],H=q[1],M=q[2];return w[0]=f[0]*v,w[1]=f[1]*v,w[2]=f[2]*v,w[3]=f[3]*v,w[4]=f[4]*H,w[5]=f[5]*H,w[6]=f[6]*H,w[7]=f[7]*H,w[8]=f[8]*M,w[9]=f[9]*M,w[10]=f[10]*M,w[11]=f[11]*M,w[12]=f[12],w[13]=f[13],w[14]=f[14],w[15]=f[15],w},U.O=function(w,f,q){var v=f[0],H=f[1],M=f[2],A=f[3],Q=f[4],W=f[5],h=f[6],K=f[7],D=f[8],$=f[9],R=f[10],_=f[11],j=f[12],o=f[13],t=f[14],U1=f[15],g1=q[0],G1=q[1],h1=q[2],K1=q[3];return w[0]=g1*v+G1*Q+h1*D+K1*j,w[1]=g1*H+G1*W+h1*$+K1*o,w[2]=g1*M+G1*h+h1*R+K1*t,w[3]=g1*A+G1*K+h1*_+K1*U1,w[4]=(g1=q[4])*v+(G1=q[5])*Q+(h1=q[6])*D+(K1=q[7])*j,w[5]=g1*H+G1*W+h1*$+K1*o,w[6]=g1*M+G1*h+h1*R+K1*t,w[7]=g1*A+G1*K+h1*_+K1*U1,w[8]=(g1=q[8])*v+(G1=q[9])*Q+(h1=q[10])*D+(K1=q[11])*j,w[9]=g1*H+G1*W+h1*$+K1*o,w[10]=g1*M+G1*h+h1*R+K1*t,w[11]=g1*A+G1*K+h1*_+K1*U1,w[12]=(g1=q[12])*v+(G1=q[13])*Q+(h1=q[14])*D+(K1=q[15])*j,w[13]=g1*H+G1*W+h1*$+K1*o,w[14]=g1*M+G1*h+h1*R+K1*t,w[15]=g1*A+G1*K+h1*_+K1*U1,w},U.P=l,U.Q=function(w,f){let q={};for(let v=0;v<f.length;v++){let H=f[v];H in w&&(q[H]=w[H])}return q},U.R=U3,U.S=m6,U.T=Jx,U.U=mG,U.V=jG,U.W=R1,U.X=P1,U.Y=E5,U.Z=u3,U._=Z,U.a=S,U.a$=T5,U.a0=function(w,f){var q,v,H,M,A;if(!w)return f!=null?f:{};if(!f)return w;let Q=Object.assign({},w);if(f.removeAll&&(Q={removeAll:!0}),f.remove){let W=new Set(f.remove);Q.add&&(Q.add=Q.add.filter((K)=>!W.has(K.id))),Q.update&&(Q.update=Q.update.filter((K)=>!W.has(K.id)));let h=new Set(((q=w.add)!==null&&q!==void 0?q:[]).map((K)=>K.id));f.remove=f.remove.filter((K)=>!h.has(K))}if(f.remove){let W=new Set(Q.remove?Q.remove.concat(f.remove):f.remove);Q.remove=Array.from(W.values())}if(f.add){let W=Q.add?Q.add.concat(f.add):f.add,h=new Map(W.map((K)=>[K.id,K]));Q.add=Array.from(h.values())}if(f.update){let W=new Map((v=Q.update)===null||v===void 0?void 0:v.map((h)=>[h.id,h]));for(let h of f.update){let K=(H=W.get(h.id))!==null&&H!==void 0?H:{id:h.id};h.newGeometry&&(K.newGeometry=h.newGeometry),h.addOrUpdateProperties&&(K.addOrUpdateProperties=((M=K.addOrUpdateProperties)!==null&&M!==void 0?M:[]).concat(h.addOrUpdateProperties)),h.removeProperties&&(K.removeProperties=((A=K.removeProperties)!==null&&A!==void 0?A:[]).concat(h.removeProperties)),h.removeAllProperties&&(K.removeAllProperties=!0),W.set(h.id,K)}Q.update=Array.from(W.values())}return Q.remove&&Q.add&&(Q.remove=Q.remove.filter((W)=>Q.add.findIndex((h)=>h.id===W)===-1)),Q},U.a1=_g,U.a2=k9,U.a3=25,U.a4=Cx,U.a5=(w)=>{let f=window.document.createElement("video");return f.muted=!0,new Promise((q)=>{f.onloadstart=()=>{q(f)};for(let v of w){let H=window.document.createElement("source");v1(v)||(f.crossOrigin="Anonymous"),H.src=v,f.appendChild(H)}})},U.a6=d1,U.a7=function(){return j0++},U.a8=C,U.a9=Y9,U.aA=function(w){let f=1/0,q=1/0,v=-1/0,H=-1/0;for(let M of w)f=Math.min(f,M.x),q=Math.min(q,M.y),v=Math.max(v,M.x),H=Math.max(H,M.y);return[f,q,v,H]},U.aB=q2,U.aC=b0,U.aD=function(w,f,q,v,H=!1){if(!q[0]&&!q[1])return[0,0];let M=H?v==="map"?-w.bearingInRadians:0:v==="viewport"?w.bearingInRadians:0;if(M){let A=Math.sin(M),Q=Math.cos(M);q=[q[0]*Q-q[1]*A,q[0]*A+q[1]*Q]}return[H?q[0]:b0(f,q[0],w.zoom),H?q[1]:b0(f,q[1],w.zoom)]},U.aF=oZ,U.aG=xY,U.aH=rZ,U.aI=qY,U.aJ=K5,U.aK=Ng,U.aL=x1,U.aM=V0,U.aN=W0,U.aO=P0,U.aP=e2,U.aQ=PG,U.aR=$1,U.aS=r1,U.aT=function(w){var f=new f1(3);return f[0]=w[0],f[1]=w[1],f[2]=w[2],f},U.aU=function(w,f,q){return w[0]=f[0]-q[0],w[1]=f[1]-q[1],w[2]=f[2]-q[2],w},U.aV=function(w,f){var q=f[0],v=f[1],H=f[2],M=q*q+v*v+H*H;return M>0&&(M=1/Math.sqrt(M)),w[0]=f[0]*M,w[1]=f[1]*M,w[2]=f[2]*M,w},U.aW=q0,U.aX=function(w,f){return w[0]*f[0]+w[1]*f[1]+w[2]*f[2]},U.aY=function(w,f,q){return w[0]=f[0]*q[0],w[1]=f[1]*q[1],w[2]=f[2]*q[2],w[3]=f[3]*q[3],w},U.aZ=i1,U.a_=function(w,f,q){let v=f[0]*q[0]+f[1]*q[1]+f[2]*q[2];return v===0?null:(-(w[0]*q[0]+w[1]*q[1]+w[2]*q[2])-q[3])/v},U.aa=h6,U.ab=f9,U.ac=gY,U.ad=function(w){let f={};if(w.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(q,v,H,M)=>{let A=H||M;return f[v]=!A||A.toLowerCase(),""}),f["max-age"]){let q=parseInt(f["max-age"],10);isNaN(q)?delete f["max-age"]:f["max-age"]=q}return f},U.ae=U0,U.af=85.051129,U.ag=t2,U.ah=function(w){return Math.pow(2,w)},U.ai=B1,U.aj=_G,U.ak=function(w){return Math.log(w)/Math.LN2},U.al=function(w){var f=w[0],q=w[1];return f*f+q*q},U.am=function(w){if(!w.length)return new Set;let f=Math.max(...w.map((W)=>W.canonical.z)),q=1/0,v=-1/0,H=1/0,M=-1/0,A=[];for(let W of w){let{x:h,y:K,z:D}=W.canonical,$=Math.pow(2,f-D),R=h*$,_=K*$;A.push({id:W,x:R,y:_}),R<q&&(q=R),R>v&&(v=R),_<H&&(H=_),_>M&&(M=_)}let Q=new Set;for(let W of A)W.x!==q&&W.x!==v&&W.y!==H&&W.y!==M||Q.add(W.id);return Q},U.an=function(w,f){let q=0,v=0;if(w.kind==="constant")v=w.layoutSize;else if(w.kind!=="source"){let{interpolationType:H,minZoom:M,maxZoom:A}=w,Q=H?U0(j2.interpolationFactor(H,f,M,A),0,1):0;w.kind==="camera"?v=m2.number(w.minSize,w.maxSize,Q):q=Q}return{uSizeT:q,uSize:v}},U.ap=function(w,{uSize:f,uSizeT:q},{lowerSize:v,upperSize:H}){return w.kind==="source"?v/m7:w.kind==="composite"?m2.number(v/m7,H/m7,q):f},U.aq=function(w,f){var q=f[0],v=f[1],H=f[2],M=f[3],A=f[4],Q=f[5],W=f[6],h=f[7],K=f[8],D=f[9],$=f[10],R=f[11],_=f[12],j=f[13],o=f[14],t=f[15],U1=q*Q-v*A,g1=q*W-H*A,G1=q*h-M*A,h1=v*W-H*Q,K1=v*h-M*Q,j1=H*h-M*W,T1=K*j-D*_,_1=K*o-$*_,t1=K*t-R*_,c1=D*o-$*j,a1=D*t-R*j,S1=$*t-R*o,E1=U1*S1-g1*a1+G1*c1+h1*t1-K1*_1+j1*T1;return E1?(w[0]=(Q*S1-W*a1+h*c1)*(E1=1/E1),w[1]=(H*a1-v*S1-M*c1)*E1,w[2]=(j*j1-o*K1+t*h1)*E1,w[3]=($*K1-D*j1-R*h1)*E1,w[4]=(W*t1-A*S1-h*_1)*E1,w[5]=(q*S1-H*t1+M*_1)*E1,w[6]=(o*G1-_*j1-t*g1)*E1,w[7]=(K*j1-$*G1+R*g1)*E1,w[8]=(A*a1-Q*t1+h*T1)*E1,w[9]=(v*t1-q*a1-M*T1)*E1,w[10]=(_*K1-j*G1+t*U1)*E1,w[11]=(D*G1-K*K1-R*U1)*E1,w[12]=(Q*_1-A*c1-W*T1)*E1,w[13]=(q*c1-v*_1+H*T1)*E1,w[14]=(j*g1-_*h1-o*U1)*E1,w[15]=(K*h1-D*g1+$*U1)*E1,w):null},U.ar=y5,U.as=function(w){var f=w[0],q=w[1];return Math.sqrt(f*f+q*q)},U.at=function(w){return w[0]=0,w[1]=0,w},U.au=function(w,f,q){return w[0]=f[0]*q,w[1]=f[1]*q,w},U.av=nZ,U.aw=i5,U.ax=function(w,f,q,v){let H=f.y-w.y,M=f.x-w.x,A=v.y-q.y,Q=v.x-q.x,W=A*M-Q*H;if(W===0)return null;let h=(Q*(w.y-q.y)-A*(w.x-q.x))/W;return new l(w.x+h*M,w.y+h*H)},U.ay=pG,U.az=RJ,U.b=O2,U.b$=class extends E2{constructor(w,f){super(w,f),this.current=[]}set(w){if(w!=this.current){this.current=w;let f=new Float32Array(w);this.gl.uniform1fv(this.location,f)}}},U.b0=function(w,f,q){return w[0]=f[0]*q,w[1]=f[1]*q,w[2]=f[2]*q,w[3]=f[3]*q,w},U.b1=function(w,f){return w[0]*f[0]+w[1]*f[1]+w[2]*f[2]+w[3]},U.b2=wY,U.b3=Ow,U.b4=function(w,f,q,v,H){var M=1/Math.tan(f/2);if(w[0]=M/q,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=M,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,H!=null&&H!==1/0){var A=1/(v-H);w[10]=(H+v)*A,w[14]=2*H*v*A}else w[10]=-1,w[14]=-2*v;return w},U.b5=function(w){var f=new f1(16);return f[0]=w[0],f[1]=w[1],f[2]=w[2],f[3]=w[3],f[4]=w[4],f[5]=w[5],f[6]=w[6],f[7]=w[7],f[8]=w[8],f[9]=w[9],f[10]=w[10],f[11]=w[11],f[12]=w[12],f[13]=w[13],f[14]=w[14],f[15]=w[15],f},U.b6=function(w,f,q){var v=Math.sin(q),H=Math.cos(q),M=f[0],A=f[1],Q=f[2],W=f[3],h=f[4],K=f[5],D=f[6],$=f[7];return f!==w&&(w[8]=f[8],w[9]=f[9],w[10]=f[10],w[11]=f[11],w[12]=f[12],w[13]=f[13],w[14]=f[14],w[15]=f[15]),w[0]=M*H+h*v,w[1]=A*H+K*v,w[2]=Q*H+D*v,w[3]=W*H+$*v,w[4]=h*H-M*v,w[5]=K*H-A*v,w[6]=D*H-Q*v,w[7]=$*H-W*v,w},U.b7=function(w,f,q){var v=Math.sin(q),H=Math.cos(q),M=f[4],A=f[5],Q=f[6],W=f[7],h=f[8],K=f[9],D=f[10],$=f[11];return f!==w&&(w[0]=f[0],w[1]=f[1],w[2]=f[2],w[3]=f[3],w[12]=f[12],w[13]=f[13],w[14]=f[14],w[15]=f[15]),w[4]=M*H+h*v,w[5]=A*H+K*v,w[6]=Q*H+D*v,w[7]=W*H+$*v,w[8]=h*H-M*v,w[9]=K*H-A*v,w[10]=D*H-Q*v,w[11]=$*H-W*v,w},U.b8=function(){let w=new Float32Array(16);return B1(w),w},U.b9=function(){let w=new Float64Array(16);return B1(w),w},U.bA=function(w,f){let q=W5(w,360),v=W5(f,360),H=v-q,M=v>q?H-360:H+360;return Math.abs(H)<Math.abs(M)?H:M},U.bB=function(w){return w[0]=0,w[1]=0,w[2]=0,w},U.bC=function(w,f,q,v){let H=Math.sqrt(w*w+f*f),M=Math.sqrt(q*q+v*v);w/=H,f/=H,q/=M,v/=M;let A=Math.acos(w*q+f*v);return-f*q+w*v>0?A:-A},U.bD=function(w,f){let q=W5(w,2*Math.PI),v=W5(f,2*Math.PI);return Math.min(Math.abs(q-v),Math.abs(q-v+2*Math.PI),Math.abs(q-v-2*Math.PI))},U.bE=function(){let w={},f=M1.$version;for(let q in M1.$root){let v=M1.$root[q];if(v.required){let H=null;H=q==="version"?f:v.type==="array"?[]:{},H!=null&&(w[q]=H)}}return w},U.bF=u8,U.bG=J1,U.bH=function w(f,q){if(Array.isArray(f)){if(!Array.isArray(q)||f.length!==q.length)return!1;for(let v=0;v<f.length;v++)if(!w(f[v],q[v]))return!1;return!0}if(typeof f=="object"&&f!==null&&q!==null){if(typeof q!="object")return!1;if(Object.keys(f).length!==Object.keys(q).length)return!1;for(let v in f)if(!w(f[v],q[v]))return!1;return!0}return f===q},U.bI=function(w){w=w.slice();let f=Object.create(null);for(let q=0;q<w.length;q++)f[w[q].id]=w[q];for(let q=0;q<w.length;q++)"ref"in w[q]&&(w[q]=i0(w[q],f[w[q].ref]));return w},U.bJ=function(w,f){if(w.type==="custom")return new IG(w,f);switch(w.type){case"background":return new NG(w,f);case"circle":return new mJ(w,f);case"color-relief":return new oJ(w,f);case"fill":return new xG(w,f);case"fill-extrusion":return new YG(w,f);case"heatmap":return new uJ(w,f);case"hillshade":return new cJ(w,f);case"line":return new BG(w,f);case"raster":return new N7(w,f);case"symbol":return new lx(w,f)}},U.bK=(w)=>w.type==="raster",U.bL=h5,U.bM=function(w,f){if(!w)return[{command:"setStyle",args:[f]}];let q=[];try{if(!N1(w.version,f.version))return[{command:"setStyle",args:[f]}];N1(w.center,f.center)||q.push({command:"setCenter",args:[f.center]}),N1(w.state,f.state)||q.push({command:"setGlobalState",args:[f.state]}),N1(w.centerAltitude,f.centerAltitude)||q.push({command:"setCenterAltitude",args:[f.centerAltitude]}),N1(w.zoom,f.zoom)||q.push({command:"setZoom",args:[f.zoom]}),N1(w.bearing,f.bearing)||q.push({command:"setBearing",args:[f.bearing]}),N1(w.pitch,f.pitch)||q.push({command:"setPitch",args:[f.pitch]}),N1(w.roll,f.roll)||q.push({command:"setRoll",args:[f.roll]}),N1(w.sprite,f.sprite)||q.push({command:"setSprite",args:[f.sprite]}),N1(w.glyphs,f.glyphs)||q.push({command:"setGlyphs",args:[f.glyphs]}),N1(w.transition,f.transition)||q.push({command:"setTransition",args:[f.transition]}),N1(w.light,f.light)||q.push({command:"setLight",args:[f.light]}),N1(w.terrain,f.terrain)||q.push({command:"setTerrain",args:[f.terrain]}),N1(w.sky,f.sky)||q.push({command:"setSky",args:[f.sky]}),N1(w.projection,f.projection)||q.push({command:"setProjection",args:[f.projection]});let v={},H=[];(function(A,Q,W,h){let K;for(K in Q=Q||{},A=A||{})Object.prototype.hasOwnProperty.call(A,K)&&(Object.prototype.hasOwnProperty.call(Q,K)||e0(K,W,h));for(K in Q)Object.prototype.hasOwnProperty.call(Q,K)&&(Object.prototype.hasOwnProperty.call(A,K)?N1(A[K],Q[K])||(A[K].type==="geojson"&&Q[K].type==="geojson"&&m0(A,Q,K)?v0(W,{command:"setGeoJSONSourceData",args:[K,Q[K].data]}):F5(K,Q,W,h)):M0(K,Q,W))})(w.sources,f.sources,H,v);let M=[];w.layers&&w.layers.forEach((A)=>{"source"in A&&v[A.source]?q.push({command:"removeLayer",args:[A.id]}):M.push(A)}),q=q.concat(H),function(A,Q,W){Q=Q||[];let h=(A=A||[]).map(z5),K=Q.map(z5),D=A.reduce(L0,{}),$=Q.reduce(L0,{}),R=h.slice(),_=Object.create(null),j,o,t,U1,g1;for(let G1=0,h1=0;G1<h.length;G1++)j=h[G1],Object.prototype.hasOwnProperty.call($,j)?h1++:(v0(W,{command:"removeLayer",args:[j]}),R.splice(R.indexOf(j,h1),1));for(let G1=0,h1=0;G1<K.length;G1++)j=K[K.length-1-G1],R[R.length-1-G1]!==j&&(Object.prototype.hasOwnProperty.call(D,j)?(v0(W,{command:"removeLayer",args:[j]}),R.splice(R.lastIndexOf(j,R.length-h1),1)):h1++,U1=R[R.length-G1],v0(W,{command:"addLayer",args:[$[j],U1]}),R.splice(R.length-G1,0,j),_[j]=!0);for(let G1=0;G1<K.length;G1++)if(j=K[G1],o=D[j],t=$[j],!_[j]&&!N1(o,t))if(N1(o.source,t.source)&&N1(o["source-layer"],t["source-layer"])&&N1(o.type,t.type)){for(g1 in D0(o.layout,t.layout,W,j,null,"setLayoutProperty"),D0(o.paint,t.paint,W,j,null,"setPaintProperty"),N1(o.filter,t.filter)||v0(W,{command:"setFilter",args:[j,t.filter]}),N1(o.minzoom,t.minzoom)&&N1(o.maxzoom,t.maxzoom)||v0(W,{command:"setLayerZoomRange",args:[j,t.minzoom,t.maxzoom]}),o)Object.prototype.hasOwnProperty.call(o,g1)&&g1!=="layout"&&g1!=="paint"&&g1!=="filter"&&g1!=="metadata"&&g1!=="minzoom"&&g1!=="maxzoom"&&(g1.indexOf("paint.")===0?D0(o[g1],t[g1],W,j,g1.slice(6),"setPaintProperty"):N1(o[g1],t[g1])||v0(W,{command:"setLayerProperty",args:[j,g1,t[g1]]}));for(g1 in t)Object.prototype.hasOwnProperty.call(t,g1)&&!Object.prototype.hasOwnProperty.call(o,g1)&&g1!=="layout"&&g1!=="paint"&&g1!=="filter"&&g1!=="metadata"&&g1!=="minzoom"&&g1!=="maxzoom"&&(g1.indexOf("paint.")===0?D0(o[g1],t[g1],W,j,g1.slice(6),"setPaintProperty"):N1(o[g1],t[g1])||v0(W,{command:"setLayerProperty",args:[j,g1,t[g1]]}))}else v0(W,{command:"removeLayer",args:[j]}),U1=R[R.lastIndexOf(j)+1],v0(W,{command:"addLayer",args:[t,U1]})}(M,f.layers,q)}catch(v){console.warn("Unable to compute style diff:",v),q=[{command:"setStyle",args:[f]}]}return q},U.bN=function(w){let f=[],q=w.id;return q===void 0&&f.push({message:`layers.${q}: missing required property "id"`}),w.render===void 0&&f.push({message:`layers.${q}: missing required method "render"`}),w.renderingMode&&w.renderingMode!=="2d"&&w.renderingMode!=="3d"&&f.push({message:`layers.${q}: property "renderingMode" must be either "2d" or "3d"`}),f},U.bO=a0,U.bP=M2,U.bQ=class extends E2{constructor(w,f){super(w,f),this.current=0}set(w){this.current!==w&&(this.current=w,this.gl.uniform1i(this.location,w))}},U.bR=m5,U.bS=class extends E2{constructor(w,f){super(w,f),this.current=u2}set(w){if(w[12]!==this.current[12]||w[0]!==this.current[0])return this.current=w,void this.gl.uniformMatrix4fv(this.location,!1,w);for(let f=1;f<16;f++)if(w[f]!==this.current[f]){this.current=w,this.gl.uniformMatrix4fv(this.location,!1,w);break}}},U.bT=x2,U.bU=class extends E2{constructor(w,f){super(w,f),this.current=[0,0,0]}set(w){w[0]===this.current[0]&&w[1]===this.current[1]&&w[2]===this.current[2]||(this.current=w,this.gl.uniform3f(this.location,w[0],w[1],w[2]))}},U.bV=class extends E2{constructor(w,f){super(w,f),this.current=[0,0]}set(w){w[0]===this.current[0]&&w[1]===this.current[1]||(this.current=w,this.gl.uniform2f(this.location,w[0],w[1]))}},U.bW=Y1,U.bX=function(w,f){var q=Math.sin(f),v=Math.cos(f);return w[0]=v,w[1]=q,w[2]=0,w[3]=-q,w[4]=v,w[5]=0,w[6]=0,w[7]=0,w[8]=1,w},U.bY=function(w,f,q){var v=f[0],H=f[1],M=f[2];return w[0]=v*q[0]+H*q[3]+M*q[6],w[1]=v*q[1]+H*q[4]+M*q[7],w[2]=v*q[2]+H*q[5]+M*q[8],w},U.bZ=function(w,f,q,v,H,M,A){var Q=1/(f-q),W=1/(v-H),h=1/(M-A);return w[0]=-2*Q,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*W,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=2*h,w[11]=0,w[12]=(f+q)*Q,w[13]=(H+v)*W,w[14]=(A+M)*h,w[15]=1,w},U.b_=class extends E2{constructor(w,f){super(w,f),this.current=[]}set(w){if(w!=this.current){this.current=w;let f=new Float32Array(4*w.length);for(let q=0;q<w.length;q++)f[4*q]=w[q].r,f[4*q+1]=w[q].g,f[4*q+2]=w[q].b,f[4*q+3]=w[q].a;this.gl.uniform4fv(this.location,f)}}},U.ba=function(){return new Float64Array(16)},U.bb=function(w,f,q){let v=new Float64Array(4);return A2(v,w,f-90,q),v},U.bc=function(w,f,q,v){var H,M,A,Q,W,h=f[0],K=f[1],D=f[2],$=f[3],R=q[0],_=q[1],j=q[2],o=q[3];return(M=h*R+K*_+D*j+$*o)<0&&(M=-M,R=-R,_=-_,j=-j,o=-o),1-M>s1?(H=Math.acos(M),A=Math.sin(H),Q=Math.sin((1-v)*H)/A,W=Math.sin(v*H)/A):(Q=1-v,W=v),w[0]=Q*h+W*R,w[1]=Q*K+W*_,w[2]=Q*D+W*j,w[3]=Q*$+W*o,w},U.bd=function(w){let f=new Float64Array(9);var q,v,H,M,A,Q,W,h,K,D,$,R,_,j,o,t,U1,g1;D=(H=(v=w)[0])*(W=H+H),$=(M=v[1])*W,_=(A=v[2])*W,j=A*(h=M+M),t=(Q=v[3])*W,U1=Q*h,g1=Q*(K=A+A),(q=f)[0]=1-(R=M*h)-(o=A*K),q[3]=$-g1,q[6]=_+U1,q[1]=$+g1,q[4]=1-D-o,q[7]=j-t,q[2]=_-U1,q[5]=j+t,q[8]=1-D-R;let G1=e2(-Math.asin(U0(f[2],-1,1))),h1,K1;return Math.hypot(f[5],f[8])<0.001?(h1=0,K1=-e2(Math.atan2(f[3],f[4]))):(h1=e2(f[5]===0&&f[8]===0?0:Math.atan2(f[5],f[8])),K1=e2(f[1]===0&&f[0]===0?0:Math.atan2(f[1],f[0]))),{roll:h1,pitch:G1+90,bearing:K1}},U.be=function(w,f){return w.roll==f.roll&&w.pitch==f.pitch&&w.bearing==f.bearing},U.bf=h0,U.bg=N4,U.bh=Cw,U.bi=Ig,U.bj=x9,U.bk=Q5,U.bl=R5,U.bm=g3,U.bn=function(w,f,q,v,H){return Q5(v,H,U0((w-f)/(q-f),0,1))},U.bo=W5,U.bp=function(){return new Float64Array(3)},U.bq=function(w,f,q,v){return w[0]=f[0]+q[0]*v,w[1]=f[1]+q[1]*v,w[2]=f[2]+q[2]*v,w},U.br=A2,U.bs=function(w,f,q){var v=q[0],H=q[1],M=q[2],A=q[3],Q=f[0],W=f[1],h=f[2],K=H*h-M*W,D=M*Q-v*h,$=v*W-H*Q;return w[0]=Q+A*(K+=K)+H*($+=$)-M*(D+=D),w[1]=W+A*D+M*K-v*$,w[2]=h+A*$+v*D-H*K,w},U.bt=function(w,f,q){let v=(H=[w[0],w[1],w[2],f[0],f[1],f[2],q[0],q[1],q[2]])[0]*((K=H[8])*(A=H[4])-(Q=H[5])*(h=H[7]))+H[1]*(-K*(M=H[3])+Q*(W=H[6]))+H[2]*(h*M-A*W);var H,M,A,Q,W,h,K;if(v===0)return null;let D=q0([],[f[0],f[1],f[2]],[q[0],q[1],q[2]]),$=q0([],[q[0],q[1],q[2]],[w[0],w[1],w[2]]),R=q0([],[w[0],w[1],w[2]],[f[0],f[1],f[2]]),_=$1([],D,-w[3]);return r1(_,_,$1([],$,-f[3])),r1(_,_,$1([],R,-q[3])),$1(_,_,1/v),_},U.bu=tZ,U.bv=function(){return new Float64Array(4)},U.bw=function(w,f,q,v){var H=[],M=[];return H[0]=f[0]-q[0],H[1]=f[1]-q[1],H[2]=f[2]-q[2],M[0]=H[0]*Math.cos(v)-H[1]*Math.sin(v),M[1]=H[0]*Math.sin(v)+H[1]*Math.cos(v),M[2]=H[2],w[0]=M[0]+q[0],w[1]=M[1]+q[1],w[2]=M[2]+q[2],w},U.bx=function(w,f,q,v){var H=[],M=[];return H[0]=f[0]-q[0],H[1]=f[1]-q[1],H[2]=f[2]-q[2],M[0]=H[0],M[1]=H[1]*Math.cos(v)-H[2]*Math.sin(v),M[2]=H[1]*Math.sin(v)+H[2]*Math.cos(v),w[0]=M[0]+q[0],w[1]=M[1]+q[1],w[2]=M[2]+q[2],w},U.by=function(w,f,q,v){var H=[],M=[];return H[0]=f[0]-q[0],H[1]=f[1]-q[1],H[2]=f[2]-q[2],M[0]=H[2]*Math.sin(v)+H[0]*Math.cos(v),M[1]=H[1],M[2]=H[2]*Math.cos(v)-H[0]*Math.sin(v),w[0]=M[0]+q[0],w[1]=M[1]+q[1],w[2]=M[2]+q[2],w},U.bz=function(w,f,q){var v=Math.sin(q),H=Math.cos(q),M=f[0],A=f[1],Q=f[2],W=f[3],h=f[8],K=f[9],D=f[10],$=f[11];return f!==w&&(w[4]=f[4],w[5]=f[5],w[6]=f[6],w[7]=f[7],w[12]=f[12],w[13]=f[13],w[14]=f[14],w[15]=f[15]),w[0]=M*H-h*v,w[1]=A*H-K*v,w[2]=Q*H-D*v,w[3]=W*H-$*v,w[8]=M*v+h*H,w[9]=A*v+K*H,w[10]=Q*v+D*H,w[11]=W*v+$*H,w},U.c=I,U.c0=class extends Xw{},U.c1=GV,U.c2=class extends b9{},U.c3=TZ,U.c4=function(w){return w<=1?1:Math.pow(2,Math.ceil(Math.log(w)/Math.LN2))},U.c5=EJ,U.c6=function(w,f,q){var v=f[0],H=f[1],M=f[2],A=q[3]*v+q[7]*H+q[11]*M+q[15];return w[0]=(q[0]*v+q[4]*H+q[8]*M+q[12])/(A=A||1),w[1]=(q[1]*v+q[5]*H+q[9]*M+q[13])/A,w[2]=(q[2]*v+q[6]*H+q[10]*M+q[14])/A,w},U.c7=class extends i8{},U.c8=class extends V{},U.c9=function(w,f){return w[0]===f[0]&&w[1]===f[1]&&w[2]===f[2]&&w[3]===f[3]&&w[4]===f[4]&&w[5]===f[5]&&w[6]===f[6]&&w[7]===f[7]&&w[8]===f[8]&&w[9]===f[9]&&w[10]===f[10]&&w[11]===f[11]&&w[12]===f[12]&&w[13]===f[13]&&w[14]===f[14]&&w[15]===f[15]},U.cA=function(w,f){S.REGISTERED_PROTOCOLS[w]=f},U.cB=function(w){delete S.REGISTERED_PROTOCOLS[w]},U.cC=function(w,f){let q={};for(let H=0;H<w.length;H++){let M=f&&f[w[H].id]||Gg(w[H]);f&&(f[w[H].id]=M);let A=q[M];A||(A=q[M]=[]),A.push(w[H])}let v=[];for(let H in q)v.push(q[H]);return v},U.cD=o1,U.cE=bY,U.cF=fY,U.cG=cZ,U.cH=function(w){w.bucket.createArrays(),w.bucket.tilePixelRatio=J0/(512*w.bucket.overscaling),w.bucket.compareText={},w.bucket.iconsNeedLinear=!1;let f=w.bucket.layers[0],q=f.layout,v=f._unevaluatedLayout._values,H={layoutIconSize:v["icon-size"].possiblyEvaluate(new n0(w.bucket.zoom+1),w.canonical),layoutTextSize:v["text-size"].possiblyEvaluate(new n0(w.bucket.zoom+1),w.canonical),textMaxSize:v["text-size"].possiblyEvaluate(new n0(18))};if(w.bucket.textSizeData.kind==="composite"){let{minZoom:h,maxZoom:K}=w.bucket.textSizeData;H.compositeTextSizes=[v["text-size"].possiblyEvaluate(new n0(h),w.canonical),v["text-size"].possiblyEvaluate(new n0(K),w.canonical)]}if(w.bucket.iconSizeData.kind==="composite"){let{minZoom:h,maxZoom:K}=w.bucket.iconSizeData;H.compositeIconSizes=[v["icon-size"].possiblyEvaluate(new n0(h),w.canonical),v["icon-size"].possiblyEvaluate(new n0(K),w.canonical)]}let M=q.get("text-line-height")*q2,A=q.get("text-rotation-alignment")!=="viewport"&&q.get("symbol-placement")!=="point",Q=q.get("text-keep-upright"),W=q.get("text-size");for(let h of w.bucket.features){let K=q.get("text-font").evaluate(h,{},w.canonical).join(","),D=W.evaluate(h,{},w.canonical),$=H.layoutTextSize.evaluate(h,{},w.canonical),R=H.layoutIconSize.evaluate(h,{},w.canonical),_={horizontal:{},vertical:void 0},j=h.text,o,t=[0,0];if(j){let G1=j.toString(),h1=q.get("text-letter-spacing").evaluate(h,{},w.canonical)*q2,K1=sz(G1)?h1:0,j1=q.get("text-anchor").evaluate(h,{},w.canonical),T1=wH(f,h,w.canonical);if(!T1){let a1=q.get("text-radial-offset").evaluate(h,{},w.canonical);t=a1?eG(j1,[a1*q2,zY]):q.get("text-offset").evaluate(h,{},w.canonical).map((S1)=>S1*q2)}let _1=A?"center":q.get("text-justify").evaluate(h,{},w.canonical),t1=q.get("symbol-placement")==="point"?q.get("text-max-width").evaluate(h,{},w.canonical)*q2:1/0,c1=()=>{w.bucket.allowVerticalPlacement&&y6(G1)&&(_.vertical=Lx(j,w.glyphMap,w.glyphPositions,w.imagePositions,K,t1,M,j1,"left",K1,t,U.ao.vertical,!0,$,D))};if(!A&&T1){let a1=new Set;if(_1==="auto")for(let E1=0;E1<T1.values.length;E1+=2)a1.add(xY(T1.values[E1]));else a1.add(_1);let S1=!1;for(let E1 of a1)if(!_.horizontal[E1])if(S1)_.horizontal[E1]=_.horizontal[0];else{let Q0=Lx(j,w.glyphMap,w.glyphPositions,w.imagePositions,K,t1,M,"center",E1,K1,t,U.ao.horizontal,!1,$,D);Q0&&(_.horizontal[E1]=Q0,S1=Q0.positionedLines.length===1)}c1()}else{_1==="auto"&&(_1=xY(j1));let a1=Lx(j,w.glyphMap,w.glyphPositions,w.imagePositions,K,t1,M,j1,_1,K1,t,U.ao.horizontal,!1,$,D);a1&&(_.horizontal[_1]=a1),c1(),y6(G1)&&A&&Q&&(_.vertical=Lx(j,w.glyphMap,w.glyphPositions,w.imagePositions,K,t1,M,j1,_1,K1,t,U.ao.vertical,!1,$,D))}}let U1=!1;if(h.icon&&h.icon.name){let G1=w.imageMap[h.icon.name];G1&&(o=IV(w.imagePositions[h.icon.name],q.get("icon-offset").evaluate(h,{},w.canonical),q.get("icon-anchor").evaluate(h,{},w.canonical)),U1=!!G1.sdf,w.bucket.sdfIcons===void 0?w.bucket.sdfIcons=U1:w.bucket.sdfIcons!==U1&&r0("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(G1.pixelRatio!==w.bucket.pixelRatio||q.get("icon-rotate").constantOr(1)!==0)&&(w.bucket.iconsNeedLinear=!0))}let g1=gH(_.horizontal)||_.vertical;w.bucket.iconsInText=!!g1&&g1.iconsInText,(g1||o)&&pV(w.bucket,h,_,o,w.imageMap,H,$,R,t,U1,w.canonical,w.subdivisionGranularity)}w.showCollisionBoxes&&w.bucket.generateCollisionDebugBuffers()},U.cI=Bx,U.cJ=Ax,U.cK=Mx,U.cL=EZ,U.cM=Qx,U.cN=class{constructor(w){this._marks={start:[w.url,"start"].join("#"),end:[w.url,"end"].join("#"),measure:w.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let w=performance.getEntriesByName(this._marks.measure);return w.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),w=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),w}},U.cO=function(w,f,q,v,H){return Z(this,void 0,void 0,function*(){if(P1())try{return yield E5(w,f,q,v,H)}catch(M){}return function(M,A,Q,W,h){let{width:K,height:D}=M;T3&&Y3||(T3=new OffscreenCanvas(K,D),Y3=T3.getContext("2d",{willReadFrequently:!0})),T3.width=K,T3.height=D,Y3.drawImage(M,0,0,K,D);let $=Y3.getImageData(A,Q,W,h);return Y3.clearRect(0,0,K,D),$.data}(w,f,q,v,H)})},U.cP=$Z,U.cQ=N,U.cR=PZ,U.cS=Z9,U.cT=xw,U.cU=function(w,f){let q=new Map;if(w==null);else if(w.type==="Feature")q.set(Pg(w,f),w);else for(let v of w.features)q.set(Pg(v,f),v);return q},U.cV=function(w,f){if(w==null)return!0;if(w.type==="Feature")return Pg(w,f)!=null;if(w.type==="FeatureCollection"){let q=new Set;for(let v of w.features){let H=Pg(v,f);if(H==null)return!1;if(q.has(H))return!1;q.add(H)}return!0}return!1},U.cW=function(w,f,q){var v,H,M,A;if(f.removeAll&&w.clear(),f.remove)for(let Q of f.remove)w.delete(Q);if(f.add)for(let Q of f.add){let W=Pg(Q,q);W!=null&&w.set(W,Q)}if(f.update)for(let Q of f.update){let W=w.get(Q.id);if(W==null)continue;let h=!Q.removeAllProperties&&(((v=Q.removeProperties)===null||v===void 0?void 0:v.length)>0||((H=Q.addOrUpdateProperties)===null||H===void 0?void 0:H.length)>0);if((Q.newGeometry||Q.removeAllProperties||h)&&(W=Object.assign({},W),w.set(Q.id,W),h&&(W.properties=Object.assign({},W.properties))),Q.newGeometry&&(W.geometry=Q.newGeometry),Q.removeAllProperties)W.properties={};else if(((M=Q.removeProperties)===null||M===void 0?void 0:M.length)>0)for(let K of Q.removeProperties)Object.prototype.hasOwnProperty.call(W.properties,K)&&delete W.properties[K];if(((A=Q.addOrUpdateProperties)===null||A===void 0?void 0:A.length)>0)for(let{key:K,value:D}of Q.addOrUpdateProperties)W.properties[K]=D}},U.cX=v4,U.ca=function(w,f){var q=w[0],v=w[1],H=w[2],M=w[3],A=w[4],Q=w[5],W=w[6],h=w[7],K=w[8],D=w[9],$=w[10],R=w[11],_=w[12],j=w[13],o=w[14],t=w[15],U1=f[0],g1=f[1],G1=f[2],h1=f[3],K1=f[4],j1=f[5],T1=f[6],_1=f[7],t1=f[8],c1=f[9],a1=f[10],S1=f[11],E1=f[12],Q0=f[13],A0=f[14],g0=f[15];return Math.abs(q-U1)<=s1*Math.max(1,Math.abs(q),Math.abs(U1))&&Math.abs(v-g1)<=s1*Math.max(1,Math.abs(v),Math.abs(g1))&&Math.abs(H-G1)<=s1*Math.max(1,Math.abs(H),Math.abs(G1))&&Math.abs(M-h1)<=s1*Math.max(1,Math.abs(M),Math.abs(h1))&&Math.abs(A-K1)<=s1*Math.max(1,Math.abs(A),Math.abs(K1))&&Math.abs(Q-j1)<=s1*Math.max(1,Math.abs(Q),Math.abs(j1))&&Math.abs(W-T1)<=s1*Math.max(1,Math.abs(W),Math.abs(T1))&&Math.abs(h-_1)<=s1*Math.max(1,Math.abs(h),Math.abs(_1))&&Math.abs(K-t1)<=s1*Math.max(1,Math.abs(K),Math.abs(t1))&&Math.abs(D-c1)<=s1*Math.max(1,Math.abs(D),Math.abs(c1))&&Math.abs($-a1)<=s1*Math.max(1,Math.abs($),Math.abs(a1))&&Math.abs(R-S1)<=s1*Math.max(1,Math.abs(R),Math.abs(S1))&&Math.abs(_-E1)<=s1*Math.max(1,Math.abs(_),Math.abs(E1))&&Math.abs(j-Q0)<=s1*Math.max(1,Math.abs(j),Math.abs(Q0))&&Math.abs(o-A0)<=s1*Math.max(1,Math.abs(o),Math.abs(A0))&&Math.abs(t-g0)<=s1*Math.max(1,Math.abs(t),Math.abs(g0))},U.cb=function(w,f){return w[0]=f[0],w[1]=f[1],w[2]=f[2],w[3]=f[3],w[4]=f[4],w[5]=f[5],w[6]=f[6],w[7]=f[7],w[8]=f[8],w[9]=f[9],w[10]=f[10],w[11]=f[11],w[12]=f[12],w[13]=f[13],w[14]=f[14],w[15]=f[15],w},U.cc=(w)=>w.type==="symbol",U.cd=(w)=>w.type==="circle",U.ce=(w)=>w.type==="heatmap",U.cf=(w)=>w.type==="line",U.cg=(w)=>w.type==="fill",U.ch=(w)=>w.type==="fill-extrusion",U.ci=(w)=>w.type==="hillshade",U.cj=(w)=>w.type==="color-relief",U.ck=(w)=>w.type==="background",U.cl=(w)=>w.type==="custom",U.cm=s2,U.cn=function(w,f,q){let v=C0(f.x-q.x,f.y-q.y),H=C0(w.x-q.x,w.y-q.y);var M,A;return e2(Math.atan2(v[0]*H[1]-v[1]*H[0],(M=v)[0]*(A=H)[0]+M[1]*A[1]))},U.co=Z0,U.cp=function(w,f){return $3[f]&&(w instanceof MouseEvent||w instanceof WheelEvent)},U.cq=function(w,f){return c4[f]&&"touches"in w},U.cr=function(w){return c4[w]||$3[w]},U.cs=function(w,f,q){var v=f[0],H=f[1];return w[0]=q[0]*v+q[4]*H+q[12],w[1]=q[1]*v+q[5]*H+q[13],w},U.ct=function(w,f){let{x:q,y:v}=_g.fromLngLat(f);return!(w<0||w>25||v<0||v>=1||q<0||q>=1)},U.cu=function(w,f){return w[0]=f[0],w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=f[1],w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=f[2],w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},U.cv=class extends E3{},U.cw=aV,U.cy=function(w){return w.message===V3},U.cz=b1,U.d=v1,U.e=s0,U.f=(w)=>Z(void 0,void 0,void 0,function*(){if(w.byteLength===0)return createImageBitmap(new ImageData(1,1));let f=new Blob([new Uint8Array(w)],{type:"image/png"});try{return createImageBitmap(f)}catch(q){throw Error(`Could not load image because of ${q.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),U.g=m,U.h=(w)=>new Promise((f,q)=>{let v=new Image;v.onload=()=>{f(v),URL.revokeObjectURL(v.src),v.onload=null,window.requestAnimationFrame(()=>{v.src=x4})},v.onerror=()=>q(Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let H=new Blob([new Uint8Array(w)],{type:"image/png"});v.src=w.byteLength?URL.createObjectURL(H):x4}),U.i=i2,U.j=(w,f)=>A1(s0(w,{type:"json"}),f),U.k=m1,U.l=C1,U.m=A1,U.n=(w,f)=>A1(s0(w,{type:"arrayBuffer"}),f),U.o=function(w){return new Qx(w).readFields(hV,[])},U.p=LG,U.q=Dg,U.r=W2,U.s=u5,U.t=a8,U.u=O0,U.v=M1,U.w=r0,U.x=Vg,U.y=Wg,U.z=P3}),Y("worker",["./shared"],function(U){class Z{constructor(I,S){this.keyCache={},I&&this.replace(I,S)}replace(I,S){this._layerConfigs={},this._layers={},this.update(I,[],S)}update(I,S,m){for(let b1 of I){this._layerConfigs[b1.id]=b1;let J1=this._layers[b1.id]=U.bJ(b1,m);J1._featureFilter=U.aa(J1.filter,m),this.keyCache[b1.id]&&delete this.keyCache[b1.id]}for(let b1 of S)delete this.keyCache[b1],delete this._layerConfigs[b1],delete this._layers[b1];this.familiesBySource={};let e=U.cC(Object.values(this._layerConfigs),this.keyCache);for(let b1 of e){let J1=b1.map((m1)=>this._layers[m1.id]),A1=J1[0];if(A1.visibility==="none")continue;let v1=A1.source||"",X1=this.familiesBySource[v1];X1||(X1=this.familiesBySource[v1]={});let l1=A1.sourceLayer||"_geojsonTileLayer",C1=X1[l1];C1||(C1=X1[l1]=[]),C1.push(J1)}}}class l{constructor(I){let S={},m=[];for(let A1 in I){let v1=I[A1],X1=S[A1]={};for(let l1 in v1){let C1=v1[+l1];if(!C1||C1.bitmap.width===0||C1.bitmap.height===0)continue;let m1={x:0,y:0,w:C1.bitmap.width+2,h:C1.bitmap.height+2};m.push(m1),X1[l1]={rect:m1,metrics:C1.metrics}}}let{w:e,h:b1}=U.p(m),J1=new U.q({width:e||1,height:b1||1});for(let A1 in I){let v1=I[A1];for(let X1 in v1){let l1=v1[+X1];if(!l1||l1.bitmap.width===0||l1.bitmap.height===0)continue;let C1=S[A1][X1].rect;U.q.copy(l1.bitmap,J1,{x:0,y:0},{x:C1.x+1,y:C1.y+1},l1.bitmap)}}this.image=J1,this.positions=S}}U.cD("GlyphAtlas",l);class N{constructor(I){this.tileID=new U.Z(I.tileID.overscaledZ,I.tileID.wrap,I.tileID.canonical.z,I.tileID.canonical.x,I.tileID.canonical.y),this.uid=I.uid,this.zoom=I.zoom,this.pixelRatio=I.pixelRatio,this.tileSize=I.tileSize,this.source=I.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=I.showCollisionBoxes,this.collectResourceTiming=!!I.collectResourceTiming,this.returnDependencies=!!I.returnDependencies,this.promoteId=I.promoteId,this.inFlightDependencies=[]}parse(I,S,m,e,b1){return U._(this,void 0,void 0,function*(){this.status="parsing",this.data=I,this.collisionBoxArray=new U.a8;let J1=new U.cE(Object.keys(I.layers).sort()),A1=new U.cF(this.tileID,this.promoteId);A1.bucketLayerIDs=[];let v1={},X1={featureIndex:A1,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:m,subdivisionGranularity:b1},l1=S.familiesBySource[this.source];for(let L0 in l1){let d1=I.layers[L0];if(!d1)continue;d1.version===1&&U.w(`Vector tile source "${this.source}" layer "${L0}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let w3=J1.encode(L0),V5=[];for(let T2=0;T2<d1.length;T2++){let b3=d1.feature(T2),u1=A1.getId(b3,L0);V5.push({feature:b3,id:u1,index:T2,sourceLayerIndex:w3})}for(let T2 of l1[L0]){let b3=T2[0];b3.source!==this.source&&U.w(`layer.source = ${b3.source} does not equal this.source = ${this.source}`),b3.isHidden(this.zoom,!0)||(P(T2,this.zoom,m),(v1[b3.id]=b3.createBucket({index:A1.bucketLayerIDs.length,layers:T2,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:w3,sourceID:this.source})).populate(V5,X1,this.tileID.canonical),A1.bucketLayerIDs.push(T2.map((u1)=>u1.id)))}}let C1=U.bO(X1.glyphDependencies,(L0)=>Object.keys(L0).map(Number));this.inFlightDependencies.forEach((L0)=>L0==null?void 0:L0.abort()),this.inFlightDependencies=[];let m1=Promise.resolve({});if(Object.keys(C1).length){let L0=new AbortController;this.inFlightDependencies.push(L0),m1=e.sendAsync({type:"GG",data:{stacks:C1,source:this.source,tileID:this.tileID,type:"glyphs"}},L0)}let w0=Object.keys(X1.iconDependencies),M1=Promise.resolve({});if(w0.length){let L0=new AbortController;this.inFlightDependencies.push(L0),M1=e.sendAsync({type:"GI",data:{icons:w0,source:this.source,tileID:this.tileID,type:"icons"}},L0)}let y0=Object.keys(X1.patternDependencies),i0=Promise.resolve({});if(y0.length){let L0=new AbortController;this.inFlightDependencies.push(L0),i0=e.sendAsync({type:"GI",data:{icons:y0,source:this.source,tileID:this.tileID,type:"patterns"}},L0)}let N1=X1.dashDependencies,v0=Promise.resolve({});if(Object.keys(N1).length){let L0=new AbortController;this.inFlightDependencies.push(L0),v0=e.sendAsync({type:"GDA",data:{dashes:N1}},L0)}let[M0,e0,F5,m0]=yield Promise.all([m1,M1,i0,v0]),D0=new l(M0),z5=new U.cG(e0,F5);for(let L0 in v1){let d1=v1[L0];d1 instanceof U.a9?(P(d1.layers,this.zoom,m),U.cH({bucket:d1,glyphMap:M0,glyphPositions:D0.positions,imageMap:e0,imagePositions:z5.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:X1.subdivisionGranularity})):d1.hasDependencies&&(d1 instanceof U.cI||d1 instanceof U.cJ||d1 instanceof U.cK)&&(P(d1.layers,this.zoom,m),d1.addFeatures(X1,this.tileID.canonical,z5.patternPositions,m0))}return this.status="done",{buckets:Object.values(v1).filter((L0)=>!L0.isEmpty()),featureIndex:A1,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:D0.image,imageAtlas:z5,dashPositions:m0,glyphMap:this.returnDependencies?M0:null,iconMap:this.returnDependencies?e0:null,glyphPositions:this.returnDependencies?D0.positions:null}})}}function P(I,S,m){let e=new U.F(S);for(let b1 of I)b1.recalculate(e,m)}class w1{constructor(I,S,m){this.actor=I,this.layerIndex=S,this.availableImages=m,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(I,S){return U._(this,void 0,void 0,function*(){let m=yield U.n(I.request,S);try{return{vectorTile:new U.cL(new U.cM(m.data)),rawData:m.data,cacheControl:m.cacheControl,expires:m.expires}}catch(e){let b1=new Uint8Array(m.data),J1=`Unable to parse the tile at ${I.request.url}, `;throw J1+=b1[0]===31&&b1[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${e.message}`,Error(J1)}})}loadTile(I){return U._(this,void 0,void 0,function*(){let S=I.uid,m=!!(I&&I.request&&I.request.collectResourceTiming)&&new U.cN(I.request),e=new N(I);this.loading[S]=e;let b1=new AbortController;e.abort=b1;try{let J1=yield this.loadVectorTile(I,b1);if(delete this.loading[S],!J1)return null;let A1=J1.rawData,v1={};J1.expires&&(v1.expires=J1.expires),J1.cacheControl&&(v1.cacheControl=J1.cacheControl);let X1={};if(m){let C1=m.finish();C1&&(X1.resourceTiming=JSON.parse(JSON.stringify(C1)))}e.vectorTile=J1.vectorTile;let l1=e.parse(J1.vectorTile,this.layerIndex,this.availableImages,this.actor,I.subdivisionGranularity);this.loaded[S]=e,this.fetching[S]={rawTileData:A1,cacheControl:v1,resourceTiming:X1};try{let C1=yield l1;return U.e({rawTileData:A1.slice(0)},C1,v1,X1)}finally{delete this.fetching[S]}}catch(J1){throw delete this.loading[S],e.status="done",this.loaded[S]=e,J1}})}reloadTile(I){return U._(this,void 0,void 0,function*(){let S=I.uid;if(!this.loaded||!this.loaded[S])throw Error("Should not be trying to reload a tile that was never loaded or has been removed");let m=this.loaded[S];if(m.showCollisionBoxes=I.showCollisionBoxes,m.status==="parsing"){let e=yield m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,I.subdivisionGranularity),b1;if(this.fetching[S]){let{rawTileData:J1,cacheControl:A1,resourceTiming:v1}=this.fetching[S];delete this.fetching[S],b1=U.e({rawTileData:J1.slice(0)},e,A1,v1)}else b1=e;return b1}if(m.status==="done"&&m.vectorTile)return m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,I.subdivisionGranularity)})}abortTile(I){return U._(this,void 0,void 0,function*(){let S=this.loading,m=I.uid;S&&S[m]&&S[m].abort&&(S[m].abort.abort(),delete S[m])})}removeTile(I){return U._(this,void 0,void 0,function*(){this.loaded&&this.loaded[I.uid]&&delete this.loaded[I.uid]})}}class H1{constructor(){this.loaded={}}loadTile(I){return U._(this,void 0,void 0,function*(){let{uid:S,encoding:m,rawImageData:e,redFactor:b1,greenFactor:J1,blueFactor:A1,baseShift:v1}=I,X1=e.width+2,l1=e.height+2,C1=U.b(e)?new U.R({width:X1,height:l1},yield U.cO(e,-1,-1,X1,l1)):e,m1=new U.cP(S,C1,m,b1,J1,A1,v1);return this.loaded=this.loaded||{},this.loaded[S]=m1,m1})}removeTile(I){let S=this.loaded,m=I.uid;S&&S[m]&&delete S[m]}}var r,z1,u=function(){if(z1)return r;function I(m,e){if(m.length!==0){S(m[0],e);for(var b1=1;b1<m.length;b1++)S(m[b1],!e)}}function S(m,e){for(var b1=0,J1=0,A1=0,v1=m.length,X1=v1-1;A1<v1;X1=A1++){var l1=(m[A1][0]-m[X1][0])*(m[X1][1]+m[A1][1]),C1=b1+l1;J1+=Math.abs(b1)>=Math.abs(l1)?b1-C1+l1:l1-C1+b1,b1=C1}b1+J1>=0!=!!e&&m.reverse()}return z1=1,r=function m(e,b1){var J1,A1=e&&e.type;if(A1==="FeatureCollection")for(J1=0;J1<e.features.length;J1++)m(e.features[J1],b1);else if(A1==="GeometryCollection")for(J1=0;J1<e.geometries.length;J1++)m(e.geometries[J1],b1);else if(A1==="Feature")m(e.geometry,b1);else if(A1==="Polygon")I(e.coordinates,b1);else if(A1==="MultiPolygon")for(J1=0;J1<e.coordinates.length;J1++)I(e.coordinates[J1],b1);return e}}(),R1=U.cQ(u);class P1 extends U.cS{constructor(I,S){super(new U.cM,0,S,[],[]),this.feature=I,this.type=I.type,this.properties=I.tags?I.tags:{},"id"in I&&(typeof I.id=="string"?this.id=parseInt(I.id,10):typeof I.id!="number"||isNaN(I.id)||(this.id=I.id))}loadGeometry(){let I=[],S=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(let m of S){let e=[];for(let b1 of m)e.push(new U.P(b1[0],b1[1]));I.push(e)}return I}}class s1 extends U.cR{constructor(I,S){super(new U.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=S?S.version:1,this.extent=S?S.extent:4096,this.length=I.length,this.features=I}feature(I){return new P1(this.features[I],this.extent)}}function f1(I,S){S.writeVarintField(15,I.version||1),S.writeStringField(1,I.name||""),S.writeVarintField(5,I.extent||4096);let m={keys:[],values:[],keycache:{},valuecache:{}};for(let J1=0;J1<I.length;J1++)m.feature=I.feature(J1),S.writeMessage(2,Y1,m);let e=m.keys;for(let J1 of e)S.writeStringField(3,J1);let b1=m.values;for(let J1 of b1)S.writeMessage(4,r1,J1)}function Y1(I,S){if(!I.feature)return;let m=I.feature;m.id!==void 0&&S.writeVarintField(1,m.id),S.writeMessage(2,B1,I),S.writeVarintField(3,m.type),S.writeMessage(4,k0,m)}function B1(I,S){for(let m in I.feature?.properties){let e=I.feature.properties[m],b1=I.keycache[m];if(e===null)continue;b1===void 0&&(I.keys.push(m),b1=I.keys.length-1,I.keycache[m]=b1),S.writeVarint(b1),typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"&&(e=JSON.stringify(e));let J1=typeof e+":"+e,A1=I.valuecache[J1];A1===void 0&&(I.values.push(e),A1=I.values.length-1,I.valuecache[J1]=A1),S.writeVarint(A1)}}function F1(I,S){return(S<<3)+(7&I)}function i1(I){return I<<1^I>>31}function k0(I,S){let m=I.loadGeometry(),e=I.type,b1=0,J1=0;for(let A1 of m){let v1=1;e===1&&(v1=A1.length),S.writeVarint(F1(1,v1));let X1=e===3?A1.length-1:A1.length;for(let l1=0;l1<X1;l1++){l1===1&&e!==1&&S.writeVarint(F1(2,X1-1));let C1=A1[l1].x-b1,m1=A1[l1].y-J1;S.writeVarint(i1(C1)),S.writeVarint(i1(m1)),b1+=C1,J1+=m1}I.type===3&&S.writeVarint(F1(7,1))}}function r1(I,S){let m=typeof I;m==="string"?S.writeStringField(1,I):m==="boolean"?S.writeBooleanField(7,I):m==="number"&&(I%1!=0?S.writeDoubleField(3,I):I<0?S.writeSVarintField(6,I):S.writeVarintField(5,I))}let $1={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:(I)=>I},q0=Math.fround||(G0=new Float32Array(1),(I)=>(G0[0]=+I,G0[0]));var G0;class T5{constructor(I){this.options=Object.assign(Object.create($1),I),this.trees=Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(I){let{log:S,minZoom:m,maxZoom:e}=this.options;S&&console.time("total time");let b1=`prepare ${I.length} points`;S&&console.time(b1),this.points=I;let J1=[];for(let v1=0;v1<I.length;v1++){let X1=I[v1];if(!X1.geometry)continue;let[l1,C1]=X1.geometry.coordinates,m1=q0(A2(l1)),w0=q0(y5(C1));J1.push(m1,w0,1/0,v1,-1,1),this.options.reduce&&J1.push(0)}let A1=this.trees[e+1]=this._createTree(J1);S&&console.timeEnd(b1);for(let v1=e;v1>=m;v1--){let X1=+Date.now();A1=this.trees[v1]=this._createTree(this._cluster(A1,v1)),S&&console.log("z%d: %d clusters in %dms",v1,A1.numItems,+Date.now()-X1)}return S&&console.timeEnd("total time"),this}getClusters(I,S){let m=((I[0]+180)%360+360)%360-180,e=Math.max(-90,Math.min(90,I[1])),b1=I[2]===180?180:((I[2]+180)%360+360)%360-180,J1=Math.max(-90,Math.min(90,I[3]));if(I[2]-I[0]>=360)m=-180,b1=180;else if(m>b1){let C1=this.getClusters([m,e,180,J1],S),m1=this.getClusters([-180,e,b1,J1],S);return C1.concat(m1)}let A1=this.trees[this._limitZoom(S)],v1=A1.range(A2(m),y5(J1),A2(b1),y5(e)),X1=A1.data,l1=[];for(let C1 of v1){let m1=this.stride*C1;l1.push(X1[m1+5]>1?i5(X1,m1,this.clusterProps):this.points[X1[m1+3]])}return l1}getChildren(I){let S=this._getOriginId(I),m=this._getOriginZoom(I),b1=this.trees[m];if(!b1)throw Error("No cluster with the specified id.");let J1=b1.data;if(S*this.stride>=J1.length)throw Error("No cluster with the specified id.");let A1=this.options.radius/(this.options.extent*Math.pow(2,m-1)),v1=b1.within(J1[S*this.stride],J1[S*this.stride+1],A1),X1=[];for(let l1 of v1){let C1=l1*this.stride;J1[C1+4]===I&&X1.push(J1[C1+5]>1?i5(J1,C1,this.clusterProps):this.points[J1[C1+3]])}if(X1.length===0)throw Error("No cluster with the specified id.");return X1}getLeaves(I,S,m){let e=[];return this._appendLeaves(e,I,S=S||10,m=m||0,0),e}getTile(I,S,m){let e=this.trees[this._limitZoom(I)],b1=Math.pow(2,I),{extent:J1,radius:A1}=this.options,v1=A1/J1,X1=(m-v1)/b1,l1=(m+1+v1)/b1,C1={features:[]};return this._addTileFeatures(e.range((S-v1)/b1,X1,(S+1+v1)/b1,l1),e.data,S,m,b1,C1),S===0&&this._addTileFeatures(e.range(1-v1/b1,X1,1,l1),e.data,b1,m,b1,C1),S===b1-1&&this._addTileFeatures(e.range(0,X1,v1/b1,l1),e.data,-1,m,b1,C1),C1.features.length?C1:null}getClusterExpansionZoom(I){let S=this._getOriginZoom(I)-1;for(;S<=this.options.maxZoom;){let m=this.getChildren(I);if(S++,m.length!==1)break;I=m[0].properties.cluster_id}return S}_appendLeaves(I,S,m,e,b1){let J1=this.getChildren(S);for(let A1 of J1){let v1=A1.properties;if(v1&&v1.cluster?b1+v1.point_count<=e?b1+=v1.point_count:b1=this._appendLeaves(I,v1.cluster_id,m,e,b1):b1<e?b1++:I.push(A1),I.length===m)break}return b1}_createTree(I){let S=new U.aI(I.length/this.stride|0,this.options.nodeSize,Float32Array);for(let m=0;m<I.length;m+=this.stride)S.add(I[m],I[m+1]);return S.finish(),S.data=I,S}_addTileFeatures(I,S,m,e,b1,J1){for(let A1 of I){let v1=A1*this.stride,X1=S[v1+5]>1,l1,C1,m1;if(X1)l1=X5(S,v1,this.clusterProps),C1=S[v1],m1=S[v1+1];else{let y0=this.points[S[v1+3]];l1=y0.properties;let[i0,N1]=y0.geometry.coordinates;C1=A2(i0),m1=y5(N1)}let w0={type:1,geometry:[[Math.round(this.options.extent*(C1*b1-m)),Math.round(this.options.extent*(m1*b1-e))]],tags:l1},M1;M1=X1||this.options.generateId?S[v1+3]:this.points[S[v1+3]].id,M1!==void 0&&(w0.id=M1),J1.features.push(w0)}}_limitZoom(I){return Math.max(this.options.minZoom,Math.min(Math.floor(+I),this.options.maxZoom+1))}_cluster(I,S){let{radius:m,extent:e,reduce:b1,minPoints:J1}=this.options,A1=m/(e*Math.pow(2,S)),v1=I.data,X1=[],l1=this.stride;for(let C1=0;C1<v1.length;C1+=l1){if(v1[C1+2]<=S)continue;v1[C1+2]=S;let m1=v1[C1],w0=v1[C1+1],M1=I.within(v1[C1],v1[C1+1],A1),y0=v1[C1+5],i0=y0;for(let N1 of M1){let v0=N1*l1;v1[v0+2]>S&&(i0+=v1[v0+5])}if(i0>y0&&i0>=J1){let N1,v0=m1*y0,M0=w0*y0,e0=-1,F5=(C1/l1<<5)+(S+1)+this.points.length;for(let m0 of M1){let D0=m0*l1;if(v1[D0+2]<=S)continue;v1[D0+2]=S;let z5=v1[D0+5];v0+=v1[D0]*z5,M0+=v1[D0+1]*z5,v1[D0+4]=F5,b1&&(N1||(N1=this._map(v1,C1,!0),e0=this.clusterProps.length,this.clusterProps.push(N1)),b1(N1,this._map(v1,D0)))}v1[C1+4]=F5,X1.push(v0/i0,M0/i0,1/0,F5,-1,i0),b1&&X1.push(e0)}else{for(let N1=0;N1<l1;N1++)X1.push(v1[C1+N1]);if(i0>1)for(let N1 of M1){let v0=N1*l1;if(!(v1[v0+2]<=S)){v1[v0+2]=S;for(let M0=0;M0<l1;M0++)X1.push(v1[v0+M0])}}}}return X1}_getOriginId(I){return I-this.points.length>>5}_getOriginZoom(I){return(I-this.points.length)%32}_map(I,S,m){if(I[S+5]>1){let J1=this.clusterProps[I[S+6]];return m?Object.assign({},J1):J1}let e=this.points[I[S+3]].properties,b1=this.options.map(e);return m&&b1===e?Object.assign({},b1):b1}}function i5(I,S,m){return{type:"Feature",id:I[S+3],properties:X5(I,S,m),geometry:{type:"Point",coordinates:[(e=I[S],360*(e-0.5)),C0(I[S+1])]}};var e}function X5(I,S,m){let e=I[S+5],b1=e>=1e4?`${Math.round(e/1000)}k`:e>=1000?Math.round(e/100)/10+"k":e,J1=I[S+6],A1=J1===-1?{}:Object.assign({},m[J1]);return Object.assign(A1,{cluster:!0,cluster_id:I[S+3],point_count:e,point_count_abbreviated:b1})}function A2(I){return I/360+0.5}function y5(I){let S=Math.sin(I*Math.PI/180),m=0.5-0.25*Math.log((1+S)/(1-S))/Math.PI;return m<0?0:m>1?1:m}function C0(I){let S=(180-360*I)*Math.PI/180;return 360*Math.atan(Math.exp(S))/Math.PI-90}function J0(I,S,m,e){let b1=e,J1=S+(m-S>>1),A1,v1=m-S,X1=I[S],l1=I[S+1],C1=I[m],m1=I[m+1];for(let w0=S+3;w0<m;w0+=3){let M1=b0(I[w0],I[w0+1],X1,l1,C1,m1);if(M1>b1)A1=w0,b1=M1;else if(M1===b1){let y0=Math.abs(w0-J1);y0<v1&&(A1=w0,v1=y0)}}b1>e&&(A1-S>3&&J0(I,S,A1,e),I[A1+2]=b1,m-A1>3&&J0(I,A1,m,e))}function b0(I,S,m,e,b1,J1){let A1=b1-m,v1=J1-e;if(A1!==0||v1!==0){let X1=((I-m)*A1+(S-e)*v1)/(A1*A1+v1*v1);X1>1?(m=b1,e=J1):X1>0&&(m+=A1*X1,e+=v1*X1)}return A1=I-m,v1=S-e,A1*A1+v1*v1}function W5(I,S,m,e){let b1={id:I==null?null:I,type:S,geometry:m,tags:e,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(S==="Point"||S==="MultiPoint"||S==="LineString")Q5(b1,m);else if(S==="Polygon")Q5(b1,m[0]);else if(S==="MultiLineString")for(let J1 of m)Q5(b1,J1);else if(S==="MultiPolygon")for(let J1 of m)Q5(b1,J1[0]);return b1}function Q5(I,S){for(let m=0;m<S.length;m+=3)I.minX=Math.min(I.minX,S[m]),I.minY=Math.min(I.minY,S[m+1]),I.maxX=Math.max(I.maxX,S[m]),I.maxY=Math.max(I.maxY,S[m+1])}function R5(I,S,m,e){if(!S.geometry)return;let b1=S.geometry.coordinates;if(b1&&b1.length===0)return;let J1=S.geometry.type,A1=Math.pow(m.tolerance/((1<<m.maxZoom)*m.extent),2),v1=[],X1=S.id;if(m.promoteId?X1=S.properties[m.promoteId]:m.generateId&&(X1=e||0),J1==="Point")s2(b1,v1);else if(J1==="MultiPoint")for(let l1 of b1)s2(l1,v1);else if(J1==="LineString")Z0(b1,v1,A1,!1);else if(J1==="MultiLineString"){if(m.lineMetrics){for(let l1 of b1)v1=[],Z0(l1,v1,A1,!1),I.push(W5(X1,"LineString",v1,S.properties));return}U0(b1,v1,A1,!1)}else if(J1==="Polygon")U0(b1,v1,A1,!0);else{if(J1!=="MultiPolygon"){if(J1==="GeometryCollection"){for(let l1 of S.geometry.geometries)R5(I,{id:X1,geometry:l1,properties:S.properties},m,e);return}throw Error("Input data is not a valid GeoJSON object.")}for(let l1 of b1){let C1=[];U0(l1,C1,A1,!0),v1.push(C1)}}I.push(W5(X1,J1,v1,S.properties))}function s2(I,S){S.push(P0(I[0]),s0(I[1]),0)}function Z0(I,S,m,e){let b1,J1,A1=0;for(let X1=0;X1<I.length;X1++){let l1=P0(I[X1][0]),C1=s0(I[X1][1]);S.push(l1,C1,0),X1>0&&(A1+=e?(b1*C1-l1*J1)/2:Math.sqrt(Math.pow(l1-b1,2)+Math.pow(C1-J1,2))),b1=l1,J1=C1}let v1=S.length-3;S[2]=1,J0(S,0,v1,m),S[v1+2]=1,S.size=Math.abs(A1),S.start=0,S.end=S.size}function U0(I,S,m,e){for(let b1=0;b1<I.length;b1++){let J1=[];Z0(I[b1],J1,m,e),S.push(J1)}}function P0(I){return I/360+0.5}function s0(I){let S=Math.sin(I*Math.PI/180),m=0.5-0.25*Math.log((1+S)/(1-S))/Math.PI;return m<0?0:m>1?1:m}function j0(I,S,m,e,b1,J1,A1,v1){if(e/=S,J1>=(m/=S)&&A1<e)return I;if(A1<m||J1>=e)return null;let X1=[];for(let l1 of I){let{geometry:C1,type:m1}=l1,w0=b1===0?l1.minX:l1.minY,M1=b1===0?l1.maxX:l1.maxY;if(w0>=m&&M1<e){X1.push(l1);continue}if(M1<m||w0>=e)continue;let y0=[];if(m1==="Point"||m1==="MultiPoint")a0(C1,y0,m,e,b1);else if(m1==="LineString")M2(C1,y0,m,e,b1,!1,v1.lineMetrics);else if(m1==="MultiLineString")d2(C1,y0,m,e,b1,!1);else if(m1==="Polygon")d2(C1,y0,m,e,b1,!0);else if(m1==="MultiPolygon")for(let i0 of C1){let N1=[];d2(i0,N1,m,e,b1,!0),N1.length&&y0.push(N1)}if(y0.length){if(v1.lineMetrics&&m1==="LineString"){for(let i0 of y0)X1.push(W5(l1.id,m1,i0,l1.tags));continue}m1!=="LineString"&&m1!=="MultiLineString"||(y0.length===1?(m1="LineString",y0=y0[0]):m1="MultiLineString"),m1!=="Point"&&m1!=="MultiPoint"||(m1=y0.length===3?"Point":"MultiPoint"),X1.push(W5(l1.id,m1,y0,l1.tags))}}return X1.length?X1:null}function a0(I,S,m,e,b1){for(let J1=0;J1<I.length;J1+=3){let A1=I[J1+b1];A1>=m&&A1<=e&&r0(S,I[J1],I[J1+1],I[J1+2])}}function M2(I,S,m,e,b1,J1,A1){let v1=h5(I),X1=b1===0?g5:i2,l1,C1,m1=I.start;for(let N1=0;N1<I.length-3;N1+=3){let v0=I[N1],M0=I[N1+1],e0=I[N1+2],F5=I[N1+3],m0=I[N1+4],D0=b1===0?v0:M0,z5=b1===0?F5:m0,L0=!1;A1&&(l1=Math.sqrt(Math.pow(v0-F5,2)+Math.pow(M0-m0,2))),D0<m?z5>m&&(C1=X1(v1,v0,M0,F5,m0,m),A1&&(v1.start=m1+l1*C1)):D0>e?z5<e&&(C1=X1(v1,v0,M0,F5,m0,e),A1&&(v1.start=m1+l1*C1)):r0(v1,v0,M0,e0),z5<m&&D0>=m&&(C1=X1(v1,v0,M0,F5,m0,m),L0=!0),z5>e&&D0<=e&&(C1=X1(v1,v0,M0,F5,m0,e),L0=!0),!J1&&L0&&(A1&&(v1.end=m1+l1*C1),S.push(v1),v1=h5(I)),A1&&(m1+=l1)}let w0=I.length-3,M1=I[w0],y0=I[w0+1],i0=b1===0?M1:y0;i0>=m&&i0<=e&&r0(v1,M1,y0,I[w0+2]),w0=v1.length-3,J1&&w0>=3&&(v1[w0]!==v1[0]||v1[w0+1]!==v1[1])&&r0(v1,v1[0],v1[1],v1[2]),v1.length&&S.push(v1)}function h5(I){let S=[];return S.size=I.size,S.start=I.start,S.end=I.end,S}function d2(I,S,m,e,b1,J1){for(let A1 of I)M2(A1,S,m,e,b1,J1,!1)}function r0(I,S,m,e){I.push(S,m,e)}function g5(I,S,m,e,b1,J1){let A1=(J1-S)/(e-S);return r0(I,J1,m+(b1-m)*A1,1),A1}function i2(I,S,m,e,b1,J1){let A1=(J1-m)/(b1-m);return r0(I,S+(e-S)*A1,J1,1),A1}function z4(I,S){let m=[];for(let e=0;e<I.length;e++){let b1=I[e],J1=b1.type,A1;if(J1==="Point"||J1==="MultiPoint"||J1==="LineString")A1=Q3(b1.geometry,S);else if(J1==="MultiLineString"||J1==="Polygon"){A1=[];for(let v1 of b1.geometry)A1.push(Q3(v1,S))}else if(J1==="MultiPolygon"){A1=[];for(let v1 of b1.geometry){let X1=[];for(let l1 of v1)X1.push(Q3(l1,S));A1.push(X1)}}m.push(W5(b1.id,J1,A1,b1.tags))}return m}function Q3(I,S){let m=[];m.size=I.size,I.start!==void 0&&(m.start=I.start,m.end=I.end);for(let e=0;e<I.length;e+=3)m.push(I[e]+S,I[e+1],I[e+2]);return m}function O2(I,S){if(I.transformed)return I;let m=1<<I.z,e=I.x,b1=I.y;for(let J1 of I.features){let{geometry:A1,type:v1}=J1;if(J1.geometry=[],v1===1)for(let X1=0;X1<A1.length;X1+=2)J1.geometry.push(x4(A1[X1],A1[X1+1],S,m,e,b1));else for(let X1=0;X1<A1.length;X1++){let l1=[];for(let C1=0;C1<A1[X1].length;C1+=2)l1.push(x4(A1[X1][C1],A1[X1][C1+1],S,m,e,b1));J1.geometry.push(l1)}}return I.transformed=!0,I}function x4(I,S,m,e,b1,J1){return[Math.round(m*(I*e-b1)),Math.round(m*(S*e-J1))]}function E5(I,S,m,e,b1){let J1=S===b1.maxZoom?0:b1.tolerance/((1<<S)*b1.extent),A1={features:[],numPoints:0,numSimplified:0,numFeatures:I.length,source:null,x:m,y:e,z:S,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(let v1 of I)T3(A1,v1,J1,b1);return A1}function T3(I,S,m,e){let{geometry:b1,type:J1}=S,A1=[];if(I.minX=Math.min(I.minX,S.minX),I.minY=Math.min(I.minY,S.minY),I.maxX=Math.max(I.maxX,S.maxX),I.maxY=Math.max(I.maxY,S.maxY),J1==="Point"||J1==="MultiPoint")for(let v1=0;v1<b1.length;v1+=3)A1.push(b1[v1],b1[v1+1]),I.numPoints++,I.numSimplified++;else if(J1==="LineString")Y3(A1,b1,I,m,!1,!1);else if(J1==="MultiLineString"||J1==="Polygon")for(let v1=0;v1<b1.length;v1++)Y3(A1,b1[v1],I,m,J1==="Polygon",v1===0);else if(J1==="MultiPolygon")for(let v1=0;v1<b1.length;v1++){let X1=b1[v1];for(let l1=0;l1<X1.length;l1++)Y3(A1,X1[l1],I,m,!0,l1===0)}if(A1.length){let v1=S.tags||null;if(J1==="LineString"&&e.lineMetrics){v1={};for(let l1 in S.tags)v1[l1]=S.tags[l1];v1.mapbox_clip_start=b1.start/b1.size,v1.mapbox_clip_end=b1.end/b1.size}let X1={geometry:A1,type:J1==="Polygon"||J1==="MultiPolygon"?3:J1==="LineString"||J1==="MultiLineString"?2:1,tags:v1};S.id!==null&&(X1.id=S.id),I.features.push(X1)}}function Y3(I,S,m,e,b1,J1){let A1=e*e;if(e>0&&S.size<(b1?A1:e))return void(m.numPoints+=S.length/3);let v1=[];for(let X1=0;X1<S.length;X1+=3)(e===0||S[X1+2]>A1)&&(m.numSimplified++,v1.push(S[X1],S[X1+1])),m.numPoints++;b1&&function(X1,l1){let C1=0;for(let m1=0,w0=X1.length,M1=w0-2;m1<w0;M1=m1,m1+=2)C1+=(X1[m1]-X1[M1])*(X1[m1+1]+X1[M1+1]);if(C1>0===l1)for(let m1=0,w0=X1.length;m1<w0/2;m1+=2){let M1=X1[m1],y0=X1[m1+1];X1[m1]=X1[w0-2-m1],X1[m1+1]=X1[w0-1-m1],X1[w0-2-m1]=M1,X1[w0-1-m1]=y0}}(v1,J1),I.push(v1)}let u5={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class t2{constructor(I,S){let m=(S=this.options=function(b1,J1){for(let A1 in J1)b1[A1]=J1[A1];return b1}(Object.create(u5),S)).debug;if(m&&console.time("preprocess data"),S.maxZoom<0||S.maxZoom>24)throw Error("maxZoom should be in the 0-24 range");if(S.promoteId&&S.generateId)throw Error("promoteId and generateId cannot be used together.");let e=function(b1,J1){let A1=[];if(b1.type==="FeatureCollection")for(let v1=0;v1<b1.features.length;v1++)R5(A1,b1.features[v1],J1,v1);else R5(A1,b1.type==="Feature"?b1:{geometry:b1},J1);return A1}(I,S);this.tiles={},this.tileCoords=[],m&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",S.indexMaxZoom,S.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),e=function(b1,J1){let A1=J1.buffer/J1.extent,v1=b1,X1=j0(b1,1,-1-A1,A1,0,-1,2,J1),l1=j0(b1,1,1-A1,2+A1,0,-1,2,J1);return(X1||l1)&&(v1=j0(b1,1,-A1,1+A1,0,-1,2,J1)||[],X1&&(v1=z4(X1,1).concat(v1)),l1&&(v1=v1.concat(z4(l1,-1)))),v1}(e,S),e.length&&this.splitTile(e,0,0,0),m&&(e.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(I,S,m,e,b1,J1,A1){let v1=[I,S,m,e],X1=this.options,l1=X1.debug;for(;v1.length;){e=v1.pop(),m=v1.pop(),S=v1.pop(),I=v1.pop();let C1=1<<S,m1=e2(S,m,e),w0=this.tiles[m1];if(!w0&&(l1>1&&console.time("creation"),w0=this.tiles[m1]=E5(I,S,m,e,X1),this.tileCoords.push({z:S,x:m,y:e}),l1)){l1>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",S,m,e,w0.numFeatures,w0.numPoints,w0.numSimplified),console.timeEnd("creation"));let z5=`z${S}`;this.stats[z5]=(this.stats[z5]||0)+1,this.total++}if(w0.source=I,b1==null){if(S===X1.indexMaxZoom||w0.numPoints<=X1.indexMaxPoints)continue}else{if(S===X1.maxZoom||S===b1)continue;if(b1!=null){let z5=b1-S;if(m!==J1>>z5||e!==A1>>z5)continue}}if(w0.source=null,I.length===0)continue;l1>1&&console.time("clipping");let M1=0.5*X1.buffer/X1.extent,y0=0.5-M1,i0=0.5+M1,N1=1+M1,v0=null,M0=null,e0=null,F5=null,m0=j0(I,C1,m-M1,m+i0,0,w0.minX,w0.maxX,X1),D0=j0(I,C1,m+y0,m+N1,0,w0.minX,w0.maxX,X1);I=null,m0&&(v0=j0(m0,C1,e-M1,e+i0,1,w0.minY,w0.maxY,X1),M0=j0(m0,C1,e+y0,e+N1,1,w0.minY,w0.maxY,X1),m0=null),D0&&(e0=j0(D0,C1,e-M1,e+i0,1,w0.minY,w0.maxY,X1),F5=j0(D0,C1,e+y0,e+N1,1,w0.minY,w0.maxY,X1),D0=null),l1>1&&console.timeEnd("clipping"),v1.push(v0||[],S+1,2*m,2*e),v1.push(M0||[],S+1,2*m,2*e+1),v1.push(e0||[],S+1,2*m+1,2*e),v1.push(F5||[],S+1,2*m+1,2*e+1)}}getTile(I,S,m){I=+I,S=+S,m=+m;let e=this.options,{extent:b1,debug:J1}=e;if(I<0||I>24)return null;let A1=1<<I,v1=e2(I,S=S+A1&A1-1,m);if(this.tiles[v1])return O2(this.tiles[v1],b1);J1>1&&console.log("drilling down to z%d-%d-%d",I,S,m);let X1,l1=I,C1=S,m1=m;for(;!X1&&l1>0;)l1--,C1>>=1,m1>>=1,X1=this.tiles[e2(l1,C1,m1)];return X1&&X1.source?(J1>1&&(console.log("found parent tile z%d-%d-%d",l1,C1,m1),console.time("drilling down")),this.splitTile(X1.source,l1,C1,m1,I,S,m),J1>1&&console.timeEnd("drilling down"),this.tiles[v1]?O2(this.tiles[v1],b1):null):null}}function e2(I,S,m){return 32*((1<<I)*m+S)+I}class c4 extends w1{constructor(I,S,m,e=$3){super(I,S,m),this._dataUpdateable=new Map,this._createGeoJSONIndex=e}loadVectorTile(I,S){return U._(this,void 0,void 0,function*(){let m=I.tileID.canonical;if(!this._geoJSONIndex)throw Error("Unable to parse the data into a cluster or geojson");let e=this._geoJSONIndex.getTile(m.z,m.x,m.y);if(!e)return null;let b1=new s1(e.features,{version:2,extent:U.$}),J1=function(A1){let v1=new U.cM;return function(X1,l1){for(let C1 in X1.layers)l1.writeMessage(3,f1,X1.layers[C1])}(A1,v1),v1.finish()}(b1);return J1.byteOffset===0&&J1.byteLength===J1.buffer.byteLength||(J1=new Uint8Array(J1)),{vectorTile:b1,rawData:J1.buffer}})}loadData(I){return U._(this,void 0,void 0,function*(){var S;(S=this._pendingRequest)===null||S===void 0||S.abort();let m=!!(I&&I.request&&I.request.collectResourceTiming)&&new U.cN(I.request);this._pendingRequest=new AbortController;try{(!this._pendingData||I.request||I.data||I.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(I,this._pendingRequest));let e=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(e,I),this.loaded={};let b1={data:e};if(m){let J1=m.finish();J1&&(b1.resourceTiming={},b1.resourceTiming[I.source]=JSON.parse(JSON.stringify(J1)))}return b1}catch(e){if(delete this._pendingRequest,U.cy(e))return{abandoned:!0};throw e}})}getData(){return U._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(I){let S=this.loaded;return S&&S[I.uid]?super.reloadTile(I):this.loadTile(I)}loadAndProcessGeoJSON(I,S){return U._(this,void 0,void 0,function*(){let m=yield this.loadGeoJSON(I,S);if(delete this._pendingRequest,typeof m!="object")throw Error(`Input data given to '${I.source}' is not a valid GeoJSON object.`);if(R1(m,!0),I.filter){let e=U.cT(I.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(e.result==="error")throw Error(e.value.map((J1)=>`${J1.key}: ${J1.message}`).join(", "));m={type:"FeatureCollection",features:m.features.filter((J1)=>e.value.evaluate({zoom:0},J1))}}return m})}loadGeoJSON(I,S){return U._(this,void 0,void 0,function*(){let{promoteId:m}=I;if(I.request){let e=yield U.j(I.request,S);return this._dataUpdateable=U.cV(e.data,m)?U.cU(e.data,m):void 0,e.data}if(typeof I.data=="string")try{let e=JSON.parse(I.data);return this._dataUpdateable=U.cV(e,m)?U.cU(e,m):void 0,e}catch(e){throw Error(`Input data given to '${I.source}' is not a valid GeoJSON object.`)}if(!I.dataDiff)throw Error(`Input data given to '${I.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw Error(`Cannot update existing geojson data in ${I.source}`);return U.cW(this._dataUpdateable,I.dataDiff,m),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(I){return U._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(I){return this._geoJSONIndex.getClusterExpansionZoom(I.clusterId)}getClusterChildren(I){return this._geoJSONIndex.getChildren(I.clusterId)}getClusterLeaves(I){return this._geoJSONIndex.getLeaves(I.clusterId,I.limit,I.offset)}}function $3(I,S){return S.cluster?new T5(function({superclusterOptions:m,clusterProperties:e}){if(!e||!m)return m;let b1={},J1={},A1={accumulated:null,zoom:0},v1={properties:null},X1=Object.keys(e);for(let l1 of X1){let[C1,m1]=e[l1],w0=U.cT(m1),M1=U.cT(typeof C1=="string"?[C1,["accumulated"],["get",l1]]:C1);b1[l1]=w0.value,J1[l1]=M1.value}return m.map=(l1)=>{v1.properties=l1;let C1={};for(let m1 of X1)C1[m1]=b1[m1].evaluate(A1,v1);return C1},m.reduce=(l1,C1)=>{v1.properties=C1;for(let m1 of X1)A1.accumulated=l1[m1],l1[m1]=J1[m1].evaluate(A1,v1)},m}(S)).load(I.features):function(m,e){return new t2(m,e)}(I,S.geojsonVtOptions)}class V3{constructor(I){this.self=I,this.actor=new U.J(I),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(S,m)=>{if(this.externalWorkerSourceTypes[S])throw Error(`Worker source with name "${S}" already registered.`);this.externalWorkerSourceTypes[S]=m},this.self.addProtocol=U.cA,this.self.removeProtocol=U.cB,this.self.registerRTLTextPlugin=(S)=>{U.cX.setMethods(S)},this.actor.registerMessageHandler("LDT",(S,m)=>this._getDEMWorkerSource(S,m.source).loadTile(m)),this.actor.registerMessageHandler("RDT",(S,m)=>U._(this,void 0,void 0,function*(){this._getDEMWorkerSource(S,m.source).removeTile(m)})),this.actor.registerMessageHandler("GCEZ",(S,m)=>U._(this,void 0,void 0,function*(){return this._getWorkerSource(S,m.type,m.source).getClusterExpansionZoom(m)})),this.actor.registerMessageHandler("GCC",(S,m)=>U._(this,void 0,void 0,function*(){return this._getWorkerSource(S,m.type,m.source).getClusterChildren(m)})),this.actor.registerMessageHandler("GCL",(S,m)=>U._(this,void 0,void 0,function*(){return this._getWorkerSource(S,m.type,m.source).getClusterLeaves(m)})),this.actor.registerMessageHandler("LD",(S,m)=>this._getWorkerSource(S,m.type,m.source).loadData(m)),this.actor.registerMessageHandler("GD",(S,m)=>this._getWorkerSource(S,m.type,m.source).getData()),this.actor.registerMessageHandler("LT",(S,m)=>this._getWorkerSource(S,m.type,m.source).loadTile(m)),this.actor.registerMessageHandler("RT",(S,m)=>this._getWorkerSource(S,m.type,m.source).reloadTile(m)),this.actor.registerMessageHandler("AT",(S,m)=>this._getWorkerSource(S,m.type,m.source).abortTile(m)),this.actor.registerMessageHandler("RMT",(S,m)=>this._getWorkerSource(S,m.type,m.source).removeTile(m)),this.actor.registerMessageHandler("RS",(S,m)=>U._(this,void 0,void 0,function*(){if(!this.workerSources[S]||!this.workerSources[S][m.type]||!this.workerSources[S][m.type][m.source])return;let e=this.workerSources[S][m.type][m.source];delete this.workerSources[S][m.type][m.source],e.removeSource!==void 0&&e.removeSource(m)})),this.actor.registerMessageHandler("RM",(S)=>U._(this,void 0,void 0,function*(){delete this.layerIndexes[S],delete this.availableImages[S],delete this.workerSources[S],delete this.demWorkerSources[S],this.globalStates.delete(S)})),this.actor.registerMessageHandler("SR",(S,m)=>U._(this,void 0,void 0,function*(){this.referrer=m})),this.actor.registerMessageHandler("SRPS",(S,m)=>this._syncRTLPluginState(S,m)),this.actor.registerMessageHandler("IS",(S,m)=>U._(this,void 0,void 0,function*(){this.self.importScripts(m)})),this.actor.registerMessageHandler("SI",(S,m)=>this._setImages(S,m)),this.actor.registerMessageHandler("UL",(S,m)=>U._(this,void 0,void 0,function*(){this._getLayerIndex(S).update(m.layers,m.removedIds,this._getGlobalState(S))})),this.actor.registerMessageHandler("UGS",(S,m)=>U._(this,void 0,void 0,function*(){let e=this._getGlobalState(S);for(let b1 in m)e[b1]=m[b1]})),this.actor.registerMessageHandler("SL",(S,m)=>U._(this,void 0,void 0,function*(){this._getLayerIndex(S).replace(m,this._getGlobalState(S))}))}_getGlobalState(I){let S=this.globalStates.get(I);return S||(S={},this.globalStates.set(I,S)),S}_setImages(I,S){return U._(this,void 0,void 0,function*(){this.availableImages[I]=S;for(let m in this.workerSources[I]){let e=this.workerSources[I][m];for(let b1 in e)e[b1].availableImages=S}})}_syncRTLPluginState(I,S){return U._(this,void 0,void 0,function*(){return yield U.cX.syncState(S,this.self.importScripts)})}_getAvailableImages(I){let S=this.availableImages[I];return S||(S=[]),S}_getLayerIndex(I){let S=this.layerIndexes[I];return S||(S=this.layerIndexes[I]=new Z),S}_getWorkerSource(I,S,m){if(this.workerSources[I]||(this.workerSources[I]={}),this.workerSources[I][S]||(this.workerSources[I][S]={}),!this.workerSources[I][S][m]){let e={sendAsync:(b1,J1)=>(b1.targetMapId=I,this.actor.sendAsync(b1,J1))};switch(S){case"vector":this.workerSources[I][S][m]=new w1(e,this._getLayerIndex(I),this._getAvailableImages(I));break;case"geojson":this.workerSources[I][S][m]=new c4(e,this._getLayerIndex(I),this._getAvailableImages(I));break;default:this.workerSources[I][S][m]=new this.externalWorkerSourceTypes[S](e,this._getLayerIndex(I),this._getAvailableImages(I))}}return this.workerSources[I][S][m]}_getDEMWorkerSource(I,S){return this.demWorkerSources[I]||(this.demWorkerSources[I]={}),this.demWorkerSources[I][S]||(this.demWorkerSources[I][S]=new H1),this.demWorkerSources[I][S]}}return U.i(self)&&(self.worker=new V3(self)),V3}),Y("index",["exports","./shared"],function(U,Z){var l="5.10.0";function N(){var b=new Z.A(4);return Z.A!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b}let P,w1,H1={frame(b,z,k){let J=requestAnimationFrame((X)=>{B(),z(X)}),{unsubscribe:B}=Z.s(b.signal,"abort",()=>{B(),cancelAnimationFrame(J),k(Z.c())},!1)},frameAsync(b){return new Promise((z,k)=>{this.frame(b,z,k)})},getImageData(b,z=0){return this.getImageCanvasContext(b).getImageData(-z,-z,b.width+2*z,b.height+2*z)},getImageCanvasContext(b){let z=window.document.createElement("canvas"),k=z.getContext("2d",{willReadFrequently:!0});if(!k)throw Error("failed to create canvas 2d context");return z.width=b.width,z.height=b.height,k.drawImage(b,0,0,b.width,b.height),k},resolveURL:(b)=>(P||(P=document.createElement("a")),P.href=b,P.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(w1==null&&(w1=matchMedia("(prefers-reduced-motion: reduce)")),w1.matches)}},r=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(b){this._frozenAt=b}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function z1(){return r.getCurrentTime()}class u{static testProp(b){if(!u.docStyle)return b[0];for(let z=0;z<b.length;z++)if(b[z]in u.docStyle)return b[z];return b[0]}static create(b,z,k){let J=window.document.createElement(b);return z!==void 0&&(J.className=z),k&&k.appendChild(J),J}static createNS(b,z){return window.document.createElementNS(b,z)}static disableDrag(){u.docStyle&&u.selectProp&&(u.userSelect=u.docStyle[u.selectProp],u.docStyle[u.selectProp]="none")}static enableDrag(){u.docStyle&&u.selectProp&&(u.docStyle[u.selectProp]=u.userSelect)}static setTransform(b,z){b.style[u.transformProp]=z}static addEventListener(b,z,k,J={}){b.addEventListener(z,k,"passive"in J?J:J.capture)}static removeEventListener(b,z,k,J={}){b.removeEventListener(z,k,"passive"in J?J:J.capture)}static suppressClickInternal(b){b.preventDefault(),b.stopPropagation(),window.removeEventListener("click",u.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",u.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",u.suppressClickInternal,!0)},0)}static getScale(b){let z=b.getBoundingClientRect();return{x:z.width/b.offsetWidth||1,y:z.height/b.offsetHeight||1,boundingClientRect:z}}static getPoint(b,z,k){let J=z.boundingClientRect;return new Z.P((k.clientX-J.left)/z.x-b.clientLeft,(k.clientY-J.top)/z.y-b.clientTop)}static mousePos(b,z){let k=u.getScale(b);return u.getPoint(b,k,z)}static touchPos(b,z){let k=[],J=u.getScale(b);for(let B=0;B<z.length;B++)k.push(u.getPoint(b,J,z[B]));return k}static mouseButton(b){return b.button}static remove(b){b.parentNode&&b.parentNode.removeChild(b)}static sanitize(b){let z=new DOMParser().parseFromString(b,"text/html").body||document.createElement("body"),k=z.querySelectorAll("script");for(let J of k)J.remove();return u.clean(z),z.innerHTML}static isPossiblyDangerous(b,z){let k=z.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(b)||!k.includes("javascript:")&&!k.includes("data:"))||!!b.startsWith("on")||void 0}static clean(b){let z=b.children;for(let k of z)u.removeAttributes(k),u.clean(k)}static removeAttributes(b){for(let{name:z,value:k}of b.attributes)u.isPossiblyDangerous(z,k)&&b.removeAttribute(z)}}u.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,u.selectProp=u.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),u.transformProp=u.testProp(["transform","WebkitTransform"]);let R1={supported:!1,testSupport:function(b){!f1&&s1&&(Y1?B1(b):P1=b)}},P1,s1,f1=!1,Y1=!1;function B1(b){let z=b.createTexture();b.bindTexture(b.TEXTURE_2D,z);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,s1),b.isContextLost())return;R1.supported=!0}catch(k){}b.deleteTexture(z),f1=!0}var F1;typeof document<"u"&&(s1=document.createElement("img"),s1.onload=()=>{P1&&B1(P1),P1=null,Y1=!0},s1.onerror=()=>{f1=!0,P1=null},s1.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(b){let z,k,J,B;b.resetRequestQueue=()=>{z=[],k=0,J=0,B={}},b.addThrottleControl=(F)=>{let C=J++;return B[C]=F,C},b.removeThrottleControl=(F)=>{delete B[F],V()},b.getImage=(F,C,O=!0)=>new Promise((d,y)=>{R1.supported&&(F.headers||(F.headers={}),F.headers.accept="image/webp,*/*"),Z.e(F,{type:"image"}),z.push({abortController:C,requestParameters:F,supportImageRefresh:O,state:"queued",onError:(T)=>{y(T)},onSuccess:(T)=>{d(T)}}),V()});let X=(F)=>Z._(this,void 0,void 0,function*(){F.state="running";let{requestParameters:C,supportImageRefresh:O,onError:d,onSuccess:y,abortController:T}=F,E=O===!1&&!Z.i(self)&&!Z.g(C.url)&&(!C.headers||Object.keys(C.headers).reduce((c,Z1)=>c&&Z1==="accept",!0));k++;let p=E?L(C,T):Z.m(C,T);try{let c=yield p;delete F.abortController,F.state="completed",c.data instanceof HTMLImageElement||Z.b(c.data)?y(c):c.data&&y({data:yield(s=c.data,typeof createImageBitmap=="function"?Z.f(s):Z.h(s)),cacheControl:c.cacheControl,expires:c.expires})}catch(c){delete F.abortController,d(c)}finally{k--,V()}var s}),V=()=>{let F=(()=>{for(let C of Object.keys(B))if(B[C]())return!0;return!1})()?Z.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:Z.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let C=k;C<F&&z.length>0;C++){let O=z.shift();O.abortController.signal.aborted?C--:X(O)}},L=(F,C)=>new Promise((O,d)=>{let y=new Image,T=F.url,E=F.credentials;E&&E==="include"?y.crossOrigin="use-credentials":(E&&E==="same-origin"||!Z.d(T))&&(y.crossOrigin="anonymous"),C.signal.addEventListener("abort",()=>{y.src="",d(Z.c())}),y.fetchPriority="high",y.onload=()=>{y.onerror=y.onload=null,O({data:y})},y.onerror=()=>{y.onerror=y.onload=null,C.signal.aborted||d(Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},y.src=T})}(F1||(F1={})),F1.resetRequestQueue();class i1{constructor(b){this._transformRequestFn=b!=null?b:null}transformRequest(b,z){return this._transformRequestFn&&this._transformRequestFn(b,z)||{url:b}}setTransformRequest(b){this._transformRequestFn=b}}function k0(b){let z=[];if(typeof b=="string")z.push({id:"default",url:b});else if(b&&b.length>0){let k=[];for(let{id:J,url:B}of b){let X=`${J}${B}`;k.indexOf(X)===-1&&(k.push(X),z.push({id:J,url:B}))}}return z}function r1(b,z,k){try{let J=new URL(b);return J.pathname+=`${z}${k}`,J.toString()}catch(J){throw Error(`Invalid sprite URL "${b}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function $1(b){let{userImage:z}=b;return!!(z&&z.render&&z.render())&&(b.data.replace(new Uint8Array(z.data.buffer)),!0)}class q0 extends Z.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new Z.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(b){if(this.loaded!==b&&(this.loaded=b,b)){for(let{ids:z,promiseResolve:k}of this.requestors)k(this._getImagesForIds(z));this.requestors=[]}}getImage(b){let z=this.images[b];if(z&&!z.data&&z.spriteData){let k=z.spriteData;z.data=new Z.R({width:k.width,height:k.height},k.context.getImageData(k.x,k.y,k.width,k.height).data),z.spriteData=null}return z}addImage(b,z){if(this.images[b])throw Error(`Image id ${b} already exist, use updateImage instead`);this._validate(b,z)&&(this.images[b]=z)}_validate(b,z){let k=!0,J=z.data||z.spriteData;return this._validateStretch(z.stretchX,J&&J.width)||(this.fire(new Z.k(Error(`Image "${b}" has invalid "stretchX" value`))),k=!1),this._validateStretch(z.stretchY,J&&J.height)||(this.fire(new Z.k(Error(`Image "${b}" has invalid "stretchY" value`))),k=!1),this._validateContent(z.content,z)||(this.fire(new Z.k(Error(`Image "${b}" has invalid "content" value`))),k=!1),k}_validateStretch(b,z){if(!b)return!0;let k=0;for(let J of b){if(J[0]<k||J[1]<J[0]||z<J[1])return!1;k=J[1]}return!0}_validateContent(b,z){if(!b)return!0;if(b.length!==4)return!1;let k=z.spriteData,J=k&&k.width||z.data.width,B=k&&k.height||z.data.height;return!(b[0]<0||J<b[0]||b[1]<0||B<b[1]||b[2]<0||J<b[2]||b[3]<0||B<b[3]||b[2]<b[0]||b[3]<b[1])}updateImage(b,z,k=!0){let J=this.getImage(b);if(k&&(J.data.width!==z.data.width||J.data.height!==z.data.height))throw Error(`size mismatch between old image (${J.data.width}x${J.data.height}) and new image (${z.data.width}x${z.data.height}).`);z.version=J.version+1,this.images[b]=z,this.updatedImages[b]=!0}removeImage(b){let z=this.images[b];delete this.images[b],delete this.patterns[b],z.userImage&&z.userImage.onRemove&&z.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(b){return new Promise((z,k)=>{let J=!0;if(!this.isLoaded())for(let B of b)this.images[B]||(J=!1);this.isLoaded()||J?z(this._getImagesForIds(b)):this.requestors.push({ids:b,promiseResolve:z})})}_getImagesForIds(b){let z={};for(let k of b){let J=this.getImage(k);J||(this.fire(new Z.l("styleimagemissing",{id:k})),J=this.getImage(k)),J?z[k]={data:J.data.clone(),pixelRatio:J.pixelRatio,sdf:J.sdf,version:J.version,stretchX:J.stretchX,stretchY:J.stretchY,content:J.content,textFitWidth:J.textFitWidth,textFitHeight:J.textFitHeight,hasRenderCallback:Boolean(J.userImage&&J.userImage.render)}:Z.w(`Image "${k}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return z}getPixelSize(){let{width:b,height:z}=this.atlasImage;return{width:b,height:z}}getPattern(b){let z=this.patterns[b],k=this.getImage(b);if(!k)return null;if(z&&z.position.version===k.version)return z.position;if(z)z.position.version=k.version;else{let J={w:k.data.width+2,h:k.data.height+2,x:0,y:0},B=new Z.I(J,k);this.patterns[b]={bin:J,position:B}}return this._updatePatternAtlas(),this.patterns[b].position}bind(b){let z=b.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Z.T(b,this.atlasImage,z.RGBA),this.atlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE)}_updatePatternAtlas(){let b=[];for(let B in this.patterns)b.push(this.patterns[B].bin);let{w:z,h:k}=Z.p(b),J=this.atlasImage;J.resize({width:z||1,height:k||1});for(let B in this.patterns){let{bin:X}=this.patterns[B],V=X.x+1,L=X.y+1,F=this.getImage(B).data,C=F.width,O=F.height;Z.R.copy(F,J,{x:0,y:0},{x:V,y:L},{width:C,height:O}),Z.R.copy(F,J,{x:0,y:O-1},{x:V,y:L-1},{width:C,height:1}),Z.R.copy(F,J,{x:0,y:0},{x:V,y:L+O},{width:C,height:1}),Z.R.copy(F,J,{x:C-1,y:0},{x:V-1,y:L},{width:1,height:O}),Z.R.copy(F,J,{x:0,y:0},{x:V+C,y:L},{width:1,height:O})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(b){for(let z of b){if(this.callbackDispatchedThisFrame[z])continue;this.callbackDispatchedThisFrame[z]=!0;let k=this.getImage(z);k||Z.w(`Image with ID: "${z}" was not found`),$1(k)&&this.updateImage(z,k)}}}let G0=100000000000000000000;function T5(b,z,k,J,B,X,V,L,F){for(let C=z;C<z+J;C++)i5(b,k*X+C,X,B,V,L,F);for(let C=k;C<k+B;C++)i5(b,C*X+z,1,J,V,L,F)}function i5(b,z,k,J,B,X,V){X[0]=0,V[0]=-G0,V[1]=G0,B[0]=b[z];for(let L=1,F=0,C=0;L<J;L++){B[L]=b[z+L*k];let O=L*L;do{let d=X[F];C=(B[L]-B[d]+O-d*d)/(L-d)/2}while(C<=V[F]&&--F>-1);F++,X[F]=L,V[F]=C,V[F+1]=G0}for(let L=0,F=0;L<J;L++){for(;V[F+1]<L;)F++;let C=X[F],O=L-C;b[z+L*k]=B[C]+O*O}}class X5{constructor(b,z,k){this.requestManager=b,this.localIdeographFontFamily=z,this.entries={},this.lang=k}setURL(b){this.url=b}getGlyphs(b){return Z._(this,void 0,void 0,function*(){let z=[];for(let B in b)for(let X of b[B])z.push(this._getAndCacheGlyphsPromise(B,X));let k=yield Promise.all(z),J={};for(let{stack:B,id:X,glyph:V}of k)J[B]||(J[B]={}),J[B][X]=V&&{id:V.id,bitmap:V.bitmap.clone(),metrics:V.metrics};return J})}_getAndCacheGlyphsPromise(b,z){return Z._(this,void 0,void 0,function*(){let k=this.entries[b];k||(k=this.entries[b]={glyphs:{},requests:{},ranges:{}});let J=k.glyphs[z];if(J!==void 0)return{stack:b,id:z,glyph:J};if(J=this._tinySDF(k,b,z),J)return k.glyphs[z]=J,{stack:b,id:z,glyph:J};let B=Math.floor(z/256);if(256*B>65535)throw Error("glyphs > 65535 not supported");if(k.ranges[B])return{stack:b,id:z,glyph:J};if(!this.url)throw Error("glyphsUrl is not set");if(!k.requests[B]){let V=X5.loadGlyphRange(b,B,this.url,this.requestManager);k.requests[B]=V}let X=yield k.requests[B];for(let V in X)this._doesCharSupportLocalGlyph(+V)||(k.glyphs[+V]=X[+V]);return k.ranges[B]=!0,{stack:b,id:z,glyph:X[z]||null}})}_doesCharSupportLocalGlyph(b){return!!this.localIdeographFontFamily&&(/\p{Ideo}|\p{sc=Hang}|\p{sc=Hira}|\p{sc=Kana}/u.test(String.fromCodePoint(b))||Z.u["CJK Unified Ideographs"](b)||Z.u["Hangul Syllables"](b)||Z.u.Hiragana(b)||Z.u.Katakana(b)||Z.u["CJK Symbols and Punctuation"](b)||Z.u["Halfwidth and Fullwidth Forms"](b))}_tinySDF(b,z,k){let J=this.localIdeographFontFamily;if(!J)return;if(!this._doesCharSupportLocalGlyph(k))return;let B=b.tinySDF;if(!B){let V="400";/bold/i.test(z)?V="900":/medium/i.test(z)?V="500":/light/i.test(z)&&(V="200"),B=b.tinySDF=new X5.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:0.25,lang:this.lang,fontFamily:J,fontWeight:V})}let X=B.draw(String.fromCharCode(k));return{id:k,bitmap:new Z.q({width:X.width||60,height:X.height||60},X.data),metrics:{width:X.glyphWidth/2||24,height:X.glyphHeight/2||24,left:X.glyphLeft/2+0.5||0,top:X.glyphTop/2-27.5||-8,advance:X.glyphAdvance/2||24,isDoubleResolution:!0}}}}X5.loadGlyphRange=function(b,z,k,J){return Z._(this,void 0,void 0,function*(){let B=256*z,X=B+255,V=J.transformRequest(k.replace("{fontstack}",b).replace("{range}",`${B}-${X}`),"Glyphs"),L=yield Z.n(V,new AbortController);if(!L||!L.data)throw Error(`Could not load glyph range. range: ${z}, ${B}-${X}`);let F={};for(let C of Z.o(L.data))F[C.id]=C;return F})},X5.TinySDF=class{constructor({fontSize:b=24,buffer:z=3,radius:k=8,cutoff:J=0.25,fontFamily:B="sans-serif",fontWeight:X="normal",fontStyle:V="normal",lang:L=null}={}){this.buffer=z,this.cutoff=J,this.radius=k,this.lang=L;let F=this.size=b+4*z,C=this._createCanvas(F),O=this.ctx=C.getContext("2d",{willReadFrequently:!0});O.font=`${V} ${X} ${b}px ${B}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(F*F),this.gridInner=new Float64Array(F*F),this.f=new Float64Array(F),this.z=new Float64Array(F+1),this.v=new Uint16Array(F)}_createCanvas(b){let z=document.createElement("canvas");return z.width=z.height=b,z}draw(b){let{width:z,actualBoundingBoxAscent:k,actualBoundingBoxDescent:J,actualBoundingBoxLeft:B,actualBoundingBoxRight:X}=this.ctx.measureText(b),V=Math.ceil(k),L=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(X-B))),F=Math.min(this.size-this.buffer,V+Math.ceil(J)),C=L+2*this.buffer,O=F+2*this.buffer,d=Math.max(C*O,0),y=new Uint8ClampedArray(d),T={data:y,width:C,height:O,glyphWidth:L,glyphHeight:F,glyphTop:V,glyphLeft:0,glyphAdvance:z};if(L===0||F===0)return T;let{ctx:E,buffer:p,gridInner:s,gridOuter:c}=this;this.lang&&(E.lang=this.lang),E.clearRect(p,p,L,F),E.fillText(b,p,p+V);let Z1=E.getImageData(p,p,L,F);c.fill(G0,0,d),s.fill(0,0,d);for(let a=0;a<F;a++)for(let x1=0;x1<L;x1++){let i=Z1.data[4*(a*L+x1)+3]/255;if(i===0)continue;let n=(a+p)*C+x1+p;if(i===1)c[n]=0,s[n]=G0;else{let q1=0.5-i;c[n]=q1>0?q1*q1:0,s[n]=q1<0?q1*q1:0}}T5(c,0,0,C,O,C,this.f,this.v,this.z),T5(s,p,p,L,F,C,this.f,this.v,this.z);for(let a=0;a<d;a++){let x1=Math.sqrt(c[a])-Math.sqrt(s[a]);y[a]=Math.round(255-255*(x1/this.radius+this.cutoff))}return T}};class A2{constructor(){this.specification=Z.v.light.position}possiblyEvaluate(b,z){return Z.B(b.expression.evaluate(z))}interpolate(b,z,k){return{x:Z.C.number(b.x,z.x,k),y:Z.C.number(b.y,z.y,k),z:Z.C.number(b.z,z.z,k)}}}let y5;class C0 extends Z.E{constructor(b){super(),y5=y5||new Z.r({anchor:new Z.D(Z.v.light.anchor),position:new A2,color:new Z.D(Z.v.light.color),intensity:new Z.D(Z.v.light.intensity)}),this._transitionable=new Z.t(y5,void 0),this.setLight(b),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(b,z={}){if(!this._validate(Z.x,b,z))for(let k in b){let J=b[k];k.endsWith("-transition")?this._transitionable.setTransition(k.slice(0,-11),J):this._transitionable.setValue(k,J)}}updateTransitions(b){this._transitioning=this._transitionable.transitioned(b,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(b){this.properties=this._transitioning.possiblyEvaluate(b)}_validate(b,z,k){return(!k||k.validate!==!1)&&Z.y(this,b.call(Z.z,{value:z,style:{glyphs:!0,sprite:!0},styleSpec:Z.v}))}}let J0=new Z.r({"sky-color":new Z.D(Z.v.sky["sky-color"]),"horizon-color":new Z.D(Z.v.sky["horizon-color"]),"fog-color":new Z.D(Z.v.sky["fog-color"]),"fog-ground-blend":new Z.D(Z.v.sky["fog-ground-blend"]),"horizon-fog-blend":new Z.D(Z.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new Z.D(Z.v.sky["sky-horizon-blend"]),"atmosphere-blend":new Z.D(Z.v.sky["atmosphere-blend"])});class b0 extends Z.E{constructor(b){super(),this._transitionable=new Z.t(J0,void 0),this.setSky(b),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new Z.F(0))}setSky(b,z={}){if(!this._validate(Z.G,b,z)){b||(b={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(let k in b){let J=b[k];k.endsWith("-transition")?this._transitionable.setTransition(k.slice(0,-11),J):this._transitionable.setValue(k,J)}}}getSky(){return this._transitionable.serialize()}updateTransitions(b){this._transitioning=this._transitionable.transitioned(b,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(b){this.properties=this._transitioning.possiblyEvaluate(b)}_validate(b,z,k={}){return(k==null?void 0:k.validate)!==!1&&Z.y(this,b.call(Z.z,Z.e({value:z,style:{glyphs:!0,sprite:!0},styleSpec:Z.v})))}calculateFogBlendOpacity(b){return b<60?0:b<70?(b-60)/10:1}}class W5{constructor(b,z){this.width=b,this.height=z,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(b,z){let k=b.join(",")+String(z);return this.dashEntry[k]||(this.dashEntry[k]=this.addDash(b,z)),this.dashEntry[k]}getDashRanges(b,z,k){let J=[],B=b.length%2==1?-b[b.length-1]*k:0,X=b[0]*k,V=!0;J.push({left:B,right:X,isDash:V,zeroLength:b[0]===0});let L=b[0];for(let F=1;F<b.length;F++){V=!V;let C=b[F];B=L*k,L+=C,X=L*k,J.push({left:B,right:X,isDash:V,zeroLength:C===0})}return J}addRoundDash(b,z,k){let J=z/2;for(let B=-k;B<=k;B++){let X=this.width*(this.nextRow+k+B),V=0,L=b[V];for(let F=0;F<this.width;F++){F/L.right>1&&(L=b[++V]);let C=Math.abs(F-L.left),O=Math.abs(F-L.right),d=Math.min(C,O),y,T=B/k*(J+1);if(L.isDash){let E=J-Math.abs(T);y=Math.sqrt(d*d+E*E)}else y=J-Math.sqrt(d*d+T*T);this.data[X+F]=Math.max(0,Math.min(255,y+128))}}}addRegularDash(b){for(let V=b.length-1;V>=0;--V){let L=b[V],F=b[V+1];L.zeroLength?b.splice(V,1):F&&F.isDash===L.isDash&&(F.left=L.left,b.splice(V,1))}let z=b[0],k=b[b.length-1];z.isDash===k.isDash&&(z.left=k.left-this.width,k.right=z.right+this.width);let J=this.width*this.nextRow,B=0,X=b[B];for(let V=0;V<this.width;V++){V/X.right>1&&(X=b[++B]);let L=Math.abs(V-X.left),F=Math.abs(V-X.right),C=Math.min(L,F);this.data[J+V]=Math.max(0,Math.min(255,(X.isDash?C:-C)+128))}}addDash(b,z){let k=z?7:0,J=2*k+1;if(this.nextRow+J>this.height)return Z.w("LineAtlas out of space"),null;let B=0;for(let V=0;V<b.length;V++)B+=b[V];if(B!==0){let V=this.width/B,L=this.getDashRanges(b,this.width,V);z?this.addRoundDash(L,V,k):this.addRegularDash(L)}let X={y:this.nextRow+k,height:2*k,width:B};return this.nextRow+=J,this.dirty=!0,X}bind(b){let z=b.gl;this.texture?(z.bindTexture(z.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,z.texSubImage2D(z.TEXTURE_2D,0,0,0,this.width,this.height,z.ALPHA,z.UNSIGNED_BYTE,this.data))):(this.texture=z.createTexture(),z.bindTexture(z.TEXTURE_2D,this.texture),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_WRAP_S,z.REPEAT),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_WRAP_T,z.REPEAT),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_MIN_FILTER,z.LINEAR),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_MAG_FILTER,z.LINEAR),z.texImage2D(z.TEXTURE_2D,0,z.ALPHA,this.width,this.height,0,z.ALPHA,z.UNSIGNED_BYTE,this.data))}}let Q5="maplibre_preloaded_worker_pool";class R5{constructor(){this.active={}}acquire(b){if(!this.workers)for(this.workers=[];this.workers.length<R5.workerCount;)this.workers.push(new Worker(Z.a.WORKER_URL));return this.active[b]=!0,this.workers.slice()}release(b){delete this.active[b],this.numActive()===0&&(this.workers.forEach((z)=>{z.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Q5]}numActive(){return Object.keys(this.active).length}}let s2=Math.floor(H1.hardwareConcurrency/2),Z0,U0;function P0(){return Z0||(Z0=new R5),Z0}R5.workerCount=Z.H(globalThis)?Math.max(Math.min(s2,3),1):1;class s0{constructor(b,z){this.workerPool=b,this.actors=[],this.currentActor=0,this.id=z;let k=this.workerPool.acquire(z);for(let J=0;J<k.length;J++){let B=new Z.J(k[J],z);B.name=`Worker ${J}`,this.actors.push(B)}if(!this.actors.length)throw Error("No actors found")}broadcast(b,z){let k=[];for(let J of this.actors)k.push(J.sendAsync({type:b,data:z}));return Promise.all(k)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(b=!0){this.actors.forEach((z)=>{z.remove()}),this.actors=[],b&&this.workerPool.release(this.id)}registerMessageHandler(b,z){for(let k of this.actors)k.registerMessageHandler(b,z)}}function j0(){return U0||(U0=new s0(P0(),Z.K),U0.registerMessageHandler("GR",(b,z,k)=>Z.m(z,k))),U0}function a0(b,z){let k=Z.L();return Z.M(k,k,[1,1,0]),Z.N(k,k,[0.5*b.width,0.5*b.height,1]),b.calculatePosMatrix?Z.O(k,k,b.calculatePosMatrix(z.toUnwrapped())):k}function M2(b,z,k,J,B,X,V){var L;let F=function(y,T,E){if(y)for(let p of y){let s=T[p];if(s&&s.source===E&&s.type==="fill-extrusion")return!0}else for(let p in T){let s=T[p];if(s.source===E&&s.type==="fill-extrusion")return!0}return!1}((L=B==null?void 0:B.layers)!==null&&L!==void 0?L:null,z,b.id),C=X.maxPitchScaleFactor(),O=b.tilesIn(J,C,F);O.sort(h5);let d=[];for(let y of O)d.push({wrappedTileID:y.tileID.wrapped().key,queryResults:y.tile.queryRenderedFeatures(z,k,b._state,y.queryGeometry,y.cameraQueryGeometry,y.scale,B,X,C,a0(b.transform,y.tileID),V?(T,E)=>V(y.tileID,T,E):void 0)});return function(y,T){for(let E in y)for(let p of y[E])d2(p,T);return y}(function(y){let T={},E={};for(let p of y){let{queryResults:s,wrappedTileID:c}=p,Z1=E[c]=E[c]||{};for(let a in s){let x1=s[a],i=Z1[a]=Z1[a]||{},n=T[a]=T[a]||[];for(let q1 of x1)i[q1.featureIndex]||(i[q1.featureIndex]=!0,n.push(q1))}}return T}(d),b)}function h5(b,z){let k=b.tileID,J=z.tileID;return k.overscaledZ-J.overscaledZ||k.canonical.y-J.canonical.y||k.wrap-J.wrap||k.canonical.x-J.canonical.x}function d2(b,z){let k=b.feature,J=z.getFeatureState(k.layer["source-layer"],k.id);k.source=k.layer.source,k.layer["source-layer"]&&(k.sourceLayer=k.layer["source-layer"]),k.state=J}function r0(b,z,k){return Z._(this,void 0,void 0,function*(){let J=b;if(b.url?J=(yield Z.j(z.transformRequest(b.url,"Source"),k)).data:yield H1.frameAsync(k),!J)return null;let B=Z.Q(Z.e(J,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in J&&J.vector_layers&&(B.vectorLayerIds=J.vector_layers.map((X)=>X.id)),B})}class g5{constructor(b,z){b&&(z?this.setSouthWest(b).setNorthEast(z):Array.isArray(b)&&(b.length===4?this.setSouthWest([b[0],b[1]]).setNorthEast([b[2],b[3]]):this.setSouthWest(b[0]).setNorthEast(b[1])))}setNorthEast(b){return this._ne=b instanceof Z.S?new Z.S(b.lng,b.lat):Z.S.convert(b),this}setSouthWest(b){return this._sw=b instanceof Z.S?new Z.S(b.lng,b.lat):Z.S.convert(b),this}extend(b){let z=this._sw,k=this._ne,J,B;if(b instanceof Z.S)J=b,B=b;else{if(!(b instanceof g5))return Array.isArray(b)?b.length===4||b.every(Array.isArray)?this.extend(g5.convert(b)):this.extend(Z.S.convert(b)):b&&(("lng"in b)||("lon"in b))&&("lat"in b)?this.extend(Z.S.convert(b)):this;if(J=b._sw,B=b._ne,!J||!B)return this}return z||k?(z.lng=Math.min(J.lng,z.lng),z.lat=Math.min(J.lat,z.lat),k.lng=Math.max(B.lng,k.lng),k.lat=Math.max(B.lat,k.lat)):(this._sw=new Z.S(J.lng,J.lat),this._ne=new Z.S(B.lng,B.lat)),this}getCenter(){return new Z.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Z.S(this.getWest(),this.getNorth())}getSouthEast(){return new Z.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(b){let{lng:z,lat:k}=Z.S.convert(b),J=this._sw.lng<=z&&z<=this._ne.lng;return this._sw.lng>this._ne.lng&&(J=this._sw.lng>=z&&z>=this._ne.lng),this._sw.lat<=k&&k<=this._ne.lat&&J}static convert(b){return b instanceof g5?b:b?new g5(b):b}static fromLngLat(b,z=0){let k=360*z/40075017,J=k/Math.cos(Math.PI/180*b.lat);return new g5(new Z.S(b.lng-J,b.lat-k),new Z.S(b.lng+J,b.lat+k))}adjustAntiMeridian(){let b=new Z.S(this._sw.lng,this._sw.lat),z=new Z.S(this._ne.lng,this._ne.lat);return new g5(b,b.lng>z.lng?new Z.S(z.lng+360,z.lat):z)}}class i2{constructor(b,z,k){this.bounds=g5.convert(this.validateBounds(b)),this.minzoom=z||0,this.maxzoom=k||24}validateBounds(b){return Array.isArray(b)&&b.length===4?[Math.max(-180,b[0]),Math.max(-90,b[1]),Math.min(180,b[2]),Math.min(90,b[3])]:[-180,-90,180,90]}contains(b){let z=Math.pow(2,b.z),k=Math.floor(Z.V(this.bounds.getWest())*z),J=Math.floor(Z.U(this.bounds.getNorth())*z),B=Math.ceil(Z.V(this.bounds.getEast())*z),X=Math.ceil(Z.U(this.bounds.getSouth())*z);return b.x>=k&&b.x<B&&b.y>=J&&b.y<X}}class z4 extends Z.E{constructor(b,z,k,J){if(super(),this.id=b,this.dispatcher=k,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Z.e(this,Z.Q(z,["url","scheme","tileSize","promoteId"])),this._options=Z.e({type:"vector"},z),this._collectResourceTiming=z.collectResourceTiming,this.tileSize!==512)throw Error("vector tile sources must have a tileSize of 512");this.setEventedParent(J)}load(){return Z._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new Z.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let b=yield r0(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),b&&(Z.e(this,b),b.bounds&&(this.tileBounds=new i2(b.bounds,this.minzoom,this.maxzoom)),this.fire(new Z.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Z.l("data",{dataType:"source",sourceDataType:"content"})))}catch(b){this._tileJSONRequest=null,this._loaded=!0,this.fire(new Z.k(b))}})}loaded(){return this._loaded}hasTile(b){return!this.tileBounds||this.tileBounds.contains(b.canonical)}onAdd(b){this.map=b,this.load()}setSourceProperty(b){this._tileJSONRequest&&this._tileJSONRequest.abort(),b(),this.load()}setTiles(b){return this.setSourceProperty(()=>{this._options.tiles=b}),this}setUrl(b){return this.setSourceProperty(()=>{this.url=b,this._options.url=b}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return Z.e({},this._options)}loadTile(b){return Z._(this,void 0,void 0,function*(){let z=b.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),k={request:this.map._requestManager.transformRequest(z,"Tile"),uid:b.uid,tileID:b.tileID,zoom:b.tileID.overscaledZ,tileSize:this.tileSize*b.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};k.request.collectResourceTiming=this._collectResourceTiming;let J="RT";if(b.actor&&b.state!=="expired"){if(b.state==="loading")return new Promise((B,X)=>{b.reloadPromise={resolve:B,reject:X}})}else b.actor=this.dispatcher.getActor(),J="LT";b.abortController=new AbortController;try{let B=yield b.actor.sendAsync({type:J,data:k},b.abortController);if(delete b.abortController,b.aborted)return;this._afterTileLoadWorkerResponse(b,B)}catch(B){if(delete b.abortController,b.aborted)return;if(B&&B.status!==404)throw B;this._afterTileLoadWorkerResponse(b,null)}})}_afterTileLoadWorkerResponse(b,z){if(z&&z.resourceTiming&&(b.resourceTiming=z.resourceTiming),z&&this.map._refreshExpiredTiles&&b.setExpiryData(z),b.loadVectorData(z,this.map.painter),b.reloadPromise){let k=b.reloadPromise;b.reloadPromise=null,this.loadTile(b).then(k.resolve).catch(k.reject)}}abortTile(b){return Z._(this,void 0,void 0,function*(){b.abortController&&(b.abortController.abort(),delete b.abortController),b.actor&&(yield b.actor.sendAsync({type:"AT",data:{uid:b.uid,type:this.type,source:this.id}}))})}unloadTile(b){return Z._(this,void 0,void 0,function*(){b.unloadVectorData(),b.actor&&(yield b.actor.sendAsync({type:"RMT",data:{uid:b.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Q3 extends Z.E{constructor(b,z,k,J){super(),this.id=b,this.dispatcher=k,this.setEventedParent(J),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Z.e({type:"raster"},z),Z.e(this,Z.Q(z,["url","scheme","tileSize"]))}load(){return Z._(this,arguments,void 0,function*(b=!1){this._loaded=!1,this.fire(new Z.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let z=yield r0(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,z&&(Z.e(this,z),z.bounds&&(this.tileBounds=new i2(z.bounds,this.minzoom,this.maxzoom)),this.fire(new Z.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Z.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:b})))}catch(z){this._tileJSONRequest=null,this._loaded=!0,this.fire(new Z.k(z))}})}loaded(){return this._loaded}onAdd(b){this.map=b,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(b){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),b(),this.load(!0)}setTiles(b){return this.setSourceProperty(()=>{this._options.tiles=b}),this}setUrl(b){return this.setSourceProperty(()=>{this.url=b,this._options.url=b}),this}serialize(){return Z.e({},this._options)}hasTile(b){return!this.tileBounds||this.tileBounds.contains(b.canonical)}loadTile(b){return Z._(this,void 0,void 0,function*(){let z=b.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);b.abortController=new AbortController;try{let k=yield F1.getImage(this.map._requestManager.transformRequest(z,"Tile"),b.abortController,this.map._refreshExpiredTiles);if(delete b.abortController,b.aborted)return void(b.state="unloaded");if(k&&k.data){this.map._refreshExpiredTiles&&(k.cacheControl||k.expires)&&b.setExpiryData({cacheControl:k.cacheControl,expires:k.expires});let J=this.map.painter.context,B=J.gl,X=k.data;b.texture=this.map.painter.getTileTexture(X.width),b.texture?b.texture.update(X,{useMipmap:!0}):(b.texture=new Z.T(J,X,B.RGBA,{useMipmap:!0}),b.texture.bind(B.LINEAR,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST)),b.state="loaded"}}catch(k){if(delete b.abortController,b.aborted)b.state="unloaded";else if(k)throw b.state="errored",k}})}abortTile(b){return Z._(this,void 0,void 0,function*(){b.abortController&&(b.abortController.abort(),delete b.abortController)})}unloadTile(b){return Z._(this,void 0,void 0,function*(){b.texture&&this.map.painter.saveTileTexture(b.texture)})}hasTransition(){return!1}}class O2 extends Q3{constructor(b,z,k,J){super(b,z,k,J),this.type="raster-dem",this.maxzoom=22,this._options=Z.e({type:"raster-dem"},z),this.encoding=z.encoding||"mapbox",this.redFactor=z.redFactor,this.greenFactor=z.greenFactor,this.blueFactor=z.blueFactor,this.baseShift=z.baseShift}loadTile(b){return Z._(this,void 0,void 0,function*(){let z=b.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),k=this.map._requestManager.transformRequest(z,"Tile");b.neighboringTiles=this._getNeighboringTiles(b.tileID),b.abortController=new AbortController;try{let J=yield F1.getImage(k,b.abortController,this.map._refreshExpiredTiles);if(delete b.abortController,b.aborted)return void(b.state="unloaded");if(J&&J.data){let B=J.data;this.map._refreshExpiredTiles&&(J.cacheControl||J.expires)&&b.setExpiryData({cacheControl:J.cacheControl,expires:J.expires});let X=Z.b(B)&&Z.W()?B:yield this.readImageNow(B),V={type:this.type,uid:b.uid,source:this.id,rawImageData:X,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!b.actor||b.state==="expired"){b.actor=this.dispatcher.getActor();let L=yield b.actor.sendAsync({type:"LDT",data:V});b.dem=L,b.needsHillshadePrepare=!0,b.needsTerrainPrepare=!0,b.state="loaded"}}}catch(J){if(delete b.abortController,b.aborted)b.state="unloaded";else if(J)throw b.state="errored",J}})}readImageNow(b){return Z._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&Z.X()){let z=b.width+2,k=b.height+2;try{return new Z.R({width:z,height:k},yield Z.Y(b,-1,-1,z,k))}catch(J){}}return H1.getImageData(b,1)})}_getNeighboringTiles(b){let z=b.canonical,k=Math.pow(2,z.z),J=(z.x-1+k)%k,B=z.x===0?b.wrap-1:b.wrap,X=(z.x+1+k)%k,V=z.x+1===k?b.wrap+1:b.wrap,L={};return L[new Z.Z(b.overscaledZ,B,z.z,J,z.y).key]={backfilled:!1},L[new Z.Z(b.overscaledZ,V,z.z,X,z.y).key]={backfilled:!1},z.y>0&&(L[new Z.Z(b.overscaledZ,B,z.z,J,z.y-1).key]={backfilled:!1},L[new Z.Z(b.overscaledZ,b.wrap,z.z,z.x,z.y-1).key]={backfilled:!1},L[new Z.Z(b.overscaledZ,V,z.z,X,z.y-1).key]={backfilled:!1}),z.y+1<k&&(L[new Z.Z(b.overscaledZ,B,z.z,J,z.y+1).key]={backfilled:!1},L[new Z.Z(b.overscaledZ,b.wrap,z.z,z.x,z.y+1).key]={backfilled:!1},L[new Z.Z(b.overscaledZ,V,z.z,X,z.y+1).key]={backfilled:!1}),L}unloadTile(b){return Z._(this,void 0,void 0,function*(){b.demTexture&&this.map.painter.saveTileTexture(b.demTexture),b.fbo&&(b.fbo.destroy(),delete b.fbo),b.dem&&delete b.dem,delete b.neighboringTiles,b.state="unloaded",b.actor&&(yield b.actor.sendAsync({type:"RDT",data:{type:this.type,uid:b.uid,source:this.id}}))})}}class x4 extends Z.E{constructor(b,z,k,J){super(),this.id=b,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:z.data},this.actor=k.getActor(),this.setEventedParent(J),this._data=z.data,this._options=Z.e({},z),this._collectResourceTiming=z.collectResourceTiming,z.maxzoom!==void 0&&(this.maxzoom=z.maxzoom),z.type&&(this.type=z.type),z.attribution&&(this.attribution=z.attribution),this.promoteId=z.promoteId,z.clusterMaxZoom!==void 0&&this.maxzoom<=z.clusterMaxZoom&&Z.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${z.clusterMaxZoom}".`),this.workerOptions=Z.e({source:this.id,cluster:z.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(z.buffer!==void 0?z.buffer:128),tolerance:this._pixelsToTileUnits(z.tolerance!==void 0?z.tolerance:0.375),extent:Z.$,maxZoom:this.maxzoom,lineMetrics:z.lineMetrics||!1,generateId:z.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(z.clusterMaxZoom),minPoints:Math.max(2,z.clusterMinPoints||2),extent:Z.$,radius:this._pixelsToTileUnits(z.clusterRadius||50),log:!1,generateId:z.generateId||!1},clusterProperties:z.clusterProperties,filter:z.filter},z.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(b){return b*(Z.$/this.tileSize)}_getClusterMaxZoom(b){let z=b?Math.round(b):this.maxzoom-1;return Number.isInteger(b)||b===void 0||Z.w(`Integer expected for option 'clusterMaxZoom': provided value "${b}" rounded to "${z}"`),z}load(){return Z._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(b){this.map=b,this.load()}setData(b){return this._data=b,this._pendingWorkerUpdate={data:b},this._updateWorkerData(),this}updateData(b){return this._pendingWorkerUpdate.diff=Z.a0(this._pendingWorkerUpdate.diff,b),this._updateWorkerData(),this}getData(){return Z._(this,void 0,void 0,function*(){let b=Z.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:b})})}getCoordinatesFromGeometry(b){return b.type==="GeometryCollection"?b.geometries.map((z)=>z.coordinates).flat(1/0):b.coordinates.flat(1/0)}getBounds(){return Z._(this,void 0,void 0,function*(){let b=new g5,z=yield this.getData(),k;switch(z.type){case"FeatureCollection":k=z.features.map((J)=>this.getCoordinatesFromGeometry(J.geometry)).flat(1/0);break;case"Feature":k=this.getCoordinatesFromGeometry(z.geometry);break;default:k=this.getCoordinatesFromGeometry(z)}if(k.length==0)return b;for(let J=0;J<k.length-1;J+=2)b.extend([k[J],k[J+1]]);return b})}setClusterOptions(b){return this.workerOptions.cluster=b.cluster,b.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(b.clusterRadius)),b.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(b.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(b){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:b,source:this.id}})}getClusterChildren(b){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:b,source:this.id}})}getClusterLeaves(b,z,k){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:b,limit:z,offset:k}})}_updateWorkerData(){return Z._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void Z.w(`No pending worker updates for GeoJSONSource ${this.id}.`);let{data:b,diff:z}=this._pendingWorkerUpdate,k=Z.e({type:this.type},this.workerOptions);b?(typeof b=="string"?(k.request=this.map._requestManager.transformRequest(H1.resolveURL(b),"Source"),k.request.collectResourceTiming=this._collectResourceTiming):k.data=JSON.stringify(b),this._pendingWorkerUpdate.data=void 0):z&&(k.dataDiff=z,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new Z.l("dataloading",{dataType:"source"}));try{let J=yield this.actor.sendAsync({type:"LD",data:k});if(this._isUpdatingWorker=!1,this._removed||J.abandoned)return void this.fire(new Z.l("dataabort",{dataType:"source"}));this._data=J.data;let B=null;J.resourceTiming&&J.resourceTiming[this.id]&&(B=J.resourceTiming[this.id].slice(0));let X={dataType:"source"};this._collectResourceTiming&&B&&B.length>0&&Z.e(X,{resourceTiming:B}),this.fire(new Z.l("data",Object.assign(Object.assign({},X),{sourceDataType:"metadata"}))),this.fire(new Z.l("data",Object.assign(Object.assign({},X),{sourceDataType:"content"})))}catch(J){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new Z.l("dataabort",{dataType:"source"}));this.fire(new Z.k(J))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}})}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(b){return Z._(this,void 0,void 0,function*(){let z=b.actor?"RT":"LT";b.actor=this.actor;let k={type:this.type,uid:b.uid,tileID:b.tileID,zoom:b.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};b.abortController=new AbortController;let J=yield this.actor.sendAsync({type:z,data:k},b.abortController);delete b.abortController,b.unloadVectorData(),b.aborted||b.loadVectorData(J,this.map.painter,z==="RT")})}abortTile(b){return Z._(this,void 0,void 0,function*(){b.abortController&&(b.abortController.abort(),delete b.abortController),b.aborted=!0})}unloadTile(b){return Z._(this,void 0,void 0,function*(){b.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:b.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return Z.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class E5 extends Z.E{constructor(b,z,k,J){super(),this.flippedWindingOrder=!1,this.id=b,this.dispatcher=k,this.coordinates=z.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(J),this.options=z}load(b){return Z._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new Z.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{let z=yield F1.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,z&&z.data&&(this.image=z.data,b&&(this.coordinates=b),this._finishLoading())}catch(z){this._request=null,this._loaded=!0,this.fire(new Z.k(z))}})}loaded(){return this._loaded}updateImage(b){return b.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=b.url,this.load(b.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Z.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(b){this.map=b,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(b){this.coordinates=b;let z=b.map(Z.a1.fromLngLat);var k;return this.tileID=function(J){let B=Z.a2.fromPoints(J),X=B.width(),V=B.height(),L=Math.max(X,V),F=Math.max(0,Math.floor(-Math.log(L)/Math.LN2)),C=Math.pow(2,F);return new Z.a4(F,Math.floor((B.minX+B.maxX)/2*C),Math.floor((B.minY+B.maxY)/2*C))}(z),this.terrainTileRanges=this._getOverlappingTileRanges(z),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=z.map((J)=>this.tileID.getTilePoint(J)._round()),this.flippedWindingOrder=((k=this.tileCoords)[1].x-k[0].x)*(k[2].y-k[0].y)-(k[1].y-k[0].y)*(k[2].x-k[0].x)<0,this.fire(new Z.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let b=this.map.painter.context,z=b.gl;this.texture||(this.texture=new Z.T(b,this.image,z.RGBA),this.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE));let k=!1;for(let J in this.tiles){let B=this.tiles[J];B.state!=="loaded"&&(B.state="loaded",B.texture=this.texture,k=!0)}k&&this.fire(new Z.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(b){return Z._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(b.tileID.canonical)?(this.tiles[String(b.tileID.wrap)]=b,b.buckets={}):b.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(b){let{minX:z,minY:k,maxX:J,maxY:B}=Z.a2.fromPoints(b),X={};for(let V=0;V<=Z.a3;V++){let L=Math.pow(2,V),F=Math.floor(z*L),C=Math.floor(k*L),O=Math.floor(J*L),d=Math.floor(B*L);X[V]={minTileX:F,minTileY:C,maxTileX:O,maxTileY:d}}return X}}class T3 extends E5{constructor(b,z,k,J){super(b,z,k,J),this.roundZoom=!0,this.type="video",this.options=z}load(){return Z._(this,void 0,void 0,function*(){this._loaded=!1;let b=this.options;this.urls=[];for(let z of b.urls)this.urls.push(this.map._requestManager.transformRequest(z,"Source").url);try{let z=yield Z.a5(this.urls);if(this._loaded=!0,!z)return;this.video=z,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(z){this.fire(new Z.k(z))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(b){if(this.video){let z=this.video.seekable;b<z.start(0)||b>z.end(0)?this.fire(new Z.k(new Z.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${z.start(0)} and ${z.end(0)}-second mark.`))):this.video.currentTime=b}}getVideo(){return this.video}onAdd(b){this.map||(this.map=b,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let b=this.map.painter.context,z=b.gl;this.texture?this.video.paused||(this.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE),z.texSubImage2D(z.TEXTURE_2D,0,0,0,z.RGBA,z.UNSIGNED_BYTE,this.video)):(this.texture=new Z.T(b,this.video,z.RGBA),this.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE));let k=!1;for(let J in this.tiles){let B=this.tiles[J];B.state!=="loaded"&&(B.state="loaded",B.texture=this.texture,k=!0)}k&&this.fire(new Z.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Y3 extends E5{constructor(b,z,k,J){super(b,z,k,J),z.coordinates?Array.isArray(z.coordinates)&&z.coordinates.length===4&&!z.coordinates.some((B)=>!Array.isArray(B)||B.length!==2||B.some((X)=>typeof X!="number"))||this.fire(new Z.k(new Z.a6(`sources.${b}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new Z.k(new Z.a6(`sources.${b}`,null,'missing required property "coordinates"'))),z.animate&&typeof z.animate!="boolean"&&this.fire(new Z.k(new Z.a6(`sources.${b}`,null,'optional "animate" property must be a boolean value'))),z.canvas?typeof z.canvas=="string"||z.canvas instanceof HTMLCanvasElement||this.fire(new Z.k(new Z.a6(`sources.${b}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new Z.k(new Z.a6(`sources.${b}`,null,'missing required property "canvas"'))),this.options=z,this.animate=z.animate===void 0||z.animate}load(){return Z._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new Z.k(Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(b){this.map=b,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),this._hasInvalidDimensions())return;if(Object.keys(this.tiles).length===0)return;let z=this.map.painter.context,k=z.gl;this.texture?(b||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Z.T(z,this.canvas,k.RGBA,{premultiply:!0});let J=!1;for(let B in this.tiles){let X=this.tiles[B];X.state!=="loaded"&&(X.state="loaded",X.texture=this.texture,J=!0)}J&&this.fire(new Z.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let b of[this.canvas.width,this.canvas.height])if(isNaN(b)||b<=0)return!0;return!1}}let u5={},t2=(b)=>{switch(b){case"geojson":return x4;case"image":return E5;case"raster":return Q3;case"raster-dem":return O2;case"vector":return z4;case"video":return T3;case"canvas":return Y3}return u5[b]},e2="RTLPluginLoaded";class c4 extends Z.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=j0()}_syncState(b){return this.status=b,this.dispatcher.broadcast("SRPS",{pluginStatus:b,pluginURL:this.url}).catch((z)=>{throw this.status="error",z})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(b){return Z._(this,arguments,void 0,function*(z,k=!1){if(this.url)throw Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=H1.resolveURL(z),!this.url)throw Error(`requested url ${z} is invalid`);if(this.status==="unavailable"){if(!k)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return Z._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new Z.l(e2))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let $3=null;function V3(){return $3||($3=new c4),$3}var I,S;(function(b){b[b.Base=0]="Base",b[b.Parent=1]="Parent"})(I||(I={})),function(b){b[b.Departing=0]="Departing",b[b.Incoming=1]="Incoming"}(S||(S={}));class m{constructor(b,z){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=b,this.uid=Z.a7(),this.uses=0,this.tileSize=z,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(b){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(b||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:b,fadingDirection:z,fadingParentID:k,fadeEndTime:J}){this.resetFadeLogic(),this.fadingRole=b,this.fadingDirection=z,this.fadingParentID=k,this.fadeEndTime=J}setSelfFadeLogic(b){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=b}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=z1(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(b){this.demTexture&&b.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(b,z,k){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",b){b.featureIndex&&(this.latestFeatureIndex=b.featureIndex,b.rawTileData?(this.latestRawTileData=b.rawTileData,this.latestFeatureIndex.rawTileData=b.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=b.collisionBoxArray,this.buckets=function(J,B){let X={};if(!B)return X;for(let V of J){let L=V.layerIds.map((F)=>B.getLayer(F)).filter(Boolean);if(L.length!==0){V.layers=L,V.stateDependentLayerIds&&(V.stateDependentLayers=V.stateDependentLayerIds.map((F)=>L.filter((C)=>C.id===F)[0]));for(let F of L)X[F.id]=V}}return X}(b.buckets,z==null?void 0:z.style),this.hasSymbolBuckets=!1;for(let J in this.buckets){let B=this.buckets[J];if(B instanceof Z.a9){if(this.hasSymbolBuckets=!0,!k)break;B.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let J in this.buckets){let B=this.buckets[J];if(B instanceof Z.a9&&B.hasRTLText){this.hasRTLText=!0,V3().lazyLoad();break}}this.queryPadding=0;for(let J in this.buckets){let B=this.buckets[J];this.queryPadding=Math.max(this.queryPadding,z.style.getLayer(J).queryRadius(B))}b.imageAtlas&&(this.imageAtlas=b.imageAtlas),b.glyphAtlasImage&&(this.glyphAtlasImage=b.glyphAtlasImage),this.dashPositions=b.dashPositions}else this.collisionBoxArray=new Z.a8}unloadVectorData(){for(let b in this.buckets)this.buckets[b].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(b){return this.buckets[b.id]}upload(b){for(let k in this.buckets){let J=this.buckets[k];J.uploadPending()&&J.upload(b)}let z=b.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Z.T(b,this.imageAtlas.image,z.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Z.T(b,this.glyphAtlasImage,z.ALPHA),this.glyphAtlasImage=null)}prepare(b){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(b,this.imageAtlasTexture)}queryRenderedFeatures(b,z,k,J,B,X,V,L,F,C,O){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:J,cameraQueryGeometry:B,scale:X,tileSize:this.tileSize,pixelPosMatrix:C,transform:L,params:V,queryPadding:this.queryPadding*F,getElevation:O},b,z,k):{}}querySourceFeatures(b,z){let k=this.latestFeatureIndex;if(!k||!k.rawTileData)return;let J=k.loadVTLayers(),B=z&&z.sourceLayer?z.sourceLayer:"",X=J._geojsonTileLayer||J[B];if(!X)return;let V=Z.aa(z==null?void 0:z.filter,z==null?void 0:z.globalState),{z:L,x:F,y:C}=this.tileID.canonical,O={z:L,x:F,y:C};for(let d=0;d<X.length;d++){let y=X.feature(d);if(V.needGeometry){let p=Z.ab(y,!0);if(!V.filter(new Z.F(this.tileID.overscaledZ),p,this.tileID.canonical))continue}else if(!V.filter(new Z.F(this.tileID.overscaledZ),y))continue;let T=k.getId(y,B),E=new Z.ac(y,L,F,C,T);E.tile=O,b.push(E)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(b){let z=this.expirationTime;if(b.cacheControl){let k=Z.ad(b.cacheControl);k["max-age"]&&(this.expirationTime=Date.now()+1000*k["max-age"])}else b.expires&&(this.expirationTime=new Date(b.expires).getTime());if(this.expirationTime){let k=Date.now(),J=!1;if(this.expirationTime>k)J=!1;else if(z)if(this.expirationTime<z)J=!0;else{let B=this.expirationTime-z;B?this.expirationTime=k+Math.max(B,30000):J=!0}else J=!0;J?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1000*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(b,z){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(b).length===0)return;let k=this.latestFeatureIndex.loadVTLayers();for(let J in this.buckets){if(!z.style.hasLayer(J))continue;let B=this.buckets[J],X=B.layers[0].sourceLayer||"_geojsonTileLayer",V=k[X],L=b[X];if(!V||!L||Object.keys(L).length===0)continue;B.update(L,V,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});let F=z&&z.style&&z.style.getLayer(J);F&&(this.queryPadding=Math.max(this.queryPadding,F.queryRadius(B)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<z1()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(b){this.symbolFadeHoldUntil=z1()+b}setDependencies(b,z){let k={};for(let J of z)k[J]=!0;this.dependencies[b]=k}hasDependency(b,z){for(let k of b){let J=this.dependencies[k];if(J){for(let B of z)if(J[B])return!0}}return!1}}class e{constructor(b,z){this.max=b,this.onRemove=z,this.reset()}reset(){for(let b in this.data)for(let z of this.data[b])z.timeout&&clearTimeout(z.timeout),this.onRemove(z.value);return this.data={},this.order=[],this}add(b,z,k){let J=b.wrapped().key;this.data[J]===void 0&&(this.data[J]=[]);let B={value:z,timeout:void 0};if(k!==void 0&&(B.timeout=setTimeout(()=>{this.remove(b,B)},k)),this.data[J].push(B),this.order.push(J),this.order.length>this.max){let X=this._getAndRemoveByKey(this.order[0]);X&&this.onRemove(X)}return this}has(b){return b.wrapped().key in this.data}getAndRemove(b){return this.has(b)?this._getAndRemoveByKey(b.wrapped().key):null}_getAndRemoveByKey(b){let z=this.data[b].shift();return z.timeout&&clearTimeout(z.timeout),this.data[b].length===0&&delete this.data[b],this.order.splice(this.order.indexOf(b),1),z.value}getByKey(b){let z=this.data[b];return z?z[0].value:null}get(b){return this.has(b)?this.data[b.wrapped().key][0].value:null}remove(b,z){if(!this.has(b))return this;let k=b.wrapped().key,J=z===void 0?0:this.data[k].indexOf(z),B=this.data[k][J];return this.data[k].splice(J,1),B.timeout&&clearTimeout(B.timeout),this.data[k].length===0&&delete this.data[k],this.onRemove(B.value),this.order.splice(this.order.indexOf(k),1),this}setMaxSize(b){for(this.max=b;this.order.length>this.max;){let z=this._getAndRemoveByKey(this.order[0]);z&&this.onRemove(z)}return this}filter(b){let z=[];for(let k in this.data)for(let J of this.data[k])b(J.value)||z.push(J);for(let k of z)this.remove(k.value.tileID,k)}}class b1{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(b,z,k){let J=String(z);if(this.stateChanges[b]=this.stateChanges[b]||{},this.stateChanges[b][J]=this.stateChanges[b][J]||{},Z.e(this.stateChanges[b][J],k),this.deletedStates[b]===null){this.deletedStates[b]={};for(let B in this.state[b])B!==J&&(this.deletedStates[b][B]=null)}else if(this.deletedStates[b]&&this.deletedStates[b][J]===null){this.deletedStates[b][J]={};for(let B in this.state[b][J])k[B]||(this.deletedStates[b][J][B]=null)}else for(let B in k)this.deletedStates[b]&&this.deletedStates[b][J]&&this.deletedStates[b][J][B]===null&&delete this.deletedStates[b][J][B]}removeFeatureState(b,z,k){if(this.deletedStates[b]===null)return;let J=String(z);if(this.deletedStates[b]=this.deletedStates[b]||{},k&&z!==void 0)this.deletedStates[b][J]!==null&&(this.deletedStates[b][J]=this.deletedStates[b][J]||{},this.deletedStates[b][J][k]=null);else if(z!==void 0)if(this.stateChanges[b]&&this.stateChanges[b][J])for(k in this.deletedStates[b][J]={},this.stateChanges[b][J])this.deletedStates[b][J][k]=null;else this.deletedStates[b][J]=null;else this.deletedStates[b]=null}getState(b,z){let k=String(z),J=Z.e({},(this.state[b]||{})[k],(this.stateChanges[b]||{})[k]);if(this.deletedStates[b]===null)return{};if(this.deletedStates[b]){let B=this.deletedStates[b][z];if(B===null)return{};for(let X in B)delete J[X]}return J}initializeTileState(b,z){b.setFeatureState(this.state,z)}coalesceChanges(b,z){let k={};for(let J in this.stateChanges){this.state[J]=this.state[J]||{};let B={};for(let X in this.stateChanges[J])this.state[J][X]||(this.state[J][X]={}),Z.e(this.state[J][X],this.stateChanges[J][X]),B[X]=this.state[J][X];k[J]=B}for(let J in this.deletedStates){this.state[J]=this.state[J]||{};let B={};if(this.deletedStates[J]===null)for(let X in this.state[J])B[X]={},this.state[J][X]={};else for(let X in this.deletedStates[J]){if(this.deletedStates[J][X]===null)this.state[J][X]={};else for(let V of Object.keys(this.deletedStates[J][X]))delete this.state[J][X][V];B[X]=this.state[J][X]}k[J]=k[J]||{},Z.e(k[J],B)}if(this.stateChanges={},this.deletedStates={},Object.keys(k).length!==0)for(let J in b)b[J].setFeatureState(k,z)}}let J1=89.25;function A1(b,z){let k=Z.ae(z.lat,-Z.af,Z.af);return new Z.P(Z.V(z.lng)*b,Z.U(k)*b)}function v1(b,z){return new Z.a1(z.x/b,z.y/b).toLngLat()}function X1(b){return b.cameraToCenterDistance*Math.min(0.85*Math.tan(Z.ag(90-b.pitch)),Math.tan(Z.ag(J1-b.pitch)))}function l1(b,z){let k=b.canonical,J=z/Z.ah(k.z),B=k.x+Math.pow(2,k.z)*b.wrap,X=Z.ai(new Float64Array(16));return Z.M(X,X,[B*J,k.y*J,0]),Z.N(X,X,[J/Z.$,J/Z.$,1]),X}function C1(b,z,k,J,B){let X=Z.a1.fromLngLat(b,z),V=B*Z.aj(1,b.lat),L=V*Math.cos(Z.ag(k)),F=Math.sqrt(V*V-L*L),C=F*Math.sin(Z.ag(-J)),O=F*Math.cos(Z.ag(-J));return new Z.a1(X.x+C,X.y+O,X.z+L)}function m1(b,z,k){let J=z.intersectsFrustum(b);if(!k||J===0)return J;let B=z.intersectsPlane(k);return B===0?0:J===2&&B===2?2:1}function w0(b,z,k){let J=0,B=(k-z)/10;for(let X=0;X<10;X++)J+=B*Math.pow(Math.cos(z+(X+0.5)/10*(k-z)),b);return J}function M1(b,z){return function(k,J,B,X,V){let L=2*((b-1)/Z.ak(Math.cos(Z.ag(J1-V))/Math.cos(Z.ag(J1)))-1),F=Math.acos(B/X),C=2*w0(L-1,0,Z.ag(V/2)),O=Math.min(Z.ag(J1),F+Z.ag(V/2)),d=w0(L-1,Math.min(O,F-Z.ag(V/2)),O),y=Math.atan(J/B),T=Math.hypot(J,B),E=k;return E+=Z.ak(X/T/Math.max(0.5,Math.cos(Z.ag(V/2)))),E+=L*Z.ak(Math.cos(y))/2,E-=Z.ak(Math.max(1,d/C/z))/2,E}}let y0=M1(9.314,3);function i0(b,z){let k=(z.roundZoom?Math.round:Math.floor)(b.zoom+Z.ak(b.tileSize/z.tileSize));return Math.max(0,k)}function N1(b,z){let k=b.getCameraFrustum(),J=b.getClippingPlane(),B=b.screenPointToMercatorCoordinate(b.getCameraPoint()),X=Z.a1.fromLngLat(b.center,b.elevation);B.z=X.z+Math.cos(b.pitchInRadians)*b.cameraToCenterDistance/b.worldSize;let V=b.getCoveringTilesDetailsProvider(),L=V.allowVariableZoom(b,z),F=i0(b,z),C=z.minzoom||0,O=z.maxzoom!==void 0?z.maxzoom:b.maxZoom,d=Math.min(Math.max(0,F),O),y=Math.pow(2,d),T=[y*B.x,y*B.y,0],E=[y*X.x,y*X.y,0],p=Math.hypot(X.x-B.x,X.y-B.y),s=Math.abs(X.z-B.z),c=Math.hypot(p,s),Z1=(i)=>({zoom:0,x:0,y:0,wrap:i,fullyVisible:!1}),a=[],x1=[];if(b.renderWorldCopies&&V.allowWorldCopies())for(let i=1;i<=3;i++)a.push(Z1(-i)),a.push(Z1(i));for(a.push(Z1(0));a.length>0;){let i=a.pop(),n=i.x,q1=i.y,V1=i.fullyVisible,W1={x:n,y:q1,z:i.zoom},L1=V.getTileBoundingVolume(W1,i.wrap,b.elevation,z);if(!V1){let D1=m1(k,L1,J);if(D1===0)continue;V1=D1===2}let Q1=V.distanceToTile2d(B.x,B.y,W1,L1),O1=F;L&&(O1=(z.calculateTileZoom||y0)(b.zoom+Z.ak(b.tileSize/z.tileSize),Q1,s,c,b.fov)),O1=(z.roundZoom?Math.round:Math.floor)(O1),O1=Math.max(0,O1);let I1=Math.min(O1,O);if(i.wrap=V.getWrap(X,W1,i.wrap),i.zoom>=I1){if(i.zoom<C)continue;let D1=d-i.zoom,n1=T[0]-0.5-(n<<D1),B0=T[1]-0.5-(q1<<D1),W0=z.reparseOverscaled?Math.max(i.zoom,O1):i.zoom;x1.push({tileID:new Z.Z(i.zoom===O?W0:i.zoom,i.wrap,i.zoom,n,q1),distanceSq:Z.al([E[0]-0.5-n,E[1]-0.5-q1]),tileDistanceToCamera:Math.sqrt(n1*n1+B0*B0)})}else for(let D1=0;D1<4;D1++)a.push({zoom:i.zoom+1,x:(n<<1)+D1%2,y:(q1<<1)+(D1>>1),wrap:i.wrap,fullyVisible:V1})}return x1.sort((i,n)=>i.distanceSq-n.distanceSq).map((i)=>i.tileID)}let v0=Z.a2.fromPoints([new Z.P(0,0),new Z.P(Z.$,Z.$)]);class M0 extends Z.E{constructor(b,z,k){super(),this.id=b,this.dispatcher=k,this.on("data",(J)=>this._dataHandler(J)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((J,B,X,V)=>{let L=new(t2(B.type))(J,B,X,V);if(L.id!==J)throw Error(`Expected Source id to be ${J} instead of ${L.id}`);return L})(b,z,k,this),this._tiles={},this._cache=new e(0,(J)=>this._unloadTile(J)),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new b1,this._didEmitContent=!1,this._updated=!1}onAdd(b){this.map=b,this._maxTileCacheSize=b?b._maxTileCacheSize:null,this._maxTileCacheZoomLevels=b?b._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(b)}onRemove(b){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(b)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(let b in this._tiles){let z=this._tiles[b];if(z.state!=="loaded"&&z.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let b=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,b&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(b,z,k){return Z._(this,void 0,void 0,function*(){try{yield this._source.loadTile(b),this._tileLoaded(b,z,k)}catch(J){b.state="errored",J.status!==404?this._source.fire(new Z.k(J,{tile:b})):this.update(this.transform,this.terrain)}})}_unloadTile(b){this._source.unloadTile&&this._source.unloadTile(b)}_abortTile(b){this._source.abortTile&&this._source.abortTile(b),this._source.fire(new Z.l("dataabort",{tile:b,coord:b.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(b){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let z in this._tiles){let k=this._tiles[z];k.upload(b),k.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((b)=>b.tileID).sort(e0).map((b)=>b.key)}getRenderableIds(b){let z=[];for(let k in this._tiles)this._isIdRenderable(k,b)&&z.push(this._tiles[k]);return b?z.sort((k,J)=>{let B=k.tileID,X=J.tileID,V=new Z.P(B.canonical.x,B.canonical.y)._rotate(-this.transform.bearingInRadians),L=new Z.P(X.canonical.x,X.canonical.y)._rotate(-this.transform.bearingInRadians);return B.overscaledZ-X.overscaledZ||L.y-V.y||L.x-V.x}).map((k)=>k.tileID.key):z.map((k)=>k.tileID).sort(e0).map((k)=>k.key)}hasRenderableParent(b){let z=b.overscaledZ-1;if(z>=this._source.minzoom){let k=this._getLoadedTile(b.scaledTo(z));if(k)return this._isIdRenderable(k.tileID.key)}return!1}_isIdRenderable(b,z=!1){var k;return(k=this._tiles[b])===null||k===void 0?void 0:k.isRenderable(z)}reload(b){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let z in this._tiles)b?this._reloadTile(z,"expired"):this._tiles[z].state!=="errored"&&this._reloadTile(z,"reloading")}}_reloadTile(b,z){return Z._(this,void 0,void 0,function*(){let k=this._tiles[b];k&&(k.state!=="loading"&&(k.state=z),yield this._loadTile(k,b,z))})}_tileLoaded(b,z,k){b.timeAdded=z1(),k==="expired"&&(b.refreshedUponExpiration=!0),this._setTileReloadTimer(z,b),this.getSource().type==="raster-dem"&&b.dem&&this._backfillDEM(b),this._state.initializeTileState(b,this.map?this.map.painter:null),b.aborted||this._source.fire(new Z.l("data",{dataType:"source",tile:b,coord:b.tileID}))}_backfillDEM(b){let z=this.getRenderableIds();for(let J=0;J<z.length;J++){let B=z[J];if(b.neighboringTiles&&b.neighboringTiles[B]){let X=this.getTileByID(B);k(b,X),k(X,b)}}function k(J,B){J.needsHillshadePrepare=!0,J.needsTerrainPrepare=!0;let X=B.tileID.canonical.x-J.tileID.canonical.x,V=B.tileID.canonical.y-J.tileID.canonical.y,L=Math.pow(2,J.tileID.canonical.z),F=B.tileID.key;X===0&&V===0||Math.abs(V)>1||(Math.abs(X)>1&&(Math.abs(X+L)===1?X+=L:Math.abs(X-L)===1&&(X-=L)),B.dem&&J.dem&&(J.dem.backfillBorder(B.dem,X,V),J.neighboringTiles&&J.neighboringTiles[F]&&(J.neighboringTiles[F].backfilled=!0)))}}getTile(b){return this.getTileByID(b.key)}getTileByID(b){return this._tiles[b]}_retainLoadedChildren(b,z){let k=Object.values(b),J=this._getLoadedDescendents(k),B={};for(let X of k){let V=J[X.key];if(!(V==null?void 0:V.length)){B[X.key]=X;continue}let L=X.overscaledZ+M0.maxUnderzooming,F=V.filter((d)=>d.tileID.overscaledZ<=L);if(!F.length){B[X.key]=X;continue}let C=Math.min(...F.map((d)=>d.tileID.overscaledZ)),O=F.filter((d)=>d.tileID.overscaledZ===C).map((d)=>d.tileID);for(let d of O)z[d.key]=d;this._areDescendentsComplete(O,C,X.overscaledZ)||(B[X.key]=X)}return B}_getLoadedDescendents(b){var z;let k={};for(let J in this._tiles){let B=this._tiles[J];if(B.hasData())for(let X of b)B.tileID.isChildOf(X)&&(k[z=X.key]||(k[z]=[])).push(B)}return k}_areDescendentsComplete(b,z,k){return b.length===1&&b[0].isOverscaled()?b[0].overscaledZ===z:Math.pow(4,z-k)===b.length}_getLoadedTile(b){let z=this._tiles[b.key];return(z==null?void 0:z.hasData())?z:null}updateCacheSize(b){let z=Math.ceil(b.width/this._source.tileSize)+1,k=Math.ceil(b.height/this._source.tileSize)+1,J=Math.floor(z*k*(this._maxTileCacheZoomLevels===null?Z.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),B=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,J):J;this._cache.setMaxSize(B)}handleWrapJump(b){let z=Math.round((b-(this._prevLng===void 0?b:this._prevLng))/360);if(this._prevLng=b,z){let k={};for(let J in this._tiles){let B=this._tiles[J];B.tileID=B.tileID.unwrapTo(B.tileID.wrap+z),k[B.tileID.key]=B}this._tiles=k,this._resetTileReloadTimers()}}update(b,z){if(!this._sourceLoaded||this._paused)return;let k;this.transform=b,this.terrain=z,this.updateCacheSize(b),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?k=b.getVisibleUnwrappedCoordinates(this._source.tileID).map((L)=>new Z.Z(L.canonical.z,L.wrap,L.canonical.z,L.canonical.x,L.canonical.y)):(k=N1(b,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:z,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(k=k.filter((L)=>this._source.hasTile(L)))):k=[],this.usedForTerrain&&(k=this._addTerrainIdealTiles(k));let J=k.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,J&&this.fire(new Z.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let B=i0(b,this._source),X=this._updateRetainedTiles(k,B),V=F5(this._source.type);V&&this._rasterFadeDuration>0&&!z&&this._updateFadingTiles(k,X),V?this._cleanUpRasterTiles(X):this._cleanUpVectorTiles(X)}_cleanUpRasterTiles(b){for(let z in this._tiles)b[z]||this._removeTile(z)}_cleanUpVectorTiles(b){for(let z in this._tiles){let k=this._tiles[z];b[z]?k.clearSymbolFadeHold():k.hasSymbolBuckets?k.holdingForSymbolFade()?k.symbolFadeFinished()&&this._removeTile(z):k.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(z)}}_addTerrainIdealTiles(b){let z=[];for(let k of b)if(k.canonical.z>this._source.minzoom){let J=k.scaledTo(k.canonical.z-1);z.push(J);let B=k.scaledTo(Math.max(this._source.minzoom,Math.min(k.canonical.z,5)));z.push(B)}return b.concat(z)}releaseSymbolFadeTiles(){for(let b in this._tiles)this._tiles[b].holdingForSymbolFade()&&this._removeTile(b)}_updateRetainedTiles(b,z){var k;let J={},B={},X=Math.max(z-M0.maxOverzooming,this._source.minzoom),V={};for(let L of b){let F=this._addTile(L);J[L.key]=L,F.hasData()||(V[L.key]=L)}V=this._retainLoadedChildren(V,J);for(let L in V){let F=V[L],C=this._tiles[L],O=C==null?void 0:C.wasRequested();for(let d=F.overscaledZ-1;d>=X;--d){let y=F.scaledTo(d);if(B[y.key])break;if(B[y.key]=!0,C=this.getTile(y),!C&&O&&(C=this._addTile(y)),C){let T=C.hasData();if((T||!((k=this.map)===null||k===void 0?void 0:k.cancelPendingTileRequestsWhileZooming)||O)&&(J[y.key]=y),O=C.wasRequested(),T)break}}}return J}_updateFadingTiles(b,z){let k=z1(),J=Z.am(b);for(let B of b){let X=this._tiles[B.key];X.fadingDirection!==S.Departing&&X.fadeOpacity!==0||X.resetFadeLogic(),this._updateFadingAncestor(X,z,k)||this._updateFadingDescendents(X,z,k)||this._updateFadingEdge(X,J,k)||X.resetFadeLogic()}}_updateFadingAncestor(b,z,k){if(!b.hasData())return!1;let{tileID:J,fadingRole:B,fadingDirection:X,fadingParentID:V}=b;if(B===I.Base&&X===S.Incoming&&V)return z[V.key]=V,!0;let L=Math.max(J.overscaledZ-this._maxFadingAncestorLevels,this._source.minzoom);for(let F=J.overscaledZ-1;F>=L;F--){let C=J.scaledTo(F),O=this._getLoadedTile(C);if(O)return b.setCrossFadeLogic({fadingRole:I.Base,fadingDirection:S.Incoming,fadingParentID:O.tileID,fadeEndTime:k+this._rasterFadeDuration}),O.setCrossFadeLogic({fadingRole:I.Parent,fadingDirection:S.Departing,fadeEndTime:k+this._rasterFadeDuration}),z[C.key]=C,!0}return!1}_updateFadingDescendents(b,z,k){if(!b.hasData())return!1;let J=b.tileID.children(this._source.maxzoom),B=this._updateFadingChildren(b,J,z,k);if(B)return!0;for(let X of J){let V=X.children(this._source.maxzoom);this._updateFadingChildren(b,V,z,k)&&(B=!0)}return B}_updateFadingChildren(b,z,k,J){if(z[0].overscaledZ>=this._source.maxzoom)return!1;let B=!1;for(let X of z){let V=this._getLoadedTile(X);if(!V)continue;let{fadingRole:L,fadingDirection:F,fadingParentID:C}=V;L===I.Base&&F===S.Departing&&C||(V.setCrossFadeLogic({fadingRole:I.Base,fadingDirection:S.Departing,fadingParentID:b.tileID,fadeEndTime:J+this._rasterFadeDuration}),b.setCrossFadeLogic({fadingRole:I.Parent,fadingDirection:S.Incoming,fadeEndTime:J+this._rasterFadeDuration})),k[X.key]=X,B=!0}return B}_updateFadingEdge(b,z,k){let J=b.tileID;return!!b.selfFading||!b.hasData()&&!!z.has(J)&&(b.setSelfFadeLogic(k+this._rasterFadeDuration),!0)}_addTile(b){let z=this._tiles[b.key];if(z)return z;z=this._cache.getAndRemove(b),z&&(z.resetFadeLogic(),this._setTileReloadTimer(b.key,z),z.tileID=b,this._state.initializeTileState(z,this.map?this.map.painter:null));let k=z;return z||(z=new m(b,this._source.tileSize*b.overscaleFactor()),this._loadTile(z,b.key,z.state)),z.uses++,this._tiles[b.key]=z,k||this._source.fire(new Z.l("dataloading",{tile:z,coord:z.tileID,dataType:"source"})),z}_setTileReloadTimer(b,z){this._clearTileReloadTimer(b);let k=z.getExpiryTimeout();k&&(this._timers[b]=setTimeout(()=>{this._reloadTile(b,"expired"),delete this._timers[b]},k))}_clearTileReloadTimer(b){let z=this._timers[b];z&&(clearTimeout(z),delete this._timers[b])}_resetTileReloadTimers(){for(let b in this._timers)clearTimeout(this._timers[b]),delete this._timers[b];for(let b in this._tiles)this._setTileReloadTimer(b,this._tiles[b])}refreshTiles(b){for(let z in this._tiles)(this._isIdRenderable(z)||this._tiles[z].state=="errored")&&b.some((k)=>k.equals(this._tiles[z].tileID.canonical))&&this._reloadTile(z,"expired")}_removeTile(b){let z=this._tiles[b];z&&(z.uses--,delete this._tiles[b],this._clearTileReloadTimer(b),z.uses>0||(z.hasData()&&z.state!=="reloading"?this._cache.add(z.tileID,z,z.getExpiryTimeout()):(z.aborted=!0,this._abortTile(z),this._unloadTile(z))))}_dataHandler(b){b.dataType==="source"&&(b.sourceDataType!=="metadata"?b.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(b.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let b in this._tiles)this._removeTile(b);this._cache.reset()}tilesIn(b,z,k){let J=[],B=this.transform;if(!B)return J;let X=B.getCoveringTilesDetailsProvider().allowWorldCopies(),V=k?B.getCameraQueryGeometry(b):b,L=(y)=>B.screenPointToMercatorCoordinate(y,this.terrain),F=this.transformBbox(b,L,!X),C=this.transformBbox(V,L,!X),O=this.getIds(),d=Z.a2.fromPoints(C);for(let y=0;y<O.length;y++){let T=this._tiles[O[y]];if(T.holdingForSymbolFade())continue;let E=X?[T.tileID]:[T.tileID.unwrapTo(-1),T.tileID.unwrapTo(0)],p=Math.pow(2,B.zoom-T.tileID.overscaledZ),s=z*T.queryPadding*Z.$/T.tileSize/p;for(let c of E){let Z1=d.map((a)=>c.getTilePoint(new Z.a1(a.x,a.y)));if(Z1.expandBy(s),Z1.intersects(v0)){let a=F.map((i)=>c.getTilePoint(i)),x1=C.map((i)=>c.getTilePoint(i));J.push({tile:T,tileID:X?c:c.unwrapTo(0),queryGeometry:a,cameraQueryGeometry:x1,scale:p})}}}return J}transformBbox(b,z,k){let J=b.map(z);if(k){let B=Z.a2.fromPoints(b);B.shrinkBy(0.001*Math.min(B.width(),B.height()));let X=B.map(z);Z.a2.fromPoints(J).covers(X)||(J=J.map((V)=>V.x>0.5?new Z.a1(V.x-1,V.y,V.z):V))}return J}getVisibleCoordinates(b){let z=this.getRenderableIds(b).map((k)=>this._tiles[k].tileID);return this.transform&&this.transform.populateCache(z),z}hasTransition(){if(this._source.hasTransition())return!0;if(F5(this._source.type)&&this._rasterFadeDuration>0){let b=z1();for(let z in this._tiles)if(this._tiles[z].fadeEndTime>=b)return!0}return!1}setRasterFadeDuration(b){this._rasterFadeDuration=b}setFeatureState(b,z,k){this._state.updateState(b=b||"_geojsonTileLayer",z,k)}removeFeatureState(b,z,k){this._state.removeFeatureState(b=b||"_geojsonTileLayer",z,k)}getFeatureState(b,z){return this._state.getState(b=b||"_geojsonTileLayer",z)}setDependencies(b,z,k){let J=this._tiles[b];J&&J.setDependencies(z,k)}reloadTilesForDependencies(b,z){for(let k in this._tiles)this._tiles[k].hasDependency(b,z)&&this._reloadTile(k,"reloading");this._cache.filter((k)=>!k.hasDependency(b,z))}}function e0(b,z){let k=Math.abs(2*b.wrap)-+(b.wrap<0),J=Math.abs(2*z.wrap)-+(z.wrap<0);return b.overscaledZ-z.overscaledZ||J-k||z.canonical.y-b.canonical.y||z.canonical.x-b.canonical.x}function F5(b){return b==="raster"||b==="image"||b==="video"}M0.maxOverzooming=10,M0.maxUnderzooming=3;class m0{constructor(b,z){this.reset(b,z)}reset(b,z){this.points=b||[],this._distances=[0];for(let k=1;k<this.points.length;k++)this._distances[k]=this._distances[k-1]+this.points[k].dist(this.points[k-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(z||0,0.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(b){if(this.points.length===1)return this.points[0];b=Z.ae(b,0,1);let z=1,k=this._distances[z],J=b*this.paddedLength+this.padding;for(;k<J&&z<this._distances.length;)k=this._distances[++z];let B=z-1,X=this._distances[B],V=k-X,L=V>0?(J-X)/V:0;return this.points[B].mult(1-L).add(this.points[z].mult(L))}}function D0(b,z){let k=!0;return b==="always"||b!=="never"&&z!=="never"||(k=!1),k}class z5{constructor(b,z,k){let J=this.boxCells=[],B=this.circleCells=[];this.xCellCount=Math.ceil(b/k),this.yCellCount=Math.ceil(z/k);for(let X=0;X<this.xCellCount*this.yCellCount;X++)J.push([]),B.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=b,this.height=z,this.xScale=this.xCellCount/b,this.yScale=this.yCellCount/z,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(b,z,k,J,B){this._forEachCell(z,k,J,B,this._insertBoxCell,this.boxUid++),this.boxKeys.push(b),this.bboxes.push(z),this.bboxes.push(k),this.bboxes.push(J),this.bboxes.push(B)}insertCircle(b,z,k,J){this._forEachCell(z-J,k-J,z+J,k+J,this._insertCircleCell,this.circleUid++),this.circleKeys.push(b),this.circles.push(z),this.circles.push(k),this.circles.push(J)}_insertBoxCell(b,z,k,J,B,X){this.boxCells[B].push(X)}_insertCircleCell(b,z,k,J,B,X){this.circleCells[B].push(X)}_query(b,z,k,J,B,X,V){if(k<0||b>this.width||J<0||z>this.height)return[];let L=[];if(b<=0&&z<=0&&this.width<=k&&this.height<=J){if(B)return[{key:null,x1:b,y1:z,x2:k,y2:J}];for(let F=0;F<this.boxKeys.length;F++)L.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(let F=0;F<this.circleKeys.length;F++){let C=this.circles[3*F],O=this.circles[3*F+1],d=this.circles[3*F+2];L.push({key:this.circleKeys[F],x1:C-d,y1:O-d,x2:C+d,y2:O+d})}}else this._forEachCell(b,z,k,J,this._queryCell,L,{hitTest:B,overlapMode:X,seenUids:{box:{},circle:{}}},V);return L}query(b,z,k,J){return this._query(b,z,k,J,!1,null)}hitTest(b,z,k,J,B,X){return this._query(b,z,k,J,!0,B,X).length>0}hitTestCircle(b,z,k,J,B){let X=b-k,V=b+k,L=z-k,F=z+k;if(V<0||X>this.width||F<0||L>this.height)return!1;let C=[];return this._forEachCell(X,L,V,F,this._queryCellCircle,C,{hitTest:!0,overlapMode:J,circle:{x:b,y:z,radius:k},seenUids:{box:{},circle:{}}},B),C.length>0}_queryCell(b,z,k,J,B,X,V,L){let{seenUids:F,hitTest:C,overlapMode:O}=V,d=this.boxCells[B];if(d!==null){let T=this.bboxes;for(let E of d)if(!F.box[E]){F.box[E]=!0;let p=4*E,s=this.boxKeys[E];if(b<=T[p+2]&&z<=T[p+3]&&k>=T[p+0]&&J>=T[p+1]&&(!L||L(s))&&(!C||!D0(O,s.overlapMode))&&(X.push({key:s,x1:T[p],y1:T[p+1],x2:T[p+2],y2:T[p+3]}),C))return!0}}let y=this.circleCells[B];if(y!==null){let T=this.circles;for(let E of y)if(!F.circle[E]){F.circle[E]=!0;let p=3*E,s=this.circleKeys[E];if(this._circleAndRectCollide(T[p],T[p+1],T[p+2],b,z,k,J)&&(!L||L(s))&&(!C||!D0(O,s.overlapMode))){let c=T[p],Z1=T[p+1],a=T[p+2];if(X.push({key:s,x1:c-a,y1:Z1-a,x2:c+a,y2:Z1+a}),C)return!0}}}return!1}_queryCellCircle(b,z,k,J,B,X,V,L){let{circle:F,seenUids:C,overlapMode:O}=V,d=this.boxCells[B];if(d!==null){let T=this.bboxes;for(let E of d)if(!C.box[E]){C.box[E]=!0;let p=4*E,s=this.boxKeys[E];if(this._circleAndRectCollide(F.x,F.y,F.radius,T[p+0],T[p+1],T[p+2],T[p+3])&&(!L||L(s))&&!D0(O,s.overlapMode))return X.push(!0),!0}}let y=this.circleCells[B];if(y!==null){let T=this.circles;for(let E of y)if(!C.circle[E]){C.circle[E]=!0;let p=3*E,s=this.circleKeys[E];if(this._circlesCollide(T[p],T[p+1],T[p+2],F.x,F.y,F.radius)&&(!L||L(s))&&!D0(O,s.overlapMode))return X.push(!0),!0}}}_forEachCell(b,z,k,J,B,X,V,L){let F=this._convertToXCellCoord(b),C=this._convertToYCellCoord(z),O=this._convertToXCellCoord(k),d=this._convertToYCellCoord(J);for(let y=F;y<=O;y++)for(let T=C;T<=d;T++)if(B.call(this,b,z,k,J,this.xCellCount*T+y,X,V,L))return}_convertToXCellCoord(b){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(b*this.xScale)))}_convertToYCellCoord(b){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(b*this.yScale)))}_circlesCollide(b,z,k,J,B,X){let V=J-b,L=B-z,F=k+X;return F*F>V*V+L*L}_circleAndRectCollide(b,z,k,J,B,X,V){let L=(X-J)/2,F=Math.abs(b-(J+L));if(F>L+k)return!1;let C=(V-B)/2,O=Math.abs(z-(B+C));if(O>C+k)return!1;if(F<=L||O<=C)return!0;let d=F-L,y=O-C;return d*d+y*y<=k*k}}function L0(b,z,k){let J=Z.L();if(!b){let{vecSouth:d,vecEast:y}=w3(z),T=N();T[0]=y[0],T[1]=y[1],T[2]=d[0],T[3]=d[1],B=T,(O=(V=(X=T)[0])*(C=X[3])-(F=X[2])*(L=X[1]))&&(B[0]=C*(O=1/O),B[1]=-L*O,B[2]=-F*O,B[3]=V*O),J[0]=T[0],J[1]=T[1],J[4]=T[2],J[5]=T[3]}var B,X,V,L,F,C,O;return Z.N(J,J,[1/k,1/k,1]),J}function d1(b,z,k,J){if(b){let B=Z.L();if(!z){let{vecSouth:X,vecEast:V}=w3(k);B[0]=V[0],B[1]=V[1],B[4]=X[0],B[5]=X[1]}return Z.N(B,B,[J,J,1]),B}return k.pixelsToClipSpaceMatrix}function w3(b){let z=Math.cos(b.rollInRadians),k=Math.sin(b.rollInRadians),J=Math.cos(b.pitchInRadians),B=Math.cos(b.bearingInRadians),X=Math.sin(b.bearingInRadians),V=Z.ar();V[0]=-B*J*k-X*z,V[1]=-X*J*k+B*z;let L=Z.as(V);L<0.000000001?Z.at(V):Z.au(V,V,1/L);let F=Z.ar();F[0]=B*J*z-X*k,F[1]=X*J*z+B*k;let C=Z.as(F);return C<0.000000001?Z.at(F):Z.au(F,F,1/C),{vecEast:F,vecSouth:V}}function V5(b,z,k,J){let B;J?(B=[b,z,J(b,z),1],Z.aw(B,B,k)):(B=[b,z,0,1],$2(B,B,k));let X=B[3];return{point:new Z.P(B[0]/X,B[1]/X),signedDistanceFromCamera:X,isOccluded:!1}}function T2(b,z){return 0.5+b/z*0.5}function b3(b,z){return b.x>=-z[0]&&b.x<=z[0]&&b.y>=-z[1]&&b.y<=z[1]}function u1(b,z,k,J,B,X,V,L,F,C,O,d,y){let T=k?b.textSizeData:b.iconSizeData,E=Z.an(T,z.transform.zoom),p=[256/z.width*2+1,256/z.height*2+1],s=k?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;s.clear();let c=b.lineVertexArray,Z1=k?b.text.placedSymbolArray:b.icon.placedSymbolArray,a=z.transform.width/z.transform.height,x1=!1;for(let i=0;i<Z1.length;i++){let n=Z1.get(i);if(n.hidden||n.writingMode===Z.ao.vertical&&!x1){K4(n.numGlyphs,s);continue}x1=!1;let q1=new Z.P(n.anchorX,n.anchorY),V1={getElevation:y,pitchedLabelPlaneMatrix:J,lineVertexArray:c,pitchWithMap:X,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:z.transform,tileAnchorPoint:q1,unwrappedTileID:F,width:C,height:O,translation:d},W1=k6(n.anchorX,n.anchorY,V1);if(!b3(W1.point,p)){K4(n.numGlyphs,s);continue}let L1=T2(z.transform.cameraToCenterDistance,W1.signedDistanceFromCamera),Q1=Z.ap(T,E,n),O1=X?Q1*z.transform.getPitchedTextCorrection(n.anchorX,n.anchorY,F)/L1:Q1*L1,I1=L3({projectionContext:V1,pitchedLabelPlaneMatrixInverse:B,symbol:n,fontSize:O1,flip:!1,keepUpright:V,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:s,aspectRatio:a,rotateToLine:L});x1=I1.useVertical,(I1.notEnoughRoom||x1||I1.needsFlipping&&L3({projectionContext:V1,pitchedLabelPlaneMatrixInverse:B,symbol:n,fontSize:O1,flip:!0,keepUpright:V,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:s,aspectRatio:a,rotateToLine:L}).notEnoughRoom)&&K4(n.numGlyphs,s)}k?b.text.dynamicLayoutVertexBuffer.updateData(s):b.icon.dynamicLayoutVertexBuffer.updateData(s)}function R0(b,z,k,J,B,X,V,L){let F=X.glyphStartIndex+X.numGlyphs,C=X.lineStartIndex,O=X.lineStartIndex+X.lineLength,d=z.getoffsetX(X.glyphStartIndex),y=z.getoffsetX(F-1),T=M7(b*d,k,J,B,X.segment,C,O,L,V);if(!T)return null;let E=M7(b*y,k,J,B,X.segment,C,O,L,V);return E?L.projectionCache.anyProjectionOccluded?null:{first:T,last:E}:null}function l0(b,z,k,J){return b===Z.ao.horizontal&&Math.abs(k.y-z.y)>Math.abs(k.x-z.x)*J?{useVertical:!0}:(b===Z.ao.vertical?z.y<k.y:z.x>k.x)?{needsFlipping:!0}:null}function L3(b){let{projectionContext:z,pitchedLabelPlaneMatrixInverse:k,symbol:J,fontSize:B,flip:X,keepUpright:V,glyphOffsetArray:L,dynamicLayoutVertexArray:F,aspectRatio:C,rotateToLine:O}=b,d=B/24,y=J.lineOffsetX*d,T=J.lineOffsetY*d,E;if(J.numGlyphs>1){let p=J.glyphStartIndex+J.numGlyphs,s=J.lineStartIndex,c=J.lineStartIndex+J.lineLength,Z1=R0(d,L,y,T,X,J,O,z);if(!Z1)return{notEnoughRoom:!0};let a=A7(Z1.first.point.x,Z1.first.point.y,z,k),x1=A7(Z1.last.point.x,Z1.last.point.y,z,k);if(V&&!X){let i=l0(J.writingMode,a,x1,C);if(i)return i}E=[Z1.first];for(let i=J.glyphStartIndex+1;i<p-1;i++){let n=M7(d*L.getoffsetX(i),y,T,X,J.segment,s,c,z,O);if(!n)return{notEnoughRoom:!0};E.push(n)}E.push(Z1.last)}else{if(V&&!X){let s=X0(z.tileAnchorPoint.x,z.tileAnchorPoint.y,z).point,c=J.lineStartIndex+J.segment+1,Z1=new Z.P(z.lineVertexArray.getx(c),z.lineVertexArray.gety(c)),a=X0(Z1.x,Z1.y,z),x1=a.signedDistanceFromCamera>0?a.point:Q8(z.tileAnchorPoint,Z1,s,1,z),i=A7(s.x,s.y,z,k),n=A7(x1.x,x1.y,z,k),q1=l0(J.writingMode,i,n,C);if(q1)return q1}let p=M7(d*L.getoffsetX(J.glyphStartIndex),y,T,X,J.segment,J.lineStartIndex,J.lineStartIndex+J.lineLength,z,O);if(!p||z.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};E=[p]}for(let p of E)Z.av(F,p.point,p.angle);return{}}function Q8(b,z,k,J,B){let X=b.add(b.sub(z)._unit()),V=X0(X.x,X.y,B).point,L=k.sub(V);return k.add(L._mult(J/L.mag()))}function F4(b,z,k){let J=z.projectionCache;if(J.projections[b])return J.projections[b];let B=new Z.P(z.lineVertexArray.getx(b),z.lineVertexArray.gety(b)),X=X0(B.x,B.y,z);if(X.signedDistanceFromCamera>0)return J.projections[b]=X.point,J.anyProjectionOccluded=J.anyProjectionOccluded||X.isOccluded,X.point;let V=b-k.direction;return Q8(k.distanceFromAnchor===0?z.tileAnchorPoint:new Z.P(z.lineVertexArray.getx(V),z.lineVertexArray.gety(V)),B,k.previousVertex,k.absOffsetX-k.distanceFromAnchor+1,z)}function X0(b,z,k){let J=b+k.translation[0],B=z+k.translation[1],X;return k.pitchWithMap?(X=V5(J,B,k.pitchedLabelPlaneMatrix,k.getElevation),X.isOccluded=!1):(X=k.transform.projectTileCoordinates(J,B,k.unwrappedTileID,k.getElevation),X.point.x=(0.5*X.point.x+0.5)*k.width,X.point.y=(0.5*-X.point.y+0.5)*k.height),X}function A7(b,z,k,J){if(k.pitchWithMap){let B=[b,z,0,1];return Z.aw(B,B,J),k.transform.projectTileCoordinates(B[0]/B[3],B[1]/B[3],k.unwrappedTileID,k.getElevation).point}return{x:b/k.width*2-1,y:1-z/k.height*2}}function k6(b,z,k){return k.transform.projectTileCoordinates(b,z,k.unwrappedTileID,k.getElevation)}function v6(b,z,k){return b._unit()._perp()._mult(z*k)}function V8(b,z,k,J,B,X,V,L,F){if(L.projectionCache.offsets[b])return L.projectionCache.offsets[b];let C=k.add(z);if(b+F.direction<J||b+F.direction>=B)return L.projectionCache.offsets[b]=C,C;let O=F4(b+F.direction,L,F),d=v6(O.sub(k),V,F.direction),y=k.add(d),T=O.add(d);return L.projectionCache.offsets[b]=Z.ax(X,C,y,T)||C,L.projectionCache.offsets[b]}function M7(b,z,k,J,B,X,V,L,F){let C=J?b-z:b+z,O=C>0?1:-1,d=0;J&&(O*=-1,d=Math.PI),O<0&&(d+=Math.PI);let y,T=O>0?X+B:X+B+1;L.projectionCache.cachedAnchorPoint?y=L.projectionCache.cachedAnchorPoint:(y=X0(L.tileAnchorPoint.x,L.tileAnchorPoint.y,L).point,L.projectionCache.cachedAnchorPoint=y);let E,p,s=y,c=y,Z1=0,a=0,x1=Math.abs(C),i=[],n;for(;Z1+a<=x1;){if(T+=O,T<X||T>=V)return null;Z1+=a,c=s,p=E;let W1={absOffsetX:x1,direction:O,distanceFromAnchor:Z1,previousVertex:c};if(s=F4(T,L,W1),k===0)i.push(c),n=s.sub(c);else{let L1,Q1=s.sub(c);L1=Q1.mag()===0?v6(F4(T+O,L,W1).sub(s),k,O):v6(Q1,k,O),p||(p=c.add(L1)),E=V8(T,L1,s,X,V,p,k,L,W1),i.push(p),n=E.sub(p)}a=n.mag()}let q1=n._mult((x1-Z1)/a)._add(p||c),V1=d+Math.atan2(s.y-c.y,s.x-c.x);return i.push(q1),{point:q1,angle:F?V1:0,path:i}}let L8=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function K4(b,z){for(let k=0;k<b;k++){let J=z.length;z.resize(J+4),z.float32.set(L8,3*J)}}function $2(b,z,k){let J=z[0],B=z[1];return b[0]=k[0]*J+k[4]*B+k[12],b[1]=k[1]*J+k[5]*B+k[13],b[3]=k[3]*J+k[7]*B+k[15],b}let N0=100;class kz{constructor(b,z=new z5(b.width+200,b.height+200,25),k=new z5(b.width+200,b.height+200,25)){this.transform=b,this.grid=z,this.ignoredGrid=k,this.pitchFactor=Math.cos(b.pitch*Math.PI/180)*b.cameraToCenterDistance,this.screenRightBoundary=b.width+N0,this.screenBottomBoundary=b.height+N0,this.gridRightBoundary=b.width+200,this.gridBottomBoundary=b.height+200,this.perspectiveRatioCutoff=0.6}placeCollisionBox(b,z,k,J,B,X,V,L,F,C,O,d){let y=this.projectAndGetPerspectiveRatio(b.anchorPointX+L[0],b.anchorPointY+L[1],B,C,d),T=k*y.perspectiveRatio,E;if(X||V)E=this._projectCollisionBox(b,T,J,B,X,V,L,y,C,O,d);else{let i=y.x+(O?O.x*T:0),n=y.y+(O?O.y*T:0);E={allPointsOccluded:!1,box:[i+b.x1*T,n+b.y1*T,i+b.x2*T,n+b.y2*T]}}let[p,s,c,Z1]=E.box,a=X?E.allPointsOccluded:y.isOccluded,x1=a;return x1||(x1=y.perspectiveRatio<this.perspectiveRatioCutoff),x1||(x1=!this.isInsideGrid(p,s,c,Z1)),x1||z!=="always"&&this.grid.hitTest(p,s,c,Z1,z,F)?{box:[p,s,c,Z1],placeable:!1,offscreen:!1,occluded:a}:{box:[p,s,c,Z1],placeable:!0,offscreen:this.isOffscreen(p,s,c,Z1),occluded:a}}placeCollisionCircles(b,z,k,J,B,X,V,L,F,C,O,d,y,T){let E=[],p=new Z.P(z.anchorX,z.anchorY),s=this.getPerspectiveRatio(p.x,p.y,X,T),c=(F?B*this.transform.getPitchedTextCorrection(z.anchorX,z.anchorY,X)/s:B*s)/Z.aB,Z1={getElevation:T,pitchedLabelPlaneMatrix:V,lineVertexArray:k,pitchWithMap:F,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:p,unwrappedTileID:X,width:this.transform.width,height:this.transform.height,translation:y},a=R0(c,J,z.lineOffsetX*c,z.lineOffsetY*c,!1,z,!1,Z1),x1=!1,i=!1,n=!0;if(a){let q1=0.5*O*s+d,V1=new Z.P(-100,-100),W1=new Z.P(this.screenRightBoundary,this.screenBottomBoundary),L1=new m0,Q1=a.first,O1=a.last,I1=[];for(let B0=Q1.path.length-1;B0>=1;B0--)I1.push(Q1.path[B0]);for(let B0=1;B0<O1.path.length;B0++)I1.push(O1.path[B0]);let D1=2.5*q1;if(F){let B0=this.projectPathToScreenSpace(I1,Z1);I1=B0.some((W0)=>W0.signedDistanceFromCamera<=0)?[]:B0.map((W0)=>W0.point)}let n1=[];if(I1.length>0){let B0=I1[0].clone(),W0=I1[0].clone();for(let q5=1;q5<I1.length;q5++)B0.x=Math.min(B0.x,I1[q5].x),B0.y=Math.min(B0.y,I1[q5].y),W0.x=Math.max(W0.x,I1[q5].x),W0.y=Math.max(W0.y,I1[q5].y);n1=B0.x>=V1.x&&W0.x<=W1.x&&B0.y>=V1.y&&W0.y<=W1.y?[I1]:W0.x<V1.x||B0.x>W1.x||W0.y<V1.y||B0.y>W1.y?[]:Z.ay([I1],V1.x,V1.y,W1.x,W1.y)}for(let B0 of n1){L1.reset(B0,0.25*q1);let W0=0;W0=L1.length<=0.5*q1?1:Math.ceil(L1.paddedLength/D1)+1;for(let q5=0;q5<W0;q5++){let f5=q5/Math.max(W0-1,1),$5=L1.lerp(f5),V0=$5.x+N0,c5=$5.y+N0;E.push(V0,c5,q1,0);let A5=V0-q1,h2=c5-q1,N5=V0+q1,j5=c5+q1;if(n=n&&this.isOffscreen(A5,h2,N5,j5),i=i||this.isInsideGrid(A5,h2,N5,j5),b!=="always"&&this.grid.hitTestCircle(V0,c5,q1,b,C)&&(x1=!0,!L))return{circles:[],offscreen:!1,collisionDetected:x1}}}}return{circles:!L&&x1||!i||s<this.perspectiveRatioCutoff?[]:E,offscreen:n,collisionDetected:x1}}projectPathToScreenSpace(b,z){let k=function(J,B){let X=Z.L();return Z.aq(X,B.pitchedLabelPlaneMatrix),J.map((V)=>{let L=V5(V.x,V.y,X,B.getElevation),F=B.transform.projectTileCoordinates(L.point.x,L.point.y,B.unwrappedTileID,B.getElevation);return F.point.x=(0.5*F.point.x+0.5)*B.width,F.point.y=(0.5*-F.point.y+0.5)*B.height,F})}(b,z);return function(J){let B=0,X=0,V=0,L=0;for(let F=0;F<J.length;F++)J[F].isOccluded?(V=F+1,L=0):(L++,L>X&&(X=L,B=V));return J.slice(B,B+X)}(k)}queryRenderedSymbols(b){if(b.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let z=[],k=new Z.a2;for(let O of b){let d=new Z.P(O.x+N0,O.y+N0);k.extend(d),z.push(d)}let{minX:J,minY:B,maxX:X,maxY:V}=k,L=this.grid.query(J,B,X,V).concat(this.ignoredGrid.query(J,B,X,V)),F={},C={};for(let O of L){let d=O.key;if(F[d.bucketInstanceId]===void 0&&(F[d.bucketInstanceId]={}),F[d.bucketInstanceId][d.featureIndex])continue;let y=[new Z.P(O.x1,O.y1),new Z.P(O.x2,O.y1),new Z.P(O.x2,O.y2),new Z.P(O.x1,O.y2)];Z.az(z,y)&&(F[d.bucketInstanceId][d.featureIndex]=!0,C[d.bucketInstanceId]===void 0&&(C[d.bucketInstanceId]=[]),C[d.bucketInstanceId].push(d.featureIndex))}return C}insertCollisionBox(b,z,k,J,B,X){(k?this.ignoredGrid:this.grid).insert({bucketInstanceId:J,featureIndex:B,collisionGroupID:X,overlapMode:z},b[0],b[1],b[2],b[3])}insertCollisionCircles(b,z,k,J,B,X){let V=k?this.ignoredGrid:this.grid,L={bucketInstanceId:J,featureIndex:B,collisionGroupID:X,overlapMode:z};for(let F=0;F<b.length;F+=4)V.insertCircle(L,b[F],b[F+1],b[F+2])}projectAndGetPerspectiveRatio(b,z,k,J,B){if(B){let X;J?(X=[b,z,J(b,z),1],Z.aw(X,X,B)):(X=[b,z,0,1],$2(X,X,B));let V=X[3];return{x:(X[0]/V+1)/2*this.transform.width+N0,y:(-X[1]/V+1)/2*this.transform.height+N0,perspectiveRatio:0.5+this.transform.cameraToCenterDistance/V*0.5,isOccluded:!1,signedDistanceFromCamera:V}}{let X=this.transform.projectTileCoordinates(b,z,k,J);return{x:(X.point.x+1)/2*this.transform.width+N0,y:(1-X.point.y)/2*this.transform.height+N0,perspectiveRatio:0.5+this.transform.cameraToCenterDistance/X.signedDistanceFromCamera*0.5,isOccluded:X.isOccluded,signedDistanceFromCamera:X.signedDistanceFromCamera}}}getPerspectiveRatio(b,z,k,J){let B=this.transform.projectTileCoordinates(b,z,k,J);return 0.5+this.transform.cameraToCenterDistance/B.signedDistanceFromCamera*0.5}isOffscreen(b,z,k,J){return k<N0||b>=this.screenRightBoundary||J<N0||z>this.screenBottomBoundary}isInsideGrid(b,z,k,J){return k>=0&&b<this.gridRightBoundary&&J>=0&&z<this.gridBottomBoundary}getViewportMatrix(){let b=Z.ai([]);return Z.M(b,b,[-100,-100,0]),b}_projectCollisionBox(b,z,k,J,B,X,V,L,F,C,O){let d=1,y=0,T=0,E=1,p=b.anchorPointX+V[0],s=b.anchorPointY+V[1];if(X&&!B){let I1=this.projectAndGetPerspectiveRatio(p+1,s,J,F,O),D1=I1.x-L.x,n1=Math.atan((I1.y-L.y)/D1)+(D1<0?Math.PI:0),B0=Math.sin(n1),W0=Math.cos(n1);d=W0,y=B0,T=-B0,E=W0}else if(!X&&B){let I1=w3(this.transform);d=I1.vecEast[0],y=I1.vecEast[1],T=I1.vecSouth[0],E=I1.vecSouth[1]}let{x:c,y:Z1}=L,a=z;B&&(c=p,Z1=s,a=Math.pow(2,-(this.transform.zoom-k.overscaledZ)),a*=this.transform.getPitchedTextCorrection(p,s,J),C||(a*=Z.ae(0.5+L.signedDistanceFromCamera/this.transform.cameraToCenterDistance*0.5,0,4))),C&&(c+=d*C.x*a+T*C.y*a,Z1+=y*C.x*a+E*C.y*a);let x1=b.x1*a,i=b.x2*a,n=(x1+i)/2,q1=b.y1*a,V1=b.y2*a,W1=(q1+V1)/2,L1=[{offsetX:x1,offsetY:q1},{offsetX:n,offsetY:q1},{offsetX:i,offsetY:q1},{offsetX:i,offsetY:W1},{offsetX:i,offsetY:V1},{offsetX:n,offsetY:V1},{offsetX:x1,offsetY:V1},{offsetX:x1,offsetY:W1}],Q1=[];for(let{offsetX:I1,offsetY:D1}of L1)Q1.push(new Z.P(c+d*I1+T*D1,Z1+y*I1+E*D1));let O1=!1;if(B){let I1=Q1.map((D1)=>this.projectAndGetPerspectiveRatio(D1.x,D1.y,J,F,O));O1=I1.some((D1)=>!D1.isOccluded),Q1=I1.map((D1)=>new Z.P(D1.x,D1.y))}else O1=!0;return{box:Z.aA(Q1),allPointsOccluded:!O1}}}class X7{constructor(b,z,k,J){this.opacity=b?Math.max(0,Math.min(1,b.opacity+(b.placed?z:-z))):J&&k?1:0,this.placed=k}isHidden(){return this.opacity===0&&!this.placed}}class a4{constructor(b,z,k,J,B){this.text=new X7(b?b.text:null,z,k,B),this.icon=new X7(b?b.icon:null,z,J,B)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class l4{constructor(b,z,k){this.text=b,this.icon=z,this.skipFade=k}}class C4{constructor(b,z,k,J,B){this.bucketInstanceId=b,this.featureIndex=z,this.sourceLayerIndex=k,this.bucketIndex=J,this.tileID=B}}class Sb{constructor(b){this.crossSourceCollisions=b,this.maxGroupID=0,this.collisionGroups={}}get(b){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[b]){let z=++this.maxGroupID;this.collisionGroups[b]={ID:z,predicate:(k)=>k.collisionGroupID===z}}return this.collisionGroups[b]}}function Tb(b,z,k,J,B){let{horizontalAlign:X,verticalAlign:V}=Z.aH(b);return new Z.P(-(X-0.5)*z+J[0]*B,-(V-0.5)*k+J[1]*B)}class $b{constructor(b,z,k,J,B){this.transform=b.clone(),this.terrain=z,this.collisionIndex=new kz(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=k,this.retainedQueryData={},this.collisionGroups=new Sb(J),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=B,B&&(B.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(b){let z=this.terrain;return z?(k,J)=>z.getElevation(b,k,J):null}getBucketParts(b,z,k,J){let B=k.getBucket(z),X=k.latestFeatureIndex;if(!B||!X||z.id!==B.layerIds[0])return;let V=k.collisionBoxArray,L=B.layers[0].layout,F=B.layers[0].paint,C=Math.pow(2,this.transform.zoom-k.tileID.overscaledZ),O=k.tileSize/Z.$,d=k.tileID.toUnwrapped(),y=L.get("text-rotation-alignment")==="map",T=Z.aC(k,1,this.transform.zoom),E=Z.aD(this.collisionIndex.transform,k,F.get("text-translate"),F.get("text-translate-anchor")),p=Z.aD(this.collisionIndex.transform,k,F.get("icon-translate"),F.get("icon-translate-anchor")),s=L0(y,this.transform,T);this.retainedQueryData[B.bucketInstanceId]=new C4(B.bucketInstanceId,X,B.sourceLayerIndex,B.index,k.tileID);let c={bucket:B,layout:L,translationText:E,translationIcon:p,unwrappedTileID:d,pitchedLabelPlaneMatrix:s,scale:C,textPixelRatio:O,holdingForFade:k.holdingForSymbolFade(),collisionBoxArray:V,partiallyEvaluatedTextSize:Z.an(B.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(B.sourceID)};if(J)for(let Z1 of B.sortKeyRanges){let{sortKey:a,symbolInstanceStart:x1,symbolInstanceEnd:i}=Z1;b.push({sortKey:a,symbolInstanceStart:x1,symbolInstanceEnd:i,parameters:c})}else b.push({symbolInstanceStart:0,symbolInstanceEnd:B.symbolInstances.length,parameters:c})}attemptAnchorPlacement(b,z,k,J,B,X,V,L,F,C,O,d,y,T,E,p,s,c,Z1,a){let x1=Z.aE[b.textAnchor],i=[b.textOffset0,b.textOffset1],n=Tb(x1,k,J,i,B),q1=this.collisionIndex.placeCollisionBox(z,d,L,F,C,V,X,p,O.predicate,Z1,n,a);if((!c||this.collisionIndex.placeCollisionBox(c,d,L,F,C,V,X,s,O.predicate,Z1,n,a).placeable)&&q1.placeable){let V1;if(this.prevPlacement&&this.prevPlacement.variableOffsets[y.crossTileID]&&this.prevPlacement.placements[y.crossTileID]&&this.prevPlacement.placements[y.crossTileID].text&&(V1=this.prevPlacement.variableOffsets[y.crossTileID].anchor),y.crossTileID===0)throw Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[y.crossTileID]={textOffset:i,width:k,height:J,anchor:x1,textBoxScale:B,prevAnchor:V1},this.markUsedJustification(T,x1,y,E),T.allowVerticalPlacement&&(this.markUsedOrientation(T,E,y),this.placedOrientations[y.crossTileID]=E),{shift:n,placedGlyphBoxes:q1}}}placeLayerBucketPart(b,z,k){let{bucket:J,layout:B,translationText:X,translationIcon:V,unwrappedTileID:L,pitchedLabelPlaneMatrix:F,textPixelRatio:C,holdingForFade:O,collisionBoxArray:d,partiallyEvaluatedTextSize:y,collisionGroup:T}=b.parameters,E=B.get("text-optional"),p=B.get("icon-optional"),s=Z.aF(B,"text-overlap","text-allow-overlap"),c=s==="always",Z1=Z.aF(B,"icon-overlap","icon-allow-overlap"),a=Z1==="always",x1=B.get("text-rotation-alignment")==="map",i=B.get("text-pitch-alignment")==="map",n=B.get("icon-text-fit")!=="none",q1=B.get("symbol-z-order")==="viewport-y",V1=c&&(a||!J.hasIconData()||p),W1=a&&(c||!J.hasTextData()||E);!J.collisionArrays&&d&&J.deserializeCollisionBoxes(d);let L1=this.retainedQueryData[J.bucketInstanceId].tileID,Q1=this._getTerrainElevationFunc(L1),O1=this.transform.getFastPathSimpleProjectionMatrix(L1),I1=(D1,n1,B0)=>{var W0,q5;if(z[D1.crossTileID])return;if(O)return void(this.placements[D1.crossTileID]=new l4(!1,!1,!1));let f5=!1,$5=!1,V0=!0,c5=null,A5={box:null,placeable:!1,offscreen:null,occluded:!1},h2={placeable:!1},N5=null,j5=null,f3=null,l3=0,T7=0,$7=0;n1.textFeatureIndex?l3=n1.textFeatureIndex:D1.useRuntimeCollisionCircles&&(l3=D1.featureIndex),n1.verticalTextFeatureIndex&&(T7=n1.verticalTextFeatureIndex);let R4=n1.textBox;if(R4){let P2=(x2)=>{let m5=Z.ao.horizontal;if(J.allowVerticalPlacement&&!x2&&this.prevPlacement){let u2=this.prevPlacement.placedOrientations[D1.crossTileID];u2&&(this.placedOrientations[D1.crossTileID]=u2,m5=u2,this.markUsedOrientation(J,m5,D1))}return m5},H3=(x2,m5)=>{if(J.allowVerticalPlacement&&D1.numVerticalGlyphVertices>0&&n1.verticalTextBox){for(let u2 of J.writingModes)if(u2===Z.ao.vertical?(A5=m5(),h2=A5):A5=x2(),A5&&A5.placeable)break}else A5=x2()},E2=D1.textAnchorOffsetStartIndex,N4=D1.textAnchorOffsetEndIndex;if(N4===E2){let x2=(m5,u2)=>{let a5=this.collisionIndex.placeCollisionBox(m5,s,C,L1,L,i,x1,X,T.predicate,Q1,void 0,O1);return a5&&a5.placeable&&(this.markUsedOrientation(J,u2,D1),this.placedOrientations[D1.crossTileID]=u2),a5};H3(()=>x2(R4,Z.ao.horizontal),()=>{let m5=n1.verticalTextBox;return J.allowVerticalPlacement&&D1.numVerticalGlyphVertices>0&&m5?x2(m5,Z.ao.vertical):{box:null,offscreen:null}}),P2(A5&&A5.placeable)}else{let x2=Z.aE[(q5=(W0=this.prevPlacement)===null||W0===void 0?void 0:W0.variableOffsets[D1.crossTileID])===null||q5===void 0?void 0:q5.anchor],m5=(a5,f7,z7)=>{let J4=a5.x2-a5.x1,C3=a5.y2-a5.y1,I4=D1.textBoxScale,Cg=n&&Z1==="never"?f7:null,S4=null,Vw=s==="never"?1:2,T4="never";x2&&Vw++;for(let qx=0;qx<Vw;qx++){for(let Lw=E2;Lw<N4;Lw++){let Ww=J.textAnchorOffsets.get(Lw);if(x2&&Ww.textAnchor!==x2)continue;let hw=this.attemptAnchorPlacement(Ww,a5,J4,C3,I4,x1,i,C,L1,L,T,T4,D1,J,z7,X,V,Cg,Q1);if(hw&&(S4=hw.placedGlyphBoxes,S4&&S4.placeable))return f5=!0,c5=hw.shift,S4}x2?x2=null:T4=s}return k&&!S4&&(S4={box:this.collisionIndex.placeCollisionBox(R4,"always",C,L1,L,i,x1,X,T.predicate,Q1,void 0,O1).box,offscreen:!1,placeable:!1,occluded:!1}),S4};H3(()=>m5(R4,n1.iconBox,Z.ao.horizontal),()=>{let a5=n1.verticalTextBox;return J.allowVerticalPlacement&&(!A5||!A5.placeable)&&D1.numVerticalGlyphVertices>0&&a5?m5(a5,n1.verticalIconBox,Z.ao.vertical):{box:null,occluded:!0,offscreen:null}}),A5&&(f5=A5.placeable,V0=A5.offscreen);let u2=P2(A5&&A5.placeable);if(!f5&&this.prevPlacement){let a5=this.prevPlacement.variableOffsets[D1.crossTileID];a5&&(this.variableOffsets[D1.crossTileID]=a5,this.markUsedJustification(J,a5.anchor,D1,u2))}}}if(N5=A5,f5=N5&&N5.placeable,V0=N5&&N5.offscreen,D1.useRuntimeCollisionCircles&&D1.centerJustifiedTextSymbolIndex>=0){let P2=J.text.placedSymbolArray.get(D1.centerJustifiedTextSymbolIndex),H3=Z.ap(J.textSizeData,y,P2),E2=B.get("text-padding");j5=this.collisionIndex.placeCollisionCircles(s,P2,J.lineVertexArray,J.glyphOffsetArray,H3,L,F,k,i,T.predicate,D1.collisionCircleDiameter,E2,X,Q1),j5.circles.length&&j5.collisionDetected&&!k&&Z.w("Collisions detected, but collision boxes are not shown"),f5=c||j5.circles.length>0&&!j5.collisionDetected,V0=V0&&j5.offscreen}if(n1.iconFeatureIndex&&($7=n1.iconFeatureIndex),n1.iconBox){let P2=(H3)=>this.collisionIndex.placeCollisionBox(H3,Z1,C,L1,L,i,x1,V,T.predicate,Q1,n&&c5?c5:void 0,O1);h2&&h2.placeable&&n1.verticalIconBox?(f3=P2(n1.verticalIconBox),$5=f3.placeable):(f3=P2(n1.iconBox),$5=f3.placeable),V0=V0&&f3.offscreen}let T6=E||D1.numHorizontalGlyphVertices===0&&D1.numVerticalGlyphVertices===0,j7=p||D1.numIconVertices===0;T6||j7?j7?T6||($5=$5&&f5):f5=$5&&f5:$5=f5=$5&&f5;let Qw=$5&&f3.placeable;if(f5&&N5.placeable&&this.collisionIndex.insertCollisionBox(N5.box,s,B.get("text-ignore-placement"),J.bucketInstanceId,h2&&h2.placeable&&T7?T7:l3,T.ID),Qw&&this.collisionIndex.insertCollisionBox(f3.box,Z1,B.get("icon-ignore-placement"),J.bucketInstanceId,$7,T.ID),j5&&f5&&this.collisionIndex.insertCollisionCircles(j5.circles,s,B.get("text-ignore-placement"),J.bucketInstanceId,l3,T.ID),k&&this.storeCollisionData(J.bucketInstanceId,B0,n1,N5,f3,j5),D1.crossTileID===0)throw Error("symbolInstance.crossTileID can't be 0");if(J.bucketInstanceId===0)throw Error("bucket.bucketInstanceId can't be 0");this.placements[D1.crossTileID]=new l4((f5||V1)&&!(N5==null?void 0:N5.occluded),($5||W1)&&!(f3==null?void 0:f3.occluded),V0||J.justReloaded),z[D1.crossTileID]=!0};if(q1){if(b.symbolInstanceStart!==0)throw Error("bucket.bucketInstanceId should be 0");let D1=J.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let n1=D1.length-1;n1>=0;--n1){let B0=D1[n1];I1(J.symbolInstances.get(B0),J.collisionArrays[B0],B0)}}else for(let D1=b.symbolInstanceStart;D1<b.symbolInstanceEnd;D1++)I1(J.symbolInstances.get(D1),J.collisionArrays[D1],D1);J.justReloaded=!1}storeCollisionData(b,z,k,J,B,X){if(k.textBox||k.iconBox){let V,L;this.collisionBoxArrays.has(b)?V=this.collisionBoxArrays.get(b):(V=new Map,this.collisionBoxArrays.set(b,V)),V.has(z)?L=V.get(z):(L={text:null,icon:null},V.set(z,L)),k.textBox&&(L.text=J.box),k.iconBox&&(L.icon=B.box)}if(X){let V=this.collisionCircleArrays[b];V===void 0&&(V=this.collisionCircleArrays[b]=[]);for(let L=0;L<X.circles.length;L+=4)V.push(X.circles[L+0]-N0),V.push(X.circles[L+1]-N0),V.push(X.circles[L+2]),V.push(X.collisionDetected?1:0)}}markUsedJustification(b,z,k,J){let B;B=J===Z.ao.vertical?k.verticalPlacedTextSymbolIndex:{left:k.leftJustifiedTextSymbolIndex,center:k.centerJustifiedTextSymbolIndex,right:k.rightJustifiedTextSymbolIndex}[Z.aG(z)];let X=[k.leftJustifiedTextSymbolIndex,k.centerJustifiedTextSymbolIndex,k.rightJustifiedTextSymbolIndex,k.verticalPlacedTextSymbolIndex];for(let V of X)V>=0&&(b.text.placedSymbolArray.get(V).crossTileID=B>=0&&V!==B?0:k.crossTileID)}markUsedOrientation(b,z,k){let J=z===Z.ao.horizontal||z===Z.ao.horizontalOnly?z:0,B=z===Z.ao.vertical?z:0,X=[k.leftJustifiedTextSymbolIndex,k.centerJustifiedTextSymbolIndex,k.rightJustifiedTextSymbolIndex];for(let V of X)b.text.placedSymbolArray.get(V).placedOrientation=J;k.verticalPlacedTextSymbolIndex&&(b.text.placedSymbolArray.get(k.verticalPlacedTextSymbolIndex).placedOrientation=B)}commit(b){this.commitTime=b,this.zoomAtLastRecencyCheck=this.transform.zoom;let z=this.prevPlacement,k=!1;this.prevZoomAdjustment=z?z.zoomAdjustment(this.transform.zoom):0;let J=z?z.symbolFadeChange(b):1,B=z?z.opacities:{},X=z?z.variableOffsets:{},V=z?z.placedOrientations:{};for(let L in this.placements){let F=this.placements[L],C=B[L];C?(this.opacities[L]=new a4(C,J,F.text,F.icon),k=k||F.text!==C.text.placed||F.icon!==C.icon.placed):(this.opacities[L]=new a4(null,J,F.text,F.icon,F.skipFade),k=k||F.text||F.icon)}for(let L in B){let F=B[L];if(!this.opacities[L]){let C=new a4(F,J,!1,!1);C.isHidden()||(this.opacities[L]=C,k=k||F.text.placed||F.icon.placed)}}for(let L in X)this.variableOffsets[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.variableOffsets[L]=X[L]);for(let L in V)this.placedOrientations[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.placedOrientations[L]=V[L]);if(z&&z.lastPlacementChangeTime===void 0)throw Error("Last placement time for previous placement is not defined");k?this.lastPlacementChangeTime=b:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=z?z.lastPlacementChangeTime:b)}updateLayerOpacities(b,z){let k={};for(let J of z){let B=J.getBucket(b);B&&J.latestFeatureIndex&&b.id===B.layerIds[0]&&this.updateBucketOpacities(B,J.tileID,k,J.collisionBoxArray)}}updateBucketOpacities(b,z,k,J){b.hasTextData()&&(b.text.opacityVertexArray.clear(),b.text.hasVisibleVertices=!1),b.hasIconData()&&(b.icon.opacityVertexArray.clear(),b.icon.hasVisibleVertices=!1),b.hasIconCollisionBoxData()&&b.iconCollisionBox.collisionVertexArray.clear(),b.hasTextCollisionBoxData()&&b.textCollisionBox.collisionVertexArray.clear();let B=b.layers[0],X=B.layout,V=new a4(null,0,!1,!1,!0),L=X.get("text-allow-overlap"),F=X.get("icon-allow-overlap"),C=B._unevaluatedLayout.hasValue("text-variable-anchor")||B._unevaluatedLayout.hasValue("text-variable-anchor-offset"),O=X.get("text-rotation-alignment")==="map",d=X.get("text-pitch-alignment")==="map",y=X.get("icon-text-fit")!=="none",T=new a4(null,0,L&&(F||!b.hasIconData()||X.get("icon-optional")),F&&(L||!b.hasTextData()||X.get("text-optional")),!0);!b.collisionArrays&&J&&(b.hasIconCollisionBoxData()||b.hasTextCollisionBoxData())&&b.deserializeCollisionBoxes(J);let E=(s,c,Z1)=>{for(let a=0;a<c/4;a++)s.opacityVertexArray.emplaceBack(Z1);s.hasVisibleVertices=s.hasVisibleVertices||Z1!==J6},p=this.collisionBoxArrays.get(b.bucketInstanceId);for(let s=0;s<b.symbolInstances.length;s++){let c=b.symbolInstances.get(s),{numHorizontalGlyphVertices:Z1,numVerticalGlyphVertices:a,crossTileID:x1}=c,i=this.opacities[x1];k[x1]?i=V:i||(i=T,this.opacities[x1]=i),k[x1]=!0;let n=c.numIconVertices>0,q1=this.placedOrientations[c.crossTileID],V1=q1===Z.ao.vertical,W1=q1===Z.ao.horizontal||q1===Z.ao.horizontalOnly;if(Z1>0||a>0){let Q1=T9(i.text);E(b.text,Z1,V1?J6:Q1),E(b.text,a,W1?J6:Q1);let O1=i.text.isHidden();[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach((n1)=>{n1>=0&&(b.text.placedSymbolArray.get(n1).hidden=O1||V1?1:0)}),c.verticalPlacedTextSymbolIndex>=0&&(b.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).hidden=O1||W1?1:0);let I1=this.variableOffsets[c.crossTileID];I1&&this.markUsedJustification(b,I1.anchor,c,q1);let D1=this.placedOrientations[c.crossTileID];D1&&(this.markUsedJustification(b,"left",c,D1),this.markUsedOrientation(b,D1,c))}if(n){let Q1=T9(i.icon),O1=!(y&&c.verticalPlacedIconSymbolIndex&&V1);c.placedIconSymbolIndex>=0&&(E(b.icon,c.numIconVertices,O1?Q1:J6),b.icon.placedSymbolArray.get(c.placedIconSymbolIndex).hidden=i.icon.isHidden()),c.verticalPlacedIconSymbolIndex>=0&&(E(b.icon,c.numVerticalIconVertices,O1?J6:Q1),b.icon.placedSymbolArray.get(c.verticalPlacedIconSymbolIndex).hidden=i.icon.isHidden())}let L1=p&&p.has(s)?p.get(s):{text:null,icon:null};if(b.hasIconCollisionBoxData()||b.hasTextCollisionBoxData()){let Q1=b.collisionArrays[s];if(Q1){let O1=new Z.P(0,0);if(Q1.textBox||Q1.verticalTextBox){let I1=!0;if(C){let D1=this.variableOffsets[x1];D1?(O1=Tb(D1.anchor,D1.width,D1.height,D1.textOffset,D1.textBoxScale),O&&O1._rotate(d?-this.transform.bearingInRadians:this.transform.bearingInRadians)):I1=!1}if(Q1.textBox||Q1.verticalTextBox){let D1;Q1.textBox&&(D1=V1),Q1.verticalTextBox&&(D1=W1),Q7(b.textCollisionBox.collisionVertexArray,i.text.placed,!I1||D1,L1.text,O1.x,O1.y)}}if(Q1.iconBox||Q1.verticalIconBox){let I1=Boolean(!W1&&Q1.verticalIconBox),D1;Q1.iconBox&&(D1=I1),Q1.verticalIconBox&&(D1=!I1),Q7(b.iconCollisionBox.collisionVertexArray,i.icon.placed,D1,L1.icon,y?O1.x:0,y?O1.y:0)}}}}if(b.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[b.bucketInstanceId]&&(this.retainedQueryData[b.bucketInstanceId].featureSortOrder=b.featureSortOrder),b.hasTextData()&&b.text.opacityVertexBuffer&&b.text.opacityVertexBuffer.updateData(b.text.opacityVertexArray),b.hasIconData()&&b.icon.opacityVertexBuffer&&b.icon.opacityVertexBuffer.updateData(b.icon.opacityVertexArray),b.hasIconCollisionBoxData()&&b.iconCollisionBox.collisionVertexBuffer&&b.iconCollisionBox.collisionVertexBuffer.updateData(b.iconCollisionBox.collisionVertexArray),b.hasTextCollisionBoxData()&&b.textCollisionBox.collisionVertexBuffer&&b.textCollisionBox.collisionVertexBuffer.updateData(b.textCollisionBox.collisionVertexArray),b.text.opacityVertexArray.length!==b.text.layoutVertexArray.length/4)throw Error(`bucket.text.opacityVertexArray.length (= ${b.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${b.text.layoutVertexArray.length}) / 4`);if(b.icon.opacityVertexArray.length!==b.icon.layoutVertexArray.length/4)throw Error(`bucket.icon.opacityVertexArray.length (= ${b.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${b.icon.layoutVertexArray.length}) / 4`);b.bucketInstanceId in this.collisionCircleArrays&&(b.collisionCircleArray=this.collisionCircleArrays[b.bucketInstanceId],delete this.collisionCircleArrays[b.bucketInstanceId])}symbolFadeChange(b){return this.fadeDuration===0?1:(b-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(b){return Math.max(0,(this.transform.zoom-b)/1.5)}hasTransitions(b){return this.stale||b-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(b,z){let k=this.zoomAtLastRecencyCheck===z?1-this.zoomAdjustment(z):1;return this.zoomAtLastRecencyCheck=z,this.commitTime+this.fadeDuration*k>b}setStale(){this.stale=!0}}function Q7(b,z,k,J,B,X){J&&J.length!==0||(J=[0,0,0,0]);let V=J[0]-N0,L=J[1]-N0,F=J[2]-N0,C=J[3]-N0;b.emplaceBack(z?1:0,k?1:0,B||0,X||0,V,L),b.emplaceBack(z?1:0,k?1:0,B||0,X||0,F,L),b.emplaceBack(z?1:0,k?1:0,B||0,X||0,F,C),b.emplaceBack(z?1:0,k?1:0,B||0,X||0,V,C)}let vz=Math.pow(2,25),VZ=Math.pow(2,24),LZ=Math.pow(2,17),WZ=Math.pow(2,16),Jz=Math.pow(2,9),Gz=Math.pow(2,8),jb=Math.pow(2,1);function T9(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;let z=b.placed?1:0,k=Math.floor(127*b.opacity);return k*vz+z*VZ+k*LZ+z*WZ+k*Jz+z*Gz+k*jb+z}let J6=0;class $9{constructor(b){this._sortAcrossTiles=b.layout.get("symbol-z-order")!=="viewport-y"&&!b.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(b,z,k,J,B){let X=this._bucketParts;for(;this._currentTileIndex<b.length;)if(z.getBucketParts(X,J,b[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,B())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,X.sort((V,L)=>V.sortKey-L.sortKey));this._currentPartIndex<X.length;)if(z.placeLayerBucketPart(X[this._currentPartIndex],this._seenCrossTileIDs,k),this._currentPartIndex++,B())return!0;return!1}}class j9{constructor(b,z,k,J,B,X,V,L){this.placement=new $b(b,z,X,V,L),this._currentPlacementIndex=k.length-1,this._forceFullPlacement=J,this._showCollisionBoxes=B,this._done=!1}isDone(){return this._done}continuePlacement(b,z,k){let J=z1(),B=()=>!this._forceFullPlacement&&z1()-J>2;for(;this._currentPlacementIndex>=0;){let X=z[b[this._currentPlacementIndex]],V=this.placement.collisionIndex.transform.zoom;if(X.type==="symbol"&&(!X.minzoom||X.minzoom<=V)&&(!X.maxzoom||X.maxzoom>V)){if(this._inProgressLayer||(this._inProgressLayer=new $9(X)),this._inProgressLayer.continuePlacement(k[X.source],this.placement,this._showCollisionBoxes,X,B))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(b){return this.placement.commit(b),this.placement}}let W8=512/Z.$/2;class G6{constructor(b,z,k){this.tileID=b,this.bucketInstanceId=k,this._symbolsByKey={};let J=new Map;for(let B=0;B<z.length;B++){let X=z.get(B),V=X.key,L=J.get(V);L?L.push(X):J.set(V,[X])}for(let[B,X]of J){let V={positions:X.map((L)=>({x:Math.floor(L.anchorX*W8),y:Math.floor(L.anchorY*W8)})),crossTileIDs:X.map((L)=>L.crossTileID)};if(V.positions.length>128){let L=new Z.aI(V.positions.length,16,Uint16Array);for(let{x:F,y:C}of V.positions)L.add(F,C);L.finish(),delete V.positions,V.index=L}this._symbolsByKey[B]=V}}getScaledCoordinates(b,z){let{x:k,y:J,z:B}=this.tileID.canonical,{x:X,y:V,z:L}=z.canonical,F=W8/Math.pow(2,L-B),C=(V*Z.$+b.anchorY)*F,O=J*Z.$*W8;return{x:Math.floor((X*Z.$+b.anchorX)*F-k*Z.$*W8),y:Math.floor(C-O)}}findMatches(b,z,k){let J=this.tileID.canonical.z<z.canonical.z?1:Math.pow(2,this.tileID.canonical.z-z.canonical.z);for(let B=0;B<b.length;B++){let X=b.get(B);if(X.crossTileID)continue;let V=this._symbolsByKey[X.key];if(!V)continue;let L=this.getScaledCoordinates(X,z);if(V.index){let F=V.index.range(L.x-J,L.y-J,L.x+J,L.y+J).sort();for(let C of F){let O=V.crossTileIDs[C];if(!k[O]){k[O]=!0,X.crossTileID=O;break}}}else if(V.positions)for(let F=0;F<V.positions.length;F++){let C=V.positions[F],O=V.crossTileIDs[F];if(Math.abs(C.x-L.x)<=J&&Math.abs(C.y-L.y)<=J&&!k[O]){k[O]=!0,X.crossTileID=O;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:b})=>b)}}class h8{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class mb{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(b){let z=Math.round((b-this.lng)/360);if(z!==0)for(let k in this.indexes){let J=this.indexes[k],B={};for(let X in J){let V=J[X];V.tileID=V.tileID.unwrapTo(V.tileID.wrap+z),B[V.tileID.key]=V}this.indexes[k]=B}this.lng=b}addBucket(b,z,k){if(this.indexes[b.overscaledZ]&&this.indexes[b.overscaledZ][b.key]){if(this.indexes[b.overscaledZ][b.key].bucketInstanceId===z.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(b.overscaledZ,this.indexes[b.overscaledZ][b.key])}for(let B=0;B<z.symbolInstances.length;B++)z.symbolInstances.get(B).crossTileID=0;this.usedCrossTileIDs[b.overscaledZ]||(this.usedCrossTileIDs[b.overscaledZ]={});let J=this.usedCrossTileIDs[b.overscaledZ];for(let B in this.indexes){let X=this.indexes[B];if(Number(B)>b.overscaledZ)for(let V in X){let L=X[V];L.tileID.isChildOf(b)&&L.findMatches(z.symbolInstances,b,J)}else{let V=X[b.scaledTo(Number(B)).key];V&&V.findMatches(z.symbolInstances,b,J)}}for(let B=0;B<z.symbolInstances.length;B++){let X=z.symbolInstances.get(B);X.crossTileID||(X.crossTileID=k.generate(),J[X.crossTileID]=!0)}return this.indexes[b.overscaledZ]===void 0&&(this.indexes[b.overscaledZ]={}),this.indexes[b.overscaledZ][b.key]=new G6(b,z.symbolInstances,z.bucketInstanceId),!0}removeBucketCrossTileIDs(b,z){for(let k of z.getCrossTileIDsLists())for(let J of k)delete this.usedCrossTileIDs[b][J]}removeStaleBuckets(b){let z=!1;for(let k in this.indexes){let J=this.indexes[k];for(let B in J)b[J[B].bucketInstanceId]||(this.removeBucketCrossTileIDs(k,J[B]),delete J[B],z=!0)}return z}}class r4{constructor(){this.layerIndexes={},this.crossTileIDs=new h8,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(b,z,k){let J=this.layerIndexes[b.id];J===void 0&&(J=this.layerIndexes[b.id]=new mb);let B=!1,X={};J.handleWrapJump(k);for(let V of z){let L=V.getBucket(b);L&&b.id===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),J.addBucket(V.tileID,L,this.crossTileIDs)&&(B=!0),X[L.bucketInstanceId]=!0)}return J.removeStaleBuckets(X)&&(B=!0),B}pruneUnusedLayers(b){let z={};b.forEach((k)=>{z[k]=!0});for(let k in this.layerIndexes)z[k]||delete this.layerIndexes[k]}}var _b="void main() {fragColor=vec4(1.0);}";let q4={prelude:K0(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:K0("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:K0("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:K0(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:K0(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:K0(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:K0(_b,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:K0(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:K0(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:K0("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:K0("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:K0(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:K0("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:K0(_b,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:K0(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:K0(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:K0(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:K0(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:K0(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:K0(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:K0(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:K0(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:K0(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:K0(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:K0(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:K0(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:K0(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:K0(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:K0(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:K0(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:K0(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:K0("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:K0("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:K0("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:K0("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:K0("in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758\n);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}","in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:K0("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function K0(b,z){let k=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,J=z.match(/in ([\w]+) ([\w]+)/g),B=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),X=z.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),V=X?X.concat(B):B,L={};return{fragmentSource:b=b.replace(k,(F,C,O,d,y)=>(L[y]=!0,C==="define"?`
#ifndef HAS_UNIFORM_u_${y}
in ${O} ${d} ${y};
#else
uniform ${O} ${d} u_${y};
#endif
`:`
#ifdef HAS_UNIFORM_u_${y}
    ${O} ${d} ${y} = u_${y};
#endif
`)),vertexSource:z=z.replace(k,(F,C,O,d,y)=>{let T=d==="float"?"vec2":"vec4",E=y.match(/color/)?"color":T;return L[y]?C==="define"?`
#ifndef HAS_UNIFORM_u_${y}
uniform lowp float u_${y}_t;
in ${O} ${T} a_${y};
out ${O} ${d} ${y};
#else
uniform ${O} ${d} u_${y};
#endif
`:E==="vec4"?`
#ifndef HAS_UNIFORM_u_${y}
    ${y} = a_${y};
#else
    ${O} ${d} ${y} = u_${y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${y}
    ${y} = unpack_mix_${E}(a_${y}, u_${y}_t);
#else
    ${O} ${d} ${y} = u_${y};
#endif
`:C==="define"?`
#ifndef HAS_UNIFORM_u_${y}
uniform lowp float u_${y}_t;
in ${O} ${T} a_${y};
#else
uniform ${O} ${d} u_${y};
#endif
`:E==="vec4"?`
#ifndef HAS_UNIFORM_u_${y}
    ${O} ${d} ${y} = a_${y};
#else
    ${O} ${d} ${y} = u_${y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${y}
    ${O} ${d} ${y} = unpack_mix_${E}(a_${y}, u_${y}_t);
#else
    ${O} ${d} ${y} = u_${y};
#endif
`}),staticAttributes:J,staticUniforms:V}}class W3{constructor(b,z,k){this.vertexBuffer=b,this.indexBuffer=z,this.segments=k}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var h0=Z.aJ([{name:"a_pos",type:"Int16",components:2}]);let F8="#define PROJECTION_MERCATOR",Hz="mercator";class V7{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Hz}get shaderDefine(){return F8}get shaderPreludeCode(){return q4.projectionMercator}get vertexShaderPreludeCode(){return q4.projectionMercator.vertexSource}get subdivisionGranularity(){return Z.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(b){}getMeshFromTileID(b,z,k,J,B){if(this._cachedMesh)return this._cachedMesh;let X=new Z.aL;X.emplaceBack(0,0),X.emplaceBack(Z.$,0),X.emplaceBack(0,Z.$),X.emplaceBack(Z.$,Z.$);let V=b.createVertexBuffer(X,h0.members),L=Z.aM.simpleSegment(0,0,4,2),F=new Z.aN;F.emplaceBack(1,0,2),F.emplaceBack(1,2,3);let C=b.createIndexBuffer(F);return this._cachedMesh=new W3(V,C,L),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(b){}}class X2{constructor(b=0,z=0,k=0,J=0){if(isNaN(b)||b<0||isNaN(z)||z<0||isNaN(k)||k<0||isNaN(J)||J<0)throw Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=b,this.bottom=z,this.left=k,this.right=J}interpolate(b,z,k){return z.top!=null&&b.top!=null&&(this.top=Z.C.number(b.top,z.top,k)),z.bottom!=null&&b.bottom!=null&&(this.bottom=Z.C.number(b.bottom,z.bottom,k)),z.left!=null&&b.left!=null&&(this.left=Z.C.number(b.left,z.left,k)),z.right!=null&&b.right!=null&&(this.right=Z.C.number(b.right,z.right,k)),this}getCenter(b,z){let k=Z.ae((this.left+b-this.right)/2,0,b),J=Z.ae((this.top+z-this.bottom)/2,0,z);return new Z.P(k,J)}equals(b){return this.top===b.top&&this.bottom===b.bottom&&this.left===b.left&&this.right===b.right}clone(){return new X2(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function z2(b,z){if(!b.renderWorldCopies||b.lngRange)return;let k=z.lng-b.center.lng;z.lng+=k>180?-360:k<-180?360:0}function y2(b){return Math.max(0,Math.floor(b))}class p5{constructor(b,z){var k;this._callbacks=b,this._tileSize=512,this._renderWorldCopies=(z==null?void 0:z.renderWorldCopies)===void 0||!!(z==null?void 0:z.renderWorldCopies),this._minZoom=(z==null?void 0:z.minZoom)||0,this._maxZoom=(z==null?void 0:z.maxZoom)||22,this._minPitch=(z==null?void 0:z.minPitch)==null?0:z==null?void 0:z.minPitch,this._maxPitch=(z==null?void 0:z.maxPitch)==null?60:z==null?void 0:z.maxPitch,this._constrain=(k=z==null?void 0:z.constrain)!==null&&k!==void 0?k:this._callbacks.constrain,this.setMaxBounds(),this._width=0,this._height=0,this._center=new Z.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=y2(this._zoom),this._scale=Z.ah(this._zoom),this._bearingInRadians=0,this._fovInRadians=0.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new X2,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(b,z,k){this._latRange=b.latRange,this._lngRange=b.lngRange,this._width=b.width,this._height=b.height,this._center=b.center,this._elevation=b.elevation,this._minElevationForCurrentTile=b.minElevationForCurrentTile,this._zoom=b.zoom,this._tileZoom=y2(this._zoom),this._scale=Z.ah(this._zoom),this._bearingInRadians=b.bearingInRadians,this._fovInRadians=b.fovInRadians,this._pitchInRadians=b.pitchInRadians,this._rollInRadians=b.rollInRadians,this._unmodified=b.unmodified,this._edgeInsets=new X2(b.padding.top,b.padding.bottom,b.padding.left,b.padding.right),this._minZoom=b.minZoom,this._maxZoom=b.maxZoom,this._minPitch=b.minPitch,this._maxPitch=b.maxPitch,this._renderWorldCopies=b.renderWorldCopies,this._cameraToCenterDistance=b.cameraToCenterDistance,this._nearZ=b.nearZ,this._farZ=b.farZ,this._autoCalculateNearFarZ=!k&&b.autoCalculateNearFarZ,z&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(b){this._minElevationForCurrentTile=b}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(b){this._minZoom!==b&&(this._minZoom=b,this.setZoom(this.constrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(b){this._maxZoom!==b&&(this._maxZoom=b,this.setZoom(this.constrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(b){this._minPitch!==b&&(this._minPitch=b,this.setPitch(Math.max(this.pitch,b)))}get maxPitch(){return this._maxPitch}setMaxPitch(b){this._maxPitch!==b&&(this._maxPitch=b,this.setPitch(Math.min(this.pitch,b)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(b){b===void 0?b=!0:b===null&&(b=!1),this._renderWorldCopies=b}get constrain(){return this._constrain}setConstrain(b){b||(b=this._callbacks.constrain),this._constrain=b,this.constrainInternal(),this._calcMatrices()}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new Z.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(b){let z=Z.aO(b,-180,180)*Math.PI/180;var k,J,B,X,V,L,F,C,O;this._bearingInRadians!==z&&(this._unmodified=!1,this._bearingInRadians=z,this._calcMatrices(),this._rotationMatrix=N(),k=this._rotationMatrix,B=-this._bearingInRadians,X=(J=this._rotationMatrix)[0],V=J[1],L=J[2],F=J[3],C=Math.sin(B),O=Math.cos(B),k[0]=X*O+L*C,k[1]=V*O+F*C,k[2]=X*-C+L*O,k[3]=V*-C+F*O)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(b){let z=Z.ae(b,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==z&&(this._unmodified=!1,this._pitchInRadians=z,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(b){let z=b/180*Math.PI;this._rollInRadians!==z&&(this._unmodified=!1,this._rollInRadians=z,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return Z.aP(this._fovInRadians)}setFov(b){b=Z.ae(b,0.1,150),this.fov!==b&&(this._unmodified=!1,this._fovInRadians=Z.ag(b),this._calcMatrices())}get zoom(){return this._zoom}setZoom(b){let z=this.constrain(this._center,b).zoom;this._zoom!==z&&(this._unmodified=!1,this._zoom=z,this._tileZoom=Math.max(0,Math.floor(z)),this._scale=Z.ah(z),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(b){b.lat===this._center.lat&&b.lng===this._center.lng||(this._unmodified=!1,this._center=b,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(b){b!==this._elevation&&(this._elevation=b,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(b){this._edgeInsets.equals(b)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,b,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(b,z){this._autoCalculateNearFarZ=!1,this._nearZ=b,this._farZ=z,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(b){return this._edgeInsets.equals(b)}interpolatePadding(b,z,k){this._unmodified=!1,this._edgeInsets.interpolate(b,z,k),this.constrainInternal(),this._calcMatrices()}resize(b,z,k=!0){this._width=b,this._height=z,k&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new g5([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(b){b?(this._lngRange=[b.getWest(),b.getEast()],this._latRange=[b.getSouth(),b.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-Z.af,Z.af])}getCameraQueryGeometry(b,z){if(z.length===1)return[z[0],b];{let{minX:k,minY:J,maxX:B,maxY:X}=Z.a2.fromPoints(z).extend(b);return[new Z.P(k,J),new Z.P(B,J),new Z.P(B,X),new Z.P(k,X),new Z.P(k,J)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;let b=this._unmodified,{center:z,zoom:k}=this.constrain(this.center,this.zoom);this.setCenter(z),this.setZoom(k),this._unmodified=b,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let b=Z.ai(new Float64Array(16));Z.N(b,b,[this._width/2,-this._height/2,1]),Z.M(b,b,[1,-1,0]),this._clipSpaceToPixelsMatrix=b,b=Z.ai(new Float64Array(16)),Z.N(b,b,[1,-1,1]),Z.M(b,b,[-1,-1,0]),Z.N(b,b,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=b,this._cameraToCenterDistance=0.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(b,z,k,J){let B=k!==void 0?k:this.bearing,X=J=J!==void 0?J:this.pitch,V=Z.a1.fromLngLat(b,z),L=-Math.cos(Z.ag(X)),F=Math.sin(Z.ag(X)),C=F*Math.sin(Z.ag(B)),O=-F*Math.cos(Z.ag(B)),d=this.elevation,y=z-d,T;L*y>=0||Math.abs(L)<0.1?(T=1e4,d=z+T*L):T=-y/L;let E,p,s=Z.aQ(1,V.y),c=0;do{if(c+=1,c>10)break;p=T/s,E=new Z.a1(V.x+C*p,V.y+O*p),s=1/E.meterInMercatorCoordinateUnits()}while(Math.abs(T-p*s)>0.000000000001);return{center:E.toLngLat(),elevation:d,zoom:Z.ak(this.height/2/Math.tan(this.fovInRadians/2)/p/this.tileSize)}}recalculateZoomAndCenter(b){if(this.elevation-b==0)return;let z=Z.aj(1,this.center.lat)*this.worldSize,k=this.cameraToCenterDistance/z,J=Z.a1.fromLngLat(this.center,this.elevation),B=C1(this.center,this.elevation,this.pitch,this.bearing,k);this._elevation=b;let X=this.calculateCenterFromCameraLngLatAlt(B.toLngLat(),Z.aQ(B.z,J.y),this.bearing,this.pitch);this._elevation=X.elevation,this._center=X.center,this.setZoom(X.zoom)}getCameraPoint(){let b=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Z.P(b*Math.sin(this.rollInRadians),b*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){let b=Z.aj(1,this.center.lat)*this.worldSize;return C1(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/b).toLngLat()}getMercatorTileCoordinates(b){if(!b)return[0,0,1,1];let z=b.canonical.z>=0?1<<b.canonical.z:Math.pow(2,b.canonical.z);return[b.canonical.x/z,b.canonical.y/z,1/z/Z.$,1/z/Z.$]}}class x5{constructor(b,z){this.min=b,this.max=z,this.center=Z.aR([],Z.aS([],this.min,this.max),0.5)}quadrant(b){let z=[b%2==0,b<2],k=Z.aT(this.min),J=Z.aT(this.max);for(let B=0;B<z.length;B++)k[B]=z[B]?this.min[B]:this.center[B],J[B]=z[B]?this.center[B]:this.max[B];return J[2]=this.max[2],new x5(k,J)}distanceX(b){return Math.max(Math.min(this.max[0],b[0]),this.min[0])-b[0]}distanceY(b){return Math.max(Math.min(this.max[1],b[1]),this.min[1])-b[1]}intersectsFrustum(b){let z=!0;for(let k=0;k<b.planes.length;k++){let J=this.intersectsPlane(b.planes[k]);if(J===0)return 0;J===1&&(z=!1)}return z?2:b.aabb.min[0]>this.max[0]||b.aabb.min[1]>this.max[1]||b.aabb.min[2]>this.max[2]||b.aabb.max[0]<this.min[0]||b.aabb.max[1]<this.min[1]||b.aabb.max[2]<this.min[2]?0:1}intersectsPlane(b){let z=b[3],k=b[3];for(let J=0;J<3;J++)b[J]>0?(z+=b[J]*this.min[J],k+=b[J]*this.max[J]):(k+=b[J]*this.min[J],z+=b[J]*this.max[J]);return z>=0?2:k<0?0:1}}class Uz{distanceToTile2d(b,z,k,J){let B=J.distanceX([b,z]),X=J.distanceY([b,z]);return Math.hypot(B,X)}getWrap(b,z,k){return k}getTileBoundingVolume(b,z,k,J){var B,X;let V=0,L=0;if(J==null?void 0:J.terrain){let C=new Z.Z(b.z,z,b.z,b.x,b.y),O=J.terrain.getMinMaxElevation(C);V=(B=O.minElevation)!==null&&B!==void 0?B:Math.min(0,k),L=(X=O.maxElevation)!==null&&X!==void 0?X:Math.max(0,k)}let F=1<<b.z;return new x5([z+b.x/F,b.y/F,V],[z+(b.x+1)/F,(b.y+1)/F,L])}allowVariableZoom(b,z){let k=b.fov*(Math.abs(Math.cos(b.rollInRadians))*b.height+Math.abs(Math.sin(b.rollInRadians))*b.width)/b.height,J=Z.ae(78.5-k/2,0,60);return!!z.terrain||b.pitch>J}allowWorldCopies(){return!0}prepareNextFrame(){}}class Q2{constructor(b,z,k){this.points=b,this.planes=z,this.aabb=k}static fromInvProjectionMatrix(b,z=1,k=0,J,B){let X=B?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],V=Math.pow(2,k),L=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((d)=>function(y,T,E,p){let s=Z.aw([],y,T),c=1/s[3]/E*p;return Z.aY(s,s,[c,c,1/s[3],c])}(d,b,z,V));J&&function(d,y,T,E){let p=E?4:0,s=E?0:4,c=0,Z1=[],a=[];for(let n=0;n<4;n++){let q1=Z.aU([],d[n+s],d[n+p]),V1=Z.aZ(q1);Z.aR(q1,q1,1/V1),Z1.push(V1),a.push(q1)}for(let n=0;n<4;n++){let q1=Z.a_(d[n+p],a[n],T);c=q1!==null&&q1>=0?Math.max(c,q1):Math.max(c,Z1[n])}let x1=function(n,q1){let V1=Z.aU([],n[q1[0]],n[q1[1]]),W1=Z.aU([],n[q1[2]],n[q1[1]]),L1=[0,0,0,0];return Z.aV(L1,Z.aW([],V1,W1)),L1[3]=-Z.aX(L1,n[q1[0]]),L1}(d,y),i=function(n,q1){let V1=Z.a$(n),W1=Z.b0([],n,1/V1),L1=Z.aU([],q1,Z.aR([],W1,Z.aX(q1,W1))),Q1=Z.a$(L1);if(Q1>0){let O1=Math.sqrt(1-W1[3]*W1[3]),I1=Z.aR([],W1,-W1[3]),D1=Z.aS([],I1,Z.aR([],L1,O1/Q1));return Z.b1(q1,D1)}return null}(T,x1);if(i!==null){let n=i/Z.aX(a[0],x1);c=Math.min(c,n)}for(let n=0;n<4;n++){let q1=Math.min(c,Z1[n]);d[n+s]=[d[n+p][0]+a[n][0]*q1,d[n+p][1]+a[n][1]*q1,d[n+p][2]+a[n][2]*q1,1]}}(L,X[0],J,B);let F=X.map((d)=>{let y=Z.aU([],L[d[0]],L[d[1]]),T=Z.aU([],L[d[2]],L[d[1]]),E=Z.aV([],Z.aW([],y,T)),p=-Z.aX(E,L[d[1]]);return E.concat(p)}),C=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],O=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(let d of L)for(let y=0;y<3;y++)C[y]=Math.min(C[y],d[y]),O[y]=Math.max(O[y],d[y]);return new Q2(L,F,new x5(C,O))}}class V2{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(b){this._helper.setMinZoom(b)}setMaxZoom(b){this._helper.setMaxZoom(b)}setMinPitch(b){this._helper.setMinPitch(b)}setMaxPitch(b){this._helper.setMaxPitch(b)}setRenderWorldCopies(b){this._helper.setRenderWorldCopies(b)}setBearing(b){this._helper.setBearing(b)}setPitch(b){this._helper.setPitch(b)}setRoll(b){this._helper.setRoll(b)}setFov(b){this._helper.setFov(b)}setZoom(b){this._helper.setZoom(b)}setCenter(b){this._helper.setCenter(b)}setElevation(b){this._helper.setElevation(b)}setMinElevationForCurrentTile(b){this._helper.setMinElevationForCurrentTile(b)}setPadding(b){this._helper.setPadding(b)}interpolatePadding(b,z,k){return this._helper.interpolatePadding(b,z,k)}isPaddingEqual(b){return this._helper.isPaddingEqual(b)}resize(b,z,k=!0){this._helper.resize(b,z,k)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(b){this._helper.setMaxBounds(b)}setConstrain(b){this._helper.setConstrain(b)}overrideNearFarZ(b,z){this._helper.overrideNearFarZ(b,z)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(b){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),b)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(b,z){}constructor(b){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(z,k)=>{k=Z.ae(+k,this.minZoom,this.maxZoom);let J={center:new Z.S(z.lng,z.lat),zoom:k},B=this._helper._lngRange;if(!this._helper._renderWorldCopies&&B===null)B=[-179.9999999999,179.9999999999];let X=this.tileSize*Z.ah(J.zoom),V=0,L=X,F=0,C=X,O=0,d=0,{x:y,y:T}=this.size;if(this._helper._latRange){let a=this._helper._latRange;V=Z.U(a[1])*X,L=Z.U(a[0])*X,L-V<T&&(O=T/(L-V))}B&&(F=Z.aO(Z.V(B[0])*X,0,X),C=Z.aO(Z.V(B[1])*X,0,X),C<F&&(C+=X),C-F<y&&(d=y/(C-F)));let{x:E,y:p}=A1(X,z),s,c,Z1=Math.max(d||0,O||0);if(Z1){let a=new Z.P(d?(C+F)/2:E,O?(L+V)/2:p);return J.center=v1(X,a).wrap(),J.zoom+=Z.ak(Z1),J}if(this._helper._latRange){let a=T/2;p-a<V&&(c=V+a),p+a>L&&(c=L-a)}if(B){let a=(F+C)/2,x1=E;this._helper._renderWorldCopies&&(x1=Z.aO(E,a-X/2,a+X/2));let i=y/2;x1-i<F&&(s=F+i),x1+i>C&&(s=C-i)}if(s!==void 0||c!==void 0){let a=new Z.P(s!=null?s:E,c!=null?c:p);J.center=v1(X,a).wrap()}return J},this._helper=new p5({calcMatrices:()=>{this._calcMatrices()},constrain:(z,k)=>this.defaultConstrain(z,k)},b),this._coveringTilesDetailsProvider=new Uz}clone(){let b=new V2;return b.apply(this),b}apply(b,z,k){this._helper.apply(b,z,k)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(b){let z=[new Z.b2(0,b)];if(this._helper._renderWorldCopies){let k=this.screenPointToMercatorCoordinate(new Z.P(0,0)),J=this.screenPointToMercatorCoordinate(new Z.P(this._helper._width,0)),B=this.screenPointToMercatorCoordinate(new Z.P(this._helper._width,this._helper._height)),X=this.screenPointToMercatorCoordinate(new Z.P(0,this._helper._height)),V=Math.floor(Math.min(k.x,J.x,B.x,X.x)),L=Math.floor(Math.max(k.x,J.x,B.x,X.x));for(let C=V-1;C<=L+1;C++)C!==0&&z.push(new Z.b2(C,b))}return z}getCameraFrustum(){return Q2.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(b){let z=this.screenPointToLocation(this.centerPoint,b),k=b?b.getElevationForLngLatZoom(z,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(k)}setLocationAtPoint(b,z){let k=Z.aj(this.elevation,this.center.lat),J=this.screenPointToMercatorCoordinateAtZ(z,k),B=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,k),X=Z.a1.fromLngLat(b),V=new Z.a1(X.x-(J.x-B.x),X.y-(J.y-B.y));this.setCenter(V==null?void 0:V.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(b,z){return z?this.coordinatePoint(Z.a1.fromLngLat(b),z.getElevationForLngLatZoom(b,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(Z.a1.fromLngLat(b))}screenPointToLocation(b,z){var k;return(k=this.screenPointToMercatorCoordinate(b,z))===null||k===void 0?void 0:k.toLngLat()}screenPointToMercatorCoordinate(b,z){if(z){let k=z.pointCoordinate(b);if(k!=null)return k}return this.screenPointToMercatorCoordinateAtZ(b)}screenPointToMercatorCoordinateAtZ(b,z){let k=z||0,J=[b.x,b.y,0,1],B=[b.x,b.y,1,1];Z.aw(J,J,this._pixelMatrixInverse),Z.aw(B,B,this._pixelMatrixInverse);let X=J[3],V=B[3],L=J[1]/X,F=B[1]/V,C=J[2]/X,O=B[2]/V,d=C===O?0:(k-C)/(O-C);return new Z.a1(Z.C.number(J[0]/X,B[0]/V,d)/this.worldSize,Z.C.number(L,F,d)/this.worldSize,k)}coordinatePoint(b,z=0,k=this._pixelMatrix){let J=[b.x*this.worldSize,b.y*this.worldSize,z,1];return Z.aw(J,J,k),new Z.P(J[0]/J[3],J[1]/J[3])}getBounds(){let b=Math.max(0,this._helper._height/2-X1(this));return new g5().extend(this.screenPointToLocation(new Z.P(0,b))).extend(this.screenPointToLocation(new Z.P(this._helper._width,b))).extend(this.screenPointToLocation(new Z.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new Z.P(0,this._helper._height)))}isPointOnMapSurface(b,z){return z?z.pointCoordinate(b)!=null:b.y>this.height/2-X1(this)}calculatePosMatrix(b,z=!1,k){var J;let B=(J=b.key)!==null&&J!==void 0?J:Z.b3(b.wrap,b.canonical.z,b.canonical.z,b.canonical.x,b.canonical.y),X=z?this._alignedPosMatrixCache:this._posMatrixCache;if(X.has(B)){let F=X.get(B);return k?F.f32:F.f64}let V=l1(b,this.worldSize);Z.O(V,z?this._alignedProjMatrix:this._viewProjMatrix,V);let L={f64:V,f32:new Float32Array(V)};return X.set(B,L),k?L.f32:L.f64}calculateFogMatrix(b){let z=b.key,k=this._fogMatrixCacheF32;if(k.has(z))return k.get(z);let J=l1(b,this.worldSize);return Z.O(J,this._fogMatrix,J),k.set(z,new Float32Array(J)),k.get(z)}calculateCenterFromCameraLngLatAlt(b,z,k,J){return this._helper.calculateCenterFromCameraLngLatAlt(b,z,k,J)}_calculateNearFarZIfNeeded(b,z,k){if(!this._helper.autoCalculateNearFarZ)return;let J=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),B=b-J*this._helper._pixelPerMeter/Math.cos(z),X=J<0?B:b,V=Math.PI/2+this.pitchInRadians,L=Z.ag(this.fov)*(Math.abs(Math.cos(Z.ag(this.roll)))*this.height+Math.abs(Math.sin(Z.ag(this.roll)))*this.width)/this.height*(0.5+k.y/this.height),F=Math.sin(L)*X/Math.sin(Z.ae(Math.PI-V-L,0.01,Math.PI-0.01)),C=X1(this),O=Math.atan(C/this._helper.cameraToCenterDistance),d=Z.ag(0.75),y=O>d?2*O*(0.5+k.y/(2*C)):d,T=Math.sin(y)*X/Math.sin(Z.ae(Math.PI-V-y,0.01,Math.PI-0.01)),E=Math.min(F,T);this._helper._farZ=1.01*(Math.cos(Math.PI/2-z)*E+X),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;let b=this.centerOffset,z=A1(this.worldSize,this.center),k=z.x,J=z.y;this._helper._pixelPerMeter=Z.aj(1,this.center.lat)*this.worldSize;let B=Z.ag(Math.min(this.pitch,J1)),X=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(B)),V;this._calculateNearFarZIfNeeded(X,B,b),V=new Float64Array(16),Z.b4(V,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),Z.aq(this._invProjMatrix,V),V[8]=2*-b.x/this._helper._width,V[9]=2*b.y/this._helper._height,this._projectionMatrix=Z.b5(V),Z.N(V,V,[1,-1,1]),Z.M(V,V,[0,0,-this._helper.cameraToCenterDistance]),Z.b6(V,V,-this.rollInRadians),Z.b7(V,V,this.pitchInRadians),Z.b6(V,V,-this.bearingInRadians),Z.M(V,V,[-k,-J,0]),this._mercatorMatrix=Z.N([],V,[this.worldSize,this.worldSize,this.worldSize]),Z.N(V,V,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=Z.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,V),Z.M(V,V,[0,0,-this.elevation]),this._viewProjMatrix=V,this._invViewProjMatrix=Z.aq([],V);let L=[0,0,-1,1];Z.aw(L,L,this._invViewProjMatrix),this._cameraPosition=[L[0]/L[3],L[1]/L[3],L[2]/L[3]],this._fogMatrix=new Float64Array(16),Z.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,X,this._helper._farZ),this._fogMatrix[8]=2*-b.x/this.width,this._fogMatrix[9]=2*b.y/this.height,Z.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),Z.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),Z.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),Z.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),Z.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),Z.M(this._fogMatrix,this._fogMatrix,[-k,-J,0]),Z.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),Z.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=Z.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,V);let F=this._helper._width%2/2,C=this._helper._height%2/2,O=Math.cos(this.bearingInRadians),d=Math.sin(-this.bearingInRadians),y=k-Math.round(k)+O*F+d*C,T=J-Math.round(J)+O*C+d*F,E=new Float64Array(V);if(Z.M(E,E,[y>0.5?y-1:y,T>0.5?T-1:T,0]),this._alignedProjMatrix=E,V=Z.aq(new Float64Array(16),this._pixelMatrix),!V)throw Error("failed to invert matrix");this._pixelMatrixInverse=V,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;let b=this.screenPointToMercatorCoordinate(new Z.P(0,0)),z=[b.x*this.worldSize,b.y*this.worldSize,0,1];return Z.aw(z,z,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){let b=Z.aj(1,this.center.lat)*this.worldSize;return C1(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/b).toLngLat()}lngLatToCameraDepth(b,z){let k=Z.a1.fromLngLat(b),J=[k.x*this.worldSize,k.y*this.worldSize,z,1];return Z.aw(J,J,this._viewProjMatrix),J[2]/J[3]}getProjectionData(b){let{overscaledTileID:z,aligned:k,applyTerrainMatrix:J}=b,B=this._helper.getMercatorTileCoordinates(z),X=z?this.calculatePosMatrix(z,k,!0):null,V;return V=z&&z.terrainRttPosMatrix32f&&J?z.terrainRttPosMatrix32f:X||Z.b8(),{mainMatrix:V,tileMercatorCoords:B,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:V}}isLocationOccluded(b){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(b,z,k){return 1}transformLightDirection(b){return Z.aT(b)}getRayDirectionFromPixel(b){throw Error("Not implemented.")}projectTileCoordinates(b,z,k,J){let B=this.calculatePosMatrix(k),X;J?(X=[b,z,J(b,z),1],Z.aw(X,X,B)):(X=[b,z,0,1],$2(X,X,B));let V=X[3];return{point:new Z.P(X[0]/V,X[1]/V),signedDistanceFromCamera:V,isOccluded:!1}}populateCache(b){for(let z of b)this.calculatePosMatrix(z)}getMatrixForModel(b,z){let k=Z.a1.fromLngLat(b,z),J=k.meterInMercatorCoordinateUnits(),B=Z.b9();return Z.M(B,B,[k.x,k.y,k.z]),Z.b6(B,B,Math.PI),Z.b7(B,B,Math.PI/2),Z.N(B,B,[-J,J,J]),B}getProjectionDataForCustomLayer(b=!0){let z=new Z.Z(0,0,0,0,0),k=this.getProjectionData({overscaledTileID:z,applyGlobeMatrix:b}),J=l1(z,this.worldSize);Z.O(J,this._viewProjMatrix,J),k.tileMercatorCoords=[0,0,1,1];let B=[Z.$,Z.$,this.worldSize/this._helper.pixelsPerMeter],X=Z.ba();return Z.N(X,J,B),k.fallbackMatrix=X,k.mainMatrix=X,k}getFastPathSimpleProjectionMatrix(b){return this.calculatePosMatrix(b)}}function g3(){Z.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Pb(b){if(b.useSlerp)if(b.k<1){let z=Z.bb(b.startEulerAngles.roll,b.startEulerAngles.pitch,b.startEulerAngles.bearing),k=Z.bb(b.endEulerAngles.roll,b.endEulerAngles.pitch,b.endEulerAngles.bearing),J=new Float64Array(4);Z.bc(J,z,k,b.k);let B=Z.bd(J);b.tr.setRoll(B.roll),b.tr.setPitch(B.pitch),b.tr.setBearing(B.bearing)}else b.tr.setRoll(b.endEulerAngles.roll),b.tr.setPitch(b.endEulerAngles.pitch),b.tr.setBearing(b.endEulerAngles.bearing);else b.tr.setRoll(Z.C.number(b.startEulerAngles.roll,b.endEulerAngles.roll,b.k)),b.tr.setPitch(Z.C.number(b.startEulerAngles.pitch,b.endEulerAngles.pitch,b.k)),b.tr.setBearing(Z.C.number(b.startEulerAngles.bearing,b.endEulerAngles.bearing,b.k))}function H6(b,z,k,J,B){let X=B.padding,V=A1(B.worldSize,k.getNorthWest()),L=A1(B.worldSize,k.getNorthEast()),F=A1(B.worldSize,k.getSouthEast()),C=A1(B.worldSize,k.getSouthWest()),O=Z.ag(-J),d=V.rotate(O),y=L.rotate(O),T=F.rotate(O),E=C.rotate(O),p=new Z.P(Math.max(d.x,y.x,E.x,T.x),Math.max(d.y,y.y,E.y,T.y)),s=new Z.P(Math.min(d.x,y.x,E.x,T.x),Math.min(d.y,y.y,E.y,T.y)),c=p.sub(s),Z1=(B.width-(X.left+X.right+z.left+z.right))/c.x,a=(B.height-(X.top+X.bottom+z.top+z.bottom))/c.y;if(a<0||Z1<0)return void g3();let x1=Math.min(Z.ak(B.scale*Math.min(Z1,a)),b.maxZoom),i=Z.P.convert(b.offset),n=new Z.P((z.left-z.right)/2,(z.top-z.bottom)/2).rotate(Z.ag(J)),q1=i.add(n).mult(B.scale/Z.ah(x1));return{center:v1(B.worldSize,V.add(F).div(2).sub(q1)),zoom:x1,bearing:J}}class H5{get useGlobeControls(){return!1}handlePanInertia(b,z){let k=b.mag(),J=Math.abs(X1(z));return{easingOffset:b.mult(Math.min(0.75*J/k,1)),easingCenter:z.center}}handleMapControlsRollPitchBearingZoom(b,z){b.bearingDelta&&z.setBearing(z.bearing+b.bearingDelta),b.pitchDelta&&z.setPitch(z.pitch+b.pitchDelta),b.rollDelta&&z.setRoll(z.roll+b.rollDelta),b.zoomDelta&&z.setZoom(z.zoom+b.zoomDelta)}handleMapControlsPan(b,z,k){b.around.distSqr(z.centerPoint)<0.01||z.setLocationAtPoint(k,b.around)}cameraForBoxAndBearing(b,z,k,J,B){return H6(b,z,k,J,B)}handleJumpToCenterZoom(b,z){b.zoom!==(z.zoom!==void 0?+z.zoom:b.zoom)&&b.setZoom(+z.zoom),z.center!==void 0&&b.setCenter(Z.S.convert(z.center))}handleEaseTo(b,z){let{zoom:k,padding:J}=b,B={roll:b.roll,pitch:b.pitch,bearing:b.bearing},X={roll:z.roll===void 0?b.roll:z.roll,pitch:z.pitch===void 0?b.pitch:z.pitch,bearing:z.bearing===void 0?b.bearing:z.bearing},V=z.zoom!==void 0,L=!b.isPaddingEqual(z.padding),F=!1,C=V?+z.zoom:b.zoom,O=b.centerPoint.add(z.offsetAsPoint),d=b.screenPointToLocation(O),{center:y,zoom:T}=b.constrain(Z.S.convert(z.center||d),C!=null?C:k);z2(b,y);let E=A1(b.worldSize,d),p=A1(b.worldSize,y).sub(E),s=Z.ah(T-k);return F=T!==k,{easeFunc:(c)=>{if(F&&b.setZoom(Z.C.number(k,T,c)),Z.be(B,X)||Pb({startEulerAngles:B,endEulerAngles:X,tr:b,k:c,useSlerp:B.roll!=X.roll}),L&&(b.interpolatePadding(J,z.padding,c),O=b.centerPoint.add(z.offsetAsPoint)),z.around)b.setLocationAtPoint(z.around,z.aroundPoint);else{let Z1=Z.ah(b.zoom-k),a=T>k?Math.min(2,s):Math.max(0.5,s),x1=Math.pow(a,1-c),i=v1(b.worldSize,E.add(p.mult(c*x1)).mult(Z1));b.setLocationAtPoint(b.renderWorldCopies?i.wrap():i,O)}},isZooming:F,elevationCenter:y}}handleFlyTo(b,z){let k=z.zoom!==void 0,J=b.zoom,B=b.constrain(Z.S.convert(z.center||z.locationAtOffset),k?+z.zoom:J),X=B.center,V=B.zoom;z2(b,X);let L=A1(b.worldSize,z.locationAtOffset),F=A1(b.worldSize,X).sub(L),C=F.mag(),O=Z.ah(V-J),d;if(z.minZoom!==void 0){let y=Math.min(+z.minZoom,J,V),T=b.constrain(X,y).zoom;d=Z.ah(T-J)}return{easeFunc:(y,T,E,p)=>{b.setZoom(y===1?V:J+Z.ak(T));let s=y===1?X:v1(b.worldSize,L.add(F.mult(E)).mult(T));b.setLocationAtPoint(b.renderWorldCopies?s.wrap():s,p)},scaleOfZoom:O,targetCenter:X,scaleOfMinZoom:d,pixelPathLength:C}}}class t0{constructor(b,z,k){this.blendFunction=b,this.blendColor=z,this.mask=k}}t0.Replace=[1,0],t0.disabled=new t0(t0.Replace,Z.bf.transparent,[!1,!1,!1,!1]),t0.unblended=new t0(t0.Replace,Z.bf.transparent,[!0,!0,!0,!0]),t0.alphaBlended=new t0([1,771],Z.bf.transparent,[!0,!0,!0,!0]);let D4=2305;class $0{constructor(b,z,k){this.enable=b,this.mode=z,this.frontFace=k}}$0.disabled=new $0(!1,1029,D4),$0.backCCW=new $0(!0,1029,D4),$0.frontCCW=new $0(!0,1028,D4);class H0{constructor(b,z,k){this.func=b,this.mask=z,this.range=k}}H0.ReadOnly=!1,H0.ReadWrite=!0,H0.disabled=new H0(519,H0.ReadOnly,[0,1]);let m9=7680;class d0{constructor(b,z,k,J,B,X){this.test=b,this.ref=z,this.mask=k,this.fail=J,this.depthFail=B,this.pass=X}}d0.disabled=new d0({func:519,mask:0},0,0,m9,m9,m9);let Eb=new WeakMap;function j3(b){var z;if(Eb.has(b))return Eb.get(b);{let k=(z=b.getParameter(b.VERSION))===null||z===void 0?void 0:z.startsWith("WebGL 2.0");return Eb.set(b,k),k}}class U6{get awaitingQuery(){return!!this._readbackQueue}constructor(b){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1000,this._readbackQueue=null,this._cachedRenderContext=b;let z=b.context,k=z.gl;this._texFormat=k.RGBA,this._texType=k.UNSIGNED_BYTE;let J=new Z.aL;J.emplaceBack(-1,-1),J.emplaceBack(2,-1),J.emplaceBack(-1,2);let B=new Z.aN;B.emplaceBack(0,1,2),this._fullscreenTriangle=new W3(z.createVertexBuffer(J,h0.members),z.createIndexBuffer(B),Z.aM.simpleSegment(0,0,J.length,B.length)),this._resultBuffer=new Uint8Array(4),z.activeTexture.set(k.TEXTURE1);let X=k.createTexture();k.bindTexture(k.TEXTURE_2D,X),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST),k.texImage2D(k.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=z.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(X),j3(k)&&(this._pbo=k.createBuffer(),k.bindBuffer(k.PIXEL_PACK_BUFFER,this._pbo),k.bufferData(k.PIXEL_PACK_BUFFER,4,k.STREAM_READ),k.bindBuffer(k.PIXEL_PACK_BUFFER,null))}destroy(){let b=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),b.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(b,z){let k=this._updateCount;return this._readbackQueue?k>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():k>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(b,z),this._updateCount++,this._measuredError}_bindFramebuffer(){let b=this._cachedRenderContext.context,z=b.gl;b.activeTexture.set(z.TEXTURE1),z.bindTexture(z.TEXTURE_2D,this._fbo.colorAttachment.get()),b.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(b,z){let k=this._cachedRenderContext.context,J=k.gl;if(this._bindFramebuffer(),k.viewport.set([0,0,this._texWidth,this._texHeight]),k.clear({color:Z.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(k,J.TRIANGLES,H0.disabled,d0.disabled,t0.unblended,$0.disabled,((B,X)=>({u_input:B,u_output_expected:X}))(b,z),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&j3(J)){J.bindBuffer(J.PIXEL_PACK_BUFFER,this._pbo),J.readBuffer(J.COLOR_ATTACHMENT0),J.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),J.bindBuffer(J.PIXEL_PACK_BUFFER,null);let B=J.fenceSync(J.SYNC_GPU_COMMANDS_COMPLETE,0);J.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:B}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){let b=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&j3(b)){let z=b.clientWaitSync(this._readbackQueue.sync,0,0);if(z===b.WAIT_FAILED)return Z.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(z===b.TIMEOUT_EXPIRED)return;b.bindBuffer(b.PIXEL_PACK_BUFFER,this._pbo),b.getBufferSubData(b.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),b.bindBuffer(b.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),b.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=U6._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(b){let z=0;return z+=b[0]/256,z+=b[1]/65536,z+=b[2]/16777216,b[3]<127&&(z=-z),z/128}}let L7=Z.$/128;function K8(b,z){let k=b.granularity!==void 0?Math.max(b.granularity,1):1,J=k+(b.generateBorders?2:0),B=k+(b.extendToNorthPole||b.generateBorders?1:0)+(b.extendToSouthPole||b.generateBorders?1:0),X=J+1,V=B+1,L=b.generateBorders?-1:0,F=b.generateBorders||b.extendToNorthPole?-1:0,C=k+(b.generateBorders?1:0),O=k+(b.generateBorders||b.extendToSouthPole?1:0),d=X*V,y=J*B*6,T=X*V>65536;if(T&&z==="16bit")throw Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");let E=T||z==="32bit",p=new Int16Array(2*d),s=0;for(let a=F;a<=O;a++)for(let x1=L;x1<=C;x1++){let i=x1/k*Z.$;x1===-1&&(i=-L7),x1===k+1&&(i=Z.$+L7);let n=a/k*Z.$;a===-1&&(n=b.extendToNorthPole?Z.bh:-L7),a===k+1&&(n=b.extendToSouthPole?Z.bi:Z.$+L7),p[s++]=i,p[s++]=n}let c=E?new Uint32Array(y):new Uint16Array(y),Z1=0;for(let a=0;a<B;a++)for(let x1=0;x1<J;x1++){let i=x1+1+a*X,n=x1+(a+1)*X,q1=x1+1+(a+1)*X;c[Z1++]=x1+a*X,c[Z1++]=n,c[Z1++]=i,c[Z1++]=i,c[Z1++]=n,c[Z1++]=q1}return{vertices:p.buffer.slice(0),indices:c.buffer.slice(0),uses32bitIndices:E}}let l8=new Z.aK({fill:new Z.bj(128,2),line:new Z.bj(512,0),tile:new Z.bj(128,32),stencil:new Z.bj(128,1),circle:3});class C8{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1000}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return q4.projectionGlobe}get vertexShaderPreludeCode(){return q4.projectionMercator.vertexSource}get subdivisionGranularity(){return l8}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(b){this._errorMeasurement||(this._errorMeasurement=new U6(b));let z=Z.U(this._errorQueryLatitudeDegrees),k=2*Math.atan(Math.exp(Math.PI-z*Math.PI*2))-0.5*Math.PI,J=this._errorMeasurement.updateErrorLoop(z,k),B=z1();J!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=J,this._errorMeasurementLastChangeTime=B);let X=Math.min(Math.max((B-this._errorMeasurementLastChangeTime)/1000/0.5,0),1);this._errorCorrectionUsable=Z.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,Z.bl(X))}_getMeshKey(b){return`${b.granularity.toString(36)}_${b.generateBorders?"b":""}${b.extendToNorthPole?"n":""}${b.extendToSouthPole?"s":""}`}getMeshFromTileID(b,z,k,J,B){let X=(B==="stencil"?l8.stencil:l8.tile).getGranularityForZoomLevel(z.z);return this._getMesh(b,{granularity:X,generateBorders:k,extendToNorthPole:z.y===0&&J,extendToSouthPole:z.y===(1<<z.z)-1&&J})}_getMesh(b,z){let k=this._getMeshKey(z);if(k in this._tileMeshCache)return this._tileMeshCache[k];let J=function(B,X){let V=K8(X,"16bit"),L=Z.aL.deserialize({arrayBuffer:V.vertices,length:V.vertices.byteLength/2/2}),F=Z.aN.deserialize({arrayBuffer:V.indices,length:V.indices.byteLength/2/3});return new W3(B.createVertexBuffer(L,h0.members),B.createIndexBuffer(F),Z.aM.simpleSegment(0,0,L.length,F.length))}(b,z);return this._tileMeshCache[k]=J,J}recalculate(b){}hasTransition(){let b=z1(),z=!1;return z=z||(b-this._errorMeasurementLastChangeTime)/1000<0.7,z=z||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,z}setErrorQueryLatitudeDegrees(b){this._errorQueryLatitudeDegrees=b}}let _9=new Z.r({type:new Z.D(Z.v.projection.type)});class D8 extends Z.E{constructor(b){super(),this._transitionable=new Z.t(_9,void 0),this.setProjection(b),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new Z.F(0)),this._mercatorProjection=new V7,this._verticalPerspectiveProjection=new C8}get transitionState(){let b=this.properties.get("type");if(typeof b=="string"&&b==="mercator")return 0;if(typeof b=="string"&&b==="vertical-perspective")return 1;if(b instanceof Z.bm){if(b.from==="vertical-perspective"&&b.to==="mercator")return 1-b.transition;if(b.from==="mercator"&&b.to==="vertical-perspective")return b.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(b){this._mercatorProjection.updateGPUdependent(b),this._verticalPerspectiveProjection.updateGPUdependent(b)}getMeshFromTileID(b,z,k,J,B){return this.currentProjection.getMeshFromTileID(b,z,k,J,B)}setProjection(b){this._transitionable.setValue("type",(b==null?void 0:b.type)||"mercator")}updateTransitions(b){this._transitioning=this._transitionable.transitioned(b,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(b){this.properties=this._transitioning.possiblyEvaluate(b)}setErrorQueryLatitudeDegrees(b){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(b),this._mercatorProjection.setErrorQueryLatitudeDegrees(b)}}function P9(b){let z=o4(b.worldSize,b.center.lat);return 2*Math.PI*z}function m3(b,z,k,J,B){let X=1/(1<<B),V=z/Z.$*X+J*X,L=Z.bo((b/Z.$*X+k*X)*Math.PI*2+Math.PI,2*Math.PI),F=2*Math.atan(Math.exp(Math.PI-V*Math.PI*2))-0.5*Math.PI,C=Math.cos(F),O=new Float64Array(3);return O[0]=Math.sin(L)*C,O[1]=Math.sin(F),O[2]=Math.cos(L)*C,O}function t5(b){return function(z,k){let J=Math.cos(k),B=new Float64Array(3);return B[0]=Math.sin(z)*J,B[1]=Math.sin(k),B[2]=Math.cos(z)*J,B}(b.lng*Math.PI/180,b.lat*Math.PI/180)}function o4(b,z){return b/(2*Math.PI)/Math.cos(z*Math.PI/180)}function Bz(b){let z=Math.asin(b[1])/Math.PI*180,k=Math.sqrt(b[0]*b[0]+b[2]*b[2]);if(k>0.000001){let J=b[0]/k,B=Math.acos(b[2]/k),X=(J>0?B:-B)/Math.PI*180;return new Z.S(Z.aO(X,-180,180),z)}return new Z.S(0,z)}function B6(b){return Math.cos(b*Math.PI/180)}function e5(b,z){let k=B6(b),J=B6(z);return Z.ak(J/k)}function Az(b,z){let k=b.rotate(z.bearingInRadians),J=z.zoom+e5(z.center.lat,0),B=Z.bk(1/B6(z.center.lat),1/B6(Math.min(Math.abs(z.center.lat),60)),Z.bn(J,7,3,0,1)),X=360/P9({worldSize:z.worldSize,center:{lat:z.center.lat}});return new Z.S(z.center.lng-k.x*X*B,Z.ae(z.center.lat+k.y*X,-Z.af,Z.af))}function ub(b){let z=0.5*b,k=Math.sin(z),J=Math.cos(z);return Math.log(k+J)-Math.log(J-k)}function j2(b,z,k,J){let B=b.lat+k*J;if(Math.abs(k)>1){let X=(Math.sign(b.lat+k)!==Math.sign(b.lat)?-Math.abs(b.lat):Math.abs(b.lat))*Math.PI/180,V=Math.abs(b.lat+k)*Math.PI/180,L=ub(X+J*(V-X)),F=ub(X),C=ub(V);return new Z.S(b.lng+z*((L-F)/(C-F)),B)}return new Z.S(b.lng+z*J,B)}class E9{constructor(b){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=b}swapBuffers(){if(!this._hadAnyChanges)return;let b=this._cachePrevious;this._cachePrevious=this._cache,this._cache=b,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(b,z,k,J){let B=`${b.z}_${b.x}_${b.y}_${(J==null?void 0:J.terrain)?"t":""}`,X=this._cache.get(B);if(X)return X;let V=this._cachePrevious.get(B);if(V)return this._cache.set(B,V),V;let L=this._boundingVolumeFactory(b,z,k,J);return this._cache.set(B,L),this._hadAnyChanges=!0,L}}class m2{constructor(b,z,k,J){this.min=k,this.max=J,this.points=b,this.planes=z}static fromAabb(b,z){let k=[];for(let J=0;J<8;J++)k.push([1&~J?b[0]:z[0],(J>>1&1)==1?z[1]:b[1],(J>>2&1)==1?z[2]:b[2]]);return new m2(k,[[-1,0,0,z[0]],[1,0,0,-b[0]],[0,-1,0,z[1]],[0,1,0,-b[1]],[0,0,-1,z[2]],[0,0,1,-b[2]]],b,z)}static fromCenterSizeAngles(b,z,k){let J=Z.br([],k[0],k[1],k[2]),B=Z.bs([],[z[0],0,0],J),X=Z.bs([],[0,z[1],0],J),V=Z.bs([],[0,0,z[2]],J),L=[...b],F=[...b];for(let O=0;O<8;O++)for(let d=0;d<3;d++){let y=b[d]+B[d]*(1&~O?-1:1)+X[d]*((O>>1&1)==1?1:-1)+V[d]*((O>>2&1)==1?1:-1);L[d]=Math.min(L[d],y),F[d]=Math.max(F[d],y)}let C=[];for(let O=0;O<8;O++){let d=[...b];Z.aS(d,d,Z.aR([],B,1&~O?-1:1)),Z.aS(d,d,Z.aR([],X,(O>>1&1)==1?1:-1)),Z.aS(d,d,Z.aR([],V,(O>>2&1)==1?1:-1)),C.push(d)}return new m2(C,[[...B,-Z.aX(B,C[0])],[...X,-Z.aX(X,C[0])],[...V,-Z.aX(V,C[0])],[-B[0],-B[1],-B[2],-Z.aX(B,C[7])],[-X[0],-X[1],-X[2],-Z.aX(X,C[7])],[-V[0],-V[1],-V[2],-Z.aX(V,C[7])]],L,F)}intersectsFrustum(b){let z=!0,k=this.points.length,J=this.planes.length,B=b.planes.length,X=b.points.length;for(let V=0;V<B;V++){let L=b.planes[V],F=0;for(let C=0;C<k;C++){let O=this.points[C];L[0]*O[0]+L[1]*O[1]+L[2]*O[2]+L[3]>=0&&F++}if(F===0)return 0;F<k&&(z=!1)}if(z)return 2;for(let V=0;V<J;V++){let L=this.planes[V],F=0;for(let C=0;C<X;C++){let O=b.points[C];L[0]*O[0]+L[1]*O[1]+L[2]*O[2]+L[3]>=0&&F++}if(F===0)return 0}return 1}intersectsPlane(b){let z=this.points.length,k=0;for(let J=0;J<z;J++){let B=this.points[J];b[0]*B[0]+b[1]*B[1]+b[2]*B[2]+b[3]>=0&&k++}return k===z?2:k===0?0:1}}function W7(b,z,k){let J=b-z;return J<0?-J:Math.max(0,J-k)}function u9(b,z,k,J,B){let X=b-k,V;return V=X<0?Math.min(-X,1+X-B):X>1?Math.min(Math.max(X-B,0),1-X):0,Math.max(V,W7(z,J,B))}class pb{constructor(){this._boundingVolumeCache=new E9(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(b,z,k,J){let B=1<<k.z,X=1/B,V=k.x/B,L=k.y/B,F=2;return F=Math.min(F,u9(b,z,V,L,X)),F=Math.min(F,u9(b,z,V+0.5,-L-X,X)),F=Math.min(F,u9(b,z,V+0.5,2-L-X,X)),F}getWrap(b,z,k){let J=1<<z.z,B=1/J,X=z.x/J,V=W7(b.x,X,B),L=W7(b.x,X-1,B),F=W7(b.x,X+1,B),C=Math.min(V,L,F);return C===F?1:C===L?-1:0}allowVariableZoom(b,z){return i0(b,z)>4}allowWorldCopies(){return!1}getTileBoundingVolume(b,z,k,J){return this._boundingVolumeCache.getTileBoundingVolume(b,z,k,J)}_computeTileBoundingVolume(b,z,k,J){var B,X;let V=0,L=0;if(J==null?void 0:J.terrain){let F=new Z.Z(b.z,z,b.z,b.x,b.y),C=J.terrain.getMinMaxElevation(F);V=(B=C.minElevation)!==null&&B!==void 0?B:Math.min(0,k),L=(X=C.maxElevation)!==null&&X!==void 0?X:Math.max(0,k)}if(V/=Z.bu,L/=Z.bu,V+=1,L+=1,b.z<=0)return m2.fromAabb([-L,-L,-L],[L,L,L]);if(b.z===1)return m2.fromAabb([b.x===0?-L:0,b.y===0?0:-L,-L],[b.x===0?0:L,b.y===0?L:0,L]);{let F=[m3(0,0,b.x,b.y,b.z),m3(Z.$,0,b.x,b.y,b.z),m3(Z.$,Z.$,b.x,b.y,b.z),m3(0,Z.$,b.x,b.y,b.z)],C=[];for(let L1 of F)C.push(Z.aR([],L1,L));if(L!==V)for(let L1 of F)C.push(Z.aR([],L1,V));b.y===0&&C.push([0,1,0]),b.y===(1<<b.z)-1&&C.push([0,-1,0]);let O=[1,1,1],d=[-1,-1,-1];for(let L1 of C)for(let Q1=0;Q1<3;Q1++)O[Q1]=Math.min(O[Q1],L1[Q1]),d[Q1]=Math.max(d[Q1],L1[Q1]);let y=m3(Z.$/2,Z.$/2,b.x,b.y,b.z),T=Z.aW([],[0,1,0],y);Z.aV(T,T);let E=Z.aW([],y,T);Z.aV(E,E);let p=Z.aW([],F[2],F[1]);Z.aV(p,p);let s=Z.aW([],F[0],F[3]);Z.aV(s,s),C.push(Z.aR([],y,L)),b.y>=(1<<b.z)/2&&C.push(Z.aR([],m3(Z.$/2,0,b.x,b.y,b.z),L)),b.y<(1<<b.z)/2&&C.push(Z.aR([],m3(Z.$/2,Z.$,b.x,b.y,b.z),L));let c=h7(y,C),Z1=h7(E,C),a=[-y[0],-y[1],-y[2],c.max],x1=[y[0],y[1],y[2],-c.min],i=[-E[0],-E[1],-E[2],Z1.max],n=[E[0],E[1],E[2],-Z1.min],q1=[...p,0],V1=[...s,0],W1=[];return b.y===0?W1.push(Z.bt(V1,q1,a),Z.bt(V1,q1,x1)):W1.push(Z.bt(i,q1,a),Z.bt(i,q1,x1),Z.bt(i,V1,a),Z.bt(i,V1,x1)),b.y===(1<<b.z)-1?W1.push(Z.bt(V1,q1,a),Z.bt(V1,q1,x1)):W1.push(Z.bt(n,q1,a),Z.bt(n,q1,x1),Z.bt(n,V1,a),Z.bt(n,V1,x1)),new m2(W1,[a,x1,i,n,q1,V1],O,d)}}}function h7(b,z){let k=1/0,J=-1/0;for(let B of z){let X=Z.aX(b,B);k=Math.min(k,X),J=Math.max(J,X)}return{min:k,max:J}}class p9{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(b){this._helper.setMinZoom(b)}setMaxZoom(b){this._helper.setMaxZoom(b)}setMinPitch(b){this._helper.setMinPitch(b)}setMaxPitch(b){this._helper.setMaxPitch(b)}setRenderWorldCopies(b){this._helper.setRenderWorldCopies(b)}setBearing(b){this._helper.setBearing(b)}setPitch(b){this._helper.setPitch(b)}setRoll(b){this._helper.setRoll(b)}setFov(b){this._helper.setFov(b)}setZoom(b){this._helper.setZoom(b)}setCenter(b){this._helper.setCenter(b)}setElevation(b){this._helper.setElevation(b)}setMinElevationForCurrentTile(b){this._helper.setMinElevationForCurrentTile(b)}setPadding(b){this._helper.setPadding(b)}interpolatePadding(b,z,k){return this._helper.interpolatePadding(b,z,k)}isPaddingEqual(b){return this._helper.isPaddingEqual(b)}resize(b,z){this._helper.resize(b,z)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(b){this._helper.setMaxBounds(b)}setConstrain(b){this._helper.setConstrain(b)}overrideNearFarZ(b,z){this._helper.overrideNearFarZ(b,z)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(b){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),b)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(b){}constructor(b){this._cachedClippingPlane=Z.bv(),this._projectionMatrix=Z.b9(),this._globeViewProjMatrix32f=Z.b8(),this._globeViewProjMatrixNoCorrection=Z.b9(),this._globeViewProjMatrixNoCorrectionInverted=Z.b9(),this._globeProjMatrixInverted=Z.b9(),this._cameraPosition=Z.bp(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(z,k)=>{let J=Z.ae(z.lat,-Z.af,Z.af),B=Z.ae(+k,this.minZoom+e5(0,J),this.maxZoom);return{center:new Z.S(z.lng,J),zoom:B}},this._helper=new p5({calcMatrices:()=>{this._calcMatrices()},constrain:(z,k)=>this.defaultConstrain(z,k)},b),this._coveringTilesDetailsProvider=new pb}clone(){let b=new p9;return b.apply(this),b}apply(b,z){this._globeLatitudeErrorCorrectionRadians=z||0,this._helper.apply(b)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){let b=Z.bp();return b[0]=this._cameraPosition[0],b[1]=this._cameraPosition[1],b[2]=this._cameraPosition[2],b}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(b){let{overscaledTileID:z,applyGlobeMatrix:k}=b,J=this._helper.getMercatorTileCoordinates(z);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:J,clippingPlane:this._cachedClippingPlane,projectionTransition:k?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(b){let z=this.pitchInRadians,k=this.cameraToCenterDistance/b,J=Math.sin(z)*k,B=Math.cos(z)*k+1,X=1/Math.sqrt(J*J+B*B)*1,V=-J,L=B,F=Math.sqrt(V*V+L*L);V/=F,L/=F;let C=[0,V,L];Z.bw(C,C,[0,0,0],-this.bearingInRadians),Z.bx(C,C,[0,0,0],-1*this.center.lat*Math.PI/180),Z.by(C,C,[0,0,0],this.center.lng*Math.PI/180);let O=1/Z.aZ(C);return Z.aR(C,C,O),[...C,-X*O]}isLocationOccluded(b){return!this.isSurfacePointVisible(t5(b))}transformLightDirection(b){let z=this._helper._center.lng*Math.PI/180,k=this._helper._center.lat*Math.PI/180,J=Math.cos(k),B=[Math.sin(z)*J,Math.sin(k),Math.cos(z)*J],X=[B[2],0,-B[0]],V=[0,0,0];Z.aW(V,X,B),Z.aV(X,X),Z.aV(V,V);let L=[0,0,0];return Z.aV(L,[X[0]*b[0]+V[0]*b[1]+B[0]*b[2],X[1]*b[0]+V[1]*b[1]+B[1]*b[2],X[2]*b[0]+V[2]*b[1]+B[2]*b[2]]),L}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(b,z,k){let J=function(V,L,F){let C=1/(1<<F.z);return new Z.a1(V/Z.$*C+F.x*C,L/Z.$*C+F.y*C)}(b,z,k.canonical),B=(X=J.y,[Z.bo(J.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-X*Math.PI*2))-0.5*Math.PI]);var X;return this.getCircleRadiusCorrection()/Math.cos(B[1])}projectTileCoordinates(b,z,k,J){let B=k.canonical,X=m3(b,z,B.x,B.y,B.z),V=1+(J?J(b,z):0)/Z.bu,L=[X[0]*V,X[1]*V,X[2]*V,1];Z.aw(L,L,this._globeViewProjMatrixNoCorrection);let F=this._cachedClippingPlane,C=F[0]*X[0]+F[1]*X[1]+F[2]*X[2]+F[3]<0;return{point:new Z.P(L[0]/L[3],L[1]/L[3]),signedDistanceFromCamera:L[3],isOccluded:C}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;let b=o4(this.worldSize,this.center.lat),z=Z.ba(),k=Z.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=0.5,this._helper._farZ=this.cameraToCenterDistance+2*b),Z.b4(z,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);let J=this.centerOffset;z[8]=2*-J.x/this._helper._width,z[9]=2*J.y/this._helper._height,this._projectionMatrix=Z.b5(z),this._globeProjMatrixInverted=Z.ba(),Z.aq(this._globeProjMatrixInverted,z),Z.M(z,z,[0,0,-this.cameraToCenterDistance]),Z.b6(z,z,this.rollInRadians),Z.b7(z,z,-this.pitchInRadians),Z.b6(z,z,this.bearingInRadians),Z.M(z,z,[0,0,-b]);let B=Z.bp();B[0]=b,B[1]=b,B[2]=b,Z.b7(k,z,this.center.lat*Math.PI/180),Z.bz(k,k,-this.center.lng*Math.PI/180),Z.N(k,k,B),this._globeViewProjMatrixNoCorrection=k,Z.b7(z,z,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),Z.bz(z,z,-this.center.lng*Math.PI/180),Z.N(z,z,B),this._globeViewProjMatrix32f=new Float32Array(z),this._globeViewProjMatrixNoCorrectionInverted=Z.ba(),Z.aq(this._globeViewProjMatrixNoCorrectionInverted,k);let X=Z.bp();this._cameraPosition=Z.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/b,Z.bw(this._cameraPosition,this._cameraPosition,X,-this.rollInRadians),Z.bx(this._cameraPosition,this._cameraPosition,X,this.pitchInRadians),Z.bw(this._cameraPosition,this._cameraPosition,X,-this.bearingInRadians),Z.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),Z.bx(this._cameraPosition,this._cameraPosition,X,-this.center.lat*Math.PI/180),Z.by(this._cameraPosition,this._cameraPosition,X,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(b);let V=Z.b5(this._globeViewProjMatrixNoCorrectionInverted);Z.N(V,V,[1,1,-1]),this._cachedFrustum=Q2.fromInvProjectionMatrix(V,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(b){Z.w("calculateFogMatrix is not supported on globe projection.");let z=Z.ba();return Z.ai(z),z}getVisibleUnwrappedCoordinates(b){return[new Z.b2(0,b)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(b){b&&Z.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(b,z){if(!this._globeViewProjMatrixNoCorrection)return 1;let k=t5(b);Z.aR(k,k,1+z/Z.bu);let J=Z.bv();return Z.aw(J,[k[0],k[1],k[2],1],this._globeViewProjMatrixNoCorrection),J[2]/J[3]}populateCache(b){}getBounds(){let b=0.5*this.width,z=0.5*this.height,k=[new Z.P(0,0),new Z.P(b,0),new Z.P(this.width,0),new Z.P(this.width,z),new Z.P(this.width,this.height),new Z.P(b,this.height),new Z.P(0,this.height),new Z.P(0,z)],J=[];for(let O of k)J.push(this.unprojectScreenPoint(O));let B=0,X=0,V=0,L=0,F=this.center;for(let O of J){let d=Z.bA(F.lng,O.lng),y=Z.bA(F.lat,O.lat);d<X&&(X=d),d>B&&(B=d),y<L&&(L=y),y>V&&(V=y)}let C=[F.lng+X,F.lat+L,F.lng+B,F.lat+V];return this.isSurfacePointOnScreen([0,1,0])&&(C[3]=90,C[0]=-180,C[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(C[1]=-90,C[0]=-180,C[2]=180),new g5(C)}calculateCenterFromCameraLngLatAlt(b,z,k,J){return this._helper.calculateCenterFromCameraLngLatAlt(b,z,k,J)}setLocationAtPoint(b,z){let k=t5(this.unprojectScreenPoint(z)),J=t5(b),B=Z.bp();Z.bB(B);let X=Z.bp();Z.by(X,k,B,-this.center.lng*Math.PI/180),Z.bx(X,X,B,this.center.lat*Math.PI/180);let V=J[0]*J[0]+J[2]*J[2],L=X[0]*X[0];if(V<L)return;let F=Math.sqrt(V-L),C=-F,O=Z.bC(J[0],J[2],X[0],F),d=Z.bC(J[0],J[2],X[0],C),y=Z.bp();Z.by(y,J,B,-O);let T=Z.bC(y[1],y[2],X[1],X[2]),E=Z.bp();Z.by(E,J,B,-d);let p=Z.bC(E[1],E[2],X[1],X[2]),s=0.5*Math.PI,c=T>=-s&&T<=s,Z1=p>=-s&&p<=s,a,x1;if(c&&Z1){let V1=this.center.lng*Math.PI/180,W1=this.center.lat*Math.PI/180;Z.bD(O,V1)+Z.bD(T,W1)<Z.bD(d,V1)+Z.bD(p,W1)?(a=O,x1=T):(a=d,x1=p)}else if(c)a=O,x1=T;else{if(!Z1)return;a=d,x1=p}let i=a/Math.PI*180,n=x1/Math.PI*180,q1=this.center.lat;this.setCenter(new Z.S(i,Z.ae(n,-90,90))),this.setZoom(this.zoom+e5(q1,this.center.lat))}locationToScreenPoint(b,z){let k=t5(b);if(z){let J=z.getElevationForLngLatZoom(b,this._helper._tileZoom);Z.aR(k,k,1+J/Z.bu)}return this._projectSurfacePointToScreen(k)}_projectSurfacePointToScreen(b){let z=Z.bv();return Z.aw(z,[...b,1],this._globeViewProjMatrixNoCorrection),z[0]/=z[3],z[1]/=z[3],new Z.P((0.5*z[0]+0.5)*this.width,(0.5*-z[1]+0.5)*this.height)}screenPointToMercatorCoordinate(b,z){if(z){let k=z.pointCoordinate(b);if(k)return k}return Z.a1.fromLngLat(this.unprojectScreenPoint(b))}screenPointToLocation(b,z){var k;return(k=this.screenPointToMercatorCoordinate(b,z))===null||k===void 0?void 0:k.toLngLat()}isPointOnMapSurface(b,z){let k=this._cameraPosition,J=this.getRayDirectionFromPixel(b);return!!this.rayPlanetIntersection(k,J)}getRayDirectionFromPixel(b){let z=Z.bv();z[0]=b.x/this.width*2-1,z[1]=-1*(b.y/this.height*2-1),z[2]=1,z[3]=1,Z.aw(z,z,this._globeViewProjMatrixNoCorrectionInverted),z[0]/=z[3],z[1]/=z[3],z[2]/=z[3];let k=Z.bp();k[0]=z[0]-this._cameraPosition[0],k[1]=z[1]-this._cameraPosition[1],k[2]=z[2]-this._cameraPosition[2];let J=Z.bp();return Z.aV(J,k),J}isSurfacePointVisible(b){let z=this._cachedClippingPlane;return z[0]*b[0]+z[1]*b[1]+z[2]*b[2]+z[3]>=0}isSurfacePointOnScreen(b){if(!this.isSurfacePointVisible(b))return!1;let z=Z.bv();return Z.aw(z,[...b,1],this._globeViewProjMatrixNoCorrection),z[0]/=z[3],z[1]/=z[3],z[2]/=z[3],z[0]>-1&&z[0]<1&&z[1]>-1&&z[1]<1&&z[2]>-1&&z[2]<1}rayPlanetIntersection(b,z){let k=Z.aX(b,z),J=Z.bp(),B=Z.bp();Z.aR(B,z,k),Z.aU(J,b,B);let X=1-Z.aX(J,J);if(X<0)return null;let V=Z.aX(b,b)-1,L=-k+(k<0?1:-1)*Math.sqrt(X),F=V/L,C=L;return{tMin:Math.min(F,C),tMax:Math.max(F,C)}}unprojectScreenPoint(b){let z=this._cameraPosition,k=this.getRayDirectionFromPixel(b),J=this.rayPlanetIntersection(z,k);if(J){let C=Z.bp();Z.aS(C,z,[k[0]*J.tMin,k[1]*J.tMin,k[2]*J.tMin]);let O=Z.bp();return Z.aV(O,C),Bz(O)}let B=this._cachedClippingPlane,X=B[0]*k[0]+B[1]*k[1]+B[2]*k[2],V=-Z.b1(B,z)/X,L=Z.bp();if(V>0)Z.aS(L,z,[k[0]*V,k[1]*V,k[2]*V]);else{let C=Z.bp();Z.aS(C,z,[2*k[0],2*k[1],2*k[2]]);let O=Z.b1(this._cachedClippingPlane,C);Z.aU(L,C,[this._cachedClippingPlane[0]*O,this._cachedClippingPlane[1]*O,this._cachedClippingPlane[2]*O])}let F=function(C){let O=Z.bp();return O[0]=C[0]*-C[3],O[1]=C[1]*-C[3],O[2]=C[2]*-C[3],{center:O,radius:Math.sqrt(1-C[3]*C[3])}}(B);return Bz(function(C,O,d){let y=Z.bp();Z.aU(y,d,C);let T=Z.bp();return Z.bq(T,C,y,O/Z.a$(y)),T}(F.center,F.radius,L))}getMatrixForModel(b,z){let k=Z.S.convert(b),J=1/Z.bu,B=Z.b9();return Z.bz(B,B,k.lng/180*Math.PI),Z.b7(B,B,-k.lat/180*Math.PI),Z.M(B,B,[0,0,1+z/Z.bu]),Z.b7(B,B,0.5*Math.PI),Z.N(B,B,[J,J,J]),B}getProjectionDataForCustomLayer(b=!0){let z=this.getProjectionData({overscaledTileID:new Z.Z(0,0,0,0,0),applyGlobeMatrix:b});return z.tileMercatorCoords=[0,0,1,1],z}getFastPathSimpleProjectionMatrix(b){}}class c9{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(b){this._helper.setMinZoom(b)}setMaxZoom(b){this._helper.setMaxZoom(b)}setMinPitch(b){this._helper.setMinPitch(b)}setMaxPitch(b){this._helper.setMaxPitch(b)}setRenderWorldCopies(b){this._helper.setRenderWorldCopies(b)}setBearing(b){this._helper.setBearing(b)}setPitch(b){this._helper.setPitch(b)}setRoll(b){this._helper.setRoll(b)}setFov(b){this._helper.setFov(b)}setZoom(b){this._helper.setZoom(b)}setCenter(b){this._helper.setCenter(b)}setElevation(b){this._helper.setElevation(b)}setMinElevationForCurrentTile(b){this._helper.setMinElevationForCurrentTile(b)}setPadding(b){this._helper.setPadding(b)}interpolatePadding(b,z,k){return this._helper.interpolatePadding(b,z,k)}isPaddingEqual(b){return this._helper.isPaddingEqual(b)}resize(b,z,k=!0){this._helper.resize(b,z,k)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(b){this._helper.setMaxBounds(b)}setConstrain(b){this._helper.setConstrain(b)}overrideNearFarZ(b,z){this._helper.overrideNearFarZ(b,z)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(b){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),b)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrain(){return this._helper.constrain}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(b,z){this._globeness=b,this._globeLatitudeErrorCorrectionRadians=z,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(b){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(z,k)=>this.currentTransform.defaultConstrain(z,k),this._helper=new p5({calcMatrices:()=>{this._calcMatrices()},constrain:(z,k)=>this.defaultConstrain(z,k)},b),this._globeness=1,this._mercatorTransform=new V2,this._verticalPerspectiveTransform=new p9}clone(){let b=new c9;return b._globeness=this._globeness,b._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,b.apply(this),b}apply(b){this._helper.apply(b),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(b){let z=this._mercatorTransform.getProjectionData(b),k=this._verticalPerspectiveTransform.getProjectionData(b);return{mainMatrix:this.isGlobeRendering?k.mainMatrix:z.mainMatrix,clippingPlane:k.clippingPlane,tileMercatorCoords:k.tileMercatorCoords,projectionTransition:b.applyGlobeMatrix?this._globeness:0,fallbackMatrix:z.fallbackMatrix}}isLocationOccluded(b){return this.currentTransform.isLocationOccluded(b)}transformLightDirection(b){return this.currentTransform.transformLightDirection(b)}getPixelScale(){return Z.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return Z.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(b,z,k){let J=this._mercatorTransform.getPitchedTextCorrection(b,z,k),B=this._verticalPerspectiveTransform.getPitchedTextCorrection(b,z,k);return Z.bk(J,B,this._globeness)}projectTileCoordinates(b,z,k,J){return this.currentTransform.projectTileCoordinates(b,z,k,J)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(b){return this.currentTransform.calculateFogMatrix(b)}getVisibleUnwrappedCoordinates(b){return this.currentTransform.getVisibleUnwrappedCoordinates(b)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(b){this._mercatorTransform.recalculateZoomAndCenter(b),this._verticalPerspectiveTransform.recalculateZoomAndCenter(b)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(b,z){return this.currentTransform.lngLatToCameraDepth(b,z)}populateCache(b){this._mercatorTransform.populateCache(b),this._verticalPerspectiveTransform.populateCache(b)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(b,z,k,J){return this._helper.calculateCenterFromCameraLngLatAlt(b,z,k,J)}setLocationAtPoint(b,z){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(b,z),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(b,z),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(b,z){return this.currentTransform.locationToScreenPoint(b,z)}screenPointToMercatorCoordinate(b,z){return this.currentTransform.screenPointToMercatorCoordinate(b,z)}screenPointToLocation(b,z){return this.currentTransform.screenPointToLocation(b,z)}isPointOnMapSurface(b,z){return this.currentTransform.isPointOnMapSurface(b,z)}getRayDirectionFromPixel(b){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(b)}getMatrixForModel(b,z){return this.currentTransform.getMatrixForModel(b,z)}getProjectionDataForCustomLayer(b=!0){let z=this._mercatorTransform.getProjectionDataForCustomLayer(b);if(!this.isGlobeRendering)return z;let k=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(b);return k.fallbackMatrix=z.mainMatrix,k}getFastPathSimpleProjectionMatrix(b){return this.currentTransform.getFastPathSimpleProjectionMatrix(b)}}class _3{get useGlobeControls(){return!0}handlePanInertia(b,z){let k=Az(b,z);return Math.abs(k.lng-z.center.lng)>180&&(k.lng=z.center.lng+179.5*Math.sign(k.lng-z.center.lng)),{easingCenter:k,easingOffset:new Z.P(0,0)}}handleMapControlsRollPitchBearingZoom(b,z){let k=b.around,J=z.screenPointToLocation(k);b.bearingDelta&&z.setBearing(z.bearing+b.bearingDelta),b.pitchDelta&&z.setPitch(z.pitch+b.pitchDelta),b.rollDelta&&z.setRoll(z.roll+b.rollDelta);let B=z.zoom;b.zoomDelta&&z.setZoom(z.zoom+b.zoomDelta);let X=z.zoom-B;if(X===0)return;let V=Z.bA(z.center.lng,J.lng),L=V/(Math.abs(V/180)+1),F=Z.bA(z.center.lat,J.lat),C=z.getRayDirectionFromPixel(k),O=z.cameraPosition,d=-1*Z.aX(O,C),y=Z.bp();Z.aS(y,O,[C[0]*d,C[1]*d,C[2]*d]);let T=Z.aZ(y)-1,E=Math.exp(0.5*-Math.max(T-0.3,0)),p=o4(z.worldSize,z.center.lat)/Math.min(z.width,z.height),s=Z.bn(p,0.9,0.5,1,0.25),c=(1-Z.ah(-X))*Math.min(E,s),Z1=z.center.lat,a=z.zoom,x1=new Z.S(z.center.lng+L*c,Z.ae(z.center.lat+F*c,-Z.af,Z.af));z.setLocationAtPoint(J,k);let i=z.center,n=Z.bn(Math.abs(V),45,85,0,1),q1=Z.bn(p,0.75,0.35,0,1),V1=Math.pow(Math.max(n,q1),0.25),W1=Z.bA(i.lng,x1.lng),L1=Z.bA(i.lat,x1.lat);z.setCenter(new Z.S(i.lng+W1*V1,i.lat+L1*V1).wrap()),z.setZoom(a+e5(Z1,z.center.lat))}handleMapControlsPan(b,z,k){if(!b.panDelta)return;let J=z.center.lat,B=z.zoom;z.setCenter(Az(b.panDelta,z).wrap()),z.setZoom(B+e5(J,z.center.lat))}cameraForBoxAndBearing(b,z,k,J,B){let X=H6(b,z,k,J,B),V=z.left/B.width*2-1,L=(B.width-z.right)/B.width*2-1,F=z.top/B.height*-2+1,C=(B.height-z.bottom)/B.height*-2+1,O=Z.bA(k.getWest(),k.getEast())<0,d=O?k.getEast():k.getWest(),y=O?k.getWest():k.getEast(),T=Math.max(k.getNorth(),k.getSouth()),E=Math.min(k.getNorth(),k.getSouth()),p=d+0.5*Z.bA(d,y),s=T+0.5*Z.bA(T,E),c=B.clone();c.setCenter(X.center),c.setBearing(X.bearing),c.setPitch(0),c.setRoll(0),c.setZoom(X.zoom);let Z1=c.modelViewProjectionMatrix,a=[t5(k.getNorthWest()),t5(k.getNorthEast()),t5(k.getSouthWest()),t5(k.getSouthEast()),t5(new Z.S(y,s)),t5(new Z.S(d,s)),t5(new Z.S(p,T)),t5(new Z.S(p,E))],x1=t5(X.center),i=Number.POSITIVE_INFINITY;for(let n of a)V<0&&(i=_3.getLesserNonNegativeNonNull(i,_3.solveVectorScale(n,x1,Z1,"x",V))),L>0&&(i=_3.getLesserNonNegativeNonNull(i,_3.solveVectorScale(n,x1,Z1,"x",L))),F>0&&(i=_3.getLesserNonNegativeNonNull(i,_3.solveVectorScale(n,x1,Z1,"y",F))),C<0&&(i=_3.getLesserNonNegativeNonNull(i,_3.solveVectorScale(n,x1,Z1,"y",C)));if(Number.isFinite(i)&&i!==0)return X.zoom=c.zoom+Z.ak(i),X;g3()}handleJumpToCenterZoom(b,z){let k=b.center.lat,J=b.constrain(z.center?Z.S.convert(z.center):b.center,b.zoom).center;b.setCenter(J.wrap());let B=z.zoom!==void 0?+z.zoom:b.zoom+e5(k,J.lat);b.zoom!==B&&b.setZoom(B)}handleEaseTo(b,z){let{zoom:k,center:J,padding:B}=b,X={roll:b.roll,pitch:b.pitch,bearing:b.bearing},V={roll:z.roll===void 0?b.roll:z.roll,pitch:z.pitch===void 0?b.pitch:z.pitch,bearing:z.bearing===void 0?b.bearing:z.bearing},L=z.zoom!==void 0,F=!b.isPaddingEqual(z.padding),C=!1,O=z.center?Z.S.convert(z.center):J,d=b.constrain(O,k).center;z2(b,d);let y=b.clone();y.setCenter(d),y.setZoom(L?+z.zoom:k+e5(J.lat,O.lat)),y.setBearing(z.bearing);let T=new Z.P(Z.ae(b.centerPoint.x+z.offsetAsPoint.x,0,b.width),Z.ae(b.centerPoint.y+z.offsetAsPoint.y,0,b.height));y.setLocationAtPoint(d,T);let E=(z.offset&&z.offsetAsPoint.mag())>0?y.center:d,p=L?+z.zoom:k+e5(J.lat,E.lat),s=k+e5(J.lat,0),c=p+e5(E.lat,0),Z1=Z.bA(J.lng,E.lng),a=Z.bA(J.lat,E.lat),x1=Z.ah(c-s);return C=p!==k,{easeFunc:(i)=>{if(Z.be(X,V)||Pb({startEulerAngles:X,endEulerAngles:V,tr:b,k:i,useSlerp:X.roll!=V.roll}),F&&b.interpolatePadding(B,z.padding,i),z.around)Z.w("Easing around a point is not supported under globe projection."),b.setLocationAtPoint(z.around,z.aroundPoint);else{let n=c>s?Math.min(2,x1):Math.max(0.5,x1),q1=Math.pow(n,1-i),V1=j2(J,Z1,a,i*q1);b.setCenter(V1.wrap())}if(C){let n=Z.C.number(s,c,i)+e5(0,b.center.lat);b.setZoom(n)}},isZooming:C,elevationCenter:E}}handleFlyTo(b,z){let k=z.zoom!==void 0,J=b.center,B=b.zoom,X=b.padding,V=!b.isPaddingEqual(z.padding),L=b.constrain(Z.S.convert(z.center||z.locationAtOffset),B).center,F=k?+z.zoom:b.zoom+e5(b.center.lat,L.lat),C=b.clone();C.setCenter(L),C.setZoom(F),C.setBearing(z.bearing);let O=new Z.P(Z.ae(b.centerPoint.x+z.offsetAsPoint.x,0,b.width),Z.ae(b.centerPoint.y+z.offsetAsPoint.y,0,b.height));C.setLocationAtPoint(L,O);let d=C.center;z2(b,d);let y=function(a,x1,i){let n=t5(x1),q1=t5(i),V1=Z.aX(n,q1),W1=Math.acos(V1),L1=P9(a);return W1/(2*Math.PI)*L1}(b,J,d),T=B+e5(J.lat,0),E=F+e5(d.lat,0),p=Z.ah(E-T),s;if(typeof z.minZoom=="number"){let a=+z.minZoom+e5(d.lat,0),x1=Math.min(a,T,E)+e5(0,d.lat),i=b.constrain(d,x1).zoom+e5(d.lat,0);s=Z.ah(i-T)}let c=Z.bA(J.lng,d.lng),Z1=Z.bA(J.lat,d.lat);return{easeFunc:(a,x1,i,n)=>{let q1=j2(J,c,Z1,i);V&&b.interpolatePadding(X,z.padding,a);let V1=a===1?d:q1;b.setCenter(V1.wrap());let W1=T+Z.ak(x1);b.setZoom(a===1?F:W1+e5(0,V1.lat))},scaleOfZoom:p,targetCenter:d,scaleOfMinZoom:s,pixelPathLength:y}}static solveVectorScale(b,z,k,J,B){let X=J==="x"?[k[0],k[4],k[8],k[12]]:[k[1],k[5],k[9],k[13]],V=[k[3],k[7],k[11],k[15]],L=b[0]*X[0]+b[1]*X[1]+b[2]*X[2],F=b[0]*V[0]+b[1]*V[1]+b[2]*V[2],C=z[0]*X[0]+z[1]*X[1]+z[2]*X[2],O=z[0]*V[0]+z[1]*V[1]+z[2]*V[2];return C+B*F===L+B*O||V[3]*(L-C)+X[3]*(O-F)+L*O==C*F?null:(C+X[3]-B*O-B*V[3])/(C-L-B*O+B*F)}static getLesserNonNegativeNonNull(b,z){return z!==null&&z>=0&&z<b?z:b}}class cb{constructor(b){this._globe=b,this._mercatorCameraHelper=new H5,this._verticalPerspectiveCameraHelper=new _3}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(b,z){return this.currentHelper.handlePanInertia(b,z)}handleMapControlsRollPitchBearingZoom(b,z){return this.currentHelper.handleMapControlsRollPitchBearingZoom(b,z)}handleMapControlsPan(b,z,k){this.currentHelper.handleMapControlsPan(b,z,k)}cameraForBoxAndBearing(b,z,k,J,B){return this.currentHelper.cameraForBoxAndBearing(b,z,k,J,B)}handleJumpToCenterZoom(b,z){this.currentHelper.handleJumpToCenterZoom(b,z)}handleEaseTo(b,z){return this.currentHelper.handleEaseTo(b,z)}handleFlyTo(b,z){return this.currentHelper.handleFlyTo(b,z)}}let a9=(b,z)=>Z.y(b,z&&z.filter((k)=>k.identifier!=="source.canvas")),hZ=Z.bE();class F7 extends Z.E{constructor(b,z={}){var k,J;super(),this._rtlPluginLoaded=()=>{for(let X in this.sourceCaches){let V=this.sourceCaches[X].getSource().type;V!=="vector"&&V!=="geojson"||this.sourceCaches[X].reload()}},this.map=b,this.dispatcher=new s0(P0(),b._getMapId()),this.dispatcher.registerMessageHandler("GG",(X,V)=>this.getGlyphs(X,V)),this.dispatcher.registerMessageHandler("GI",(X,V)=>this.getImages(X,V)),this.dispatcher.registerMessageHandler("GDA",(X,V)=>this.getDashes(X,V)),this.imageManager=new q0,this.imageManager.setEventedParent(this);let B=((k=b._container)===null||k===void 0?void 0:k.lang)||typeof document<"u"&&((J=document.documentElement)===null||J===void 0?void 0:J.lang)||void 0;this.glyphManager=new X5(b._requestManager,z.localIdeographFontFamily,B),this.lineAtlas=new W5(256,512),this.crossTileSymbolIndex=new r4,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new Z.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",Z.bG()),V3().on(e2,this._rtlPluginLoaded),this.on("data",(X)=>{if(X.dataType!=="source"||X.sourceDataType!=="metadata")return;let V=this.sourceCaches[X.sourceId];if(!V)return;let L=V.getSource();if(L&&L.vectorLayerIds)for(let F in this._layers){let C=this._layers[F];C.source===L.id&&this._validateLayer(C)}})}setGlobalStateProperty(b,z){var k,J,B;this._checkLoaded();let X=z===null?(B=(J=(k=this.stylesheet.state)===null||k===void 0?void 0:k[b])===null||J===void 0?void 0:J.default)!==null&&B!==void 0?B:null:z;if(Z.bH(X,this._globalState[b]))return this;this._globalState[b]=X,this._applyGlobalStateChanges([b])}getGlobalState(){return this._globalState}setGlobalState(b){this._checkLoaded();let z=[];for(let k in b)!Z.bH(this._globalState[k],b[k].default)&&(z.push(k),this._globalState[k]=b[k].default);this._applyGlobalStateChanges(z)}_applyGlobalStateChanges(b){if(b.length===0)return;let z=new Set,k={};for(let J of b){k[J]=this._globalState[J];for(let B in this._layers){let X=this._layers[B],V=X.getLayoutAffectingGlobalStateRefs(),L=X.getPaintAffectingGlobalStateRefs();if(V.has(J)&&z.add(X.source),L.has(J))for(let{name:F,value:C}of L.get(J))this._updatePaintProperty(X,F,C)}}this.dispatcher.broadcast("UGS",k);for(let J in this.sourceCaches)z.has(J)&&(this._reloadSource(J),this._changed=!0)}loadURL(b,z={},k){this.fire(new Z.l("dataloading",{dataType:"style"})),z.validate=typeof z.validate!="boolean"||z.validate;let J=this.map._requestManager.transformRequest(b,"Style");this._loadStyleRequest=new AbortController;let B=this._loadStyleRequest;Z.j(J,this._loadStyleRequest).then((X)=>{this._loadStyleRequest=null,this._load(X.data,z,k)}).catch((X)=>{this._loadStyleRequest=null,X&&!B.signal.aborted&&this.fire(new Z.k(X))})}loadJSON(b,z={},k){this.fire(new Z.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,H1.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,z.validate=z.validate!==!1,this._load(b,z,k)}).catch(()=>{})}loadEmpty(){this.fire(new Z.l("dataloading",{dataType:"style"})),this._load(hZ,{validate:!1})}_load(b,z,k){var J,B;let X=z.transformStyle?z.transformStyle(k,b):b;if(!z.validate||!a9(this,Z.z(X))){X=Object.assign({},X),this._loaded=!0,this.stylesheet=X;for(let V in X.sources)this.addSource(V,X.sources[V],{validate:!1});X.sprite?this._loadSprite(X.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(X.glyphs),this._createLayers(),this.light=new C0(this.stylesheet.light),this._setProjectionInternal(((J=this.stylesheet.projection)===null||J===void 0?void 0:J.type)||"mercator"),this.sky=new b0(this.stylesheet.sky),this.map.setTerrain((B=this.stylesheet.terrain)!==null&&B!==void 0?B:null),this.fire(new Z.l("data",{dataType:"style"})),this.fire(new Z.l("style.load"))}}_createLayers(){var b,z,k;let J=Z.bI(this.stylesheet.layers);this.setGlobalState((b=this.stylesheet.state)!==null&&b!==void 0?b:null),this.dispatcher.broadcast("SL",J),this._order=J.map((B)=>B.id),this._layers={},this._serializedLayers=null;for(let B of J){let X=Z.bJ(B,this._globalState);if(X.setEventedParent(this,{layer:{id:B.id}}),this._layers[B.id]=X,Z.bK(X)&&this.sourceCaches[X.source]){let V=(k=(z=B.paint)===null||z===void 0?void 0:z["raster-fade-duration"])!==null&&k!==void 0?k:X.paint.get("raster-fade-duration");this.sourceCaches[X.source].setRasterFadeDuration(V)}}}_loadSprite(b,z=!1,k=void 0){let J;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(B,X,V,L){return Z._(this,void 0,void 0,function*(){let F=k0(B),C=V>1?"@2x":"",O={},d={};for(let{id:y,url:T}of F){let E=X.transformRequest(r1(T,C,".json"),"SpriteJSON");O[y]=Z.j(E,L);let p=X.transformRequest(r1(T,C,".png"),"SpriteImage");d[y]=F1.getImage(p,L)}return yield Promise.all([...Object.values(O),...Object.values(d)]),function(y,T){return Z._(this,void 0,void 0,function*(){let E={};for(let p in y){E[p]={};let s=H1.getImageCanvasContext((yield T[p]).data),c=(yield y[p]).data;for(let Z1 in c){let{width:a,height:x1,x:i,y:n,sdf:q1,pixelRatio:V1,stretchX:W1,stretchY:L1,content:Q1,textFitWidth:O1,textFitHeight:I1}=c[Z1];E[p][Z1]={data:null,pixelRatio:V1,sdf:q1,stretchX:W1,stretchY:L1,content:Q1,textFitWidth:O1,textFitHeight:I1,spriteData:{width:a,height:x1,x:i,y:n,context:s}}}}return E})}(O,d)})}(b,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((B)=>{if(this._spriteRequest=null,B)for(let X in B){this._spritesImagesIds[X]=[];let V=this._spritesImagesIds[X]?this._spritesImagesIds[X].filter((L)=>!(L in B)):[];for(let L of V)this.imageManager.removeImage(L),this._changedImages[L]=!0;for(let L in B[X]){let F=X==="default"?L:`${X}:${L}`;this._spritesImagesIds[X].push(F),F in this.imageManager.images?this.imageManager.updateImage(F,B[X][L],!1):this.imageManager.addImage(F,B[X][L]),z&&(this._changedImages[F]=!0)}}}).catch((B)=>{this._spriteRequest=null,J=B,this.fire(new Z.k(J))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),z&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new Z.l("data",{dataType:"style"})),k&&k(J)})}_unloadSprite(){for(let b of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(b),this._changedImages[b]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new Z.l("data",{dataType:"style"}))}_validateLayer(b){let z=this.sourceCaches[b.source];if(!z)return;let k=b.sourceLayer;if(!k)return;let J=z.getSource();(J.type==="geojson"||J.vectorLayerIds&&J.vectorLayerIds.indexOf(k)===-1)&&this.fire(new Z.k(Error(`Source layer "${k}" does not exist on source "${J.id}" as specified by style layer "${b.id}".`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(let b in this.sourceCaches)if(!this.sourceCaches[b].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(b,z=!1){let k=this._serializedAllLayers();if(!b||b.length===0)return Object.values(z?Z.bL(k):k);let J=[];for(let B of b)if(k[B]){let X=z?Z.bL(k[B]):k[B];J.push(X)}return J}_serializedAllLayers(){let b=this._serializedLayers;if(b)return b;b=this._serializedLayers={};let z=Object.keys(this._layers);for(let k of z){let J=this._layers[k];J.type!=="custom"&&(b[k]=J.serialize())}return b}hasTransitions(){var b,z,k;if((b=this.light)===null||b===void 0?void 0:b.hasTransition())return!0;if((z=this.sky)===null||z===void 0?void 0:z.hasTransition())return!0;if((k=this.projection)===null||k===void 0?void 0:k.hasTransition())return!0;for(let J in this.sourceCaches)if(this.sourceCaches[J].hasTransition())return!0;for(let J in this._layers)if(this._layers[J].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw Error("Style is not done loading.")}update(b){if(!this._loaded)return;let z=this._changed;if(z){let J=Object.keys(this._updatedLayers),B=Object.keys(this._removedLayers);(J.length||B.length)&&this._updateWorkerLayers(J,B);for(let X in this._updatedSources){let V=this._updatedSources[X];if(V==="reload")this._reloadSource(X);else{if(V!=="clear")throw Error(`Invalid action ${V}`);this._clearSource(X)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let X in this._updatedPaintProps)this._layers[X].updateTransitions(b);this.light.updateTransitions(b),this.sky.updateTransitions(b),this._resetUpdates()}let k={};for(let J in this.sourceCaches){let B=this.sourceCaches[J];k[J]=B.used,B.used=!1}for(let J of this._order){let B=this._layers[J];B.recalculate(b,this._availableImages),!B.isHidden(b.zoom)&&B.source&&(this.sourceCaches[B.source].used=!0)}for(let J in k){let B=this.sourceCaches[J];!!k[J]!=!!B.used&&B.fire(new Z.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:J}))}this.light.recalculate(b),this.sky.recalculate(b),this.projection.recalculate(b),this.z=b.zoom,z&&this.fire(new Z.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){let b=Object.keys(this._changedImages);if(b.length){for(let z in this.sourceCaches)this.sourceCaches[z].reloadTilesForDependencies(["icons","patterns"],b);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let b in this.sourceCaches)this.sourceCaches[b].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(b,z){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(b,!1),removedIds:z})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(b,z={}){var k;this._checkLoaded();let J=this.serialize();if(b=z.transformStyle?z.transformStyle(J,b):b,((k=z.validate)===null||k===void 0||k)&&a9(this,Z.z(b)))return!1;(b=Z.bL(b)).layers=Z.bI(b.layers);let B=Z.bM(J,b),X=this._getOperationsToPerform(B);if(X.unimplemented.length>0)throw Error(`Unimplemented: ${X.unimplemented.join(", ")}.`);if(X.operations.length===0)return!1;for(let V of X.operations)V();return this.stylesheet=b,this._serializedLayers=null,!0}_getOperationsToPerform(b){let z=[],k=[];for(let J of b)switch(J.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":z.push(()=>this.addLayer.apply(this,J.args));break;case"removeLayer":z.push(()=>this.removeLayer.apply(this,J.args));break;case"setPaintProperty":z.push(()=>this.setPaintProperty.apply(this,J.args));break;case"setLayoutProperty":z.push(()=>this.setLayoutProperty.apply(this,J.args));break;case"setFilter":z.push(()=>this.setFilter.apply(this,J.args));break;case"addSource":z.push(()=>this.addSource.apply(this,J.args));break;case"removeSource":z.push(()=>this.removeSource.apply(this,J.args));break;case"setLayerZoomRange":z.push(()=>this.setLayerZoomRange.apply(this,J.args));break;case"setLight":z.push(()=>this.setLight.apply(this,J.args));break;case"setGeoJSONSourceData":z.push(()=>this.setGeoJSONSourceData.apply(this,J.args));break;case"setGlyphs":z.push(()=>this.setGlyphs.apply(this,J.args));break;case"setSprite":z.push(()=>this.setSprite.apply(this,J.args));break;case"setTerrain":z.push(()=>this.map.setTerrain.apply(this,J.args));break;case"setSky":z.push(()=>this.setSky.apply(this,J.args));break;case"setProjection":this.setProjection.apply(this,J.args);break;case"setGlobalState":z.push(()=>this.setGlobalState.apply(this,J.args));break;case"setTransition":z.push(()=>{});break;default:k.push(J.command)}return{operations:z,unimplemented:k}}addImage(b,z){if(this.getImage(b))return this.fire(new Z.k(Error(`An image named "${b}" already exists.`)));this.imageManager.addImage(b,z),this._afterImageUpdated(b)}updateImage(b,z){this.imageManager.updateImage(b,z)}getImage(b){return this.imageManager.getImage(b)}removeImage(b){if(!this.getImage(b))return this.fire(new Z.k(Error(`An image named "${b}" does not exist.`)));this.imageManager.removeImage(b),this._afterImageUpdated(b)}_afterImageUpdated(b){this._availableImages=this.imageManager.listImages(),this._changedImages[b]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new Z.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(b,z,k={}){if(this._checkLoaded(),this.sourceCaches[b]!==void 0)throw Error(`Source "${b}" already exists.`);if(!z.type)throw Error(`The type property must be defined, but only the following properties were given: ${Object.keys(z).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(z.type)>=0&&this._validate(Z.z.source,`sources.${b}`,z,null,k))return;this.map&&this.map._collectResourceTiming&&(z.collectResourceTiming=!0);let J=this.sourceCaches[b]=new M0(b,z,this.dispatcher);J.style=this,J.setEventedParent(this,()=>({isSourceLoaded:J.loaded(),source:J.serialize(),sourceId:b})),J.onAdd(this.map),this._changed=!0}removeSource(b){if(this._checkLoaded(),this.sourceCaches[b]===void 0)throw Error("There is no source with this ID");for(let k in this._layers)if(this._layers[k].source===b)return this.fire(new Z.k(Error(`Source "${b}" cannot be removed while layer "${k}" is using it.`)));let z=this.sourceCaches[b];delete this.sourceCaches[b],delete this._updatedSources[b],z.fire(new Z.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:b})),z.setEventedParent(null),z.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(b,z){if(this._checkLoaded(),this.sourceCaches[b]===void 0)throw Error(`There is no source with this ID=${b}`);let k=this.sourceCaches[b].getSource();if(k.type!=="geojson")throw Error(`geojsonSource.type is ${k.type}, which is !== 'geojson`);k.setData(z),this._changed=!0}getSource(b){return this.sourceCaches[b]&&this.sourceCaches[b].getSource()}addLayer(b,z,k={}){this._checkLoaded();let J=b.id;if(this.getLayer(J))return void this.fire(new Z.k(Error(`Layer "${J}" already exists on this map.`)));let B;if(b.type==="custom"){if(a9(this,Z.bN(b)))return;B=Z.bJ(b,this._globalState)}else{if("source"in b&&typeof b.source=="object"&&(this.addSource(J,b.source),b=Z.bL(b),b=Z.e(b,{source:J})),this._validate(Z.z.layer,`layers.${J}`,b,{arrayIndex:-1},k))return;B=Z.bJ(b,this._globalState),this._validateLayer(B),B.setEventedParent(this,{layer:{id:J}})}let X=z?this._order.indexOf(z):this._order.length;if(z&&X===-1)this.fire(new Z.k(Error(`Cannot add layer "${J}" before non-existing layer "${z}".`)));else{if(this._order.splice(X,0,J),this._layerOrderChanged=!0,this._layers[J]=B,this._removedLayers[J]&&B.source&&B.type!=="custom"){let V=this._removedLayers[J];delete this._removedLayers[J],V.type!==B.type?this._updatedSources[B.source]="clear":(this._updatedSources[B.source]="reload",this.sourceCaches[B.source].pause())}this._updateLayer(B),B.onAdd&&B.onAdd(this.map)}}moveLayer(b,z){if(this._checkLoaded(),this._changed=!0,!this._layers[b])return void this.fire(new Z.k(Error(`The layer '${b}' does not exist in the map's style and cannot be moved.`)));if(b===z)return;let k=this._order.indexOf(b);this._order.splice(k,1);let J=z?this._order.indexOf(z):this._order.length;z&&J===-1?this.fire(new Z.k(Error(`Cannot move layer "${b}" before non-existing layer "${z}".`))):(this._order.splice(J,0,b),this._layerOrderChanged=!0)}removeLayer(b){this._checkLoaded();let z=this._layers[b];if(!z)return void this.fire(new Z.k(Error(`Cannot remove non-existing layer "${b}".`)));z.setEventedParent(null);let k=this._order.indexOf(b);this._order.splice(k,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[b]=z,delete this._layers[b],this._serializedLayers&&delete this._serializedLayers[b],delete this._updatedLayers[b],delete this._updatedPaintProps[b],z.onRemove&&z.onRemove(this.map)}getLayer(b){return this._layers[b]}getLayersOrder(){return[...this._order]}hasLayer(b){return b in this._layers}setLayerZoomRange(b,z,k){this._checkLoaded();let J=this.getLayer(b);J?J.minzoom===z&&J.maxzoom===k||(z!=null&&(J.minzoom=z),k!=null&&(J.maxzoom=k),this._updateLayer(J)):this.fire(new Z.k(Error(`Cannot set the zoom range of non-existing layer "${b}".`)))}setFilter(b,z,k={}){this._checkLoaded();let J=this.getLayer(b);if(J){if(!Z.bH(J.filter,z))return z==null?(J.setFilter(void 0),void this._updateLayer(J)):void(this._validate(Z.z.filter,`layers.${J.id}.filter`,z,null,k)||(J.setFilter(Z.bL(z)),this._updateLayer(J)))}else this.fire(new Z.k(Error(`Cannot filter non-existing layer "${b}".`)))}getFilter(b){return Z.bL(this.getLayer(b).filter)}setLayoutProperty(b,z,k,J={}){this._checkLoaded();let B=this.getLayer(b);B?Z.bH(B.getLayoutProperty(z),k)||(B.setLayoutProperty(z,k,J),this._updateLayer(B)):this.fire(new Z.k(Error(`Cannot style non-existing layer "${b}".`)))}getLayoutProperty(b,z){let k=this.getLayer(b);if(k)return k.getLayoutProperty(z);this.fire(new Z.k(Error(`Cannot get style of non-existing layer "${b}".`)))}setPaintProperty(b,z,k,J={}){this._checkLoaded();let B=this.getLayer(b);B?Z.bH(B.getPaintProperty(z),k)||this._updatePaintProperty(B,z,k,J):this.fire(new Z.k(Error(`Cannot style non-existing layer "${b}".`)))}_updatePaintProperty(b,z,k,J={}){b.setPaintProperty(z,k,J)&&this._updateLayer(b),Z.bK(b)&&z==="raster-fade-duration"&&this.sourceCaches[b.source].setRasterFadeDuration(k),this._changed=!0,this._updatedPaintProps[b.id]=!0,this._serializedLayers=null}getPaintProperty(b,z){return this.getLayer(b).getPaintProperty(z)}setFeatureState(b,z){this._checkLoaded();let{source:k,sourceLayer:J}=b,B=this.sourceCaches[k];if(B===void 0)return void this.fire(new Z.k(Error(`The source '${k}' does not exist in the map's style.`)));let X=B.getSource().type;X==="geojson"&&J?this.fire(new Z.k(Error("GeoJSON sources cannot have a sourceLayer parameter."))):X!=="vector"||J?(b.id===void 0&&this.fire(new Z.k(Error("The feature id parameter must be provided."))),B.setFeatureState(J,b.id,z)):this.fire(new Z.k(Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(b,z){this._checkLoaded();let k=b.source,J=this.sourceCaches[k];if(J===void 0)return void this.fire(new Z.k(Error(`The source '${k}' does not exist in the map's style.`)));let B=J.getSource().type,X=B==="vector"?b.sourceLayer:void 0;B!=="vector"||X?z&&typeof b.id!="string"&&typeof b.id!="number"?this.fire(new Z.k(Error("A feature id is required to remove its specific state property."))):J.removeFeatureState(X,b.id,z):this.fire(new Z.k(Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(b){this._checkLoaded();let{source:z,sourceLayer:k}=b,J=this.sourceCaches[z];if(J!==void 0)return J.getSource().type!=="vector"||k?(b.id===void 0&&this.fire(new Z.k(Error("The feature id parameter must be provided."))),J.getFeatureState(k,b.id)):void this.fire(new Z.k(Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new Z.k(Error(`The source '${z}' does not exist in the map's style.`)))}getTransition(){return Z.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let b=Z.bO(this.sourceCaches,(B)=>B.serialize()),z=this._serializeByIds(this._order,!0),k=this.map.getTerrain()||void 0,J=this.stylesheet;return Z.bP({version:J.version,name:J.name,metadata:J.metadata,light:J.light,sky:J.sky,center:J.center,zoom:J.zoom,bearing:J.bearing,pitch:J.pitch,sprite:J.sprite,glyphs:J.glyphs,transition:J.transition,projection:J.projection,sources:b,layers:z,terrain:k},(B)=>B!==void 0)}_updateLayer(b){this._updatedLayers[b.id]=!0,b.source&&!this._updatedSources[b.source]&&this.sourceCaches[b.source].getSource().type!=="raster"&&(this._updatedSources[b.source]="reload",this.sourceCaches[b.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(b){let z=(X)=>this._layers[X].type==="fill-extrusion",k={},J=[];for(let X=this._order.length-1;X>=0;X--){let V=this._order[X];if(z(V)){k[V]=X;for(let L of b){let F=L[V];if(F)for(let C of F)J.push(C)}}}J.sort((X,V)=>V.intersectionZ-X.intersectionZ);let B=[];for(let X=this._order.length-1;X>=0;X--){let V=this._order[X];if(z(V))for(let L=J.length-1;L>=0;L--){let F=J[L].feature;if(k[F.layer.id]<X)break;B.push(F),J.pop()}else for(let L of b){let F=L[V];if(F)for(let C of F)B.push(C.feature)}}return B}queryRenderedFeatures(b,z,k){z&&z.filter&&this._validate(Z.z.filter,"queryRenderedFeatures.filter",z.filter,null,z);let J={};if(z&&z.layers){if(!(Array.isArray(z.layers)||z.layers instanceof Set))return this.fire(new Z.k(Error("parameters.layers must be an Array or a Set of strings"))),[];for(let F of z.layers){let C=this._layers[F];if(!C)return this.fire(new Z.k(Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];J[C.source]=!0}}let B=[];z.availableImages=this._availableImages;let X=this._serializedAllLayers(),V=z.layers instanceof Set?z.layers:Array.isArray(z.layers)?new Set(z.layers):null,L=Object.assign(Object.assign({},z),{layers:V,globalState:this._globalState});for(let F in this.sourceCaches)z.layers&&!J[F]||B.push(M2(this.sourceCaches[F],this._layers,X,b,L,k,this.map.terrain?(C,O,d)=>this.map.terrain.getElevation(C,O,d):void 0));return this.placement&&B.push(function(F,C,O,d,y,T,E){let p={},s=T.queryRenderedSymbols(d),c=[];for(let Z1 of Object.keys(s).map(Number))c.push(E[Z1]);c.sort(h5);for(let Z1 of c){let a=Z1.featureIndex.lookupSymbolFeatures(s[Z1.bucketInstanceId],C,Z1.bucketIndex,Z1.sourceLayerIndex,{filterSpec:y.filter,globalState:y.globalState},y.layers,y.availableImages,F);for(let x1 in a){let i=p[x1]=p[x1]||[],n=a[x1];n.sort((q1,V1)=>{let W1=Z1.featureSortOrder;if(W1){let L1=W1.indexOf(q1.featureIndex);return W1.indexOf(V1.featureIndex)-L1}return V1.featureIndex-q1.featureIndex});for(let q1 of n)i.push(q1)}}return function(Z1,a,x1){for(let i in Z1)for(let n of Z1[i])d2(n,x1[a[i].source]);return Z1}(p,F,O)}(this._layers,X,this.sourceCaches,b,L,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(B)}querySourceFeatures(b,z){(z==null?void 0:z.filter)&&this._validate(Z.z.filter,"querySourceFeatures.filter",z.filter,null,z);let k=this.sourceCaches[b];return k?function(J,B){let X=J.getRenderableIds().map((F)=>J.getTileByID(F)),V=[],L={};for(let F=0;F<X.length;F++){let C=X[F],O=C.tileID.canonical.key;L[O]||(L[O]=!0,C.querySourceFeatures(V,B))}return V}(k,z?Object.assign(Object.assign({},z),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(b,z={}){this._checkLoaded();let k=this.light.getLight(),J=!1;for(let X in b)if(!Z.bH(b[X],k[X])){J=!0;break}if(!J)return;let B={now:z1(),transition:Z.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(b,z),this.light.updateTransitions(B)}getProjection(){var b;return(b=this.stylesheet)===null||b===void 0?void 0:b.projection}setProjection(b){if(this._checkLoaded(),this.projection){if(this.projection.name===b.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=b,this._setProjectionInternal(b.type)}getSky(){var b;return(b=this.stylesheet)===null||b===void 0?void 0:b.sky}setSky(b,z={}){this._checkLoaded();let k=this.getSky(),J=!1;if(!b&&!k)return;if(b&&!k)J=!0;else if(!b&&k)J=!0;else for(let X in b)if(!Z.bH(b[X],k[X])){J=!0;break}if(!J)return;let B={now:z1(),transition:Z.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=b,this.sky.setSky(b,z),this.sky.updateTransitions(B)}_setProjectionInternal(b){let z=function(k,J){let B={constrain:J};if(Array.isArray(k)){let X=new D8({type:k});return{projection:X,transform:new c9(B),cameraHelper:new cb(X)}}switch(k){case"mercator":return{projection:new V7,transform:new V2(B),cameraHelper:new H5};case"globe":{let X=new D8({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:X,transform:new c9(B),cameraHelper:new cb(X)}}case"vertical-perspective":return{projection:new C8,transform:new p9(B),cameraHelper:new _3};default:return Z.w(`Unknown projection name: ${k}. Falling back to mercator projection.`),{projection:new V7,transform:new V2(B),cameraHelper:new H5}}}(b,this.map.transformConstrain);this.projection=z.projection,this.map.migrateProjection(z.transform,z.cameraHelper);for(let k in this.sourceCaches)this.sourceCaches[k].reload()}_validate(b,z,k,J,B={}){return(!B||B.validate!==!1)&&a9(this,b.call(Z.z,Z.e({key:z,style:this.serialize(),value:k,styleSpec:Z.v},J)))}_remove(b=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),V3().off(e2,this._rtlPluginLoaded);for(let z in this._layers)this._layers[z].setEventedParent(null);for(let z in this.sourceCaches){let k=this.sourceCaches[z];k.setEventedParent(null),k.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),b&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(b)}_clearSource(b){this.sourceCaches[b].clearTiles()}_reloadSource(b){this.sourceCaches[b].resume(),this.sourceCaches[b].reload()}_updateSources(b){for(let z in this.sourceCaches)this.sourceCaches[z].update(b,this.map.terrain)}_generateCollisionBoxes(){for(let b in this.sourceCaches)this._reloadSource(b)}_updatePlacement(b,z,k,J,B=!1){let X=!1,V=!1,L={};for(let F of this._order){let C=this._layers[F];if(C.type!=="symbol")continue;if(!L[C.source]){let d=this.sourceCaches[C.source];L[C.source]=d.getRenderableIds(!0).map((y)=>d.getTileByID(y)).sort((y,T)=>T.tileID.overscaledZ-y.tileID.overscaledZ||(y.tileID.isLessThan(T.tileID)?-1:1))}let O=this.crossTileSymbolIndex.addLayer(C,L[C.source],b.center.lng);X=X||O}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((B=B||this._layerOrderChanged||k===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(z1(),b.zoom))&&(this.pauseablePlacement=new j9(b,this.map.terrain,this._order,B,z,k,J,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(z1()),V=!0),X&&this.pauseablePlacement.placement.setStale()),V||X)for(let F of this._order){let C=this._layers[F];C.type==="symbol"&&this.placement.updateLayerOpacities(C,L[C.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(z1())}_releaseSymbolFadeTiles(){for(let b in this.sourceCaches)this.sourceCaches[b].releaseSymbolFadeTiles()}getImages(b,z){return Z._(this,void 0,void 0,function*(){let k=yield this.imageManager.getImages(z.icons);this._updateTilesForChangedImages();let J=this.sourceCaches[z.source];return J&&J.setDependencies(z.tileID.key,z.type,z.icons),k})}getGlyphs(b,z){return Z._(this,void 0,void 0,function*(){let k=yield this.glyphManager.getGlyphs(z.stacks),J=this.sourceCaches[z.source];return J&&J.setDependencies(z.tileID.key,z.type,[""]),k})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(b,z={}){this._checkLoaded(),b&&this._validate(Z.z.glyphs,"glyphs",b,null,z)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=b,this.glyphManager.entries={},this.glyphManager.setURL(b))}getDashes(b,z){return Z._(this,void 0,void 0,function*(){let k={};for(let[J,B]of Object.entries(z.dashes))k[J]=this.lineAtlas.getDash(B.dasharray,B.round);return k})}addSprite(b,z,k={},J){this._checkLoaded();let B=[{id:b,url:z}],X=[...k0(this.stylesheet.sprite),...B];this._validate(Z.z.sprite,"sprite",X,null,k)||(this.stylesheet.sprite=X,this._loadSprite(B,!0,J))}removeSprite(b){this._checkLoaded();let z=k0(this.stylesheet.sprite);if(z.find((k)=>k.id===b)){if(this._spritesImagesIds[b])for(let k of this._spritesImagesIds[b])this.imageManager.removeImage(k),this._changedImages[k]=!0;z.splice(z.findIndex((k)=>k.id===b),1),this.stylesheet.sprite=z.length>0?z:void 0,delete this._spritesImagesIds[b],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new Z.l("data",{dataType:"style"}))}else this.fire(new Z.k(Error(`Sprite "${b}" doesn't exists on this map.`)))}getSprite(){return k0(this.stylesheet.sprite)}setSprite(b,z={},k){this._checkLoaded(),b&&this._validate(Z.z.sprite,"sprite",b,null,z)||(this.stylesheet.sprite=b,b?this._loadSprite(b,!0,k):(this._unloadSprite(),k&&k(null)))}}var ab=Z.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class d8{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(b,z,k,J,B,X,V,L,F){this.context=b;let C=this.boundPaintVertexBuffers.length!==J.length;for(let O=0;!C&&O<J.length;O++)this.boundPaintVertexBuffers[O]!==J[O]&&(C=!0);!this.vao||this.boundProgram!==z||this.boundLayoutVertexBuffer!==k||C||this.boundIndexBuffer!==B||this.boundVertexOffset!==X||this.boundDynamicVertexBuffer!==V||this.boundDynamicVertexBuffer2!==L||this.boundDynamicVertexBuffer3!==F?this.freshBind(z,k,J,B,X,V,L,F):(b.bindVertexArray.set(this.vao),V&&V.bind(),B&&B.dynamicDraw&&B.bind(),L&&L.bind(),F&&F.bind())}freshBind(b,z,k,J,B,X,V,L){let F=b.numAttributes,C=this.context,O=C.gl;this.vao&&this.destroy(),this.vao=C.createVertexArray(),C.bindVertexArray.set(this.vao),this.boundProgram=b,this.boundLayoutVertexBuffer=z,this.boundPaintVertexBuffers=k,this.boundIndexBuffer=J,this.boundVertexOffset=B,this.boundDynamicVertexBuffer=X,this.boundDynamicVertexBuffer2=V,this.boundDynamicVertexBuffer3=L,z.enableAttributes(O,b);for(let d of k)d.enableAttributes(O,b);X&&X.enableAttributes(O,b),V&&V.enableAttributes(O,b),L&&L.enableAttributes(O,b),z.bind(),z.setVertexAttribPointers(O,b,B);for(let d of k)d.bind(),d.setVertexAttribPointers(O,b,B);X&&(X.bind(),X.setVertexAttribPointers(O,b,B)),J&&J.bind(),V&&(V.bind(),V.setVertexAttribPointers(O,b,B)),L&&(L.bind(),L.setVertexAttribPointers(O,b,B)),C.currentNumAttributes=F}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}let rb=(b,z,k,J,B)=>({u_texture:0,u_ele_delta:b,u_fog_matrix:z,u_fog_color:k?k.properties.get("fog-color"):Z.bf.white,u_fog_ground_blend:k?k.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:B?0:k?k.calculateFogBlendOpacity(J):0,u_horizon_color:k?k.properties.get("horizon-color"):Z.bf.white,u_horizon_fog_blend:k?k.properties.get("horizon-fog-blend"):1,u_is_globe_mode:B?1:0}),ob={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function k3(b){let z=[];for(let k=0;k<b.length;k++){if(b[k]===null)continue;let J=b[k].split(" ");z.push(J.pop())}return z}class Mz{constructor(b,z,k,J,B,X,V,L,F=[]){let C=b.gl;this.program=C.createProgram();let O=k3(z.staticAttributes),d=k?k.getBinderAttributes():[],y=O.concat(d),T=q4.prelude.staticUniforms?k3(q4.prelude.staticUniforms):[],E=V.staticUniforms?k3(V.staticUniforms):[],p=z.staticUniforms?k3(z.staticUniforms):[],s=k?k.getBinderUniforms():[],c=T.concat(E).concat(p).concat(s),Z1=[];for(let W1 of c)Z1.indexOf(W1)<0&&Z1.push(W1);let a=k?k.defines():[];j3(C)&&a.unshift("#version 300 es"),B&&a.push("#define OVERDRAW_INSPECTOR;"),X&&a.push("#define TERRAIN3D;"),L&&a.push(L),F&&a.push(...F);let x1=a.concat(q4.prelude.fragmentSource,V.fragmentSource,z.fragmentSource).join(`
`),i=a.concat(q4.prelude.vertexSource,V.vertexSource,z.vertexSource).join(`
`);j3(C)||(x1=function(W1){return W1.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(x1),i=function(W1){return W1.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(i));let n=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(n,x1),C.compileShader(n),!C.getShaderParameter(n,C.COMPILE_STATUS))throw Error(`Could not compile fragment shader: ${C.getShaderInfoLog(n)}`);C.attachShader(this.program,n);let q1=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);if(C.shaderSource(q1,i),C.compileShader(q1),!C.getShaderParameter(q1,C.COMPILE_STATUS))throw Error(`Could not compile vertex shader: ${C.getShaderInfoLog(q1)}`);C.attachShader(this.program,q1),this.attributes={};let V1={};this.numAttributes=y.length;for(let W1=0;W1<this.numAttributes;W1++)y[W1]&&(C.bindAttribLocation(this.program,W1,y[W1]),this.attributes[y[W1]]=W1);if(C.linkProgram(this.program),!C.getProgramParameter(this.program,C.LINK_STATUS))throw Error(`Program failed to link: ${C.getProgramInfoLog(this.program)}`);C.deleteShader(q1),C.deleteShader(n);for(let W1=0;W1<Z1.length;W1++){let L1=Z1[W1];if(L1&&!V1[L1]){let Q1=C.getUniformLocation(this.program,L1);Q1&&(V1[L1]=Q1)}}this.fixedUniforms=J(b,V1),this.terrainUniforms=((W1,L1)=>({u_depth:new Z.bQ(W1,L1.u_depth),u_terrain:new Z.bQ(W1,L1.u_terrain),u_terrain_dim:new Z.bg(W1,L1.u_terrain_dim),u_terrain_matrix:new Z.bS(W1,L1.u_terrain_matrix),u_terrain_unpack:new Z.bT(W1,L1.u_terrain_unpack),u_terrain_exaggeration:new Z.bg(W1,L1.u_terrain_exaggeration)}))(b,V1),this.projectionUniforms=((W1,L1)=>({u_projection_matrix:new Z.bS(W1,L1.u_projection_matrix),u_projection_tile_mercator_coords:new Z.bT(W1,L1.u_projection_tile_mercator_coords),u_projection_clipping_plane:new Z.bT(W1,L1.u_projection_clipping_plane),u_projection_transition:new Z.bg(W1,L1.u_projection_transition),u_projection_fallback_matrix:new Z.bS(W1,L1.u_projection_fallback_matrix)}))(b,V1),this.binderUniforms=k?k.getUniforms(b,V1):[]}draw(b,z,k,J,B,X,V,L,F,C,O,d,y,T,E,p,s,c,Z1){let a=b.gl;if(this.failedToCreate)return;if(b.program.set(this.program),b.setDepthMode(k),b.setStencilMode(J),b.setColorMode(B),b.setCullFace(X),L){b.activeTexture.set(a.TEXTURE2),a.bindTexture(a.TEXTURE_2D,L.depthTexture),b.activeTexture.set(a.TEXTURE3),a.bindTexture(a.TEXTURE_2D,L.texture);for(let i in this.terrainUniforms)this.terrainUniforms[i].set(L[i])}if(F)for(let i in F)this.projectionUniforms[ob[i]].set(F[i]);if(V)for(let i in this.fixedUniforms)this.fixedUniforms[i].set(V[i]);p&&p.setUniforms(b,this.binderUniforms,T,{zoom:E});let x1=0;switch(z){case a.LINES:x1=2;break;case a.TRIANGLES:x1=3;break;case a.LINE_STRIP:x1=1}for(let i of y.get()){let n=i.vaos||(i.vaos={});(n[C]||(n[C]=new d8)).bind(b,this,O,p?p.getPaintVertexBuffers():[],d,i.vertexOffset,s,c,Z1),a.drawElements(z,i.primitiveLength*x1,a.UNSIGNED_SHORT,i.primitiveOffset*x1*2)}}}function r9(b,z,k){let J=1/Z.aC(k,1,z.transform.tileZoom),B=Math.pow(2,k.tileID.overscaledZ),X=k.tileSize*Math.pow(2,z.transform.tileZoom)/B,V=X*(k.tileID.canonical.x+k.tileID.wrap*B),L=X*k.tileID.canonical.y;return{u_image:0,u_texsize:k.imageAtlasTexture.size,u_scale:[J,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[V>>16,L>>16],u_pixel_coord_lower:[65535&V,65535&L]}}let A6=(b,z,k,J)=>{let B=b.style.light,X=B.properties.get("position"),V=[X.x,X.y,X.z],L=Z.bW();B.properties.get("anchor")==="viewport"&&Z.bX(L,b.transform.bearingInRadians),Z.bY(V,V,L);let F=b.transform.transformLightDirection(V),C=B.properties.get("color");return{u_lightpos:V,u_lightpos_globe:F,u_lightintensity:B.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+z,u_opacity:k,u_fill_translate:J}},O8=(b,z,k,J,B,X,V)=>Z.e(A6(b,z,k,J),r9(X,b,V),{u_height_factor:-Math.pow(2,B.overscaledZ)/V.tileSize/8}),Xz=(b,z,k,J)=>Z.e(r9(z,b,k),{u_fill_translate:J}),o9=(b,z)=>({u_world:b,u_fill_translate:z}),FZ=(b,z,k,J,B)=>Z.e(Xz(b,z,k,B),{u_world:J}),M6=(b,z,k,J,B)=>{let X=b.transform,V,L,F=0;if(k.paint.get("circle-pitch-alignment")==="map"){let C=Z.aC(z,1,X.zoom);V=!0,L=[C,C],F=C/(Z.$*Math.pow(2,z.tileID.overscaledZ))*2*Math.PI*B}else V=!1,L=X.pixelsToGLUnits;return{u_camera_to_center_distance:X.cameraToCenterDistance,u_scale_with_map:+(k.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+V,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:L,u_globe_extrude_scale:F,u_translate:J}},KZ=(b)=>({u_pixel_extrude_scale:[1/b.width,1/b.height]}),Qz=(b)=>({u_viewport_size:[b.width,b.height]}),Vz=(b,z=1)=>({u_color:b,u_overlay:0,u_overlay_scale:z}),nb=(b,z,k,J)=>{let B=Z.aC(b,1,z)/(Z.$*Math.pow(2,b.tileID.overscaledZ))*2*Math.PI*J;return{u_extrude_scale:Z.aC(b,1,z),u_intensity:k,u_globe_extrude_scale:B}},n9=(b,z,k,J)=>{let B=Z.L();Z.bZ(B,0,b.width,b.height,0,0,1);let X=b.context.gl;return{u_matrix:B,u_world:[X.drawingBufferWidth,X.drawingBufferHeight],u_image:k,u_color_ramp:J,u_opacity:z.paint.get("heatmap-opacity")}},Lz=(b,z,k)=>{let J=k.paint.get("hillshade-accent-color"),B;switch(k.paint.get("hillshade-method")){case"basic":B=4;break;case"combined":B=1;break;case"igor":B=2;break;case"multidirectional":B=3;break;default:B=0}let X=k.getIlluminationProperties();for(let V=0;V<X.directionRadians.length;V++)k.paint.get("hillshade-illumination-anchor")==="viewport"&&(X.directionRadians[V]+=b.transform.bearingInRadians);return{u_image:0,u_latrange:hz(0,z.tileID),u_exaggeration:k.paint.get("hillshade-exaggeration"),u_altitudes:X.altitudeRadians,u_azimuths:X.directionRadians,u_accent:J,u_method:B,u_highlights:X.highlightColor,u_shadows:X.shadowColor}},Wz=(b,z)=>{let k=z.stride,J=Z.L();return Z.bZ(J,0,Z.$,-Z.$,0,0,1),Z.M(J,J,[0,-Z.$,0]),{u_matrix:J,u_image:1,u_dimension:[k,k],u_zoom:b.overscaledZ,u_unpack:z.getUnpackVector()}};function hz(b,z){let k=Math.pow(2,z.canonical.z),J=z.canonical.y;return[new Z.a1(0,J/k).toLngLat().lat,new Z.a1(0,(J+1)/k).toLngLat().lat]}let Fz=(b,z,k=0)=>({u_image:0,u_unpack:z.getUnpackVector(),u_dimension:[z.stride,z.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:k,u_opacity:b.paint.get("color-relief-opacity")}),Z4=(b,z,k,J)=>{let B=b.transform;return{u_translation:Cz(b,z,k),u_ratio:J/Z.aC(z,1,B.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/B.pixelsToGLUnits[0],1/B.pixelsToGLUnits[1]]}},Kz=(b,z,k,J,B)=>Z.e(Z4(b,z,k,J),{u_image:0,u_image_height:B}),lz=(b,z,k,J,B)=>{let X=b.transform,V=X6(z,X);return{u_translation:Cz(b,z,k),u_texsize:z.imageAtlasTexture.size,u_ratio:J/Z.aC(z,1,X.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[V,B.fromScale,B.toScale],u_fade:B.t,u_units_to_pixels:[1/X.pixelsToGLUnits[0],1/X.pixelsToGLUnits[1]]}},y8=(b,z,k,J,B)=>{let X=X6(z,b.transform);return Z.e(Z4(b,z,k,J),{u_tileratio:X,u_crossfade_from:B.fromScale,u_crossfade_to:B.toScale,u_image:0,u_mix:B.t,u_lineatlas_width:b.lineAtlas.width,u_lineatlas_height:b.lineAtlas.height})},lZ=(b,z,k,J,B,X)=>{let V=X6(z,b.transform);return Z.e(Z4(b,z,k,J),{u_image:0,u_image_height:X,u_tileratio:V,u_crossfade_from:B.fromScale,u_crossfade_to:B.toScale,u_image_dash:1,u_mix:B.t,u_lineatlas_width:b.lineAtlas.width,u_lineatlas_height:b.lineAtlas.height})};function X6(b,z){return 1/Z.aC(b,1,z.tileZoom)}function Cz(b,z,k){return Z.aD(b.transform,z,k.paint.get("line-translate"),k.paint.get("line-translate-anchor"))}let CZ=(b,z,k,J,B)=>{return{u_tl_parent:b,u_scale_parent:z,u_buffer_scale:1,u_fade_t:k.mix,u_opacity:k.opacity*J.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:J.paint.get("raster-brightness-min"),u_brightness_high:J.paint.get("raster-brightness-max"),u_saturation_factor:(V=J.paint.get("raster-saturation"),V>0?1-1/(1.001-V):-V),u_contrast_factor:(X=J.paint.get("raster-contrast"),X>0?1/(1-X):1+X),u_spin_weights:Dz(J.paint.get("raster-hue-rotate")),u_coords_top:[B[0].x,B[0].y,B[1].x,B[1].y],u_coords_bottom:[B[3].x,B[3].y,B[2].x,B[2].y]};var X,V};function Dz(b){b*=Math.PI/180;let z=Math.sin(b),k=Math.cos(b);return[(2*k+1)/3,(-Math.sqrt(3)*z-k+1)/3,(Math.sqrt(3)*z-k+1)/3]}let sb=(b,z,k,J,B,X,V,L,F,C,O,d,y)=>{let T=V.transform;return{u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:z?z.uSizeT:0,u_size:z?z.uSize:0,u_camera_to_center_distance:T.cameraToCenterDistance,u_pitch:T.pitch/360*2*Math.PI,u_rotate_symbol:+k,u_aspect_ratio:T.width/T.height,u_fade_change:V.options.fadeDuration?V.symbolFadeChange:1,u_label_plane_matrix:L,u_coord_matrix:F,u_is_text:+O,u_pitch_with_map:+J,u_is_along_line:B,u_is_variable_anchor:X,u_texsize:d,u_texture:0,u_translation:C,u_pitched_scale:y}},ib=(b,z,k,J,B,X,V,L,F,C,O,d,y,T)=>{let E=V.transform;return Z.e(sb(b,z,k,J,B,X,V,L,F,C,O,d,T),{u_gamma_scale:J?Math.cos(E.pitch*Math.PI/180)*E.cameraToCenterDistance:1,u_device_pixel_ratio:V.pixelRatio,u_is_halo:1})},s9=(b,z,k,J,B,X,V,L,F,C,O,d,y)=>Z.e(ib(b,z,k,J,B,X,V,L,F,C,!0,O,0,y),{u_texsize_icon:d,u_texture_icon:1}),dz=(b,z)=>({u_opacity:b,u_color:z}),i9=(b,z,k,J,B)=>Z.e(function(X,V,L,F){let C=L.imageManager.getPattern(X.from.toString()),O=L.imageManager.getPattern(X.to.toString()),{width:d,height:y}=L.imageManager.getPixelSize(),T=Math.pow(2,F.tileID.overscaledZ),E=F.tileSize*Math.pow(2,L.transform.tileZoom)/T,p=E*(F.tileID.canonical.x+F.tileID.wrap*T),s=E*F.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:C.tl,u_pattern_br_a:C.br,u_pattern_tl_b:O.tl,u_pattern_br_b:O.br,u_texsize:[d,y],u_mix:V.t,u_pattern_size_a:C.displaySize,u_pattern_size_b:O.displaySize,u_scale_a:V.fromScale,u_scale_b:V.toScale,u_tile_units_to_pixels:1/Z.aC(F,1,L.transform.tileZoom),u_pixel_coord_upper:[p>>16,s>>16],u_pixel_coord_lower:[65535&p,65535&s]}}(k,B,z,J),{u_opacity:b}),Y4=(b,z)=>{},tb={fillExtrusion:(b,z)=>({u_lightpos:new Z.bU(b,z.u_lightpos),u_lightpos_globe:new Z.bU(b,z.u_lightpos_globe),u_lightintensity:new Z.bg(b,z.u_lightintensity),u_lightcolor:new Z.bU(b,z.u_lightcolor),u_vertical_gradient:new Z.bg(b,z.u_vertical_gradient),u_opacity:new Z.bg(b,z.u_opacity),u_fill_translate:new Z.bV(b,z.u_fill_translate)}),fillExtrusionPattern:(b,z)=>({u_lightpos:new Z.bU(b,z.u_lightpos),u_lightpos_globe:new Z.bU(b,z.u_lightpos_globe),u_lightintensity:new Z.bg(b,z.u_lightintensity),u_lightcolor:new Z.bU(b,z.u_lightcolor),u_vertical_gradient:new Z.bg(b,z.u_vertical_gradient),u_height_factor:new Z.bg(b,z.u_height_factor),u_opacity:new Z.bg(b,z.u_opacity),u_fill_translate:new Z.bV(b,z.u_fill_translate),u_image:new Z.bQ(b,z.u_image),u_texsize:new Z.bV(b,z.u_texsize),u_pixel_coord_upper:new Z.bV(b,z.u_pixel_coord_upper),u_pixel_coord_lower:new Z.bV(b,z.u_pixel_coord_lower),u_scale:new Z.bU(b,z.u_scale),u_fade:new Z.bg(b,z.u_fade)}),fill:(b,z)=>({u_fill_translate:new Z.bV(b,z.u_fill_translate)}),fillPattern:(b,z)=>({u_image:new Z.bQ(b,z.u_image),u_texsize:new Z.bV(b,z.u_texsize),u_pixel_coord_upper:new Z.bV(b,z.u_pixel_coord_upper),u_pixel_coord_lower:new Z.bV(b,z.u_pixel_coord_lower),u_scale:new Z.bU(b,z.u_scale),u_fade:new Z.bg(b,z.u_fade),u_fill_translate:new Z.bV(b,z.u_fill_translate)}),fillOutline:(b,z)=>({u_world:new Z.bV(b,z.u_world),u_fill_translate:new Z.bV(b,z.u_fill_translate)}),fillOutlinePattern:(b,z)=>({u_world:new Z.bV(b,z.u_world),u_image:new Z.bQ(b,z.u_image),u_texsize:new Z.bV(b,z.u_texsize),u_pixel_coord_upper:new Z.bV(b,z.u_pixel_coord_upper),u_pixel_coord_lower:new Z.bV(b,z.u_pixel_coord_lower),u_scale:new Z.bU(b,z.u_scale),u_fade:new Z.bg(b,z.u_fade),u_fill_translate:new Z.bV(b,z.u_fill_translate)}),circle:(b,z)=>({u_camera_to_center_distance:new Z.bg(b,z.u_camera_to_center_distance),u_scale_with_map:new Z.bQ(b,z.u_scale_with_map),u_pitch_with_map:new Z.bQ(b,z.u_pitch_with_map),u_extrude_scale:new Z.bV(b,z.u_extrude_scale),u_device_pixel_ratio:new Z.bg(b,z.u_device_pixel_ratio),u_globe_extrude_scale:new Z.bg(b,z.u_globe_extrude_scale),u_translate:new Z.bV(b,z.u_translate)}),collisionBox:(b,z)=>({u_pixel_extrude_scale:new Z.bV(b,z.u_pixel_extrude_scale)}),collisionCircle:(b,z)=>({u_viewport_size:new Z.bV(b,z.u_viewport_size)}),debug:(b,z)=>({u_color:new Z.bR(b,z.u_color),u_overlay:new Z.bQ(b,z.u_overlay),u_overlay_scale:new Z.bg(b,z.u_overlay_scale)}),depth:Y4,clippingMask:Y4,heatmap:(b,z)=>({u_extrude_scale:new Z.bg(b,z.u_extrude_scale),u_intensity:new Z.bg(b,z.u_intensity),u_globe_extrude_scale:new Z.bg(b,z.u_globe_extrude_scale)}),heatmapTexture:(b,z)=>({u_matrix:new Z.bS(b,z.u_matrix),u_world:new Z.bV(b,z.u_world),u_image:new Z.bQ(b,z.u_image),u_color_ramp:new Z.bQ(b,z.u_color_ramp),u_opacity:new Z.bg(b,z.u_opacity)}),hillshade:(b,z)=>({u_image:new Z.bQ(b,z.u_image),u_latrange:new Z.bV(b,z.u_latrange),u_exaggeration:new Z.bg(b,z.u_exaggeration),u_altitudes:new Z.b$(b,z.u_altitudes),u_azimuths:new Z.b$(b,z.u_azimuths),u_accent:new Z.bR(b,z.u_accent),u_method:new Z.bQ(b,z.u_method),u_shadows:new Z.b_(b,z.u_shadows),u_highlights:new Z.b_(b,z.u_highlights)}),hillshadePrepare:(b,z)=>({u_matrix:new Z.bS(b,z.u_matrix),u_image:new Z.bQ(b,z.u_image),u_dimension:new Z.bV(b,z.u_dimension),u_zoom:new Z.bg(b,z.u_zoom),u_unpack:new Z.bT(b,z.u_unpack)}),colorRelief:(b,z)=>({u_image:new Z.bQ(b,z.u_image),u_unpack:new Z.bT(b,z.u_unpack),u_dimension:new Z.bV(b,z.u_dimension),u_elevation_stops:new Z.bQ(b,z.u_elevation_stops),u_color_stops:new Z.bQ(b,z.u_color_stops),u_color_ramp_size:new Z.bQ(b,z.u_color_ramp_size),u_opacity:new Z.bg(b,z.u_opacity)}),line:(b,z)=>({u_translation:new Z.bV(b,z.u_translation),u_ratio:new Z.bg(b,z.u_ratio),u_device_pixel_ratio:new Z.bg(b,z.u_device_pixel_ratio),u_units_to_pixels:new Z.bV(b,z.u_units_to_pixels)}),lineGradient:(b,z)=>({u_translation:new Z.bV(b,z.u_translation),u_ratio:new Z.bg(b,z.u_ratio),u_device_pixel_ratio:new Z.bg(b,z.u_device_pixel_ratio),u_units_to_pixels:new Z.bV(b,z.u_units_to_pixels),u_image:new Z.bQ(b,z.u_image),u_image_height:new Z.bg(b,z.u_image_height)}),linePattern:(b,z)=>({u_translation:new Z.bV(b,z.u_translation),u_texsize:new Z.bV(b,z.u_texsize),u_ratio:new Z.bg(b,z.u_ratio),u_device_pixel_ratio:new Z.bg(b,z.u_device_pixel_ratio),u_image:new Z.bQ(b,z.u_image),u_units_to_pixels:new Z.bV(b,z.u_units_to_pixels),u_scale:new Z.bU(b,z.u_scale),u_fade:new Z.bg(b,z.u_fade)}),lineSDF:(b,z)=>({u_translation:new Z.bV(b,z.u_translation),u_ratio:new Z.bg(b,z.u_ratio),u_device_pixel_ratio:new Z.bg(b,z.u_device_pixel_ratio),u_units_to_pixels:new Z.bV(b,z.u_units_to_pixels),u_image:new Z.bQ(b,z.u_image),u_mix:new Z.bg(b,z.u_mix),u_tileratio:new Z.bg(b,z.u_tileratio),u_crossfade_from:new Z.bg(b,z.u_crossfade_from),u_crossfade_to:new Z.bg(b,z.u_crossfade_to),u_lineatlas_width:new Z.bg(b,z.u_lineatlas_width),u_lineatlas_height:new Z.bg(b,z.u_lineatlas_height)}),lineGradientSDF:(b,z)=>({u_translation:new Z.bV(b,z.u_translation),u_ratio:new Z.bg(b,z.u_ratio),u_device_pixel_ratio:new Z.bg(b,z.u_device_pixel_ratio),u_units_to_pixels:new Z.bV(b,z.u_units_to_pixels),u_image:new Z.bQ(b,z.u_image),u_image_height:new Z.bg(b,z.u_image_height),u_tileratio:new Z.bg(b,z.u_tileratio),u_crossfade_from:new Z.bg(b,z.u_crossfade_from),u_crossfade_to:new Z.bg(b,z.u_crossfade_to),u_image_dash:new Z.bQ(b,z.u_image_dash),u_mix:new Z.bg(b,z.u_mix),u_lineatlas_width:new Z.bg(b,z.u_lineatlas_width),u_lineatlas_height:new Z.bg(b,z.u_lineatlas_height)}),raster:(b,z)=>({u_tl_parent:new Z.bV(b,z.u_tl_parent),u_scale_parent:new Z.bg(b,z.u_scale_parent),u_buffer_scale:new Z.bg(b,z.u_buffer_scale),u_fade_t:new Z.bg(b,z.u_fade_t),u_opacity:new Z.bg(b,z.u_opacity),u_image0:new Z.bQ(b,z.u_image0),u_image1:new Z.bQ(b,z.u_image1),u_brightness_low:new Z.bg(b,z.u_brightness_low),u_brightness_high:new Z.bg(b,z.u_brightness_high),u_saturation_factor:new Z.bg(b,z.u_saturation_factor),u_contrast_factor:new Z.bg(b,z.u_contrast_factor),u_spin_weights:new Z.bU(b,z.u_spin_weights),u_coords_top:new Z.bT(b,z.u_coords_top),u_coords_bottom:new Z.bT(b,z.u_coords_bottom)}),symbolIcon:(b,z)=>({u_is_size_zoom_constant:new Z.bQ(b,z.u_is_size_zoom_constant),u_is_size_feature_constant:new Z.bQ(b,z.u_is_size_feature_constant),u_size_t:new Z.bg(b,z.u_size_t),u_size:new Z.bg(b,z.u_size),u_camera_to_center_distance:new Z.bg(b,z.u_camera_to_center_distance),u_pitch:new Z.bg(b,z.u_pitch),u_rotate_symbol:new Z.bQ(b,z.u_rotate_symbol),u_aspect_ratio:new Z.bg(b,z.u_aspect_ratio),u_fade_change:new Z.bg(b,z.u_fade_change),u_label_plane_matrix:new Z.bS(b,z.u_label_plane_matrix),u_coord_matrix:new Z.bS(b,z.u_coord_matrix),u_is_text:new Z.bQ(b,z.u_is_text),u_pitch_with_map:new Z.bQ(b,z.u_pitch_with_map),u_is_along_line:new Z.bQ(b,z.u_is_along_line),u_is_variable_anchor:new Z.bQ(b,z.u_is_variable_anchor),u_texsize:new Z.bV(b,z.u_texsize),u_texture:new Z.bQ(b,z.u_texture),u_translation:new Z.bV(b,z.u_translation),u_pitched_scale:new Z.bg(b,z.u_pitched_scale)}),symbolSDF:(b,z)=>({u_is_size_zoom_constant:new Z.bQ(b,z.u_is_size_zoom_constant),u_is_size_feature_constant:new Z.bQ(b,z.u_is_size_feature_constant),u_size_t:new Z.bg(b,z.u_size_t),u_size:new Z.bg(b,z.u_size),u_camera_to_center_distance:new Z.bg(b,z.u_camera_to_center_distance),u_pitch:new Z.bg(b,z.u_pitch),u_rotate_symbol:new Z.bQ(b,z.u_rotate_symbol),u_aspect_ratio:new Z.bg(b,z.u_aspect_ratio),u_fade_change:new Z.bg(b,z.u_fade_change),u_label_plane_matrix:new Z.bS(b,z.u_label_plane_matrix),u_coord_matrix:new Z.bS(b,z.u_coord_matrix),u_is_text:new Z.bQ(b,z.u_is_text),u_pitch_with_map:new Z.bQ(b,z.u_pitch_with_map),u_is_along_line:new Z.bQ(b,z.u_is_along_line),u_is_variable_anchor:new Z.bQ(b,z.u_is_variable_anchor),u_texsize:new Z.bV(b,z.u_texsize),u_texture:new Z.bQ(b,z.u_texture),u_gamma_scale:new Z.bg(b,z.u_gamma_scale),u_device_pixel_ratio:new Z.bg(b,z.u_device_pixel_ratio),u_is_halo:new Z.bQ(b,z.u_is_halo),u_translation:new Z.bV(b,z.u_translation),u_pitched_scale:new Z.bg(b,z.u_pitched_scale)}),symbolTextAndIcon:(b,z)=>({u_is_size_zoom_constant:new Z.bQ(b,z.u_is_size_zoom_constant),u_is_size_feature_constant:new Z.bQ(b,z.u_is_size_feature_constant),u_size_t:new Z.bg(b,z.u_size_t),u_size:new Z.bg(b,z.u_size),u_camera_to_center_distance:new Z.bg(b,z.u_camera_to_center_distance),u_pitch:new Z.bg(b,z.u_pitch),u_rotate_symbol:new Z.bQ(b,z.u_rotate_symbol),u_aspect_ratio:new Z.bg(b,z.u_aspect_ratio),u_fade_change:new Z.bg(b,z.u_fade_change),u_label_plane_matrix:new Z.bS(b,z.u_label_plane_matrix),u_coord_matrix:new Z.bS(b,z.u_coord_matrix),u_is_text:new Z.bQ(b,z.u_is_text),u_pitch_with_map:new Z.bQ(b,z.u_pitch_with_map),u_is_along_line:new Z.bQ(b,z.u_is_along_line),u_is_variable_anchor:new Z.bQ(b,z.u_is_variable_anchor),u_texsize:new Z.bV(b,z.u_texsize),u_texsize_icon:new Z.bV(b,z.u_texsize_icon),u_texture:new Z.bQ(b,z.u_texture),u_texture_icon:new Z.bQ(b,z.u_texture_icon),u_gamma_scale:new Z.bg(b,z.u_gamma_scale),u_device_pixel_ratio:new Z.bg(b,z.u_device_pixel_ratio),u_is_halo:new Z.bQ(b,z.u_is_halo),u_translation:new Z.bV(b,z.u_translation),u_pitched_scale:new Z.bg(b,z.u_pitched_scale)}),background:(b,z)=>({u_opacity:new Z.bg(b,z.u_opacity),u_color:new Z.bR(b,z.u_color)}),backgroundPattern:(b,z)=>({u_opacity:new Z.bg(b,z.u_opacity),u_image:new Z.bQ(b,z.u_image),u_pattern_tl_a:new Z.bV(b,z.u_pattern_tl_a),u_pattern_br_a:new Z.bV(b,z.u_pattern_br_a),u_pattern_tl_b:new Z.bV(b,z.u_pattern_tl_b),u_pattern_br_b:new Z.bV(b,z.u_pattern_br_b),u_texsize:new Z.bV(b,z.u_texsize),u_mix:new Z.bg(b,z.u_mix),u_pattern_size_a:new Z.bV(b,z.u_pattern_size_a),u_pattern_size_b:new Z.bV(b,z.u_pattern_size_b),u_scale_a:new Z.bg(b,z.u_scale_a),u_scale_b:new Z.bg(b,z.u_scale_b),u_pixel_coord_upper:new Z.bV(b,z.u_pixel_coord_upper),u_pixel_coord_lower:new Z.bV(b,z.u_pixel_coord_lower),u_tile_units_to_pixels:new Z.bg(b,z.u_tile_units_to_pixels)}),terrain:(b,z)=>({u_texture:new Z.bQ(b,z.u_texture),u_ele_delta:new Z.bg(b,z.u_ele_delta),u_fog_matrix:new Z.bS(b,z.u_fog_matrix),u_fog_color:new Z.bR(b,z.u_fog_color),u_fog_ground_blend:new Z.bg(b,z.u_fog_ground_blend),u_fog_ground_blend_opacity:new Z.bg(b,z.u_fog_ground_blend_opacity),u_horizon_color:new Z.bR(b,z.u_horizon_color),u_horizon_fog_blend:new Z.bg(b,z.u_horizon_fog_blend),u_is_globe_mode:new Z.bg(b,z.u_is_globe_mode)}),terrainDepth:(b,z)=>({u_ele_delta:new Z.bg(b,z.u_ele_delta)}),terrainCoords:(b,z)=>({u_texture:new Z.bQ(b,z.u_texture),u_terrain_coords_id:new Z.bg(b,z.u_terrain_coords_id),u_ele_delta:new Z.bg(b,z.u_ele_delta)}),projectionErrorMeasurement:(b,z)=>({u_input:new Z.bg(b,z.u_input),u_output_expected:new Z.bg(b,z.u_output_expected)}),atmosphere:(b,z)=>({u_sun_pos:new Z.bU(b,z.u_sun_pos),u_atmosphere_blend:new Z.bg(b,z.u_atmosphere_blend),u_globe_position:new Z.bU(b,z.u_globe_position),u_globe_radius:new Z.bg(b,z.u_globe_radius),u_inv_proj_matrix:new Z.bS(b,z.u_inv_proj_matrix)}),sky:(b,z)=>({u_sky_color:new Z.bR(b,z.u_sky_color),u_horizon_color:new Z.bR(b,z.u_horizon_color),u_horizon:new Z.bV(b,z.u_horizon),u_horizon_normal:new Z.bV(b,z.u_horizon_normal),u_sky_horizon_blend:new Z.bg(b,z.u_sky_horizon_blend),u_sky_blend:new Z.bg(b,z.u_sky_blend)})};class t9{constructor(b,z,k){this.context=b;let J=b.gl;this.buffer=J.createBuffer(),this.dynamicDraw=Boolean(k),this.context.unbindVAO(),b.bindElementBuffer.set(this.buffer),J.bufferData(J.ELEMENT_ARRAY_BUFFER,z.arrayBuffer,this.dynamicDraw?J.DYNAMIC_DRAW:J.STATIC_DRAW),this.dynamicDraw||delete z.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(b){let z=this.context.gl;if(!this.dynamicDraw)throw Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),z.bufferSubData(z.ELEMENT_ARRAY_BUFFER,0,b.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let eb={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class wg{constructor(b,z,k,J){this.length=z.length,this.attributes=k,this.itemSize=z.bytesPerElement,this.dynamicDraw=J,this.context=b;let B=b.gl;this.buffer=B.createBuffer(),b.bindVertexBuffer.set(this.buffer),B.bufferData(B.ARRAY_BUFFER,z.arrayBuffer,this.dynamicDraw?B.DYNAMIC_DRAW:B.STATIC_DRAW),this.dynamicDraw||delete z.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(b){if(b.length!==this.length)throw Error(`Length of new data is ${b.length}, which doesn't match current length of ${this.length}`);let z=this.context.gl;this.bind(),z.bufferSubData(z.ARRAY_BUFFER,0,b.arrayBuffer)}enableAttributes(b,z){for(let k=0;k<this.attributes.length;k++){let J=z.attributes[this.attributes[k].name];J!==void 0&&b.enableVertexAttribArray(J)}}setVertexAttribPointers(b,z,k){for(let J=0;J<this.attributes.length;J++){let B=this.attributes[J],X=z.attributes[B.name];X!==void 0&&b.vertexAttribPointer(X,B.components,b[eb[B.type]],!1,this.itemSize,B.offset+this.itemSize*(k||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class E0{constructor(b){this.gl=b.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(b){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class n4 extends E0{getDefault(){return Z.bf.transparent}set(b){let z=this.current;(b.r!==z.r||b.g!==z.g||b.b!==z.b||b.a!==z.a||this.dirty)&&(this.gl.clearColor(b.r,b.g,b.b,b.a),this.current=b,this.dirty=!1)}}class e9 extends E0{getDefault(){return 1}set(b){(b!==this.current||this.dirty)&&(this.gl.clearDepth(b),this.current=b,this.dirty=!1)}}class Oz extends E0{getDefault(){return 0}set(b){(b!==this.current||this.dirty)&&(this.gl.clearStencil(b),this.current=b,this.dirty=!1)}}class yz extends E0{getDefault(){return[!0,!0,!0,!0]}set(b){let z=this.current;(b[0]!==z[0]||b[1]!==z[1]||b[2]!==z[2]||b[3]!==z[3]||this.dirty)&&(this.gl.colorMask(b[0],b[1],b[2],b[3]),this.current=b,this.dirty=!1)}}class Rz extends E0{getDefault(){return!0}set(b){(b!==this.current||this.dirty)&&(this.gl.depthMask(b),this.current=b,this.dirty=!1)}}class Nz extends E0{getDefault(){return 255}set(b){(b!==this.current||this.dirty)&&(this.gl.stencilMask(b),this.current=b,this.dirty=!1)}}class bg extends E0{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(b){let z=this.current;(b.func!==z.func||b.ref!==z.ref||b.mask!==z.mask||this.dirty)&&(this.gl.stencilFunc(b.func,b.ref,b.mask),this.current=b,this.dirty=!1)}}class Iz extends E0{getDefault(){let b=this.gl;return[b.KEEP,b.KEEP,b.KEEP]}set(b){let z=this.current;(b[0]!==z[0]||b[1]!==z[1]||b[2]!==z[2]||this.dirty)&&(this.gl.stencilOp(b[0],b[1],b[2]),this.current=b,this.dirty=!1)}}class gg extends E0{getDefault(){return!1}set(b){if(b===this.current&&!this.dirty)return;let z=this.gl;b?z.enable(z.STENCIL_TEST):z.disable(z.STENCIL_TEST),this.current=b,this.dirty=!1}}class R8 extends E0{getDefault(){return[0,1]}set(b){let z=this.current;(b[0]!==z[0]||b[1]!==z[1]||this.dirty)&&(this.gl.depthRange(b[0],b[1]),this.current=b,this.dirty=!1)}}class N8 extends E0{getDefault(){return!1}set(b){if(b===this.current&&!this.dirty)return;let z=this.gl;b?z.enable(z.DEPTH_TEST):z.disable(z.DEPTH_TEST),this.current=b,this.dirty=!1}}class I8 extends E0{getDefault(){return this.gl.LESS}set(b){(b!==this.current||this.dirty)&&(this.gl.depthFunc(b),this.current=b,this.dirty=!1)}}class ww extends E0{getDefault(){return!1}set(b){if(b===this.current&&!this.dirty)return;let z=this.gl;b?z.enable(z.BLEND):z.disable(z.BLEND),this.current=b,this.dirty=!1}}class s4 extends E0{getDefault(){let b=this.gl;return[b.ONE,b.ZERO]}set(b){let z=this.current;(b[0]!==z[0]||b[1]!==z[1]||this.dirty)&&(this.gl.blendFunc(b[0],b[1]),this.current=b,this.dirty=!1)}}class Q6 extends E0{getDefault(){return Z.bf.transparent}set(b){let z=this.current;(b.r!==z.r||b.g!==z.g||b.b!==z.b||b.a!==z.a||this.dirty)&&(this.gl.blendColor(b.r,b.g,b.b,b.a),this.current=b,this.dirty=!1)}}class K7 extends E0{getDefault(){return this.gl.FUNC_ADD}set(b){(b!==this.current||this.dirty)&&(this.gl.blendEquation(b),this.current=b,this.dirty=!1)}}class v3 extends E0{getDefault(){return!1}set(b){if(b===this.current&&!this.dirty)return;let z=this.gl;b?z.enable(z.CULL_FACE):z.disable(z.CULL_FACE),this.current=b,this.dirty=!1}}class fg extends E0{getDefault(){return this.gl.BACK}set(b){(b!==this.current||this.dirty)&&(this.gl.cullFace(b),this.current=b,this.dirty=!1)}}class zg extends E0{getDefault(){return this.gl.CCW}set(b){(b!==this.current||this.dirty)&&(this.gl.frontFace(b),this.current=b,this.dirty=!1)}}class bw extends E0{getDefault(){return null}set(b){(b!==this.current||this.dirty)&&(this.gl.useProgram(b),this.current=b,this.dirty=!1)}}class i4 extends E0{getDefault(){return this.gl.TEXTURE0}set(b){(b!==this.current||this.dirty)&&(this.gl.activeTexture(b),this.current=b,this.dirty=!1)}}class S8 extends E0{getDefault(){let b=this.gl;return[0,0,b.drawingBufferWidth,b.drawingBufferHeight]}set(b){let z=this.current;(b[0]!==z[0]||b[1]!==z[1]||b[2]!==z[2]||b[3]!==z[3]||this.dirty)&&(this.gl.viewport(b[0],b[1],b[2],b[3]),this.current=b,this.dirty=!1)}}class T8 extends E0{getDefault(){return null}set(b){if(b===this.current&&!this.dirty)return;let z=this.gl;z.bindFramebuffer(z.FRAMEBUFFER,b),this.current=b,this.dirty=!1}}class V6 extends E0{getDefault(){return null}set(b){if(b===this.current&&!this.dirty)return;let z=this.gl;z.bindRenderbuffer(z.RENDERBUFFER,b),this.current=b,this.dirty=!1}}class $8 extends E0{getDefault(){return null}set(b){if(b===this.current&&!this.dirty)return;let z=this.gl;z.bindTexture(z.TEXTURE_2D,b),this.current=b,this.dirty=!1}}class xg extends E0{getDefault(){return null}set(b){if(b===this.current&&!this.dirty)return;let z=this.gl;z.bindBuffer(z.ARRAY_BUFFER,b),this.current=b,this.dirty=!1}}class l7 extends E0{getDefault(){return null}set(b){let z=this.gl;z.bindBuffer(z.ELEMENT_ARRAY_BUFFER,b),this.current=b,this.dirty=!1}}class C7 extends E0{getDefault(){return null}set(b){var z;if(b===this.current&&!this.dirty)return;let k=this.gl;j3(k)?k.bindVertexArray(b):(z=k.getExtension("OES_vertex_array_object"))===null||z===void 0||z.bindVertexArrayOES(b),this.current=b,this.dirty=!1}}class qg extends E0{getDefault(){return 4}set(b){if(b===this.current&&!this.dirty)return;let z=this.gl;z.pixelStorei(z.UNPACK_ALIGNMENT,b),this.current=b,this.dirty=!1}}class gw extends E0{getDefault(){return!1}set(b){if(b===this.current&&!this.dirty)return;let z=this.gl;z.pixelStorei(z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b),this.current=b,this.dirty=!1}}class I0 extends E0{getDefault(){return!1}set(b){if(b===this.current&&!this.dirty)return;let z=this.gl;z.pixelStorei(z.UNPACK_FLIP_Y_WEBGL,b),this.current=b,this.dirty=!1}}class D7 extends E0{constructor(b,z){super(b),this.context=b,this.parent=z}getDefault(){return null}}class Sz extends D7{setDirty(){this.dirty=!0}set(b){if(b===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let z=this.gl;z.framebufferTexture2D(z.FRAMEBUFFER,z.COLOR_ATTACHMENT0,z.TEXTURE_2D,b,0),this.current=b,this.dirty=!1}}class Zg extends D7{set(b){if(b===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let z=this.gl;z.framebufferRenderbuffer(z.FRAMEBUFFER,z.DEPTH_ATTACHMENT,z.RENDERBUFFER,b),this.current=b,this.dirty=!1}}class L6 extends D7{set(b){if(b===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let z=this.gl;z.framebufferRenderbuffer(z.FRAMEBUFFER,z.DEPTH_STENCIL_ATTACHMENT,z.RENDERBUFFER,b),this.current=b,this.dirty=!1}}let Tz="Framebuffer is not complete";class $z{constructor(b,z,k,J,B){this.context=b,this.width=z,this.height=k;let X=b.gl,V=this.framebuffer=X.createFramebuffer();if(this.colorAttachment=new Sz(b,V),J)this.depthAttachment=B?new L6(b,V):new Zg(b,V);else if(B)throw Error("Stencil cannot be set without depth");if(X.checkFramebufferStatus(X.FRAMEBUFFER)!==X.FRAMEBUFFER_COMPLETE)throw Error(Tz)}destroy(){let b=this.context.gl,z=this.colorAttachment.get();if(z&&b.deleteTexture(z),this.depthAttachment){let k=this.depthAttachment.get();k&&b.deleteRenderbuffer(k)}b.deleteFramebuffer(this.framebuffer)}}class Yg{constructor(b){var z,k;if(this.gl=b,this.clearColor=new n4(this),this.clearDepth=new e9(this),this.clearStencil=new Oz(this),this.colorMask=new yz(this),this.depthMask=new Rz(this),this.stencilMask=new Nz(this),this.stencilFunc=new bg(this),this.stencilOp=new Iz(this),this.stencilTest=new gg(this),this.depthRange=new R8(this),this.depthTest=new N8(this),this.depthFunc=new I8(this),this.blend=new ww(this),this.blendFunc=new s4(this),this.blendColor=new Q6(this),this.blendEquation=new K7(this),this.cullFace=new v3(this),this.cullFaceSide=new fg(this),this.frontFace=new zg(this),this.program=new bw(this),this.activeTexture=new i4(this),this.viewport=new S8(this),this.bindFramebuffer=new T8(this),this.bindRenderbuffer=new V6(this),this.bindTexture=new $8(this),this.bindVertexBuffer=new xg(this),this.bindElementBuffer=new l7(this),this.bindVertexArray=new C7(this),this.pixelStoreUnpack=new qg(this),this.pixelStoreUnpackPremultiplyAlpha=new gw(this),this.pixelStoreUnpackFlipY=new I0(this),this.extTextureFilterAnisotropic=b.getExtension("EXT_texture_filter_anisotropic")||b.getExtension("MOZ_EXT_texture_filter_anisotropic")||b.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=b.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=b.getParameter(b.MAX_TEXTURE_SIZE),j3(b)){this.HALF_FLOAT=b.HALF_FLOAT;let J=b.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(z=b.RGBA16F)!==null&&z!==void 0?z:J==null?void 0:J.RGBA16F_EXT,this.RGB16F=(k=b.RGB16F)!==null&&k!==void 0?k:J==null?void 0:J.RGB16F_EXT,b.getExtension("EXT_color_buffer_float")}else{b.getExtension("EXT_color_buffer_half_float"),b.getExtension("OES_texture_half_float_linear");let J=b.getExtension("OES_texture_half_float");this.HALF_FLOAT=J==null?void 0:J.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(b,z){return new t9(this,b,z)}createVertexBuffer(b,z,k){return new wg(this,b,z,k)}createRenderbuffer(b,z,k){let J=this.gl,B=J.createRenderbuffer();return this.bindRenderbuffer.set(B),J.renderbufferStorage(J.RENDERBUFFER,b,z,k),this.bindRenderbuffer.set(null),B}createFramebuffer(b,z,k,J){return new $z(this,b,z,k,J)}clear({color:b,depth:z,stencil:k}){let J=this.gl,B=0;b&&(B|=J.COLOR_BUFFER_BIT,this.clearColor.set(b),this.colorMask.set([!0,!0,!0,!0])),z!==void 0&&(B|=J.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(z),this.depthMask.set(!0)),k!==void 0&&(B|=J.STENCIL_BUFFER_BIT,this.clearStencil.set(k),this.stencilMask.set(255)),J.clear(B)}setCullFace(b){b.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(b.mode),this.frontFace.set(b.frontFace))}setDepthMode(b){b.func!==this.gl.ALWAYS||b.mask?(this.depthTest.set(!0),this.depthFunc.set(b.func),this.depthMask.set(b.mask),this.depthRange.set(b.range)):this.depthTest.set(!1)}setStencilMode(b){b.test.func!==this.gl.ALWAYS||b.mask?(this.stencilTest.set(!0),this.stencilMask.set(b.mask),this.stencilOp.set([b.fail,b.depthFail,b.pass]),this.stencilFunc.set({func:b.test.func,ref:b.ref,mask:b.test.mask})):this.stencilTest.set(!1)}setColorMode(b){Z.bH(b.blendFunction,t0.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(b.blendFunction),this.blendColor.set(b.blendColor)),this.colorMask.set(b.mask)}createVertexArray(){var b;return j3(this.gl)?this.gl.createVertexArray():(b=this.gl.getExtension("OES_vertex_array_object"))===null||b===void 0?void 0:b.createVertexArrayOES()}deleteVertexArray(b){var z;return j3(this.gl)?this.gl.deleteVertexArray(b):(z=this.gl.getExtension("OES_vertex_array_object"))===null||z===void 0?void 0:z.deleteVertexArrayOES(b)}unbindVAO(){this.bindVertexArray.set(null)}}let fw;function j8(b,z,k,J,B){let{context:X,transform:V}=b,L=X.gl,F=b.useProgram("collisionBox"),C=[],O=0,d=0;for(let c=0;c<J.length;c++){let Z1=J[c],a=z.getTile(Z1).getBucket(k);if(!a)continue;let x1=B?a.textCollisionBox:a.iconCollisionBox,i=a.collisionCircleArray;i.length>0&&(C.push({circleArray:i,circleOffset:d,coord:Z1}),O+=i.length/4,d=O),x1&&F.draw(X,L.LINES,H0.disabled,d0.disabled,b.colorModeForRenderPass(),$0.disabled,KZ(b.transform),b.style.map.terrain&&b.style.map.terrain.getTerrainData(Z1),V.getProjectionData({overscaledTileID:Z1,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),k.id,x1.layoutVertexBuffer,x1.indexBuffer,x1.segments,null,b.transform.zoom,null,null,x1.collisionVertexBuffer)}if(!B||!C.length)return;let y=b.useProgram("collisionCircle"),T=new Z.c0;T.resize(4*O),T._trim();let E=0;for(let c of C)for(let Z1=0;Z1<c.circleArray.length/4;Z1++){let a=4*Z1,x1=c.circleArray[a+0],i=c.circleArray[a+1],n=c.circleArray[a+2],q1=c.circleArray[a+3];T.emplace(E++,x1,i,n,q1,0),T.emplace(E++,x1,i,n,q1,1),T.emplace(E++,x1,i,n,q1,2),T.emplace(E++,x1,i,n,q1,3)}(!fw||fw.length<2*O)&&(fw=function(c){let Z1=2*c,a=new Z.c2;a.resize(Z1),a._trim();for(let x1=0;x1<Z1;x1++){let i=6*x1;a.uint16[i+0]=4*x1+0,a.uint16[i+1]=4*x1+1,a.uint16[i+2]=4*x1+2,a.uint16[i+3]=4*x1+2,a.uint16[i+4]=4*x1+3,a.uint16[i+5]=4*x1+0}return a}(O));let p=X.createIndexBuffer(fw,!0),s=X.createVertexBuffer(T,Z.c1.members,!0);for(let c of C){let Z1=Qz(b.transform);y.draw(X,L.TRIANGLES,H0.disabled,d0.disabled,b.colorModeForRenderPass(),$0.disabled,Z1,b.style.map.terrain&&b.style.map.terrain.getTerrainData(c.coord),null,k.id,s,p,Z.aM.simpleSegment(0,2*c.circleOffset,c.circleArray.length,c.circleArray.length/2),null,b.transform.zoom,null,null,null)}s.destroy(),p.destroy()}let zw=Z.ai(new Float32Array(16));function xw(b,z,k,J,B,X){let{horizontalAlign:V,verticalAlign:L}=Z.aH(b);return new Z.P((-(V-0.5)*z/B+J[0])*X,(-(L-0.5)*k/B+J[1])*X)}function m8(b,z,k,J,B,X){let V=z.tileAnchorPoint.add(new Z.P(z.translation[0],z.translation[1]));if(z.pitchWithMap){let L=J.mult(X);k||(L=L.rotate(-B));let F=V.add(L);return V5(F.x,F.y,z.pitchedLabelPlaneMatrix,z.getElevation).point}if(k){let L=X0(z.tileAnchorPoint.x+1,z.tileAnchorPoint.y,z).point.sub(b),F=Math.atan(L.y/L.x)+(L.x<0?Math.PI:0);return b.add(J.rotate(F))}return b.add(J)}function qw(b,z,k,J,B,X,V,L,F,C,O,d){let y=b.text.placedSymbolArray,T=b.text.dynamicLayoutVertexArray,E=b.icon.dynamicLayoutVertexArray,p={};T.clear();for(let s=0;s<y.length;s++){let c=y.get(s),Z1=c.hidden||!c.crossTileID||b.allowVerticalPlacement&&!c.placedOrientation?null:J[c.crossTileID];if(Z1){let a=new Z.P(c.anchorX,c.anchorY),x1={getElevation:d,width:B.width,height:B.height,pitchedLabelPlaneMatrix:X,pitchWithMap:k,transform:B,tileAnchorPoint:a,translation:C,unwrappedTileID:O},i=k?k6(a.x,a.y,x1):X0(a.x,a.y,x1),n=T2(B.cameraToCenterDistance,i.signedDistanceFromCamera),q1=Z.ap(b.textSizeData,L,c)*n/Z.aB;k&&(q1*=b.tilePixelRatio/V);let{width:V1,height:W1,anchor:L1,textOffset:Q1,textBoxScale:O1}=Z1,I1=xw(L1,V1,W1,Q1,O1,q1),D1=B.getPitchedTextCorrection(a.x+C[0],a.y+C[1],O),n1=m8(i.point,x1,z,I1,-B.bearingInRadians,D1),B0=b.allowVerticalPlacement&&c.placedOrientation===Z.ao.vertical?Math.PI/2:0;for(let W0=0;W0<c.numGlyphs;W0++)Z.av(T,n1,B0);F&&c.associatedIconIndex>=0&&(p[c.associatedIconIndex]={shiftedAnchor:n1,angle:B0})}else K4(c.numGlyphs,T)}if(F){E.clear();let s=b.icon.placedSymbolArray;for(let c=0;c<s.length;c++){let Z1=s.get(c);if(Z1.hidden)K4(Z1.numGlyphs,E);else{let a=p[c];if(a)for(let x1=0;x1<Z1.numGlyphs;x1++)Z.av(E,a.shiftedAnchor,a.angle);else K4(Z1.numGlyphs,E)}}b.icon.dynamicLayoutVertexBuffer.updateData(E)}b.text.dynamicLayoutVertexBuffer.updateData(T)}function jz(b,z,k){return k.iconsInText&&z?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function _8(b,z,k,J,B,X,V,L,F,C,O,d,y){let T=b.context,E=T.gl,p=b.transform,s=L==="map",c=F==="map",Z1=L!=="viewport"&&k.layout.get("symbol-placement")!=="point",a=s&&!c&&!Z1,x1=!k.layout.get("symbol-sort-key").isConstant(),i=!1,n=b.getDepthModeForSublayer(0,H0.ReadOnly),q1=k._unevaluatedLayout.hasValue("text-variable-anchor")||k._unevaluatedLayout.hasValue("text-variable-anchor-offset"),V1=[],W1=p.getCircleRadiusCorrection();for(let L1 of J){let Q1=z.getTile(L1),O1=Q1.getBucket(k);if(!O1)continue;let I1=B?O1.text:O1.icon;if(!I1||!I1.segments.get().length||!I1.hasVisibleVertices)continue;let D1=I1.programConfigurations.get(k.id),n1=B||O1.sdfIcons,B0=B?O1.textSizeData:O1.iconSizeData,W0=c||p.pitch!==0,q5=b.useProgram(jz(n1,B,O1),D1),f5=Z.an(B0,p.zoom),$5=b.style.map.terrain&&b.style.map.terrain.getTerrainData(L1),V0,c5,A5,h2,N5=[0,0],j5=null;if(B)c5=Q1.glyphAtlasTexture,A5=E.LINEAR,V0=Q1.glyphAtlasTexture.size,O1.iconsInText&&(N5=Q1.imageAtlasTexture.size,j5=Q1.imageAtlasTexture,h2=W0||b.options.rotating||b.options.zooming||B0.kind==="composite"||B0.kind==="camera"?E.LINEAR:E.NEAREST);else{let m5=k.layout.get("icon-size").constantOr(0)!==1||O1.iconsNeedLinear;c5=Q1.imageAtlasTexture,A5=n1||b.options.rotating||b.options.zooming||m5||W0?E.LINEAR:E.NEAREST,V0=Q1.imageAtlasTexture.size}let f3=Z.aC(Q1,1,b.transform.zoom),l3=L0(s,b.transform,f3),T7=Z.L();Z.aq(T7,l3);let $7=d1(c,s,b.transform,f3),R4=Z.aD(p,Q1,X,V),T6=p.getProjectionData({overscaledTileID:L1,applyGlobeMatrix:!y,applyTerrainMatrix:!0}),j7=q1&&O1.hasTextData(),Qw=k.layout.get("icon-text-fit")!=="none"&&j7&&O1.hasIconData();if(Z1){let m5=b.style.map.terrain?(a5,f7)=>b.style.map.terrain.getElevation(L1,a5,f7):null,u2=k.layout.get("text-rotation-alignment")==="map";u1(O1,b,B,l3,T7,c,C,u2,L1.toUnwrapped(),p.width,p.height,R4,m5)}let P2=B&&q1||Qw,H3=Z1||P2?zw:c?l3:b.transform.clipSpaceToPixelsMatrix,E2=n1&&k.paint.get(B?"text-halo-width":"icon-halo-width").constantOr(1)!==0,N4;N4=n1?O1.iconsInText?s9(B0.kind,f5,a,c,Z1,P2,b,H3,$7,R4,V0,N5,W1):ib(B0.kind,f5,a,c,Z1,P2,b,H3,$7,R4,B,V0,0,W1):sb(B0.kind,f5,a,c,Z1,P2,b,H3,$7,R4,B,V0,W1);let x2={program:q5,buffers:I1,uniformValues:N4,projectionData:T6,atlasTexture:c5,atlasTextureIcon:j5,atlasInterpolation:A5,atlasInterpolationIcon:h2,isSDF:n1,hasHalo:E2};if(x1&&O1.canOverlap){i=!0;let m5=I1.segments.get();for(let u2 of m5)V1.push({segments:new Z.aM([u2]),sortKey:u2.sortKey,state:x2,terrainData:$5})}else V1.push({segments:I1.segments,sortKey:0,state:x2,terrainData:$5})}i&&V1.sort((L1,Q1)=>L1.sortKey-Q1.sortKey);for(let L1 of V1){let Q1=L1.state;if(T.activeTexture.set(E.TEXTURE0),Q1.atlasTexture.bind(Q1.atlasInterpolation,E.CLAMP_TO_EDGE),Q1.atlasTextureIcon&&(T.activeTexture.set(E.TEXTURE1),Q1.atlasTextureIcon&&Q1.atlasTextureIcon.bind(Q1.atlasInterpolationIcon,E.CLAMP_TO_EDGE)),Q1.isSDF){let O1=Q1.uniformValues;Q1.hasHalo&&(O1.u_is_halo=1,P8(Q1.buffers,L1.segments,k,b,Q1.program,n,O,d,O1,Q1.projectionData,L1.terrainData)),O1.u_is_halo=0}P8(Q1.buffers,L1.segments,k,b,Q1.program,n,O,d,Q1.uniformValues,Q1.projectionData,L1.terrainData)}}function P8(b,z,k,J,B,X,V,L,F,C,O){let d=J.context;B.draw(d,d.gl.TRIANGLES,X,V,L,$0.backCCW,F,O,C,k.id,b.layoutVertexBuffer,b.indexBuffer,z,k.paint,J.transform.zoom,b.programConfigurations.get(k.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function Zw(b,z,k,J,B){let X=b.context,V=X.gl,L=d0.disabled,F=new t0([V.ONE,V.ONE],Z.bf.transparent,[!0,!0,!0,!0]),C=z.getBucket(k);if(!C)return;let O=J.key,d=k.heatmapFbos.get(O);d||(d=Yw(X,z.tileSize,z.tileSize),k.heatmapFbos.set(O,d)),X.bindFramebuffer.set(d.framebuffer),X.viewport.set([0,0,z.tileSize,z.tileSize]),X.clear({color:Z.bf.transparent});let y=C.programConfigurations.get(k.id),T=b.useProgram("heatmap",y,!B),E=b.transform.getProjectionData({overscaledTileID:z.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),p=b.style.map.terrain.getTerrainData(J);T.draw(X,V.TRIANGLES,H0.disabled,L,F,$0.disabled,nb(z,b.transform.zoom,k.paint.get("heatmap-intensity"),1),p,E,k.id,C.layoutVertexBuffer,C.indexBuffer,C.segments,k.paint,b.transform.zoom,y)}function W6(b,z,k,J,B){let X=b.context,V=X.gl,L=b.transform;X.setColorMode(b.colorModeForRenderPass());let F=mz(X,z),C=k.key,O=z.heatmapFbos.get(C);if(!O)return;X.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,O.colorAttachment.get()),X.activeTexture.set(V.TEXTURE1),F.bind(V.LINEAR,V.CLAMP_TO_EDGE);let d=L.getProjectionData({overscaledTileID:k,applyTerrainMatrix:B,applyGlobeMatrix:!J});b.useProgram("heatmapTexture").draw(X,V.TRIANGLES,H0.disabled,d0.disabled,b.colorModeForRenderPass(),$0.disabled,n9(b,z,0,1),null,d,z.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments,z.paint,L.zoom),O.destroy(),z.heatmapFbos.delete(C)}function Yw(b,z,k){var J,B;let X=b.gl,V=X.createTexture();X.bindTexture(X.TEXTURE_2D,V),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.LINEAR);let L=(J=b.HALF_FLOAT)!==null&&J!==void 0?J:X.UNSIGNED_BYTE,F=(B=b.RGBA16F)!==null&&B!==void 0?B:X.RGBA;X.texImage2D(X.TEXTURE_2D,0,F,z,k,0,X.RGBA,L,null);let C=b.createFramebuffer(z,k,!1,!1);return C.colorAttachment.set(V),C}function mz(b,z){return z.colorRampTexture||(z.colorRampTexture=new Z.T(b,z.colorRamp,b.gl.RGBA)),z.colorRampTexture}function h6(b,z,k,J,B,X,V,L){let F=256;if(B.stepInterpolant){let C=z.getSource().maxzoom,O=V.canonical.z===C?Math.ceil(1<<b.transform.maxZoom-V.canonical.z):1;F=Z.ae(Z.c4(X.maxLineLength/Z.$*1024*O),256,k.maxTextureSize)}return L.gradient=Z.c5({expression:B.gradientExpression(),evaluationKey:"lineProgress",resolution:F,image:L.gradient||void 0,clips:X.lineClipsArray}),L.texture?L.texture.update(L.gradient):L.texture=new Z.T(k,L.gradient,J.RGBA),L.version=B.gradientVersion,L.texture}function DZ(b,z,k,J,B){b.activeTexture.set(z.TEXTURE0),k.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),J.updatePaintBuffers(B)}function _z(b,z,k,J,B,X){(B||b.lineAtlas.dirty)&&(z.activeTexture.set(k.TEXTURE0),b.lineAtlas.bind(z)),J.updatePaintBuffers(X)}function kw(b,z,k,J,B,X,V){let L=X.gradients[B.id],F=L.texture;B.gradientVersion!==L.version&&(F=h6(b,z,k,J,B,X,V,L)),k.activeTexture.set(J.TEXTURE0),F.bind(B.stepInterpolant?J.NEAREST:J.LINEAR,J.CLAMP_TO_EDGE)}function kg(b,z,k,J,B,X,V,L,F){let C=X.gradients[B.id],O=C.texture;B.gradientVersion!==C.version&&(O=h6(b,z,k,J,B,X,V,C)),k.activeTexture.set(J.TEXTURE0),O.bind(B.stepInterpolant?J.NEAREST:J.LINEAR,J.CLAMP_TO_EDGE),k.activeTexture.set(J.TEXTURE1),b.lineAtlas.bind(k),L.updatePaintBuffers(F)}function vg(b,z,k,J,B){if(!k||!J||!J.imageAtlas)return;let X=J.imageAtlas.patternPositions,V=X[k.to.toString()],L=X[k.from.toString()];if(!V&&L&&(V=L),!L&&V&&(L=V),!V||!L){let F=B.getPaintProperty(z);V=X[F],L=X[F]}V&&L&&b.setConstantPatternPositions(V,L)}function Jg(b,z,k,J,B,X,V,L){let F=b.context.gl,O=k.paint.get("fill-pattern"),d=O&&O.constantOr(1),y=k.getCrossfadeParameters(),T,E,p,s,c,Z1=b.transform,a=k.paint.get("fill-translate"),x1=k.paint.get("fill-translate-anchor");V?(E=d&&!k.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",T=F.LINES):(E=d?"fillPattern":"fill",T=F.TRIANGLES);let i=O.constantOr(null);for(let n of J){let q1=z.getTile(n);if(d&&!q1.patternsLoaded())continue;let V1=q1.getBucket(k);if(!V1)continue;let W1=V1.programConfigurations.get(k.id),L1=b.useProgram(E,W1),Q1=b.style.map.terrain&&b.style.map.terrain.getTerrainData(n);d&&(b.context.activeTexture.set(F.TEXTURE0),q1.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),W1.updatePaintBuffers(y)),vg(W1,"fill-pattern",i,q1,k);let O1=Z1.getProjectionData({overscaledTileID:n,applyGlobeMatrix:!L,applyTerrainMatrix:!0}),I1=Z.aD(Z1,q1,a,x1);if(V){s=V1.indexBuffer2,c=V1.segments2;let n1=[F.drawingBufferWidth,F.drawingBufferHeight];p=E==="fillOutlinePattern"&&d?FZ(b,y,q1,n1,I1):o9(n1,I1)}else s=V1.indexBuffer,c=V1.segments,p=d?Xz(b,y,q1,I1):{u_fill_translate:I1};let D1=b.stencilModeForClipping(n);L1.draw(b.context,T,B,D1,X,$0.backCCW,p,Q1,O1,k.id,V1.layoutVertexBuffer,s,c,k.paint,b.transform.zoom,W1)}}function F6(b,z,k,J,B,X,V,L){let F=b.context,C=F.gl,d=k.paint.get("fill-extrusion-pattern"),y=d.constantOr(1),T=k.getCrossfadeParameters(),E=k.paint.get("fill-extrusion-opacity"),p=d.constantOr(null),s=b.transform;for(let c of J){let Z1=z.getTile(c),a=Z1.getBucket(k);if(!a)continue;let x1=b.style.map.terrain&&b.style.map.terrain.getTerrainData(c),i=a.programConfigurations.get(k.id),n=b.useProgram(y?"fillExtrusionPattern":"fillExtrusion",i);y&&(b.context.activeTexture.set(C.TEXTURE0),Z1.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),i.updatePaintBuffers(T));let q1=s.getProjectionData({overscaledTileID:c,applyGlobeMatrix:!L,applyTerrainMatrix:!0});vg(i,"fill-extrusion-pattern",p,Z1,k);let V1=Z.aD(s,Z1,k.paint.get("fill-extrusion-translate"),k.paint.get("fill-extrusion-translate-anchor")),W1=k.paint.get("fill-extrusion-vertical-gradient"),L1=y?O8(b,W1,E,V1,c,T,Z1):A6(b,W1,E,V1);n.draw(F,F.gl.TRIANGLES,B,X,V,$0.backCCW,L1,x1,q1,k.id,a.layoutVertexBuffer,a.indexBuffer,a.segments,k.paint,b.transform.zoom,i,b.style.map.terrain&&a.centroidVertexBuffer)}}function E8(b,z,k,J,B,X,V,L,F){var C;let O=b.style.projection,d=b.context,y=b.transform,T=d.gl,E=[`#define NUM_ILLUMINATION_SOURCES ${k.paint.get("hillshade-highlight-color").values.length}`],p=b.useProgram("hillshade",null,!1,E),s=!b.options.moving;for(let c of J){let Z1=z.getTile(c),a=Z1.fbo;if(!a)continue;let x1=O.getMeshFromTileID(d,c.canonical,L,!0,"raster"),i=(C=b.style.map.terrain)===null||C===void 0?void 0:C.getTerrainData(c);d.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,a.colorAttachment.get());let n=y.getProjectionData({overscaledTileID:c,aligned:s,applyGlobeMatrix:!F,applyTerrainMatrix:!0});p.draw(d,T.TRIANGLES,X,B[c.overscaledZ],V,$0.backCCW,Lz(b,Z1,k),i,n,k.id,x1.vertexBuffer,x1.indexBuffer,x1.segments)}}function Gg(b,z,k,J,B,X,V,L,F){var C;let O=b.style.projection,d=b.context,y=b.transform,T=d.gl,E=b.useProgram("colorRelief"),p=!b.options.moving,s=!0,c=0;for(let Z1 of J){let a=z.getTile(Z1),x1=a.dem;if(s){let L1=T.getParameter(T.MAX_TEXTURE_SIZE),{elevationTexture:Q1,colorTexture:O1}=k.getColorRampTextures(d,L1,x1.getUnpackVector());d.activeTexture.set(T.TEXTURE1),Q1.bind(T.NEAREST,T.CLAMP_TO_EDGE),d.activeTexture.set(T.TEXTURE4),O1.bind(T.LINEAR,T.CLAMP_TO_EDGE),s=!1,c=Q1.size[0]}if(!x1||!x1.data)continue;let i=x1.stride,n=x1.getPixels();if(d.activeTexture.set(T.TEXTURE0),d.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||b.getTileTexture(i),a.demTexture){let L1=a.demTexture;L1.update(n,{premultiply:!1}),L1.bind(T.LINEAR,T.CLAMP_TO_EDGE)}else a.demTexture=new Z.T(d,n,T.RGBA,{premultiply:!1}),a.demTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE);let q1=O.getMeshFromTileID(d,Z1.canonical,L,!0,"raster"),V1=(C=b.style.map.terrain)===null||C===void 0?void 0:C.getTerrainData(Z1),W1=y.getProjectionData({overscaledTileID:Z1,aligned:p,applyGlobeMatrix:!F,applyTerrainMatrix:!0});E.draw(d,T.TRIANGLES,X,B[Z1.overscaledZ],V,$0.backCCW,Fz(k,a.dem,c),V1,W1,k.id,q1.vertexBuffer,q1.indexBuffer,q1.segments)}}let vw=[new Z.P(0,0),new Z.P(Z.$,0),new Z.P(Z.$,Z.$),new Z.P(0,Z.$)];function U5(b,z,k,J,B,X,V,L,F=!1,C=!1){let O=J[J.length-1].overscaledZ,d=b.context,y=d.gl,T=b.useProgram("raster"),E=b.transform,p=b.style.projection,s=b.colorModeForRenderPass(),c=!b.options.moving,Z1=k.paint.get("raster-opacity"),a=k.paint.get("raster-resampling"),x1=k.paint.get("raster-fade-duration"),i=!!b.style.map.terrain;for(let n of J){let q1=b.getDepthModeForSublayer(n.overscaledZ-O,Z1===1?H0.ReadWrite:H0.ReadOnly,y.LESS),V1=z.getTile(n),W1=a==="nearest"?y.NEAREST:y.LINEAR;d.activeTexture.set(y.TEXTURE0),V1.texture.bind(W1,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST),d.activeTexture.set(y.TEXTURE1);let{parentTile:L1,parentScaleBy:Q1,parentTopLeft:O1,fadeValues:I1}=d7(V1,z,x1,i);V1.fadeOpacity=I1.tileOpacity,L1?(L1.fadeOpacity=I1.parentTileOpacity,L1.texture.bind(W1,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST)):V1.texture.bind(W1,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST),V1.texture.useMipmap&&d.extTextureFilterAnisotropic&&b.transform.pitch>20&&y.texParameterf(y.TEXTURE_2D,d.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,d.extTextureFilterAnisotropicMax);let D1=b.style.map.terrain&&b.style.map.terrain.getTerrainData(n),n1=E.getProjectionData({overscaledTileID:n,aligned:c,applyGlobeMatrix:!C,applyTerrainMatrix:!0}),B0=CZ(O1,Q1,I1.fadeMix,k,L),W0=p.getMeshFromTileID(d,n.canonical,X,V,"raster");T.draw(d,y.TRIANGLES,q1,B?B[n.overscaledZ]:d0.disabled,s,F?$0.frontCCW:$0.backCCW,B0,D1,n1,k.id,W0.vertexBuffer,W0.indexBuffer,W0.segments)}}function d7(b,z,k,J){let B={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(k===0||J)return B;if(b.fadingParentID){let X=z._getLoadedTile(b.fadingParentID);if(!X)return B;let V=Math.pow(2,X.tileID.overscaledZ-b.tileID.overscaledZ),L=[b.tileID.canonical.x*V%1,b.tileID.canonical.y*V%1],F=function(C,O,d){let y=z1(),T=(y-O.timeAdded)/d,E=C.fadingDirection===S.Incoming,p=Z.ae((y-C.timeAdded)/d,0,1),s=Z.ae(1-T,0,1),c=E?p:s;return{tileOpacity:c,parentTileOpacity:E?s:p,fadeMix:{opacity:1,mix:1-c}}}(b,X,k);return{parentTile:X,parentScaleBy:V,parentTopLeft:L,fadeValues:F}}if(b.selfFading){let X=function(V,L){let F=(z1()-V.timeAdded)/L,C=Z.ae(F,0,1);return{tileOpacity:C,fadeMix:{opacity:C,mix:0}}}(b,k);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:X}}return B}let h3=new Z.bf(1,0,0,1),Hg=new Z.bf(0,1,0,1),Jw=new Z.bf(0,0,1,1),Pz=new Z.bf(1,0,1,1),K6=new Z.bf(0,1,1,1);function Gw(b,z,k,J){C6(b,0,z+k/2,b.transform.width,k,J)}function l6(b,z,k,J){C6(b,z-k/2,0,k,b.transform.height,J)}function C6(b,z,k,J,B,X){let V=b.context,L=V.gl;L.enable(L.SCISSOR_TEST),L.scissor(z*b.pixelRatio,k*b.pixelRatio,J*b.pixelRatio,B*b.pixelRatio),V.clear({color:X}),L.disable(L.SCISSOR_TEST)}function Ez(b,z,k){let J=b.context,B=J.gl,X=b.useProgram("debug"),V=H0.disabled,L=d0.disabled,F=b.colorModeForRenderPass(),O=b.style.map.terrain&&b.style.map.terrain.getTerrainData(k);J.activeTexture.set(B.TEXTURE0);let d=z.getTileByID(k.key).latestRawTileData,y=Math.floor((d&&d.byteLength||0)/1024),T=z.getTile(k).tileSize,E=512/Math.min(T,512)*(k.overscaledZ/b.transform.zoom)*0.5,p=k.canonical.toString();k.overscaledZ!==k.canonical.z&&(p+=` => ${k.overscaledZ}`),function(c,Z1){c.initDebugOverlayCanvas();let a=c.debugOverlayCanvas,x1=c.context.gl,i=c.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,a.width,a.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(Z1,5,5),i.strokeText(Z1,5,5),c.debugOverlayTexture.update(a),c.debugOverlayTexture.bind(x1.LINEAR,x1.CLAMP_TO_EDGE)}(b,`${p} ${y}kB`);let s=b.transform.getProjectionData({overscaledTileID:k,applyGlobeMatrix:!0,applyTerrainMatrix:!0});X.draw(J,B.TRIANGLES,V,L,t0.alphaBlended,$0.disabled,Vz(Z.bf.transparent,E),null,s,"$debug",b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),X.draw(J,B.LINE_STRIP,V,L,F,$0.disabled,Vz(Z.bf.red),O,s,"$debug",b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function Ug(b,z,k,J){let{isRenderingGlobe:B}=J,X=b.context,V=X.gl,L=b.transform,F=b.colorModeForRenderPass(),C=b.getDepthModeFor3D(),O=b.useProgram("terrain");X.bindFramebuffer.set(null),X.viewport.set([0,0,b.width,b.height]);for(let d of k){let y=z.getTerrainMesh(d.tileID),T=b.renderToTexture.getTexture(d),E=z.getTerrainData(d.tileID);X.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,T.texture);let p=z.getMeshFrameDelta(L.zoom),s=L.calculateFogMatrix(d.tileID.toUnwrapped()),c=rb(p,s,b.style.sky,L.pitch,B),Z1=L.getProjectionData({overscaledTileID:d.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});O.draw(X,V.TRIANGLES,C,d0.disabled,F,$0.backCCW,c,E,Z1,"terrain",y.vertexBuffer,y.indexBuffer,y.segments)}}function Bg(b,z){if(!z.mesh){let k=new Z.aL;k.emplaceBack(-1,-1),k.emplaceBack(1,-1),k.emplaceBack(1,1),k.emplaceBack(-1,1);let J=new Z.aN;J.emplaceBack(0,1,2),J.emplaceBack(0,2,3),z.mesh=new W3(b.createVertexBuffer(k,h0.members),b.createIndexBuffer(J),Z.aM.simpleSegment(0,0,k.length,J.length))}return z.mesh}class Ag{constructor(b,z){this.context=new Yg(b),this.transform=z,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:Z.ai(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=M0.maxUnderzooming+M0.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new r4}resize(b,z,k){if(this.width=Math.floor(b*k),this.height=Math.floor(z*k),this.pixelRatio=k,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let J of this.style._order)this.style._layers[J].resize()}setup(){let b=this.context,z=new Z.aL;z.emplaceBack(0,0),z.emplaceBack(Z.$,0),z.emplaceBack(0,Z.$),z.emplaceBack(Z.$,Z.$),this.tileExtentBuffer=b.createVertexBuffer(z,h0.members),this.tileExtentSegments=Z.aM.simpleSegment(0,0,4,2);let k=new Z.aL;k.emplaceBack(0,0),k.emplaceBack(Z.$,0),k.emplaceBack(0,Z.$),k.emplaceBack(Z.$,Z.$),this.debugBuffer=b.createVertexBuffer(k,h0.members),this.debugSegments=Z.aM.simpleSegment(0,0,4,5);let J=new Z.c7;J.emplaceBack(0,0,0,0),J.emplaceBack(Z.$,0,Z.$,0),J.emplaceBack(0,Z.$,0,Z.$),J.emplaceBack(Z.$,Z.$,Z.$,Z.$),this.rasterBoundsBuffer=b.createVertexBuffer(J,ab.members),this.rasterBoundsSegments=Z.aM.simpleSegment(0,0,4,2);let B=new Z.aL;B.emplaceBack(0,0),B.emplaceBack(Z.$,0),B.emplaceBack(0,Z.$),B.emplaceBack(Z.$,Z.$),this.rasterBoundsBufferPosOnly=b.createVertexBuffer(B,h0.members),this.rasterBoundsSegmentsPosOnly=Z.aM.simpleSegment(0,0,4,5);let X=new Z.aL;X.emplaceBack(0,0),X.emplaceBack(1,0),X.emplaceBack(0,1),X.emplaceBack(1,1),this.viewportBuffer=b.createVertexBuffer(X,h0.members),this.viewportSegments=Z.aM.simpleSegment(0,0,4,2);let V=new Z.c8;V.emplaceBack(0),V.emplaceBack(1),V.emplaceBack(3),V.emplaceBack(2),V.emplaceBack(0),this.tileBorderIndexBuffer=b.createIndexBuffer(V);let L=new Z.aN;L.emplaceBack(1,0,2),L.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=b.createIndexBuffer(L);let F=this.context.gl;this.stencilClearMode=new d0({func:F.ALWAYS,mask:0},0,255,F.ZERO,F.ZERO,F.ZERO),this.tileExtentMesh=new W3(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){let b=this.context,z=b.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let k=Z.L();Z.bZ(k,0,this.width,this.height,0,0,1),Z.N(k,k,[z.drawingBufferWidth,z.drawingBufferHeight,0]);let J={mainMatrix:k,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:k};this.useProgram("clippingMask",null,!0).draw(b,z.TRIANGLES,H0.disabled,this.stencilClearMode,t0.disabled,$0.disabled,null,null,J,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(b,z,k){if(this.currentStencilSource===b.source||!b.isTileClipped()||!z||!z.length)return;this.currentStencilSource=b.source,this.nextStencilID+z.length>256&&this.clearStencil();let J=this.context;J.setColorMode(t0.disabled),J.setDepthMode(H0.disabled);let B={};for(let X of z)B[X.key]=this.nextStencilID++;this._renderTileMasks(B,z,k,!0),this._renderTileMasks(B,z,k,!1),this._tileClippingMaskIDs=B}_renderTileMasks(b,z,k,J){let B=this.context,X=B.gl,V=this.style.projection,L=this.transform,F=this.useProgram("clippingMask");for(let C of z){let O=b[C.key],d=this.style.map.terrain&&this.style.map.terrain.getTerrainData(C),y=V.getMeshFromTileID(this.context,C.canonical,J,!0,"stencil"),T=L.getProjectionData({overscaledTileID:C,applyGlobeMatrix:!k,applyTerrainMatrix:!0});F.draw(B,X.TRIANGLES,H0.disabled,new d0({func:X.ALWAYS,mask:0},O,255,X.KEEP,X.KEEP,X.REPLACE),t0.disabled,k?$0.disabled:$0.backCCW,null,d,T,"$clipping",y.vertexBuffer,y.indexBuffer,y.segments)}}_renderTilesDepthBuffer(){let b=this.context,z=b.gl,k=this.style.projection,J=this.transform,B=this.useProgram("depth"),X=this.getDepthModeFor3D(),V=N1(J,{tileSize:J.tileSize});for(let L of V){let F=this.style.map.terrain&&this.style.map.terrain.getTerrainData(L),C=k.getMeshFromTileID(this.context,L.canonical,!0,!0,"raster"),O=J.getProjectionData({overscaledTileID:L,applyGlobeMatrix:!0,applyTerrainMatrix:!0});B.draw(b,z.TRIANGLES,X,d0.disabled,t0.disabled,$0.backCCW,null,F,O,"$clipping",C.vertexBuffer,C.indexBuffer,C.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let b=this.nextStencilID++,z=this.context.gl;return new d0({func:z.NOTEQUAL,mask:255},b,255,z.KEEP,z.KEEP,z.REPLACE)}stencilModeForClipping(b){let z=this.context.gl;return new d0({func:z.EQUAL,mask:255},this._tileClippingMaskIDs[b.key],0,z.KEEP,z.KEEP,z.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(b){let z=this.context.gl,k=b.sort((X,V)=>V.overscaledZ-X.overscaledZ),J=k[k.length-1].overscaledZ,B=k[0].overscaledZ-J+1;if(B>1){this.currentStencilSource=void 0,this.nextStencilID+B>256&&this.clearStencil();let X={};for(let V=0;V<B;V++)X[V+J]=new d0({func:z.GEQUAL,mask:255},V+this.nextStencilID,255,z.KEEP,z.KEEP,z.REPLACE);return this.nextStencilID+=B,[X,k]}return[{[J]:d0.disabled},k]}stencilConfigForOverlapTwoPass(b){let z=this.context.gl,k=b.sort((X,V)=>V.overscaledZ-X.overscaledZ),J=k[k.length-1].overscaledZ,B=k[0].overscaledZ-J+1;if(this.clearStencil(),B>1){let X={},V={};for(let L=0;L<B;L++)X[L+J]=new d0({func:z.GREATER,mask:255},B+1+L,255,z.KEEP,z.KEEP,z.REPLACE),V[L+J]=new d0({func:z.GREATER,mask:255},1+L,255,z.KEEP,z.KEEP,z.REPLACE);return this.nextStencilID=2*B+1,[X,V,k]}return this.nextStencilID=3,[{[J]:new d0({func:z.GREATER,mask:255},2,255,z.KEEP,z.KEEP,z.REPLACE)},{[J]:new d0({func:z.GREATER,mask:255},1,255,z.KEEP,z.KEEP,z.REPLACE)},k]}colorModeForRenderPass(){let b=this.context.gl;if(this._showOverdrawInspector)return new t0([b.CONSTANT_COLOR,b.ONE],new Z.bf(0.125,0.125,0.125,0),[!0,!0,!0,!0]);return this.renderPass==="opaque"?t0.unblended:t0.alphaBlended}getDepthModeForSublayer(b,z,k){if(!this.opaquePassEnabledForLayer())return H0.disabled;let J=1-((1+this.currentLayer)*this.numSublayers+b)*this.depthEpsilon;return new H0(k||this.context.gl.LEQUAL,z,[J,J])}getDepthModeFor3D(){return new H0(this.context.gl.LEQUAL,H0.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(b,z){var k,J;this.style=b,this.options=z,this.lineAtlas=b.lineAtlas,this.imageManager=b.imageManager,this.glyphManager=b.glyphManager,this.symbolFadeChange=b.placement.symbolFadeChange(z1()),this.imageManager.beginFrame();let B=this.style._order,X=this.style.sourceCaches,V={},L={},F={},C={isRenderingToTexture:!1,isRenderingGlobe:((k=b.projection)===null||k===void 0?void 0:k.transitionState)>0};for(let d in X){let y=X[d];y.used&&y.prepare(this.context),V[d]=y.getVisibleCoordinates(!1),L[d]=V[d].slice().reverse(),F[d]=y.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let d=0;d<B.length;d++)if(this.style._layers[B[d]].is3D()){this.opaquePassCutoff=d;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(let d of B){let y=this.style._layers[d];if(!y.hasOffscreenPass()||y.isHidden(this.transform.zoom))continue;let T=L[y.source];(y.type==="custom"||T.length)&&this.renderLayer(this,X[y.source],y,T,C)}if((J=this.style.projection)===null||J===void 0||J.updateGPUdependent({context:this.context,useProgram:(d)=>this.useProgram(d)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:z.showOverdrawInspector?Z.bf.black:Z.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(d,y){let T=d.context,E=T.gl,p=((i,n,q1)=>{let V1=Math.cos(n.rollInRadians),W1=Math.sin(n.rollInRadians),L1=X1(n),Q1=n.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:i.properties.get("sky-color"),u_horizon_color:i.properties.get("horizon-color"),u_horizon:[(n.width/2-L1*W1)*q1,(n.height/2+L1*V1)*q1],u_horizon_normal:[-W1,V1],u_sky_horizon_blend:i.properties.get("sky-horizon-blend")*n.height/2*q1,u_sky_blend:Q1}})(y,d.style.map.transform,d.pixelRatio),s=new H0(E.LEQUAL,H0.ReadWrite,[0,1]),c=d0.disabled,Z1=d.colorModeForRenderPass(),a=d.useProgram("sky"),x1=Bg(T,y);a.draw(T,E.TRIANGLES,s,c,Z1,$0.disabled,p,null,void 0,"sky",x1.vertexBuffer,x1.indexBuffer,x1.segments)}(this,this.style.sky),this._showOverdrawInspector=z.showOverdrawInspector,this.depthRangeFor3D=[0,1-(b._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=B.length-1;this.currentLayer>=0;this.currentLayer--){let d=this.style._layers[B[this.currentLayer]],y=X[d.source],T=V[d.source];this._renderTileClippingMasks(d,T,!1),this.renderLayer(this,y,d,T,C)}this.renderPass="translucent";let O=!1;for(this.currentLayer=0;this.currentLayer<B.length;this.currentLayer++){let d=this.style._layers[B[this.currentLayer]],y=X[d.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(d,C))continue;this.opaquePassEnabledForLayer()||O||(O=!0,C.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());let T=(d.type==="symbol"?F:L)[d.source];this._renderTileClippingMasks(d,V[d.source],!!this.renderToTexture),this.renderLayer(this,y,d,T,C)}if(C.isRenderingGlobe&&function(d,y,T){let E=d.context,p=E.gl,s=d.useProgram("atmosphere"),c=new H0(p.LEQUAL,H0.ReadOnly,[0,1]),Z1=d.transform,a=function(Q1,O1){let I1=Q1.properties.get("position"),D1=[-I1.x,-I1.y,-I1.z],n1=Z.ai(new Float64Array(16));return Q1.properties.get("anchor")==="map"&&(Z.b6(n1,n1,O1.rollInRadians),Z.b7(n1,n1,-O1.pitchInRadians),Z.b6(n1,n1,O1.bearingInRadians),Z.b7(n1,n1,O1.center.lat*Math.PI/180),Z.bz(n1,n1,-O1.center.lng*Math.PI/180)),Z.c6(D1,D1,n1),D1}(T,d.transform),x1=Z1.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),i=y.properties.get("atmosphere-blend")*x1.projectionTransition;if(i===0)return;let n=o4(Z1.worldSize,Z1.center.lat),q1=Z1.inverseProjectionMatrix,V1=new Float64Array(4);V1[3]=1,Z.aw(V1,V1,Z1.modelViewProjectionMatrix),V1[0]/=V1[3],V1[1]/=V1[3],V1[2]/=V1[3],V1[3]=1,Z.aw(V1,V1,q1),V1[0]/=V1[3],V1[1]/=V1[3],V1[2]/=V1[3],V1[3]=1;let W1=((Q1,O1,I1,D1,n1)=>({u_sun_pos:Q1,u_atmosphere_blend:O1,u_globe_position:I1,u_globe_radius:D1,u_inv_proj_matrix:n1}))(a,i,[V1[0],V1[1],V1[2]],n,q1),L1=Bg(E,y);s.draw(E,p.TRIANGLES,c,d0.disabled,t0.alphaBlended,$0.disabled,W1,null,null,"atmosphere",L1.vertexBuffer,L1.indexBuffer,L1.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){let d=function(y,T){let E=null,p=Object.values(y._layers).flatMap((a)=>a.source&&!a.isHidden(T)?[y.sourceCaches[a.source]]:[]),s=p.filter((a)=>a.getSource().type==="vector"),c=p.filter((a)=>a.getSource().type!=="vector"),Z1=(a)=>{(!E||E.getSource().maxzoom<a.getSource().maxzoom)&&(E=a)};return s.forEach((a)=>Z1(a)),E||c.forEach((a)=>Z1(a)),E}(this.style,this.transform.zoom);d&&function(y,T,E){for(let p=0;p<E.length;p++)Ez(y,T,E[p])}(this,d,d.getVisibleCoordinates())}this.options.showPadding&&function(d){let y=d.transform.padding;Gw(d,d.transform.height-(y.top||0),3,h3),Gw(d,y.bottom||0,3,Hg),l6(d,y.left||0,3,Jw),l6(d,d.transform.width-(y.right||0),3,Pz);let T=d.transform.centerPoint;(function(E,p,s,c){C6(E,p-1,s-10,2,20,c),C6(E,p-10,s-1,20,2,c)})(d,T.x,d.transform.height-T.y,K6)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(b){if(!this.style||!this.style.map||!this.style.map.terrain)return;let z=this.terrainFacilitator.matrix,k=this.transform.modelViewProjectionMatrix,J=this.terrainFacilitator.dirty;J||(J=b?!Z.c9(z,k):!Z.ca(z,k)),J||(J=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),J&&(Z.cb(z,k),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(B,X){let V=B.context,L=V.gl,F=B.transform,C=t0.unblended,O=new H0(L.LEQUAL,H0.ReadWrite,[0,1]),d=X.sourceCache.getRenderableTiles(),y=B.useProgram("terrainDepth");V.bindFramebuffer.set(X.getFramebuffer("depth").framebuffer),V.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),V.clear({color:Z.bf.transparent,depth:1});for(let T of d){let E=X.getTerrainMesh(T.tileID),p=X.getTerrainData(T.tileID),s=F.getProjectionData({overscaledTileID:T.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),c={u_ele_delta:X.getMeshFrameDelta(F.zoom)};y.draw(V,L.TRIANGLES,O,d0.disabled,C,$0.backCCW,c,p,s,"terrain",E.vertexBuffer,E.indexBuffer,E.segments)}V.bindFramebuffer.set(null),V.viewport.set([0,0,B.width,B.height])}(this,this.style.map.terrain),function(B,X){let V=B.context,L=V.gl,F=B.transform,C=t0.unblended,O=new H0(L.LEQUAL,H0.ReadWrite,[0,1]),d=X.getCoordsTexture(),y=X.sourceCache.getRenderableTiles(),T=B.useProgram("terrainCoords");V.bindFramebuffer.set(X.getFramebuffer("coords").framebuffer),V.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),V.clear({color:Z.bf.transparent,depth:1}),X.coordsIndex=[];for(let E of y){let p=X.getTerrainMesh(E.tileID),s=X.getTerrainData(E.tileID);V.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,d.texture);let c={u_terrain_coords_id:(255-X.coordsIndex.length)/255,u_texture:0,u_ele_delta:X.getMeshFrameDelta(F.zoom)},Z1=F.getProjectionData({overscaledTileID:E.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});T.draw(V,L.TRIANGLES,O,d0.disabled,C,$0.backCCW,c,s,Z1,"terrain",p.vertexBuffer,p.indexBuffer,p.segments),X.coordsIndex.push(E.tileID.key)}V.bindFramebuffer.set(null),V.viewport.set([0,0,B.width,B.height])}(this,this.style.map.terrain))}renderLayer(b,z,k,J,B){k.isHidden(this.transform.zoom)||(k.type==="background"||k.type==="custom"||(J||[]).length)&&(this.id=k.id,Z.cc(k)?function(X,V,L,F,C,O){if(X.renderPass!=="translucent")return;let{isRenderingToTexture:d}=O,y=d0.disabled,T=X.colorModeForRenderPass();(L._unevaluatedLayout.hasValue("text-variable-anchor")||L._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(E,p,s,c,Z1,a,x1,i,n){let q1=p.transform,V1=p.style.map.terrain,W1=Z1==="map",L1=a==="map";for(let Q1 of E){let O1=c.getTile(Q1),I1=O1.getBucket(s);if(!I1||!I1.text||!I1.text.segments.get().length)continue;let D1=Z.an(I1.textSizeData,q1.zoom),n1=Z.aC(O1,1,p.transform.zoom),B0=L0(W1,p.transform,n1),W0=s.layout.get("icon-text-fit")!=="none"&&I1.hasIconData();if(D1){let q5=Math.pow(2,q1.zoom-O1.tileID.overscaledZ),f5=V1?($5,V0)=>V1.getElevation(Q1,$5,V0):null;qw(I1,W1,L1,n,q1,B0,q5,D1,W0,Z.aD(q1,O1,x1,i),Q1.toUnwrapped(),f5)}}}(F,X,L,V,L.layout.get("text-rotation-alignment"),L.layout.get("text-pitch-alignment"),L.paint.get("text-translate"),L.paint.get("text-translate-anchor"),C),L.paint.get("icon-opacity").constantOr(1)!==0&&_8(X,V,L,F,!1,L.paint.get("icon-translate"),L.paint.get("icon-translate-anchor"),L.layout.get("icon-rotation-alignment"),L.layout.get("icon-pitch-alignment"),L.layout.get("icon-keep-upright"),y,T,d),L.paint.get("text-opacity").constantOr(1)!==0&&_8(X,V,L,F,!0,L.paint.get("text-translate"),L.paint.get("text-translate-anchor"),L.layout.get("text-rotation-alignment"),L.layout.get("text-pitch-alignment"),L.layout.get("text-keep-upright"),y,T,d),V.map.showCollisionBoxes&&(j8(X,V,L,F,!0),j8(X,V,L,F,!1))}(b,z,k,J,this.style.placement.variableOffsets,B):Z.cd(k)?function(X,V,L,F,C){if(X.renderPass!=="translucent")return;let{isRenderingToTexture:O}=C,d=L.paint.get("circle-opacity"),y=L.paint.get("circle-stroke-width"),T=L.paint.get("circle-stroke-opacity"),E=!L.layout.get("circle-sort-key").isConstant();if(d.constantOr(1)===0&&(y.constantOr(1)===0||T.constantOr(1)===0))return;let p=X.context,s=p.gl,c=X.transform,Z1=X.getDepthModeForSublayer(0,H0.ReadOnly),a=d0.disabled,x1=X.colorModeForRenderPass(),i=[],n=c.getCircleRadiusCorrection();for(let q1=0;q1<F.length;q1++){let V1=F[q1],W1=V.getTile(V1),L1=W1.getBucket(L);if(!L1)continue;let Q1=L.paint.get("circle-translate"),O1=L.paint.get("circle-translate-anchor"),I1=Z.aD(c,W1,Q1,O1),D1=L1.programConfigurations.get(L.id),n1=X.useProgram("circle",D1),B0=L1.layoutVertexBuffer,W0=L1.indexBuffer,q5=X.style.map.terrain&&X.style.map.terrain.getTerrainData(V1),f5={programConfiguration:D1,program:n1,layoutVertexBuffer:B0,indexBuffer:W0,uniformValues:M6(X,W1,L,I1,n),terrainData:q5,projectionData:c.getProjectionData({overscaledTileID:V1,applyGlobeMatrix:!O,applyTerrainMatrix:!0})};if(E){let $5=L1.segments.get();for(let V0 of $5)i.push({segments:new Z.aM([V0]),sortKey:V0.sortKey,state:f5})}else i.push({segments:L1.segments,sortKey:0,state:f5})}E&&i.sort((q1,V1)=>q1.sortKey-V1.sortKey);for(let q1 of i){let{programConfiguration:V1,program:W1,layoutVertexBuffer:L1,indexBuffer:Q1,uniformValues:O1,terrainData:I1,projectionData:D1}=q1.state;W1.draw(p,s.TRIANGLES,Z1,a,x1,$0.backCCW,O1,I1,D1,L.id,L1,Q1,q1.segments,L.paint,X.transform.zoom,V1)}}(b,z,k,J,B):Z.ce(k)?function(X,V,L,F,C){if(L.paint.get("heatmap-opacity")===0)return;let O=X.context,{isRenderingToTexture:d,isRenderingGlobe:y}=C;if(X.style.map.terrain){for(let T of F){let E=V.getTile(T);V.hasRenderableParent(T)||(X.renderPass==="offscreen"?Zw(X,E,L,T,y):X.renderPass==="translucent"&&W6(X,L,T,d,y))}O.viewport.set([0,0,X.width,X.height])}else X.renderPass==="offscreen"?function(T,E,p,s){let c=T.context,Z1=c.gl,a=T.transform,x1=d0.disabled,i=new t0([Z1.ONE,Z1.ONE],Z.bf.transparent,[!0,!0,!0,!0]);(function(n,q1,V1){let W1=n.gl;n.activeTexture.set(W1.TEXTURE1),n.viewport.set([0,0,q1.width/4,q1.height/4]);let L1=V1.heatmapFbos.get(Z.c3);L1?(W1.bindTexture(W1.TEXTURE_2D,L1.colorAttachment.get()),n.bindFramebuffer.set(L1.framebuffer)):(L1=Yw(n,q1.width/4,q1.height/4),V1.heatmapFbos.set(Z.c3,L1))})(c,T,p),c.clear({color:Z.bf.transparent});for(let n=0;n<s.length;n++){let q1=s[n];if(E.hasRenderableParent(q1))continue;let V1=E.getTile(q1),W1=V1.getBucket(p);if(!W1)continue;let L1=W1.programConfigurations.get(p.id),Q1=T.useProgram("heatmap",L1),O1=a.getProjectionData({overscaledTileID:q1,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),I1=a.getCircleRadiusCorrection();Q1.draw(c,Z1.TRIANGLES,H0.disabled,x1,i,$0.backCCW,nb(V1,a.zoom,p.paint.get("heatmap-intensity"),I1),null,O1,p.id,W1.layoutVertexBuffer,W1.indexBuffer,W1.segments,p.paint,a.zoom,L1)}c.viewport.set([0,0,T.width,T.height])}(X,V,L,F):X.renderPass==="translucent"&&function(T,E){let p=T.context,s=p.gl;p.setColorMode(T.colorModeForRenderPass());let c=E.heatmapFbos.get(Z.c3);c&&(p.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,c.colorAttachment.get()),p.activeTexture.set(s.TEXTURE1),mz(p,E).bind(s.LINEAR,s.CLAMP_TO_EDGE),T.useProgram("heatmapTexture").draw(p,s.TRIANGLES,H0.disabled,d0.disabled,T.colorModeForRenderPass(),$0.disabled,n9(T,E,0,1),null,null,E.id,T.viewportBuffer,T.quadTriangleIndexBuffer,T.viewportSegments,E.paint,T.transform.zoom))}(X,L)}(b,z,k,J,B):Z.cf(k)?function(X,V,L,F,C){if(X.renderPass!=="translucent")return;let{isRenderingToTexture:O}=C,d=L.paint.get("line-opacity"),y=L.paint.get("line-width");if(d.constantOr(1)===0||y.constantOr(1)===0)return;let T=X.getDepthModeForSublayer(0,H0.ReadOnly),E=X.colorModeForRenderPass(),p=L.paint.get("line-dasharray"),s=p.constantOr(1),c=L.paint.get("line-pattern"),Z1=c.constantOr(1),a=L.paint.get("line-gradient"),x1=L.getCrossfadeParameters(),i;i=Z1?"linePattern":s&&a?"lineGradientSDF":s?"lineSDF":a?"lineGradient":"line";let n=X.context,q1=n.gl,V1=X.transform,W1=!0;for(let L1 of F){let Q1=V.getTile(L1);if(Z1&&!Q1.patternsLoaded())continue;let O1=Q1.getBucket(L);if(!O1)continue;let I1=O1.programConfigurations.get(L.id),D1=X.context.program.get(),n1=X.useProgram(i,I1),B0=W1||n1.program!==D1,W0=X.style.map.terrain&&X.style.map.terrain.getTerrainData(L1),q5=c.constantOr(null),f5=p&&p.constantOr(null);if(q5&&Q1.imageAtlas){let h2=Q1.imageAtlas,N5=h2.patternPositions[q5.to.toString()],j5=h2.patternPositions[q5.from.toString()];N5&&j5&&I1.setConstantPatternPositions(N5,j5)}else if(f5){let h2=L.layout.get("line-cap")==="round",N5=X.lineAtlas.getDash(f5.to,h2),j5=X.lineAtlas.getDash(f5.from,h2);I1.setConstantDashPositions(N5,j5)}let $5=V1.getProjectionData({overscaledTileID:L1,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),V0=V1.getPixelScale(),c5;Z1?(c5=lz(X,Q1,L,V0,x1),DZ(n,q1,Q1,I1,x1)):s&&a?(c5=lZ(X,Q1,L,V0,x1,O1.lineClipsArray.length),kg(X,V,n,q1,L,O1,L1,I1,x1)):s?(c5=y8(X,Q1,L,V0,x1),_z(X,n,q1,I1,B0,x1)):a?(c5=Kz(X,Q1,L,V0,O1.lineClipsArray.length),kw(X,V,n,q1,L,O1,L1)):c5=Z4(X,Q1,L,V0);let A5=X.stencilModeForClipping(L1);n1.draw(n,q1.TRIANGLES,T,A5,E,$0.disabled,c5,W0,$5,L.id,O1.layoutVertexBuffer,O1.indexBuffer,O1.segments,L.paint,X.transform.zoom,I1,O1.layoutVertexBuffer2),W1=!1}}(b,z,k,J,B):Z.cg(k)?function(X,V,L,F,C){let O=L.paint.get("fill-color"),d=L.paint.get("fill-opacity");if(d.constantOr(1)===0)return;let{isRenderingToTexture:y}=C,T=X.colorModeForRenderPass(),E=L.paint.get("fill-pattern"),p=X.opaquePassEnabledForLayer()&&!E.constantOr(1)&&O.constantOr(Z.bf.transparent).a===1&&d.constantOr(0)===1?"opaque":"translucent";if(X.renderPass===p){let s=X.getDepthModeForSublayer(1,X.renderPass==="opaque"?H0.ReadWrite:H0.ReadOnly);Jg(X,V,L,F,s,T,!1,y)}if(X.renderPass==="translucent"&&L.paint.get("fill-antialias")){let s=X.getDepthModeForSublayer(L.getPaintProperty("fill-outline-color")?2:0,H0.ReadOnly);Jg(X,V,L,F,s,T,!0,y)}}(b,z,k,J,B):Z.ch(k)?function(X,V,L,F,C){let O=L.paint.get("fill-extrusion-opacity");if(O===0)return;let{isRenderingToTexture:d}=C;if(X.renderPass==="translucent"){let y=new H0(X.context.gl.LEQUAL,H0.ReadWrite,X.depthRangeFor3D);if(O!==1||L.paint.get("fill-extrusion-pattern").constantOr(1))F6(X,V,L,F,y,d0.disabled,t0.disabled,d),F6(X,V,L,F,y,X.stencilModeFor3D(),X.colorModeForRenderPass(),d);else{let T=X.colorModeForRenderPass();F6(X,V,L,F,y,d0.disabled,T,d)}}}(b,z,k,J,B):Z.ci(k)?function(X,V,L,F,C){if(X.renderPass!=="offscreen"&&X.renderPass!=="translucent")return;let{isRenderingToTexture:O}=C,d=X.context,y=X.style.projection.useSubdivision,T=X.getDepthModeForSublayer(0,H0.ReadOnly),E=X.colorModeForRenderPass();if(X.renderPass==="offscreen")(function(p,s,c,Z1,a,x1,i){let n=p.context,q1=n.gl;for(let V1 of c){let W1=s.getTile(V1),L1=W1.dem;if(!L1||!L1.data)continue;if(!W1.needsHillshadePrepare)continue;let{dim:Q1,stride:O1}=L1,I1=L1.getPixels();if(n.activeTexture.set(q1.TEXTURE1),n.pixelStoreUnpackPremultiplyAlpha.set(!1),W1.demTexture=W1.demTexture||p.getTileTexture(O1),W1.demTexture){let n1=W1.demTexture;n1.update(I1,{premultiply:!1}),n1.bind(q1.NEAREST,q1.CLAMP_TO_EDGE)}else W1.demTexture=new Z.T(n,I1,q1.RGBA,{premultiply:!1}),W1.demTexture.bind(q1.NEAREST,q1.CLAMP_TO_EDGE);n.activeTexture.set(q1.TEXTURE0);let D1=W1.fbo;if(!D1){let n1=new Z.T(n,{width:Q1,height:Q1,data:null},q1.RGBA);n1.bind(q1.LINEAR,q1.CLAMP_TO_EDGE),D1=W1.fbo=n.createFramebuffer(Q1,Q1,!0,!1),D1.colorAttachment.set(n1.texture)}n.bindFramebuffer.set(D1.framebuffer),n.viewport.set([0,0,Q1,Q1]),p.useProgram("hillshadePrepare").draw(n,q1.TRIANGLES,a,x1,i,$0.disabled,Wz(W1.tileID,L1),null,null,Z1.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments),W1.needsHillshadePrepare=!1}})(X,V,F,L,T,d0.disabled,E),d.viewport.set([0,0,X.width,X.height]);else if(X.renderPass==="translucent")if(y){let[p,s,c]=X.stencilConfigForOverlapTwoPass(F);E8(X,V,L,c,p,T,E,!1,O),E8(X,V,L,c,s,T,E,!0,O)}else{let[p,s]=X.getStencilConfigForOverlapAndUpdateStencilID(F);E8(X,V,L,s,p,T,E,!1,O)}}(b,z,k,J,B):Z.cj(k)?function(X,V,L,F,C){if(X.renderPass!=="translucent")return;if(!F.length)return;let{isRenderingToTexture:O}=C,d=X.style.projection.useSubdivision,y=X.getDepthModeForSublayer(0,H0.ReadOnly),T=X.colorModeForRenderPass();if(d){let[E,p,s]=X.stencilConfigForOverlapTwoPass(F);Gg(X,V,L,s,E,y,T,!1,O),Gg(X,V,L,s,p,y,T,!0,O)}else{let[E,p]=X.getStencilConfigForOverlapAndUpdateStencilID(F);Gg(X,V,L,p,E,y,T,!1,O)}}(b,z,k,J,B):Z.bK(k)?function(X,V,L,F,C){if(X.renderPass!=="translucent")return;if(L.paint.get("raster-opacity")===0)return;if(!F.length)return;let{isRenderingToTexture:O}=C,d=V.getSource(),y=X.style.projection.useSubdivision;if(d instanceof E5)U5(X,V,L,F,null,!1,!1,d.tileCoords,d.flippedWindingOrder,O);else if(y){let[T,E,p]=X.stencilConfigForOverlapTwoPass(F);U5(X,V,L,p,T,!1,!0,vw,!1,O),U5(X,V,L,p,E,!0,!0,vw,!1,O)}else{let[T,E]=X.getStencilConfigForOverlapAndUpdateStencilID(F);U5(X,V,L,E,T,!1,!0,vw,!1,O)}}(b,z,k,J,B):Z.ck(k)?function(X,V,L,F,C){let O=L.paint.get("background-color"),d=L.paint.get("background-opacity");if(d===0)return;let{isRenderingToTexture:y}=C,T=X.context,E=T.gl,p=X.style.projection,s=X.transform,c=s.tileSize,Z1=L.paint.get("background-pattern");if(X.isPatternMissing(Z1))return;let a=!Z1&&O.a===1&&d===1&&X.opaquePassEnabledForLayer()?"opaque":"translucent";if(X.renderPass!==a)return;let x1=d0.disabled,i=X.getDepthModeForSublayer(0,a==="opaque"?H0.ReadWrite:H0.ReadOnly),n=X.colorModeForRenderPass(),q1=X.useProgram(Z1?"backgroundPattern":"background"),V1=F||N1(s,{tileSize:c,terrain:X.style.map.terrain});Z1&&(T.activeTexture.set(E.TEXTURE0),X.imageManager.bind(X.context));let W1=L.getCrossfadeParameters();for(let L1 of V1){let Q1=s.getProjectionData({overscaledTileID:L1,applyGlobeMatrix:!y,applyTerrainMatrix:!0}),O1=Z1?i9(d,X,Z1,{tileID:L1,tileSize:c},W1):dz(d,O),I1=X.style.map.terrain&&X.style.map.terrain.getTerrainData(L1),D1=p.getMeshFromTileID(T,L1.canonical,!1,!0,"raster");q1.draw(T,E.TRIANGLES,i,x1,n,$0.backCCW,O1,I1,Q1,L.id,D1.vertexBuffer,D1.indexBuffer,D1.segments)}}(b,0,k,J,B):Z.cl(k)&&function(X,V,L,F){let{isRenderingGlobe:C}=F,O=X.context,d=L.implementation,y=X.style.projection,T=X.transform,E=T.getProjectionDataForCustomLayer(C),p={farZ:T.farZ,nearZ:T.nearZ,fov:T.fov*Math.PI/180,modelViewProjectionMatrix:T.modelViewProjectionMatrix,projectionMatrix:T.projectionMatrix,shaderData:{variantName:y.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${y.shaderPreludeCode.vertexSource}`,define:y.shaderDefine},defaultProjectionData:E},s=d.renderingMode?d.renderingMode:"2d";if(X.renderPass==="offscreen"){let c=d.prerender;c&&(X.setCustomLayerDefaults(),O.setColorMode(X.colorModeForRenderPass()),c.call(d,O.gl,p),O.setDirty(),X.setBaseState())}else if(X.renderPass==="translucent"){X.setCustomLayerDefaults(),O.setColorMode(X.colorModeForRenderPass()),O.setStencilMode(d0.disabled);let c=s==="3d"?X.getDepthModeFor3D():X.getDepthModeForSublayer(0,H0.ReadOnly);O.setDepthMode(c),d.render(O.gl,p),O.setDirty(),X.setBaseState(),O.bindFramebuffer.set(null)}}(b,0,k,B))}saveTileTexture(b){let z=this._tileTextures[b.size[0]];z?z.push(b):this._tileTextures[b.size[0]]=[b]}getTileTexture(b){let z=this._tileTextures[b];return z&&z.length>0?z.pop():null}isPatternMissing(b){if(!b)return!1;if(!b.from||!b.to)return!0;let z=this.imageManager.getPattern(b.from.toString()),k=this.imageManager.getPattern(b.to.toString());return!z||!k}useProgram(b,z,k=!1,J=[]){this.cache=this.cache||{};let B=!!this.style.map.terrain,X=this.style.projection,V=k?q4.projectionMercator:X.shaderPreludeCode,L=k?F8:X.shaderDefine,F=b+(z?z.cacheKey:"")+`/${k?Hz:X.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(B?"/terrain":"")+(J?`/${J.join("/")}`:"");return this.cache[F]||(this.cache[F]=new Mz(this.context,q4[b],z,tb[b],this._showOverdrawInspector,B,V,L,J)),this.cache[F]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let b=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(b.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Z.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:b,drawingBufferHeight:z}=this.context.gl;return this.width!==b||this.height!==z}}function Mg(b,z){let k,J=!1,B=null,X=null,V=()=>{B=null,J&&(b.apply(X,k),B=setTimeout(V,z),J=!1)};return(...L)=>(J=!0,X=this,k=L,B||V(),B)}class d4{constructor(b){this._getCurrentHash=()=>{let z=window.location.hash.replace("#","");if(this._hashName){let k;return z.split("&").map((J)=>J.split("=")).forEach((J)=>{J[0]===this._hashName&&(k=J)}),(k&&k[1]||"").split("/")}return z.split("/")},this._onHashChange=()=>{let z=this._getCurrentHash();if(!this._isValidHash(z))return!1;let k=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(z[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+z[2],+z[1]],zoom:+z[0],bearing:k,pitch:+(z[4]||0)}),!0},this._updateHashUnthrottled=()=>{let z=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,z)},this._removeHash=()=>{let z=this._getCurrentHash();if(z.length===0)return;let k=z.join("/"),J=k;J.split("&").length>0&&(J=J.split("&")[0]),this._hashName&&(J=`${this._hashName}=${k}`);let B=window.location.hash.replace(J,"");B.startsWith("#&")?B=B.slice(0,1)+B.slice(2):B==="#"&&(B="");let X=window.location.href.replace(/(#.+)?$/,B);X=X.replace("&&","&"),window.history.replaceState(window.history.state,null,X)},this._updateHash=Mg(this._updateHashUnthrottled,300),this._hashName=b&&encodeURIComponent(b)}addTo(b){return this._map=b,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(b){let z=this._map.getCenter(),k=Math.round(100*this._map.getZoom())/100,J=Math.ceil((k*Math.LN2+Math.log(2.8444444444444446))/Math.LN10),B=Math.pow(10,J),X=Math.round(z.lng*B)/B,V=Math.round(z.lat*B)/B,L=this._map.getBearing(),F=this._map.getPitch(),C="";if(C+=b?`/${X}/${V}/${k}`:`${k}/${V}/${X}`,(L||F)&&(C+="/"+Math.round(10*L)/10),F&&(C+=`/${Math.round(F)}`),this._hashName){let O=this._hashName,d=!1,y=window.location.hash.slice(1).split("&").map((T)=>{let E=T.split("=")[0];return E===O?(d=!0,`${E}=${C}`):T}).filter((T)=>T);return d||y.push(`${O}=${C}`),`#${y.join("&")}`}return`#${C}`}_isValidHash(b){if(b.length<3||b.some(isNaN))return!1;try{new Z.S(+b[2],+b[1])}catch(B){return!1}let z=+b[0],k=+(b[3]||0),J=+(b[4]||0);return z>=this._map.getMinZoom()&&z<=this._map.getMaxZoom()&&k>=-180&&k<=180&&J>=this._map.getMinPitch()&&J<=this._map.getMaxPitch()}}let D6={linearity:0.3,easing:Z.cm(0,0,0.3,1)},uz=Z.e({deceleration:2500,maxSpeed:1400},D6),pz=Z.e({deceleration:20,maxSpeed:1400},D6),cz=Z.e({deceleration:1000,maxSpeed:360},D6),az=Z.e({deceleration:1000,maxSpeed:90},D6),rz=Z.e({deceleration:1000,maxSpeed:360},D6);class Xg{constructor(b){this._map=b,this.clear()}clear(){this._inertiaBuffer=[]}record(b){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:z1(),settings:b})}_drainInertiaBuffer(){let b=this._inertiaBuffer,z=z1();for(;b.length>0&&z-b[0].time>160;)b.shift()}_onMoveEnd(b){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let z={zoom:0,bearing:0,pitch:0,roll:0,pan:new Z.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:B}of this._inertiaBuffer)z.zoom+=B.zoomDelta||0,z.bearing+=B.bearingDelta||0,z.pitch+=B.pitchDelta||0,z.roll+=B.rollDelta||0,B.panDelta&&z.pan._add(B.panDelta),B.around&&(z.around=B.around),B.pinchAround&&(z.pinchAround=B.pinchAround);let k=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,J={};if(z.pan.mag()){let B=t4(z.pan.mag(),k,Z.e({},uz,b||{})),X=z.pan.mult(B.amount/z.pan.mag()),V=this._map.cameraHelper.handlePanInertia(X,this._map.transform);J.center=V.easingCenter,J.offset=V.easingOffset,d6(J,B)}if(z.zoom){let B=t4(z.zoom,k,pz);J.zoom=this._map.transform.zoom+B.amount,d6(J,B)}if(z.bearing){let B=t4(z.bearing,k,cz);J.bearing=this._map.transform.bearing+Z.ae(B.amount,-179,179),d6(J,B)}if(z.pitch){let B=t4(z.pitch,k,az);J.pitch=this._map.transform.pitch+B.amount,d6(J,B)}if(z.roll){let B=t4(z.roll,k,rz);J.roll=this._map.transform.roll+Z.ae(B.amount,-179,179),d6(J,B)}if(J.zoom||J.bearing){let B=z.pinchAround===void 0?z.around:z.pinchAround;J.around=B?this._map.unproject(B):this._map.getCenter()}return this.clear(),Z.e(J,{noMoveStart:!0})}}function d6(b,z){(!b.duration||b.duration<z.duration)&&(b.duration=z.duration,b.easing=z.easing)}function t4(b,z,k){let{maxSpeed:J,linearity:B,deceleration:X}=k,V=Z.ae(b*B/(z/1000),-J,J),L=Math.abs(V)/(X*B);return{easing:k.easing,duration:1000*L,amount:V*(L/2)}}class _2 extends Z.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(b,z,k,J={}){k=k instanceof MouseEvent?k:new MouseEvent(b,k);let B=u.mousePos(z.getCanvas(),k),X=z.unproject(B);super(b,Z.e({point:B,lngLat:X,originalEvent:k},J)),this._defaultPrevented=!1,this.target=z}}class L2 extends Z.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(b,z,k){let J=b==="touchend"?k.changedTouches:k.touches,B=u.touchPos(z.getCanvasContainer(),J),X=B.map((L)=>z.unproject(L)),V=B.reduce((L,F,C,O)=>L.add(F.div(O.length)),new Z.P(0,0));super(b,{points:B,point:V,lngLats:X,lngLat:z.unproject(V),originalEvent:k}),this._defaultPrevented=!1}}class J3 extends Z.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(b,z,k){super(b,{originalEvent:k}),this._defaultPrevented=!1}}class Qg{constructor(b,z){this._map=b,this._clickTolerance=z.clickTolerance}reset(){delete this._mousedownPos}wheel(b){return this._firePreventable(new J3(b.type,this._map,b))}mousedown(b,z){return this._mousedownPos=z,this._firePreventable(new _2(b.type,this._map,b))}mouseup(b){this._map.fire(new _2(b.type,this._map,b))}click(b,z){this._mousedownPos&&this._mousedownPos.dist(z)>=this._clickTolerance||this._map.fire(new _2(b.type,this._map,b))}dblclick(b){return this._firePreventable(new _2(b.type,this._map,b))}mouseover(b){this._map.fire(new _2(b.type,this._map,b))}mouseout(b){this._map.fire(new _2(b.type,this._map,b))}touchstart(b){return this._firePreventable(new L2(b.type,this._map,b))}touchmove(b){this._map.fire(new L2(b.type,this._map,b))}touchend(b){this._map.fire(new L2(b.type,this._map,b))}touchcancel(b){this._map.fire(new L2(b.type,this._map,b))}_firePreventable(b){if(this._map.fire(b),b.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class F3{constructor(b){this._map=b}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(b){this._map.fire(new _2(b.type,this._map,b))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new _2("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(b){this._delayContextMenu?this._contextMenuEvent=b:this._ignoreContextMenu||this._map.fire(new _2(b.type,this._map,b)),this._map.listens("contextmenu")&&b.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class P3{constructor(b){this._map=b}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(b){return this.transform.screenPointToLocation(Z.P.convert(b),this._map.terrain)}}class Vg{constructor(b,z){this._map=b,this._tr=new P3(b),this._el=b.getCanvasContainer(),this._container=b.getContainer(),this._clickTolerance=z.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(b,z){this.isEnabled()&&b.shiftKey&&b.button===0&&(u.disableDrag(),this._startPos=this._lastPos=z,this._active=!0)}mousemoveWindow(b,z){if(!this._active)return;let k=z;if(this._lastPos.equals(k)||!this._box&&k.dist(this._startPos)<this._clickTolerance)return;let J=this._startPos;this._lastPos=k,this._box||(this._box=u.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",b));let B=Math.min(J.x,k.x),X=Math.max(J.x,k.x),V=Math.min(J.y,k.y),L=Math.max(J.y,k.y);u.setTransform(this._box,`translate(${B}px,${V}px)`),this._box.style.width=X-B+"px",this._box.style.height=L-V+"px"}mouseupWindow(b,z){if(!this._active)return;if(b.button!==0)return;let k=this._startPos,J=z;if(this.reset(),u.suppressClick(),k.x!==J.x||k.y!==J.y)return this._map.fire(new Z.l("boxzoomend",{originalEvent:b})),{cameraAnimation:(B)=>B.fitScreenCoordinates(k,J,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",b)}keydown(b){this._active&&b.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",b))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(u.remove(this._box),this._box=null),u.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(b,z){return this._map.fire(new Z.l(b,{originalEvent:z}))}}function Lg(b,z){if(b.length!==z.length)throw Error(`The number of touches and points are not equal - touches ${b.length}, points ${z.length}`);let k={};for(let J=0;J<b.length;J++)k[b[J].identifier]=z[J];return k}class oz{constructor(b){this.reset(),this.numTouches=b.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(b,z,k){(this.centroid||k.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=b.timeStamp),k.length===this.numTouches&&(this.centroid=function(J){let B=new Z.P(0,0);for(let X of J)B._add(X);return B.div(J.length)}(z),this.touches=Lg(k,z)))}touchmove(b,z,k){if(this.aborted||!this.centroid)return;let J=Lg(k,z);for(let B in this.touches){let X=J[B];(!X||X.dist(this.touches[B])>30)&&(this.aborted=!0)}}touchend(b,z,k){if((!this.centroid||b.timeStamp-this.startTime>500)&&(this.aborted=!0),k.length===0){let J=!this.aborted&&this.centroid;if(this.reset(),J)return J}}}class Hw{constructor(b){this.singleTap=new oz(b),this.numTaps=b.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(b,z,k){this.singleTap.touchstart(b,z,k)}touchmove(b,z,k){this.singleTap.touchmove(b,z,k)}touchend(b,z,k){let J=this.singleTap.touchend(b,z,k);if(J){let B=b.timeStamp-this.lastTime<500,X=!this.lastTap||this.lastTap.dist(J)<30;if(B&&X||this.reset(),this.count++,this.lastTime=b.timeStamp,this.lastTap=J,this.count===this.numTaps)return this.reset(),J}}}class Wg{constructor(b){this._tr=new P3(b),this._zoomIn=new Hw({numTouches:1,numTaps:2}),this._zoomOut=new Hw({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(b,z,k){this._zoomIn.touchstart(b,z,k),this._zoomOut.touchstart(b,z,k)}touchmove(b,z,k){this._zoomIn.touchmove(b,z,k),this._zoomOut.touchmove(b,z,k)}touchend(b,z,k){let J=this._zoomIn.touchend(b,z,k),B=this._zoomOut.touchend(b,z,k),X=this._tr;return J?(this._active=!0,b.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:(V)=>V.easeTo({duration:300,zoom:X.zoom+1,around:X.unproject(J)},{originalEvent:b})}):B?(this._active=!0,b.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:(V)=>V.easeTo({duration:300,zoom:X.zoom-1,around:X.unproject(B)},{originalEvent:b})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class k4{constructor(b){this._enabled=!!b.enable,this._moveStateManager=b.moveStateManager,this._clickTolerance=b.clickTolerance||1,this._moveFunction=b.move,this._activateOnStart=!!b.activateOnStart,b.assignEvents(this),this.reset()}reset(b){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(b)}_move(...b){let z=this._moveFunction(...b);if(z.bearingDelta||z.pitchDelta||z.rollDelta||z.around||z.panDelta)return this._active=!0,z}dragStart(b,z){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(b)&&(this._moveStateManager.startMove(b),this._lastPoint=Array.isArray(z)?z[0]:z,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(b,z){if(!this.isEnabled())return;let k=this._lastPoint;if(!k)return;if(b.preventDefault(),!this._moveStateManager.isValidMoveEvent(b))return void this.reset(b);let J=Array.isArray(z)?z[0]:z;return!this._moved&&J.dist(k)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=J,this._move(k,J))}dragEnd(b){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(b)&&(this._moved&&u.suppressClick(),this.reset(b))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}let O4=0,o1=2,nz={[O4]:1,[o1]:2};class e4{constructor(b){this._correctEvent=b.checkCorrectEvent}startMove(b){let z=u.mouseButton(b);this._eventButton=z}endMove(b){delete this._eventButton}isValidStartEvent(b){return this._correctEvent(b)}isValidMoveEvent(b){return!function(z,k){let J=nz[k];return z.buttons===void 0||(z.buttons&J)!==J}(b,this._eventButton)}isValidEndEvent(b){return u.mouseButton(b)===this._eventButton}}class hg{constructor(){this._firstTouch=void 0}_isOneFingerTouch(b){return b.targetTouches.length===1}_isSameTouchEvent(b){return b.targetTouches[0].identifier===this._firstTouch}startMove(b){this._firstTouch=b.targetTouches[0].identifier}endMove(b){delete this._firstTouch}isValidStartEvent(b){return this._isOneFingerTouch(b)}isValidMoveEvent(b){return this._isOneFingerTouch(b)&&this._isSameTouchEvent(b)}isValidEndEvent(b){return this._isOneFingerTouch(b)&&this._isSameTouchEvent(b)}}class O6{constructor(b=new e4({checkCorrectEvent:()=>!0}),z=new hg){this.mouseMoveStateManager=b,this.oneFingerTouchMoveStateManager=z}_executeRelevantHandler(b,z,k){return b instanceof MouseEvent?z(b):typeof TouchEvent<"u"&&b instanceof TouchEvent?k(b):void 0}startMove(b){this._executeRelevantHandler(b,(z)=>this.mouseMoveStateManager.startMove(z),(z)=>this.oneFingerTouchMoveStateManager.startMove(z))}endMove(b){this._executeRelevantHandler(b,(z)=>this.mouseMoveStateManager.endMove(z),(z)=>this.oneFingerTouchMoveStateManager.endMove(z))}isValidStartEvent(b){return this._executeRelevantHandler(b,(z)=>this.mouseMoveStateManager.isValidStartEvent(z),(z)=>this.oneFingerTouchMoveStateManager.isValidStartEvent(z))}isValidMoveEvent(b){return this._executeRelevantHandler(b,(z)=>this.mouseMoveStateManager.isValidMoveEvent(z),(z)=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(z))}isValidEndEvent(b){return this._executeRelevantHandler(b,(z)=>this.mouseMoveStateManager.isValidEndEvent(z),(z)=>this.oneFingerTouchMoveStateManager.isValidEndEvent(z))}}let w7=(b)=>{b.mousedown=b.dragStart,b.mousemoveWindow=b.dragMove,b.mouseup=b.dragEnd,b.contextmenu=(z)=>{z.preventDefault()}};class u8{constructor(b,z){this._clickTolerance=b.clickTolerance||1,this._map=z,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new Z.P(0,0)}_shouldBePrevented(b){return b<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(b,z,k){return this._calculateTransform(b,z,k)}touchmove(b,z,k){if(this._active){if(!this._shouldBePrevented(k.length))return b.preventDefault(),this._calculateTransform(b,z,k);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",b)}}touchend(b,z,k){this._calculateTransform(b,z,k),this._active&&this._shouldBePrevented(k.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(b,z,k){k.length>0&&(this._active=!0);let J=Lg(k,z),B=new Z.P(0,0),X=new Z.P(0,0),V=0;for(let F in J){let C=J[F],O=this._touches[F];O&&(B._add(C),X._add(C.sub(O)),V++,J[F]=C)}if(this._touches=J,this._shouldBePrevented(V)||!X.mag())return;let L=X.div(V);return this._sum._add(L),this._sum.mag()<this._clickTolerance?void 0:{around:B.div(V),panDelta:L}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class O0{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(b,z,k){this._firstTwoTouches||k.length<2||(this._firstTwoTouches=[k[0].identifier,k[1].identifier],this._start([z[0],z[1]]))}touchmove(b,z,k){if(!this._firstTwoTouches)return;b.preventDefault();let[J,B]=this._firstTwoTouches,X=y6(k,z,J),V=y6(k,z,B);if(!X||!V)return;let L=this._aroundCenter?null:X.add(V).div(2);return this._move([X,V],L,b)}touchend(b,z,k){if(!this._firstTwoTouches)return;let[J,B]=this._firstTwoTouches,X=y6(k,z,J),V=y6(k,z,B);X&&V||(this._active&&u.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(b){this._enabled=!0,this._aroundCenter=!!b&&b.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function y6(b,z,k){for(let J=0;J<b.length;J++)if(b[J].identifier===k)return z[J]}function sz(b,z){return Math.log(b/z)/Math.LN2}class p8 extends O0{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(b){this._startDistance=this._distance=b[0].dist(b[1])}_move(b,z){let k=this._distance;if(this._distance=b[0].dist(b[1]),this._active||!(Math.abs(sz(this._distance,this._startDistance))<0.1))return this._active=!0,{zoomDelta:sz(this._distance,k),pinchAround:z}}}function iz(b,z){return 180*b.angleWith(z)/Math.PI}class Fg extends O0{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(b){this._startVector=this._vector=b[0].sub(b[1]),this._minDiameter=b[0].dist(b[1])}_move(b,z,k){let J=this._vector;if(this._vector=b[0].sub(b[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:iz(this._vector,J),pinchAround:z}}_isBelowThreshold(b){this._minDiameter=Math.min(this._minDiameter,b.mag());let z=25/(Math.PI*this._minDiameter)*360,k=iz(b,this._startVector);return Math.abs(k)<z}}function Uw(b){return Math.abs(b.y)>Math.abs(b.x)}class c8 extends O0{constructor(b){super(),this._currentTouchCount=0,this._map=b}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(b,z,k){super.touchstart(b,z,k),this._currentTouchCount=k.length}_start(b){this._lastPoints=b,Uw(b[0].sub(b[1]))&&(this._valid=!1)}_move(b,z,k){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let J=b[0].sub(this._lastPoints[0]),B=b[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(J,B,k.timeStamp),this._valid?(this._lastPoints=b,this._active=!0,{pitchDelta:(J.y+B.y)/2*-0.5}):void 0}gestureBeginsVertically(b,z,k){if(this._valid!==void 0)return this._valid;let J=b.mag()>=2,B=z.mag()>=2;if(!J&&!B)return;if(!J||!B)return this._firstMove===void 0&&(this._firstMove=k),k-this._firstMove<100&&void 0;let X=b.y>0==z.y>0;return Uw(b)&&Uw(z)&&X}}let tz={panStep:100,bearingStep:15,pitchStep:10};class Kg{constructor(b){this._tr=new P3(b);let z=tz;this._panStep=z.panStep,this._bearingStep=z.bearingStep,this._pitchStep=z.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(b){if(b.altKey||b.ctrlKey||b.metaKey)return;let z=0,k=0,J=0,B=0,X=0;switch(b.keyCode){case 61:case 107:case 171:case 187:z=1;break;case 189:case 109:case 173:z=-1;break;case 37:b.shiftKey?k=-1:(b.preventDefault(),B=-1);break;case 39:b.shiftKey?k=1:(b.preventDefault(),B=1);break;case 38:b.shiftKey?J=1:(b.preventDefault(),X=-1);break;case 40:b.shiftKey?J=-1:(b.preventDefault(),X=1);break;default:return}return this._rotationDisabled&&(k=0,J=0),{cameraAnimation:(V)=>{let L=this._tr;V.easeTo({duration:300,easeId:"keyboardHandler",easing:ez,zoom:z?Math.round(L.zoom)+z*(b.shiftKey?2:1):L.zoom,bearing:L.bearing+k*this._bearingStep,pitch:L.pitch+J*this._pitchStep,offset:[-B*this._panStep,-X*this._panStep],center:L.center},{originalEvent:b})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ez(b){return b*(2-b)}let wx=4.000244140625,dZ=0.0022222222222222222;class v4{constructor(b,z){this._onTimeout=(k)=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(k)},this._map=b,this._tr=new P3(b),this._triggerRenderFrame=z,this._delta=0,this._defaultZoomRate=0.01,this._wheelZoomRate=dZ}setZoomRate(b){this._defaultZoomRate=b}setWheelZoomRate(b){this._wheelZoomRate=b}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(b){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!b&&b.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(b){return!!this._map.cooperativeGestures.isEnabled()&&!(b.ctrlKey||this._map.cooperativeGestures.isBypassed(b))}wheel(b){if(!this.isEnabled())return;if(this._shouldBePrevented(b))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",b);let z=b.deltaMode===WheelEvent.DOM_DELTA_LINE?40*b.deltaY:b.deltaY,k=z1(),J=k-(this._lastWheelEventTime||0);this._lastWheelEventTime=k,z!==0&&z%wx==0?this._type="wheel":z!==0&&Math.abs(z)<4?this._type="trackpad":J>400?(this._type=null,this._lastValue=z,this._timeout=setTimeout(this._onTimeout,40,b)):this._type||(this._type=Math.abs(J*z)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,z+=this._lastValue)),b.shiftKey&&z&&(z/=4),this._type&&(this._lastWheelEvent=b,this._delta-=z,this._active||this._start(b)),b.preventDefault()}_start(b){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let z=u.mousePos(this._map.getCanvas(),b),k=this._tr;this._aroundPoint=this._aroundCenter?k.transform.locationToScreenPoint(Z.S.convert(k.center)):z,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;let b=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){let V=b.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=V),typeof this._targetZoom=="number"&&(this._targetZoom+=V)}if(this._delta!==0){let V=this._type==="wheel"&&Math.abs(this._delta)>wx?this._wheelZoomRate:this._defaultZoomRate,L=2/(1+Math.exp(-Math.abs(this._delta*V)));this._delta<0&&L!==0&&(L=1/L);let F=typeof this._targetZoom!="number"?b.scale:Z.ah(this._targetZoom);this._targetZoom=b.constrain(b.getCameraLngLat(),Z.ak(F*L)).zoom,this._type==="wheel"&&(this._startZoom=b.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let z=typeof this._targetZoom!="number"?b.zoom:this._targetZoom,k=this._startZoom,J=this._easing,B,X=!1;if(this._type==="wheel"&&k&&J){let V=z1()-this._lastWheelEventTime,L=Math.min((V+5)/200,1),F=J(L);B=Z.C.number(k,z,F),L<1?this._frameId||(this._frameId=!0):X=!0}else B=z,X=!0;return this._active=!0,X&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=B,{noInertia:!0,needsRenderFrame:!X,zoomDelta:B-b.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(b){let z=Z.co;if(this._prevEase){let k=this._prevEase,J=(z1()-k.start)/k.duration,B=k.easing(J+0.01)-k.easing(J),X=0.27/Math.sqrt(B*B+0.0001)*0.01,V=Math.sqrt(0.0729-X*X);z=Z.cm(X,V,0.25,1)}return this._prevEase={start:z1(),duration:b,easing:z},z}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class n0{constructor(b,z){this._clickZoom=b,this._tapZoom=z}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class bx{constructor(b){this._tr=new P3(b),this.reset()}reset(){this._active=!1}dblclick(b,z){return b.preventDefault(),{cameraAnimation:(k)=>{k.easeTo({duration:300,zoom:this._tr.zoom+(b.shiftKey?-1:1),around:this._tr.unproject(z)},{originalEvent:b})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class R6{constructor(){this._tap=new Hw({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(b,z,k){if(!this._swipePoint)if(this._tapTime){let J=z[0],B=b.timeStamp-this._tapTime<500,X=this._tapPoint.dist(J)<30;B&&X?k.length>0&&(this._swipePoint=J,this._swipeTouch=k[0].identifier):this.reset()}else this._tap.touchstart(b,z,k)}touchmove(b,z,k){if(this._tapTime){if(this._swipePoint){if(k[0].identifier!==this._swipeTouch)return;let J=z[0],B=J.y-this._swipePoint.y;return this._swipePoint=J,b.preventDefault(),this._active=!0,{zoomDelta:B/128}}}else this._tap.touchmove(b,z,k)}touchend(b,z,k){if(this._tapTime)this._swipePoint&&k.length===0&&this.reset();else{let J=this._tap.touchend(b,z,k);J&&(this._tapTime=b.timeStamp,this._tapPoint=J)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class N6{constructor(b,z,k){this._el=b,this._mousePan=z,this._touchPan=k}enable(b){this._inertiaOptions=b||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class a8{constructor(b,z,k,J){this._pitchWithRotate=b.pitchWithRotate,this._rollEnabled=b.rollEnabled,this._mouseRotate=z,this._mousePitch=k,this._mouseRoll=J}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class r8{constructor(b,z,k,J){this._el=b,this._touchZoom=z,this._touchRotate=k,this._tapDragZoom=J,this._rotationDisabled=!1,this._enabled=!0}enable(b){this._touchZoom.enable(b),this._rotationDisabled||this._touchRotate.enable(b),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class o8{constructor(b,z){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=b,this._options=z,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let b=this._map.getCanvasContainer();b.classList.add("maplibregl-cooperative-gestures"),this._container=u.create("div","maplibregl-cooperative-gesture-screen",b);let z=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(z=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));let k=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),J=document.createElement("div");J.className="maplibregl-desktop-message",J.textContent=z,this._container.appendChild(J);let B=document.createElement("div");B.className="maplibregl-mobile-message",B.textContent=k,this._container.appendChild(B),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(u.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(b){return b[this._bypassKey]}notifyGestureBlocked(b,z){this._enabled&&(this._map.fire(new Z.l("cooperativegestureprevented",{gestureType:b,originalEvent:z})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}let n8=(b)=>b.zoom||b.drag||b.roll||b.pitch||b.rotate;class K3 extends Z.l{}function O7(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta||b.rollDelta}class e1{constructor(b,z){this.handleWindowEvent=(J)=>{this.handleEvent(J,`${J.type}Window`)},this.handleEvent=(J,B)=>{if(J.type==="blur")return void this.stop(!0);this._updatingCamera=!0;let X=J.type==="renderFrame"?void 0:J,V={needsRenderFrame:!1},L={},F={};for(let{handlerName:d,handler:y,allowed:T}of this._handlers){if(!y.isEnabled())continue;let E;if(this._blockedByActive(F,T,d))y.reset();else if(y[B||J.type]){if(Z.cp(J,B||J.type)){let p=u.mousePos(this._map.getCanvas(),J);E=y[B||J.type](J,p)}else if(Z.cq(J,B||J.type)){let p=this._getMapTouches(J.touches),s=u.touchPos(this._map.getCanvas(),p);E=y[B||J.type](J,s,p)}else Z.cr(B||J.type)||(E=y[B||J.type](J));this.mergeHandlerResult(V,L,E,d,X),E&&E.needsRenderFrame&&this._triggerRenderFrame()}(E||y.isActive())&&(F[d]=y)}let C={};for(let d in this._previousActiveHandlers)F[d]||(C[d]=X);this._previousActiveHandlers=F,(Object.keys(C).length||O7(V))&&(this._changes.push([V,L,C]),this._triggerRenderFrame()),(Object.keys(F).length||O7(V))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:O}=V;O&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],O(this._map))},this._map=b,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Xg(b),this._bearingSnap=z.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(z);let k=this._el;this._listeners=[[k,"touchstart",{passive:!0}],[k,"touchmove",{passive:!1}],[k,"touchend",void 0],[k,"touchcancel",void 0],[k,"mousedown",void 0],[k,"mousemove",void 0],[k,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[k,"mouseover",void 0],[k,"mouseout",void 0],[k,"dblclick",void 0],[k,"click",void 0],[k,"keydown",{capture:!1}],[k,"keyup",void 0],[k,"wheel",{passive:!1}],[k,"contextmenu",void 0],[window,"blur",void 0]];for(let[J,B,X]of this._listeners)u.addEventListener(J,B,J===document?this.handleWindowEvent:this.handleEvent,X)}destroy(){for(let[b,z,k]of this._listeners)u.removeEventListener(b,z,b===document?this.handleWindowEvent:this.handleEvent,k)}_addDefaultHandlers(b){let z=this._map,k=z.getCanvasContainer();this._add("mapEvent",new Qg(z,b));let J=z.boxZoom=new Vg(z,b);this._add("boxZoom",J),b.interactive&&b.boxZoom&&J.enable();let B=z.cooperativeGestures=new o8(z,b.cooperativeGestures);this._add("cooperativeGestures",B),b.cooperativeGestures&&B.enable();let X=new Wg(z),V=new bx(z);z.doubleClickZoom=new n0(V,X),this._add("tapZoom",X),this._add("clickZoom",V),b.interactive&&b.doubleClickZoom&&z.doubleClickZoom.enable();let L=new R6;this._add("tapDragZoom",L);let F=z.touchPitch=new c8(z);this._add("touchPitch",F),b.interactive&&b.touchPitch&&z.touchPitch.enable(b.touchPitch);let C=()=>z.project(z.getCenter()),O=function({enable:a,clickTolerance:x1,aroundCenter:i=!0,minPixelCenterThreshold:n=100,rotateDegreesPerPixelMoved:q1=0.8},V1){let W1=new e4({checkCorrectEvent:(L1)=>u.mouseButton(L1)===0&&L1.ctrlKey||u.mouseButton(L1)===2&&!L1.ctrlKey});return new k4({clickTolerance:x1,move:(L1,Q1)=>{let O1=V1();if(i&&Math.abs(O1.y-L1.y)>n)return{bearingDelta:Z.cn(new Z.P(L1.x,Q1.y),Q1,O1)};let I1=(Q1.x-L1.x)*q1;return i&&Q1.y<O1.y&&(I1=-I1),{bearingDelta:I1}},moveStateManager:W1,enable:a,assignEvents:w7})}(b,C),d=function({enable:a,clickTolerance:x1,pitchDegreesPerPixelMoved:i=-0.5}){let n=new e4({checkCorrectEvent:(q1)=>u.mouseButton(q1)===0&&q1.ctrlKey||u.mouseButton(q1)===2});return new k4({clickTolerance:x1,move:(q1,V1)=>({pitchDelta:(V1.y-q1.y)*i}),moveStateManager:n,enable:a,assignEvents:w7})}(b),y=function({enable:a,clickTolerance:x1,rollDegreesPerPixelMoved:i=0.3},n){let q1=new e4({checkCorrectEvent:(V1)=>u.mouseButton(V1)===2&&V1.ctrlKey});return new k4({clickTolerance:x1,move:(V1,W1)=>{let L1=n(),Q1=(W1.x-V1.x)*i;return W1.y<L1.y&&(Q1=-Q1),{rollDelta:Q1}},moveStateManager:q1,enable:a,assignEvents:w7})}(b,C);z.dragRotate=new a8(b,O,d,y),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",d,["mouseRotate","mouseRoll"]),this._add("mouseRoll",y,["mousePitch"]),b.interactive&&b.dragRotate&&z.dragRotate.enable();let T=function({enable:a,clickTolerance:x1}){let i=new e4({checkCorrectEvent:(n)=>u.mouseButton(n)===0&&!n.ctrlKey});return new k4({clickTolerance:x1,move:(n,q1)=>({around:q1,panDelta:q1.sub(n)}),activateOnStart:!0,moveStateManager:i,enable:a,assignEvents:w7})}(b),E=new u8(b,z);z.dragPan=new N6(k,T,E),this._add("mousePan",T),this._add("touchPan",E,["touchZoom","touchRotate"]),b.interactive&&b.dragPan&&z.dragPan.enable(b.dragPan);let p=new Fg,s=new p8;z.touchZoomRotate=new r8(k,s,p,L),this._add("touchRotate",p,["touchPan","touchZoom"]),this._add("touchZoom",s,["touchPan","touchRotate"]),b.interactive&&b.touchZoomRotate&&z.touchZoomRotate.enable(b.touchZoomRotate),this._add("blockableMapEvent",new F3(z));let c=z.scrollZoom=new v4(z,()=>this._triggerRenderFrame());this._add("scrollZoom",c,["mousePan"]),b.interactive&&b.scrollZoom&&z.scrollZoom.enable(b.scrollZoom);let Z1=z.keyboard=new Kg(z);this._add("keyboard",Z1),b.interactive&&b.keyboard&&z.keyboard.enable()}_add(b,z,k){this._handlers.push({handlerName:b,handler:z,allowed:k}),this._handlersById[b]=z}stop(b){if(!this._updatingCamera){for(let{handler:z}of this._handlers)z.reset();this._inertia.clear(),this._fireEvents({},{},b),this._changes=[]}}isActive(){for(let{handler:b}of this._handlers)if(b.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(n8(this._eventsInProgress))||this.isZooming()}_blockedByActive(b,z,k){for(let J in b)if(J!==k&&(!z||z.indexOf(J)<0))return!0;return!1}_getMapTouches(b){let z=[];for(let k of b)this._el.contains(k.target)&&z.push(k);return z}mergeHandlerResult(b,z,k,J,B){if(!k)return;Z.e(b,k);let X={handlerName:J,originalEvent:k.originalEvent||B};k.zoomDelta!==void 0&&(z.zoom=X),k.panDelta!==void 0&&(z.drag=X),k.rollDelta!==void 0&&(z.roll=X),k.pitchDelta!==void 0&&(z.pitch=X),k.bearingDelta!==void 0&&(z.rotate=X)}_applyChanges(){let b={},z={},k={};for(let[J,B,X]of this._changes)J.panDelta&&(b.panDelta=(b.panDelta||new Z.P(0,0))._add(J.panDelta)),J.zoomDelta&&(b.zoomDelta=(b.zoomDelta||0)+J.zoomDelta),J.bearingDelta&&(b.bearingDelta=(b.bearingDelta||0)+J.bearingDelta),J.pitchDelta&&(b.pitchDelta=(b.pitchDelta||0)+J.pitchDelta),J.rollDelta&&(b.rollDelta=(b.rollDelta||0)+J.rollDelta),J.around!==void 0&&(b.around=J.around),J.pinchAround!==void 0&&(b.pinchAround=J.pinchAround),J.noInertia&&(b.noInertia=J.noInertia),Z.e(z,B),Z.e(k,X);this._updateMapTransform(b,z,k),this._changes=[]}_updateMapTransform(b,z,k){let J=this._map,B=J._getTransformForUpdate(),X=J.terrain;if(!(O7(b)||X&&this._terrainMovement))return this._fireEvents(z,k,!0);J._stop(!0);let{panDelta:V,zoomDelta:L,bearingDelta:F,pitchDelta:C,rollDelta:O,around:d,pinchAround:y}=b;y!==void 0&&(d=y),d=d||J.transform.centerPoint,X&&!B.isPointOnMapSurface(d)&&(d=B.centerPoint);let T={panDelta:V,zoomDelta:L,rollDelta:O,pitchDelta:C,bearingDelta:F,around:d};this._map.cameraHelper.useGlobeControls&&!B.isPointOnMapSurface(d)&&(d=B.centerPoint);let E=d.distSqr(B.centerPoint)<0.01?B.center:B.screenPointToLocation(V?d.sub(V):d);this._handleMapControls({terrain:X,tr:B,deltasForHelper:T,preZoomAroundLoc:E,combinedEventsInProgress:z,panDelta:V}),J._applyUpdatedTransform(B),this._map._update(),b.noInertia||this._inertia.record(b),this._fireEvents(z,k,!0)}_handleMapControls({terrain:b,tr:z,deltasForHelper:k,preZoomAroundLoc:J,combinedEventsInProgress:B,panDelta:X}){let V=this._map.cameraHelper;if(V.handleMapControlsRollPitchBearingZoom(k,z),b)return V.useGlobeControls?(this._terrainMovement||!B.drag&&!B.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void V.handleMapControlsPan(k,z,J)):this._terrainMovement||!B.drag&&!B.zoom?void(B.drag&&this._terrainMovement&&X?z.setCenter(z.screenPointToLocation(z.centerPoint.sub(X))):V.handleMapControlsPan(k,z,J)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void V.handleMapControlsPan(k,z,J));V.handleMapControlsPan(k,z,J)}_fireEvents(b,z,k){let J=n8(this._eventsInProgress),B=n8(b),X={};for(let O in b){let{originalEvent:d}=b[O];this._eventsInProgress[O]||(X[`${O}start`]=d),this._eventsInProgress[O]=b[O]}!J&&B&&this._fireEvent("movestart",B.originalEvent);for(let O in X)this._fireEvent(O,X[O]);B&&this._fireEvent("move",B.originalEvent);for(let O in b){let{originalEvent:d}=b[O];this._fireEvent(O,d)}let V={},L;for(let O in this._eventsInProgress){let{handlerName:d,originalEvent:y}=this._eventsInProgress[O];this._handlersById[d].isActive()||(delete this._eventsInProgress[O],L=z[d]||y,V[`${O}end`]=L)}for(let O in V)this._fireEvent(O,V[O]);let F=n8(this._eventsInProgress),C=(J||B)&&!F;if(C&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;let O=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&O.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(O)}if(k&&C){this._updatingCamera=!0;let O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),d=(y)=>y!==0&&-this._bearingSnap<y&&y<this._bearingSnap;!O||!O.essential&&H1.prefersReducedMotion?(this._map.fire(new Z.l("moveend",{originalEvent:L})),d(this._map.getBearing())&&this._map.resetNorth()):(d(O.bearing||this._map.getBearing())&&(O.bearing=0),O.freezeElevation=!0,this._map.easeTo(O,{originalEvent:L})),this._updatingCamera=!1}}_fireEvent(b,z){this._map.fire(new Z.l(b,z?{originalEvent:z}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((b)=>{delete this._frameId,this.handleEvent(new K3("renderFrame",{timeStamp:b})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Y0 extends Z.E{constructor(b,z,k){super(),this._renderFrameCallback=()=>{let J=Math.min((z1()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(J)),J<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=b,this._bearingSnap=k.bearingSnap,this.cameraHelper=z,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(b,z){b.apply(this.transform),this.transform=b,this.cameraHelper=z}getCenter(){return new Z.S(this.transform.center.lng,this.transform.center.lat)}setCenter(b,z){return this.jumpTo({center:b},z)}getCenterElevation(){return this.transform.elevation}setCenterElevation(b,z){return this.jumpTo({elevation:b},z),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(b){this._centerClampedToGround=b}panBy(b,z,k){return b=Z.P.convert(b).mult(-1),this.panTo(this.transform.center,Z.e({offset:b},z),k)}panTo(b,z,k){return this.easeTo(Z.e({center:b},z),k)}getZoom(){return this.transform.zoom}setZoom(b,z){return this.jumpTo({zoom:b},z),this}zoomTo(b,z,k){return this.easeTo(Z.e({zoom:b},z),k)}zoomIn(b,z){return this.zoomTo(this.getZoom()+1,b,z),this}zoomOut(b,z){return this.zoomTo(this.getZoom()-1,b,z),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(b,z){return b!=this.transform.fov&&(this.transform.setFov(b),this.fire(new Z.l("movestart",z)).fire(new Z.l("move",z)).fire(new Z.l("moveend",z))),this}getBearing(){return this.transform.bearing}setBearing(b,z){return this.jumpTo({bearing:b},z),this}getPadding(){return this.transform.padding}setPadding(b,z){return this.jumpTo({padding:b},z),this}rotateTo(b,z,k){return this.easeTo(Z.e({bearing:b},z),k)}resetNorth(b,z){return this.rotateTo(0,Z.e({duration:1000},b),z),this}resetNorthPitch(b,z){return this.easeTo(Z.e({bearing:0,pitch:0,roll:0,duration:1000},b),z),this}snapToNorth(b,z){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(b,z):this}getPitch(){return this.transform.pitch}setPitch(b,z){return this.jumpTo({pitch:b},z),this}getRoll(){return this.transform.roll}setRoll(b,z){return this.jumpTo({roll:b},z),this}cameraForBounds(b,z){b=g5.convert(b).adjustAntiMeridian();let k=z&&z.bearing||0;return this._cameraForBoxAndBearing(b.getNorthWest(),b.getSouthEast(),k,z)}_cameraForBoxAndBearing(b,z,k,J){let B={top:0,bottom:0,right:0,left:0};if(typeof(J=Z.e({padding:B,offset:[0,0],maxZoom:this.transform.maxZoom},J)).padding=="number"){let F=J.padding;J.padding={top:F,bottom:F,right:F,left:F}}let X=Z.e(B,J.padding);J.padding=X;let V=this.transform,L=new g5(b,z);return this.cameraHelper.cameraForBoxAndBearing(J,X,L,k,V)}fitBounds(b,z,k){return this._fitInternal(this.cameraForBounds(b,z),z,k)}fitScreenCoordinates(b,z,k,J,B){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(Z.P.convert(b)),this.transform.screenPointToLocation(Z.P.convert(z)),k,J),J,B)}_fitInternal(b,z,k){return b?(delete(z=Z.e(b,z)).padding,z.linear?this.easeTo(z,k):this.flyTo(z,k)):this}jumpTo(b,z){this.stop();let k=this._getTransformForUpdate(),J=!1,B=!1,X=!1,V=k.zoom;this.cameraHelper.handleJumpToCenterZoom(k,b);let L=k.zoom!==V;return"elevation"in b&&k.elevation!==+b.elevation&&k.setElevation(+b.elevation),"bearing"in b&&k.bearing!==+b.bearing&&(J=!0,k.setBearing(+b.bearing)),"pitch"in b&&k.pitch!==+b.pitch&&(B=!0,k.setPitch(+b.pitch)),"roll"in b&&k.roll!==+b.roll&&(X=!0,k.setRoll(+b.roll)),b.padding==null||k.isPaddingEqual(b.padding)||k.setPadding(b.padding),this._applyUpdatedTransform(k),this.fire(new Z.l("movestart",z)).fire(new Z.l("move",z)),L&&this.fire(new Z.l("zoomstart",z)).fire(new Z.l("zoom",z)).fire(new Z.l("zoomend",z)),J&&this.fire(new Z.l("rotatestart",z)).fire(new Z.l("rotate",z)).fire(new Z.l("rotateend",z)),B&&this.fire(new Z.l("pitchstart",z)).fire(new Z.l("pitch",z)).fire(new Z.l("pitchend",z)),X&&this.fire(new Z.l("rollstart",z)).fire(new Z.l("roll",z)).fire(new Z.l("rollend",z)),this.fire(new Z.l("moveend",z))}calculateCameraOptionsFromTo(b,z,k,J=0){let B=Z.a1.fromLngLat(b,z),X=Z.a1.fromLngLat(k,J),V=X.x-B.x,L=X.y-B.y,F=X.z-B.z,C=Math.hypot(V,L,F);if(C===0)throw Error("Can't calculate camera options with same From and To");let O=Math.hypot(V,L),d=Z.ak(this.transform.cameraToCenterDistance/C/this.transform.tileSize),y=180*Math.atan2(V,-L)/Math.PI,T=180*Math.acos(O/C)/Math.PI;return T=F<0?90-T:90+T,{center:X.toLngLat(),elevation:J,zoom:d,pitch:T,bearing:y}}calculateCameraOptionsFromCameraLngLatAltRotation(b,z,k,J,B){let X=this.transform.calculateCenterFromCameraLngLatAlt(b,z,k,J);return{center:X.center,elevation:X.elevation,zoom:X.zoom,bearing:k,pitch:J,roll:B}}easeTo(b,z){this._stop(!1,b.easeId),((b=Z.e({offset:[0,0],duration:500,easing:Z.co},b)).animate===!1||!b.essential&&H1.prefersReducedMotion)&&(b.duration=0);let k=this._getTransformForUpdate(),J=this.getBearing(),B=k.pitch,X=k.roll,V="bearing"in b?this._normalizeBearing(b.bearing,J):J,L="pitch"in b?+b.pitch:B,F="roll"in b?this._normalizeBearing(b.roll,X):X,C="padding"in b?b.padding:k.padding,O=Z.P.convert(b.offset),d,y;b.around&&(d=Z.S.convert(b.around),y=k.locationToScreenPoint(d));let T={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},E=this.cameraHelper.handleEaseTo(k,{bearing:V,pitch:L,roll:F,padding:C,around:d,aroundPoint:y,offsetAsPoint:O,offset:b.offset,zoom:b.zoom,center:b.center});return this._rotating=this._rotating||J!==V,this._pitching=this._pitching||L!==B,this._rolling=this._rolling||F!==X,this._padding=!k.isPaddingEqual(C),this._zooming=this._zooming||E.isZooming,this._easeId=b.easeId,this._prepareEase(z,b.noMoveStart,T),this.terrain&&this._prepareElevation(E.elevationCenter),this._ease((p)=>{E.easeFunc(p),this.terrain&&!b.freezeElevation&&this._updateElevation(p),this._applyUpdatedTransform(k),this._fireMoveEvents(z)},(p)=>{this.terrain&&b.freezeElevation&&this._finalizeElevation(),this._afterEase(z,p)},b),this}_prepareEase(b,z,k={}){this._moving=!0,z||k.moving||this.fire(new Z.l("movestart",b)),this._zooming&&!k.zooming&&this.fire(new Z.l("zoomstart",b)),this._rotating&&!k.rotating&&this.fire(new Z.l("rotatestart",b)),this._pitching&&!k.pitching&&this.fire(new Z.l("pitchstart",b)),this._rolling&&!k.rolling&&this.fire(new Z.l("rollstart",b))}_prepareElevation(b){this._elevationCenter=b,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(b,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(b){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));let z=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(b<1&&z!==this._elevationTarget){let k=this._elevationTarget-this._elevationStart;this._elevationStart+=b*(k-(z-(k*b+this._elevationStart))/(1-b)),this._elevationTarget=z}this.transform.setElevation(Z.C.number(this._elevationStart,this._elevationTarget,b))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(b){if(!this.terrain&&b.elevation>=0&&b.pitch<=90)return{};let z=b.getCameraLngLat(),k=b.getCameraAltitude(),J=this.terrain?this.terrain.getElevationForLngLatZoom(z,b.zoom):0;if(k<J){let B=this.calculateCameraOptionsFromTo(z,J,b.center,b.elevation);return{pitch:B.pitch,zoom:B.zoom}}return{}}_applyUpdatedTransform(b){let z=[];if(z.push((J)=>this._elevateCameraIfInsideTerrain(J)),this.transformCameraUpdate&&z.push((J)=>this.transformCameraUpdate(J)),!z.length)return;let k=b.clone();for(let J of z){let B=k.clone(),{center:X,zoom:V,roll:L,pitch:F,bearing:C,elevation:O}=J(B);X&&B.setCenter(X),O!==void 0&&B.setElevation(O),V!==void 0&&B.setZoom(V),L!==void 0&&B.setRoll(L),F!==void 0&&B.setPitch(F),C!==void 0&&B.setBearing(C),k.apply(B)}this.transform.apply(k)}_fireMoveEvents(b){this.fire(new Z.l("move",b)),this._zooming&&this.fire(new Z.l("zoom",b)),this._rotating&&this.fire(new Z.l("rotate",b)),this._pitching&&this.fire(new Z.l("pitch",b)),this._rolling&&this.fire(new Z.l("roll",b))}_afterEase(b,z){if(this._easeId&&z&&this._easeId===z)return;delete this._easeId;let k=this._zooming,J=this._rotating,B=this._pitching,X=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,k&&this.fire(new Z.l("zoomend",b)),J&&this.fire(new Z.l("rotateend",b)),B&&this.fire(new Z.l("pitchend",b)),X&&this.fire(new Z.l("rollend",b)),this.fire(new Z.l("moveend",b))}flyTo(b,z){if(!b.essential&&H1.prefersReducedMotion){let Q1=Z.Q(b,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(Q1,z)}this.stop(),b=Z.e({offset:[0,0],speed:1.2,curve:1.42,easing:Z.co},b);let k=this._getTransformForUpdate(),J=k.bearing,B=k.pitch,X=k.roll,V=k.padding,L="bearing"in b?this._normalizeBearing(b.bearing,J):J,F="pitch"in b?+b.pitch:B,C="roll"in b?this._normalizeBearing(b.roll,X):X,O="padding"in b?b.padding:k.padding,d=Z.P.convert(b.offset),y=k.centerPoint.add(d),T=k.screenPointToLocation(y),E=this.cameraHelper.handleFlyTo(k,{bearing:L,pitch:F,roll:C,padding:O,locationAtOffset:T,offsetAsPoint:d,center:b.center,minZoom:b.minZoom,zoom:b.zoom}),p=b.curve,s=Math.max(k.width,k.height),c=s/E.scaleOfZoom,Z1=E.pixelPathLength;typeof E.scaleOfMinZoom=="number"&&(p=Math.sqrt(s/E.scaleOfMinZoom/Z1*2));let a=p*p;function x1(Q1){let O1=(c*c-s*s+(Q1?-1:1)*a*a*Z1*Z1)/(2*(Q1?c:s)*a*Z1);return Math.log(Math.sqrt(O1*O1+1)-O1)}function i(Q1){return(Math.exp(Q1)-Math.exp(-Q1))/2}function n(Q1){return(Math.exp(Q1)+Math.exp(-Q1))/2}let q1=x1(!1),V1=function(Q1){return n(q1)/n(q1+p*Q1)},W1=function(Q1){return s*((n(q1)*(i(O1=q1+p*Q1)/n(O1))-i(q1))/a)/Z1;var O1},L1=(x1(!0)-q1)/p;if(Math.abs(Z1)<0.000002||!isFinite(L1)){if(Math.abs(s-c)<0.000001)return this.easeTo(b,z);let Q1=c<s?-1:1;L1=Math.abs(Math.log(c/s))/p,W1=()=>0,V1=(O1)=>Math.exp(Q1*p*O1)}return b.duration="duration"in b?+b.duration:1000*L1/("screenSpeed"in b?+b.screenSpeed/p:+b.speed),b.maxDuration&&b.duration>b.maxDuration&&(b.duration=0),this._zooming=!0,this._rotating=J!==L,this._pitching=F!==B,this._rolling=C!==X,this._padding=!k.isPaddingEqual(O),this._prepareEase(z,!1),this.terrain&&this._prepareElevation(E.targetCenter),this._ease((Q1)=>{let O1=Q1*L1,I1=1/V1(O1),D1=W1(O1);this._rotating&&k.setBearing(Z.C.number(J,L,Q1)),this._pitching&&k.setPitch(Z.C.number(B,F,Q1)),this._rolling&&k.setRoll(Z.C.number(X,C,Q1)),this._padding&&(k.interpolatePadding(V,O,Q1),y=k.centerPoint.add(d)),E.easeFunc(Q1,I1,D1,y),this.terrain&&!b.freezeElevation&&this._updateElevation(Q1),this._applyUpdatedTransform(k),this._fireMoveEvents(z)},()=>{this.terrain&&b.freezeElevation&&this._finalizeElevation(),this._afterEase(z)},b),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(b,z){var k;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let J=this._onEaseEnd;delete this._onEaseEnd,J.call(this,z)}return b||(k=this.handlers)===null||k===void 0||k.stop(!1),this}_ease(b,z,k){k.animate===!1||k.duration===0?(b(1),z()):(this._easeStart=z1(),this._easeOptions=k,this._onEaseFrame=b,this._onEaseEnd=z,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(b,z){b=Z.aO(b,-180,180);let k=Math.abs(b-z);return Math.abs(b-360-z)<k&&(b-=360),Math.abs(b+360-z)<k&&(b+=360),b}queryTerrainElevation(b){return this.terrain?this.terrain.getElevationForLngLatZoom(Z.S.convert(b),this.transform.tileZoom):null}}let y7={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class s8{constructor(b=y7){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=(z)=>{!z||z.sourceDataType!=="metadata"&&z.sourceDataType!=="visibility"&&z.dataType!=="style"&&z.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=b}getDefaultPosition(){return"bottom-right"}onAdd(b){return this._map=b,this._compact=this.options.compact,this._container=u.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=u.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=u.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){u.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(b,z){let k=this._map._getUIString(`AttributionControl.${z}`);b.title=k,b.setAttribute("aria-label",k)}_updateAttributions(){if(!this._map.style)return;let b=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?b=b.concat(this.options.customAttribution.map((J)=>typeof J!="string"?"":J)):typeof this.options.customAttribution=="string"&&b.push(this.options.customAttribution)),this._map.style.stylesheet){let J=this._map.style.stylesheet;this.styleOwner=J.owner,this.styleId=J.id}let z=this._map.style.sourceCaches;for(let J in z){let B=z[J];if(B.used||B.usedForTerrain){let X=B.getSource();X.attribution&&b.indexOf(X.attribution)<0&&b.push(X.attribution)}}b=b.filter((J)=>String(J).trim()),b.sort((J,B)=>J.length-B.length),b=b.filter((J,B)=>{for(let X=B+1;X<b.length;X++)if(b[X].indexOf(J)>=0)return!1;return!0});let k=b.join(" | ");k!==this._attribHTML&&(this._attribHTML=k,b.length?(this._innerContainer.innerHTML=u.sanitize(k),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class R7{constructor(b={}){this._updateCompact=()=>{let z=this._container.children;if(z.length){let k=z[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&k.classList.add("maplibregl-compact"):k.classList.remove("maplibregl-compact")}},this.options=b}getDefaultPosition(){return"bottom-left"}onAdd(b){this._map=b,this._compact=this.options&&this.options.compact,this._container=u.create("div","maplibregl-ctrl");let z=u.create("a","maplibregl-ctrl-logo");return z.target="_blank",z.rel="noopener nofollow",z.href="https://maplibre.org/",z.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),z.setAttribute("rel","noopener nofollow"),this._container.appendChild(z),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){u.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class W2{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(b){let z=++this._id;return this._queue.push({callback:b,id:z,cancelled:!1}),z}remove(b){let z=this._currentlyRunning,k=z?this._queue.concat(z):this._queue;for(let J of k)if(J.id===b)return void(J.cancelled=!0)}run(b=0){if(this._currentlyRunning)throw Error("Attempting to run(), but is already running.");let z=this._currentlyRunning=this._queue;this._queue=[];for(let k of z)if(!k.cancelled&&(k.callback(b),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var gx=Z.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class G3 extends Z.E{constructor(b){super(),this._lastTilesetChange=z1(),this.sourceCache=b,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=b._source.tileSize*2**this.deltaZoom,b.usedForTerrain=!0,b.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(b,z){this.sourceCache.update(b,z),this._renderableTilesKeys=[];let k={};for(let J of N1(b,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:z,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))k[J.key]=!0,this._renderableTilesKeys.push(J.key),this._tiles[J.key]||(J.terrainRttPosMatrix32f=new Float64Array(16),Z.bZ(J.terrainRttPosMatrix32f,0,Z.$,Z.$,0,0,1),this._tiles[J.key]=new m(J,this.tileSize),this._lastTilesetChange=z1());for(let J in this._tiles)k[J]||delete this._tiles[J]}freeRtt(b){for(let z in this._tiles){let k=this._tiles[z];(!b||k.tileID.equals(b)||k.tileID.isChildOf(b)||b.isChildOf(k.tileID))&&(k.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((b)=>this.getTileByID(b))}getTileByID(b){return this._tiles[b]}getTerrainCoords(b,z){return z?this._getTerrainCoordsForTileRanges(b,z):this._getTerrainCoordsForRegularTile(b)}_getTerrainCoordsForRegularTile(b){let z={};for(let k of this._renderableTilesKeys){let J=this._tiles[k].tileID,B=b.clone(),X=Z.ba();if(J.canonical.equals(b.canonical))Z.bZ(X,0,Z.$,Z.$,0,0,1);else if(J.canonical.isChildOf(b.canonical)){let V=J.canonical.z-b.canonical.z,L=J.canonical.x-(J.canonical.x>>V<<V),F=J.canonical.y-(J.canonical.y>>V<<V),C=Z.$>>V;Z.bZ(X,0,C,C,0,0,1),Z.M(X,X,[-L*C,-F*C,0])}else{if(!b.canonical.isChildOf(J.canonical))continue;{let V=b.canonical.z-J.canonical.z,L=b.canonical.x-(b.canonical.x>>V<<V),F=b.canonical.y-(b.canonical.y>>V<<V),C=Z.$>>V;Z.bZ(X,0,Z.$,Z.$,0,0,1),Z.M(X,X,[L*C,F*C,0]),Z.N(X,X,[1/2**V,1/2**V,0])}}B.terrainRttPosMatrix32f=new Float32Array(X),z[k]=B}return z}_getTerrainCoordsForTileRanges(b,z){let k={};for(let J of this._renderableTilesKeys){let B=this._tiles[J].tileID;if(!this._isWithinTileRanges(B,z))continue;let X=b.clone(),V=Z.ba();if(B.canonical.z===b.canonical.z){let L=b.canonical.x-B.canonical.x,F=b.canonical.y-B.canonical.y;Z.bZ(V,0,Z.$,Z.$,0,0,1),Z.M(V,V,[L*Z.$,F*Z.$,0])}else if(B.canonical.z>b.canonical.z){let L=B.canonical.z-b.canonical.z,F=B.canonical.x-(B.canonical.x>>L<<L),C=B.canonical.y-(B.canonical.y>>L<<L),O=b.canonical.x-(B.canonical.x>>L),d=b.canonical.y-(B.canonical.y>>L),y=Z.$>>L;Z.bZ(V,0,y,y,0,0,1),Z.M(V,V,[-F*y+O*Z.$,-C*y+d*Z.$,0])}else{let L=b.canonical.z-B.canonical.z,F=b.canonical.x-(b.canonical.x>>L<<L),C=b.canonical.y-(b.canonical.y>>L<<L),O=(b.canonical.x>>L)-B.canonical.x,d=(b.canonical.y>>L)-B.canonical.y,y=Z.$<<L;Z.bZ(V,0,y,y,0,0,1),Z.M(V,V,[F*Z.$+O*y,C*Z.$+d*y,0])}X.terrainRttPosMatrix32f=new Float32Array(V),k[J]=X}return k}getSourceTile(b,z){let k=this.sourceCache._source,J=b.overscaledZ-this.deltaZoom;if(J>k.maxzoom&&(J=k.maxzoom),J<k.minzoom)return null;this._sourceTileCache[b.key]||(this._sourceTileCache[b.key]=b.scaledTo(J).key);let B=this.sourceCache.getTileByID(this._sourceTileCache[b.key]);if((!B||!B.dem)&&z)for(;J>=k.minzoom&&(!B||!B.dem);)B=this.sourceCache.getTileByID(b.scaledTo(J--).key);return B}anyTilesAfterTime(b=Date.now()){return this._lastTilesetChange>=b}_isWithinTileRanges(b,z){return z[b.canonical.z]&&b.canonical.x>=z[b.canonical.z].minTileX&&b.canonical.x<=z[b.canonical.z].maxTileX&&b.canonical.y>=z[b.canonical.z].minTileY&&b.canonical.y<=z[b.canonical.z].maxTileY}}class lg{constructor(b,z,k){this._meshCache={},this.painter=b,this.sourceCache=new G3(z),this.options=k,this.exaggeration=typeof k.exaggeration=="number"?k.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(b,z,k,J=Z.$){var B;if(!(z>=0&&z<J&&k>=0&&k<J))return 0;let X=this.getTerrainData(b),V=(B=X.tile)===null||B===void 0?void 0:B.dem;if(!V)return 0;let L=Z.cs([],[z/J*Z.$,k/J*Z.$],X.u_terrain_matrix),F=[L[0]*V.dim,L[1]*V.dim],C=Math.floor(F[0]),O=Math.floor(F[1]),d=F[0]-C,y=F[1]-O;return V.get(C,O)*(1-d)*(1-y)+V.get(C+1,O)*d*(1-y)+V.get(C,O+1)*(1-d)*y+V.get(C+1,O+1)*d*y}getElevationForLngLatZoom(b,z){if(!Z.ct(z,b.wrap()))return 0;let{tileID:k,mercatorX:J,mercatorY:B}=this._getOverscaledTileIDFromLngLatZoom(b,z);return this.getElevation(k,J%Z.$,B%Z.$,Z.$)}getElevation(b,z,k,J=Z.$){return this.getDEMElevation(b,z,k,J)*this.exaggeration}getTerrainData(b){if(!this._emptyDemTexture){let J=this.painter.context,B=new Z.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Z.T(J,B,J.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Z.T(J,new Z.R({width:1,height:1}),J.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(J.gl.NEAREST,J.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=Z.ai([])}let z=this.sourceCache.getSourceTile(b,!0);if(z&&z.dem&&(!z.demTexture||z.needsTerrainPrepare)){let J=this.painter.context;z.demTexture=this.painter.getTileTexture(z.dem.stride),z.demTexture?z.demTexture.update(z.dem.getPixels(),{premultiply:!1}):z.demTexture=new Z.T(J,z.dem.getPixels(),J.gl.RGBA,{premultiply:!1}),z.demTexture.bind(J.gl.NEAREST,J.gl.CLAMP_TO_EDGE),z.needsTerrainPrepare=!1}let k=z&&z+z.tileID.key+b.key;if(k&&!this._demMatrixCache[k]){let J=this.sourceCache.sourceCache._source.maxzoom,B=b.canonical.z-z.tileID.canonical.z;b.overscaledZ>b.canonical.z&&(b.canonical.z>=J?B=b.canonical.z-J:Z.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let X=b.canonical.x-(b.canonical.x>>B<<B),V=b.canonical.y-(b.canonical.y>>B<<B),L=Z.cu(new Float64Array(16),[1/(Z.$<<B),1/(Z.$<<B),0]);Z.M(L,L,[X*Z.$,V*Z.$,0]),this._demMatrixCache[b.key]={matrix:L,coord:b}}return{u_depth:2,u_terrain:3,u_terrain_dim:z&&z.dem&&z.dem.dim||1,u_terrain_matrix:k?this._demMatrixCache[b.key].matrix:this._emptyDemMatrix,u_terrain_unpack:z&&z.dem&&z.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(z&&z.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:z}}getFramebuffer(b){let z=this.painter,k=z.width/devicePixelRatio,J=z.height/devicePixelRatio;return!this._fbo||this._fbo.width===k&&this._fbo.height===J||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Z.T(z.context,{width:k,height:J,data:null},z.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(z.context.gl.NEAREST,z.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Z.T(z.context,{width:k,height:J,data:null},z.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(z.context.gl.NEAREST,z.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=z.context.createFramebuffer(k,J,!0,!1),this._fbo.depthAttachment.set(z.context.createRenderbuffer(z.context.gl.DEPTH_COMPONENT16,k,J))),this._fbo.colorAttachment.set(b==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let b=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let z=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let B=0,X=0;B<this._coordsTextureSize;B++)for(let V=0;V<this._coordsTextureSize;V++,X+=4)z[X+0]=255&V,z[X+1]=255&B,z[X+2]=V>>8<<4|B>>8,z[X+3]=0;let k=new Z.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(z.buffer)),J=new Z.T(b,k,b.gl.RGBA,{premultiply:!1});return J.bind(b.gl.NEAREST,b.gl.CLAMP_TO_EDGE),this._coordsTexture=J,J}pointCoordinate(b){this.painter.maybeDrawDepthAndCoords(!0);let z=new Uint8Array(4),k=this.painter.context,J=k.gl,B=Math.round(b.x*this.painter.pixelRatio/devicePixelRatio),X=Math.round(b.y*this.painter.pixelRatio/devicePixelRatio),V=Math.round(this.painter.height/devicePixelRatio);k.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),J.readPixels(B,V-X-1,1,1,J.RGBA,J.UNSIGNED_BYTE,z),k.bindFramebuffer.set(null);let L=z[0]+(z[2]>>4<<8),F=z[1]+((15&z[2])<<8),C=this.coordsIndex[255-z[3]],O=C&&this.sourceCache.getTileByID(C);if(!O)return null;let d=this._coordsTextureSize,y=(1<<O.tileID.canonical.z)*d;return new Z.a1((O.tileID.canonical.x*d+L)/y+O.tileID.wrap,(O.tileID.canonical.y*d+F)/y,this.getElevation(O.tileID,L,F,d))}depthAtPoint(b){let z=new Uint8Array(4),k=this.painter.context,J=k.gl;return k.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),J.readPixels(b.x,this.painter.height/devicePixelRatio-b.y-1,1,1,J.RGBA,J.UNSIGNED_BYTE,z),k.bindFramebuffer.set(null),(z[0]/16777216+z[1]/65536+z[2]/256+z[3])/256}getTerrainMesh(b){var z;let k=((z=this.painter.style.projection)===null||z===void 0?void 0:z.transitionState)>0,J=k&&b.canonical.y===0,B=k&&b.canonical.y===(1<<b.canonical.z)-1,X=`m_${J?"n":""}_${B?"s":""}`;if(this._meshCache[X])return this._meshCache[X];let V=this.painter.context,L=new Z.cv,F=new Z.aN,C=this.meshSize,O=Z.$/C,d=C*C;for(let n=0;n<=C;n++)for(let q1=0;q1<=C;q1++)L.emplaceBack(q1*O,n*O,0);for(let n=0;n<d;n+=C+1)for(let q1=0;q1<C;q1++)F.emplaceBack(q1+n,C+q1+n+1,C+q1+n+2),F.emplaceBack(q1+n,C+q1+n+2,q1+n+1);let y=L.length,T=y+(C+1),E=(C+1)*C,p=J?Z.bh:0,s=J?0:1,c=B?Z.bi:Z.$,Z1=B?0:1;for(let n=0;n<=C;n++)L.emplaceBack(n*O,p,s);for(let n=0;n<=C;n++)L.emplaceBack(n*O,c,Z1);for(let n=0;n<C;n++)F.emplaceBack(E+n,T+n,T+n+1),F.emplaceBack(E+n,T+n+1,E+n+1),F.emplaceBack(0+n,y+n+1,y+n),F.emplaceBack(0+n,0+n+1,y+n+1);let a=L.length,x1=a+2*(C+1);for(let n of[0,1])for(let q1=0;q1<=C;q1++)for(let V1 of[0,1])L.emplaceBack(n*Z.$,q1*O,V1);for(let n=0;n<2*C;n+=2)F.emplaceBack(a+n,a+n+1,a+n+3),F.emplaceBack(a+n,a+n+3,a+n+2),F.emplaceBack(x1+n,x1+n+3,x1+n+1),F.emplaceBack(x1+n,x1+n+2,x1+n+3);let i=new W3(V.createVertexBuffer(L,gx.members),V.createIndexBuffer(F),Z.aM.simpleSegment(0,0,L.length,F.length));return this._meshCache[X]=i,i}getMeshFrameDelta(b){return 2*Math.PI*Z.bu/Math.pow(2,Math.max(b,0))/5}getMinTileElevationForLngLatZoom(b,z){var k;let{tileID:J}=this._getOverscaledTileIDFromLngLatZoom(b,z);return(k=this.getMinMaxElevation(J).minElevation)!==null&&k!==void 0?k:0}getMinMaxElevation(b){let z=this.getTerrainData(b).tile,k={minElevation:null,maxElevation:null};return z&&z.dem&&(k.minElevation=z.dem.min*this.exaggeration,k.maxElevation=z.dem.max*this.exaggeration),k}_getOverscaledTileIDFromLngLatZoom(b,z){let k=Z.a1.fromLngLat(b.wrap()),J=(1<<z)*Z.$,B=k.x*J,X=k.y*J,V=Math.floor(B/Z.$),L=Math.floor(X/Z.$);return{tileID:new Z.Z(z,0,z,V,L),mercatorX:B,mercatorY:X}}}class fx{constructor(b,z,k){this._context=b,this._size=z,this._tileSize=k,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let b of this._objects)b.texture.destroy(),b.fbo.destroy()}_createObject(b){let z=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),k=new Z.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return k.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),z.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),z.colorAttachment.set(k.texture),{id:b,fbo:z,texture:k,stamp:-1,inUse:!1}}getObjectForId(b){return this._objects[b]}useObject(b){b.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((z)=>b.id!==z),this._recentlyUsed.push(b.id)}stampObject(b){b.stamp=++this._stamp}getOrCreateFreeObject(){for(let z of this._recentlyUsed)if(!this._objects[z].inUse)return this._objects[z];if(this._objects.length>=this._size)throw Error("No free RenderPool available, call freeAllObjects() required!");let b=this._createObject(this._objects.length);return this._objects.push(b),b}freeObject(b){b.inUse=!1}freeAllObjects(){for(let b of this._objects)this.freeObject(b)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((b)=>!b.inUse)===!1}}let N7={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class zx{constructor(b,z){this.painter=b,this.terrain=z,this.pool=new fx(b.context,30,z.sourceCache.tileSize*z.qualityFactor)}destruct(){this.pool.destruct()}getTexture(b){return this.pool.getObjectForId(b.rtt[this._stacks.length-1].id).texture}prepareForRender(b,z){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=b._order.filter((k)=>!b._layers[k].isHidden(z)),this._coordsAscending={};for(let k in b.sourceCaches){this._coordsAscending[k]={};let J=b.sourceCaches[k].getVisibleCoordinates(),B=b.sourceCaches[k].getSource(),X=B instanceof E5?B.terrainTileRanges:null;for(let V of J){let L=this.terrain.sourceCache.getTerrainCoords(V,X);for(let F in L)this._coordsAscending[k][F]||(this._coordsAscending[k][F]=[]),this._coordsAscending[k][F].push(L[F])}}this._coordsAscendingStr={};for(let k of b._order){let J=b._layers[k],B=J.source;if(N7[J.type]&&!this._coordsAscendingStr[B]){this._coordsAscendingStr[B]={};for(let X in this._coordsAscending[B])this._coordsAscendingStr[B][X]=this._coordsAscending[B][X].map((V)=>V.key).sort().join()}}for(let k of this._renderableTiles)for(let J in this._coordsAscendingStr){let B=this._coordsAscendingStr[J][k.tileID.key];B&&B!==k.rttCoords[J]&&(k.rtt=[])}}renderLayer(b,z){if(b.isHidden(this.painter.transform.zoom))return!1;let k=Object.assign(Object.assign({},z),{isRenderingToTexture:!0}),J=b.type,B=this.painter,X=this._renderableLayerIds[this._renderableLayerIds.length-1]===b.id;if(N7[J]&&(this._prevType&&N7[this._prevType]||this._stacks.push([]),this._prevType=J,this._stacks[this._stacks.length-1].push(b.id),!X))return!0;if(N7[this._prevType]||N7[J]&&X){this._prevType=J;let V=this._stacks.length-1,L=this._stacks[V]||[];for(let F of this._renderableTiles){if(this.pool.isFull()&&(Ug(this.painter,this.terrain,this._rttTiles,k),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(F),F.rtt[V]){let O=this.pool.getObjectForId(F.rtt[V].id);if(O.stamp===F.rtt[V].stamp){this.pool.useObject(O);continue}}let C=this.pool.getOrCreateFreeObject();this.pool.useObject(C),this.pool.stampObject(C),F.rtt[V]={id:C.id,stamp:C.stamp},B.context.bindFramebuffer.set(C.fbo.framebuffer),B.context.clear({color:Z.bf.transparent,stencil:0}),B.currentStencilSource=void 0;for(let O=0;O<L.length;O++){let d=B.style._layers[L[O]],y=d.source?this._coordsAscending[d.source][F.tileID.key]:[F.tileID];B.context.viewport.set([0,0,C.fbo.width,C.fbo.height]),B._renderTileClippingMasks(d,y,!0),B.renderLayer(B,B.style.sourceCaches[d.source],d,y,k),d.source&&(F.rttCoords[d.source]=this._coordsAscendingStr[d.source][F.tileID.key])}}return Ug(this.painter,this.terrain,this._rttTiles,k),this._rttTiles=[],this.pool.freeAllObjects(),N7[J]}return!1}}let I6={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},B5=l,K5={hash:!1,interactive:!0,bearingSnap:7,attributionControl:y7,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:Z.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},xx={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class I7{constructor(b,z,k=!1){this.mousedown=(B)=>{this.startMove(B,u.mousePos(this.element,B)),u.addEventListener(window,"mousemove",this.mousemove),u.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=(B)=>{this.move(B,u.mousePos(this.element,B))},this.mouseup=(B)=>{this._rotatePitchHandler.dragEnd(B),this.offTemp()},this.touchstart=(B)=>{B.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=u.touchPos(this.element,B.targetTouches)[0],this.startMove(B,this._startPos),u.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),u.addEventListener(window,"touchend",this.touchend))},this.touchmove=(B)=>{B.targetTouches.length!==1?this.reset():(this._lastPos=u.touchPos(this.element,B.targetTouches)[0],this.move(B,this._lastPos))},this.touchend=(B)=>{B.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=z;let J=new O6;this._rotatePitchHandler=new k4({clickTolerance:3,move:(B,X)=>{let V=z.getBoundingClientRect(),L=new Z.P((V.bottom-V.top)/2,(V.right-V.left)/2);return{bearingDelta:Z.cn(new Z.P(B.x,X.y),X,L),pitchDelta:k?-0.5*(X.y-B.y):void 0}},moveStateManager:J,enable:!0,assignEvents:()=>{}}),this.map=b,u.addEventListener(z,"mousedown",this.mousedown),u.addEventListener(z,"touchstart",this.touchstart,{passive:!1}),u.addEventListener(z,"touchcancel",this.reset)}startMove(b,z){this._rotatePitchHandler.dragStart(b,z),u.disableDrag()}move(b,z){let k=this.map,{bearingDelta:J,pitchDelta:B}=this._rotatePitchHandler.dragMove(b,z)||{};J&&k.setBearing(k.getBearing()+J),B&&k.setPitch(k.getPitch()+B)}off(){let b=this.element;u.removeEventListener(b,"mousedown",this.mousedown),u.removeEventListener(b,"touchstart",this.touchstart,{passive:!1}),u.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),u.removeEventListener(window,"touchend",this.touchend),u.removeEventListener(b,"touchcancel",this.reset),this.offTemp()}offTemp(){u.enableDrag(),u.removeEventListener(window,"mousemove",this.mousemove),u.removeEventListener(window,"mouseup",this.mouseup),u.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),u.removeEventListener(window,"touchend",this.touchend)}}let E3;function i8(b,z,k,J=!1){if(J||!k.getCoveringTilesDetailsProvider().allowWorldCopies())return b==null?void 0:b.wrap();let B=new Z.S(b.lng,b.lat);if(b=new Z.S(b.lng,b.lat),z){let X=new Z.S(b.lng-360,b.lat),V=new Z.S(b.lng+360,b.lat),L=k.locationToScreenPoint(b).distSqr(z);k.locationToScreenPoint(X).distSqr(z)<L?b=X:k.locationToScreenPoint(V).distSqr(z)<L&&(b=V)}for(;Math.abs(b.lng-k.center.lng)>180;){let X=k.locationToScreenPoint(b);if(X.x>=0&&X.y>=0&&X.x<=k.width&&X.y<=k.height)break;b.lng>k.center.lng?b.lng-=360:b.lng+=360}return b.lng!==B.lng&&k.isPointOnMapSurface(k.locationToScreenPoint(b))?b:B}let S6={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function t8(b,z,k){let J=b.classList;for(let B in S6)J.remove(`maplibregl-${k}-anchor-${B}`);J.add(`maplibregl-${k}-anchor-${z}`)}class y4 extends Z.E{constructor(b){if(super(),this._onKeyPress=(z)=>{let k=z.code,J=z.charCode||z.keyCode;k!=="Space"&&k!=="Enter"&&J!==32&&J!==13||this.togglePopup()},this._onMapClick=(z)=>{let k=z.originalEvent.target,J=this._element;this._popup&&(k===J||J.contains(k))&&this.togglePopup()},this._update=(z)=>{if(!this._map)return;let k=this._map.loaded()&&!this._map.isMoving();((z==null?void 0:z.type)==="terrain"||(z==null?void 0:z.type)==="render"&&!k)&&this._map.once("render",this._update),this._lngLat=i8(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let J="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?J=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(J=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let B="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?B="rotateX(0deg)":this._pitchAlignment==="map"&&(B=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||z&&z.type!=="moveend"||(this._pos=this._pos.round()),u.setTransform(this._element,`${S6[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${B} ${J}`),H1.frameAsync(new AbortController).then(()=>{this._updateOpacity(z&&z.type==="moveend")}).catch(()=>{})},this._onMove=(z)=>{if(!this._isDragging){let k=this._clickTolerance||this._map._clickTolerance;this._isDragging=z.point.dist(this._pointerdownPos)>=k}this._isDragging&&(this._pos=z.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new Z.l("dragstart"))),this.fire(new Z.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new Z.l("dragend")),this._state="inactive"},this._addDragHandler=(z)=>{this._element.contains(z.originalEvent.target)&&(z.preventDefault(),this._positionDelta=z.point.sub(this._pos).add(this._offset),this._pointerdownPos=z.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=b&&b.anchor||"center",this._color=b&&b.color||"#3FB1CE",this._scale=b&&b.scale||1,this._draggable=b&&b.draggable||!1,this._clickTolerance=b&&b.clickTolerance||0,this._subpixelPositioning=b&&b.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=b&&b.rotation||0,this._rotationAlignment=b&&b.rotationAlignment||"auto",this._pitchAlignment=b&&b.pitchAlignment&&b.pitchAlignment!=="auto"?b.pitchAlignment:this._rotationAlignment,this.setOpacity(b==null?void 0:b.opacity,b==null?void 0:b.opacityWhenCovered),b&&b.element)this._element=b.element,this._offset=Z.P.convert(b&&b.offset||[0,0]);else{this._defaultMarker=!0,this._element=u.create("div");let z=u.createNS("http://www.w3.org/2000/svg","svg"),k=41,J=27;z.setAttributeNS(null,"display","block"),z.setAttributeNS(null,"height",`${k}px`),z.setAttributeNS(null,"width",`${J}px`),z.setAttributeNS(null,"viewBox",`0 0 ${J} ${k}`);let B=u.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"stroke","none"),B.setAttributeNS(null,"stroke-width","1"),B.setAttributeNS(null,"fill","none"),B.setAttributeNS(null,"fill-rule","evenodd");let X=u.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"fill-rule","nonzero");let V=u.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"transform","translate(3.0, 29.0)"),V.setAttributeNS(null,"fill","#000000");let L=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let s of L){let c=u.createNS("http://www.w3.org/2000/svg","ellipse");c.setAttributeNS(null,"opacity","0.04"),c.setAttributeNS(null,"cx","10.5"),c.setAttributeNS(null,"cy","5.80029008"),c.setAttributeNS(null,"rx",s.rx),c.setAttributeNS(null,"ry",s.ry),V.appendChild(c)}let F=u.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"fill",this._color);let C=u.createNS("http://www.w3.org/2000/svg","path");C.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),F.appendChild(C);let O=u.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"opacity","0.25"),O.setAttributeNS(null,"fill","#000000");let d=u.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),O.appendChild(d);let y=u.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"transform","translate(6.0, 7.0)"),y.setAttributeNS(null,"fill","#FFFFFF");let T=u.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(8.0, 8.0)");let E=u.createNS("http://www.w3.org/2000/svg","circle");E.setAttributeNS(null,"fill","#000000"),E.setAttributeNS(null,"opacity","0.25"),E.setAttributeNS(null,"cx","5.5"),E.setAttributeNS(null,"cy","5.5"),E.setAttributeNS(null,"r","5.4999962");let p=u.createNS("http://www.w3.org/2000/svg","circle");p.setAttributeNS(null,"fill","#FFFFFF"),p.setAttributeNS(null,"cx","5.5"),p.setAttributeNS(null,"cy","5.5"),p.setAttributeNS(null,"r","5.4999962"),T.appendChild(E),T.appendChild(p),X.appendChild(V),X.appendChild(F),X.appendChild(O),X.appendChild(y),X.appendChild(T),z.appendChild(X),z.setAttributeNS(null,"height",k*this._scale+"px"),z.setAttributeNS(null,"width",J*this._scale+"px"),this._element.appendChild(z),this._offset=Z.P.convert(b&&b.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(z)=>{z.preventDefault()}),this._element.addEventListener("mousedown",(z)=>{z.preventDefault()}),t8(this._element,this._anchor,"marker"),b&&b.className)for(let z of b.className.split(" "))this._element.classList.add(z);this._popup=null}addTo(b){return this.remove(),this._map=b,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",b._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),b.getCanvasContainer().appendChild(this._element),b.on("move",this._update),b.on("moveend",this._update),b.on("terrain",this._update),b.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),u.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=Z.S.convert(b),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(b){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),b){if(!("offset"in b.options)){let J=Math.abs(13.5)/Math.SQRT2;b.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[J,-1*(24.6+J)],"bottom-right":[-J,-1*(24.6+J)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=b,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(b){return this._subpixelPositioning=b,this}getPopup(){return this._popup}togglePopup(){let b=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:b?(b.isOpen()?b.remove():(b.setLngLat(this._lngLat),b.addTo(this._map)),this):this}_updateOpacity(b=!1){var z,k;let J=(z=this._map)===null||z===void 0?void 0:z.terrain,B=this._map.transform.isLocationOccluded(this._lngLat);if(!J||B){let y=B?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==y&&(this._element.style.opacity=y))}if(b)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}let X=this._map,V=X.terrain.depthAtPoint(this._pos),L=X.terrain.getElevationForLngLatZoom(this._lngLat,X.transform.tileZoom);if(X.transform.lngLatToCameraDepth(this._lngLat,L)-V<0.006)return void(this._element.style.opacity=this._opacity);let F=-this._offset.y/X.transform.pixelsPerMeter,C=Math.sin(X.getPitch()*Math.PI/180)*F,O=X.terrain.depthAtPoint(new Z.P(this._pos.x,this._pos.y-this._offset.y)),d=X.transform.lngLatToCameraDepth(this._lngLat,L+C)-O>0.006;((k=this._popup)===null||k===void 0?void 0:k.isOpen())&&d&&this._popup.remove(),this._element.style.opacity=d?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(b){return this._offset=Z.P.convert(b),this._update(),this}addClassName(b){this._element.classList.add(b)}removeClassName(b){this._element.classList.remove(b)}toggleClassName(b){return this._element.classList.toggle(b)}setDraggable(b){return this._draggable=!!b,this._map&&(b?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(b){return this._rotation=b||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(b){return this._rotationAlignment=b||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(b){return this._pitchAlignment=b&&b!=="auto"?b:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(b,z){return(this._opacity===void 0||b===void 0&&z===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),b!==void 0&&(this._opacity=b),z!==void 0&&(this._opacityWhenCovered=z),this._map&&this._updateOpacity(!0),this}}let Bw={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6000},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},S7=0,b7=!1,Aw={maxWidth:100,unit:"metric"};function e8(b,z,k){let J=k&&k.maxWidth||100,B=b._container.clientHeight/2,X=b._container.clientWidth/2,V=b.unproject([X-J/2,B]),L=b.unproject([X+J/2,B]),F=Math.round(b.project(L).x-b.project(V).x),C=Math.min(J,F,b._container.clientWidth),O=V.distanceTo(L);if(k&&k.unit==="imperial"){let d=3.2808*O;d>5280?g7(z,C,d/5280,b._getUIString("ScaleControl.Miles")):g7(z,C,d,b._getUIString("ScaleControl.Feet"))}else k&&k.unit==="nautical"?g7(z,C,O/1852,b._getUIString("ScaleControl.NauticalMiles")):O>=1000?g7(z,C,O/1000,b._getUIString("ScaleControl.Kilometers")):g7(z,C,O,b._getUIString("ScaleControl.Meters"))}function g7(b,z,k,J){let B=function(X){let V=Math.pow(10,`${Math.floor(X)}`.length-1),L=X/V;return L=L>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function(F){let C=Math.pow(10,Math.ceil(-Math.log(F)/Math.LN10));return Math.round(F*C)/C}(L),V*L}(k);b.style.width=z*(B/k)+"px",b.innerHTML=`${B}&nbsp;${J}`}let Mw={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Xw=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function w9(b){if(b){if(typeof b=="number"){let z=Math.round(Math.abs(b)/Math.SQRT2);return{center:new Z.P(0,0),top:new Z.P(0,b),"top-left":new Z.P(z,z),"top-right":new Z.P(-z,z),bottom:new Z.P(0,-b),"bottom-left":new Z.P(z,-z),"bottom-right":new Z.P(-z,-z),left:new Z.P(b,0),right:new Z.P(-b,0)}}if(b instanceof Z.P||Array.isArray(b)){let z=Z.P.convert(b);return{center:z,top:z,"top-left":z,"top-right":z,bottom:z,"bottom-left":z,"bottom-right":z,left:z,right:z}}return{center:Z.P.convert(b.center||[0,0]),top:Z.P.convert(b.top||[0,0]),"top-left":Z.P.convert(b["top-left"]||[0,0]),"top-right":Z.P.convert(b["top-right"]||[0,0]),bottom:Z.P.convert(b.bottom||[0,0]),"bottom-left":Z.P.convert(b["bottom-left"]||[0,0]),"bottom-right":Z.P.convert(b["bottom-right"]||[0,0]),left:Z.P.convert(b.left||[0,0]),right:Z.P.convert(b.right||[0,0])}}return w9(new Z.P(0,0))}let b9=l;U.AJAXError=Z.cz,U.Event=Z.l,U.Evented=Z.E,U.LngLat=Z.S,U.MercatorCoordinate=Z.a1,U.Point=Z.P,U.addProtocol=Z.cA,U.config=Z.a,U.removeProtocol=Z.cB,U.AttributionControl=s8,U.BoxZoomHandler=Vg,U.CanvasSource=Y3,U.CooperativeGesturesHandler=o8,U.DoubleClickZoomHandler=n0,U.DragPanHandler=N6,U.DragRotateHandler=a8,U.EdgeInsets=X2,U.FullscreenControl=class extends Z.E{constructor(b={}){super(),this._onFullscreenChange=()=>{var z;let k=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;(z=k==null?void 0:k.shadowRoot)===null||z===void 0?void 0:z.fullscreenElement;)k=k.shadowRoot.fullscreenElement;k===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:Z.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":("onmozfullscreenchange"in document)?this._fullscreenchange="mozfullscreenchange":("onwebkitfullscreenchange"in document)?this._fullscreenchange="webkitfullscreenchange":("onmsfullscreenchange"in document)&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=u.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){u.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let b=this._fullscreenButton=u.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);u.create("span","maplibregl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new Z.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new Z.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},U.GeoJSONSource=x4,U.GeolocateControl=class extends Z.E{constructor(b){super(),this._onSuccess=(z)=>{if(this._map){if(this._isOutOfMapMaxBounds(z))return this._setErrorState(),this.fire(new Z.l("outofmaxbounds",z)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=z,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(z),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(z),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new Z.l("geolocate",z)),this._finish()}},this._updateCamera=(z)=>{let k=new Z.S(z.coords.longitude,z.coords.latitude),J=z.coords.accuracy,B=this._map.getBearing(),X=Z.e({bearing:B},this.options.fitBoundsOptions),V=g5.fromLngLat(k,J);this._map.fitBounds(V,X,{geolocateSource:!0})},this._updateMarker=(z)=>{if(z){let k=new Z.S(z.coords.longitude,z.coords.latitude);this._accuracyCircleMarker.setLngLat(k).addTo(this._map),this._userLocationDotMarker.setLngLat(k).addTo(this._map),this._accuracy=z.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=(z)=>{if(this._map){if(z.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let k=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=k,this._geolocateButton.setAttribute("aria-label",k),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(z.code===3&&b7)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new Z.l("error",z)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(z)=>z.preventDefault()),this._geolocateButton=u.create("button","maplibregl-ctrl-geolocate",this._container),u.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=(z)=>{if(this._map){if(z===!1){Z.w("Geolocation support is not available so the GeolocateControl will be disabled.");let k=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=k,this._geolocateButton.setAttribute("aria-label",k)}else{let k=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=k,this._geolocateButton.setAttribute("aria-label",k)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=u.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new y4({element:this._dotElement}),this._circleElement=u.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new y4({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(k)=>{let J=(k==null?void 0:k[0])instanceof ResizeObserverEntry;k.geolocateSource||this._watchState!=="ACTIVE_LOCK"||J||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Z.l("trackuserlocationend")),this.fire(new Z.l("userlocationlostfocus")))})}},this.options=Z.e({},Bw,b)}onAdd(b){return this._map=b,this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return Z._(this,arguments,void 0,function*(z=!1){if(E3!==void 0&&!z)return E3;if(window.navigator.permissions===void 0)return E3=!!window.navigator.geolocation,E3;try{E3=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch(k){E3=!!window.navigator.geolocation}return E3})}().then((z)=>this._finishSetupUI(z)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),u.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,S7=0,b7=!1}_isOutOfMapMaxBounds(b){let z=this._map.getMaxBounds(),k=b.coords;return z&&(k.longitude<z.getWest()||k.longitude>z.getEast()||k.latitude<z.getSouth()||k.latitude>z.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){let b=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&b))return;let z=this._map.project(b),k=this._map.unproject([z.x+100,z.y]),J=b.distanceTo(k)/100,B=2*this._accuracy/J;this._circleElement.style.width=`${B.toFixed(2)}px`,this._circleElement.style.height=`${B.toFixed(2)}px`}trigger(){if(!this._setup)return Z.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new Z.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":S7--,b7=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new Z.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new Z.l("trackuserlocationstart")),this.fire(new Z.l("userlocationfocus"));break;default:throw Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),S7++,S7>1?(b={maximumAge:600000,timeout:0},b7=!0):(b=this.options.positionOptions,b7=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},U.GlobeControl=class{constructor(){this._toggleProjection=()=>{var b;let z=(b=this._map.getProjection())===null||b===void 0?void 0:b.type;this._map.setProjection(z!=="mercator"&&z?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var b;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((b=this._map.getProjection())===null||b===void 0?void 0:b.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(b){return this._map=b,this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=u.create("button","maplibregl-ctrl-globe",this._container),u.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){u.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},U.Hash=d4,U.ImageSource=E5,U.KeyboardHandler=Kg,U.LngLatBounds=g5,U.LogoControl=R7,U.Map=class extends Y0{constructor(b){var z,k;Z.cw.mark(Z.cx.create);let J=Object.assign(Object.assign(Object.assign({},K5),b),{canvasContextAttributes:Object.assign(Object.assign({},K5.canvasContextAttributes),b.canvasContextAttributes)});if(J.minZoom!=null&&J.maxZoom!=null&&J.minZoom>J.maxZoom)throw Error("maxZoom must be greater than or equal to minZoom");if(J.minPitch!=null&&J.maxPitch!=null&&J.minPitch>J.maxPitch)throw Error("maxPitch must be greater than or equal to minPitch");if(J.minPitch!=null&&J.minPitch<0)throw Error("minPitch must be greater than or equal to 0");if(J.maxPitch!=null&&J.maxPitch>180)throw Error("maxPitch must be less than or equal to 180");let B=new V2,X=new H5;if(J.minZoom!==void 0&&B.setMinZoom(J.minZoom),J.maxZoom!==void 0&&B.setMaxZoom(J.maxZoom),J.minPitch!==void 0&&B.setMinPitch(J.minPitch),J.maxPitch!==void 0&&B.setMaxPitch(J.maxPitch),J.renderWorldCopies!==void 0&&B.setRenderWorldCopies(J.renderWorldCopies),J.transformConstrain!==null&&B.setConstrain(J.transformConstrain),super(B,X,{bearingSnap:J.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new W2,this._controls=[],this._mapId=Z.a7(),this._contextLost=(L)=>{L.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new Z.l("webglcontextlost",{originalEvent:L}))},this._contextRestored=(L)=>{this._setupPainter(),this.resize(),this._update(),this.fire(new Z.l("webglcontextrestored",{originalEvent:L}))},this._onMapScroll=(L)=>{if(L.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=J.interactive,this._maxTileCacheSize=J.maxTileCacheSize,this._maxTileCacheZoomLevels=J.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},J.canvasContextAttributes),this._trackResize=J.trackResize===!0,this._bearingSnap=J.bearingSnap,this._centerClampedToGround=J.centerClampedToGround,this._refreshExpiredTiles=J.refreshExpiredTiles===!0,this._fadeDuration=J.fadeDuration,this._crossSourceCollisions=J.crossSourceCollisions===!0,this._collectResourceTiming=J.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},I6),J.locale),this._clickTolerance=J.clickTolerance,this._overridePixelRatio=J.pixelRatio,this._maxCanvasSize=J.maxCanvasSize,this.transformCameraUpdate=J.transformCameraUpdate,this.transformConstrain=J.transformConstrain,this.cancelPendingTileRequestsWhileZooming=J.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=F1.addThrottleControl(()=>this.isMoving()),this._requestManager=new i1(J.transformRequest),typeof J.container=="string"){if(this._container=document.getElementById(J.container),!this._container)throw Error(`Container '${J.container}' not found.`)}else{if(!(J.container instanceof HTMLElement))throw Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=J.container}if(J.maxBounds&&this.setMaxBounds(J.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let L=!1,F=Mg((C)=>{this._trackResize&&!this._removed&&(this.resize(C),this.redraw())},50);this._resizeObserver=new ResizeObserver((C)=>{L?F(C):L=!0}),this._resizeObserver.observe(this._container)}this.handlers=new e1(this,J),this._hash=J.hash&&new d4(typeof J.hash=="string"&&J.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:J.center,elevation:J.elevation,zoom:J.zoom,bearing:J.bearing,pitch:J.pitch,roll:J.roll}),J.bounds&&(this.resize(),this.fitBounds(J.bounds,Z.e({},J.fitBoundsOptions,{duration:0}))));let V=typeof J.style=="string"||((k=(z=J.style)===null||z===void 0?void 0:z.projection)===null||k===void 0?void 0:k.type)!=="globe";this.resize(null,V),this._localIdeographFontFamily=J.localIdeographFontFamily,this._validateStyle=J.validateStyle,J.style&&this.setStyle(J.style,{localIdeographFontFamily:J.localIdeographFontFamily}),J.attributionControl&&this.addControl(new s8(typeof J.attributionControl=="boolean"?void 0:J.attributionControl)),J.maplibreLogo&&this.addControl(new R7,J.logoPosition),this.on("style.load",()=>{if(V||this._resizeTransform(),this.transform.unmodified){let L=Z.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(L)}}),this.on("data",(L)=>{this._update(L.dataType==="style"),this.fire(new Z.l(`${L.dataType}data`,L))}),this.on("dataloading",(L)=>{this.fire(new Z.l(`${L.dataType}dataloading`,L))}),this.on("dataabort",(L)=>{this.fire(new Z.l("sourcedataabort",L))})}_getMapId(){return this._mapId}setGlobalStateProperty(b,z){return this.style.setGlobalStateProperty(b,z),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(b,z){if(z===void 0&&(z=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new Z.k(Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let k=b.onAdd(this);this._controls.push(b);let J=this._controlPositions[z];return z.indexOf("bottom")!==-1?J.insertBefore(k,J.firstChild):J.appendChild(k),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new Z.k(Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let z=this._controls.indexOf(b);return z>-1&&this._controls.splice(z,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}coveringTiles(b){return N1(this.transform,b)}calculateCameraOptionsFromTo(b,z,k,J){return J==null&&this.terrain&&(J=this.terrain.getElevationForLngLatZoom(k,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(b,z,k,J)}resize(b,z=!0){let[k,J]=this._containerDimensions(),B=this._getClampedPixelRatio(k,J);if(this._resizeCanvas(k,J,B),this.painter.resize(k,J,B),this.painter.overLimit()){let V=this.painter.context.gl;this._maxCanvasSize=[V.drawingBufferWidth,V.drawingBufferHeight];let L=this._getClampedPixelRatio(k,J);this._resizeCanvas(k,J,L),this.painter.resize(k,J,L)}this._resizeTransform(z);let X=!this._moving;return X&&(this.stop(),this.fire(new Z.l("movestart",b)).fire(new Z.l("move",b))),this.fire(new Z.l("resize",b)),X&&this.fire(new Z.l("moveend",b)),this}_resizeTransform(b=!0){var z;let[k,J]=this._containerDimensions();this.transform.resize(k,J,b),(z=this._requestedCameraState)===null||z===void 0||z.resize(k,J,b)}_getClampedPixelRatio(b,z){let{0:k,1:J}=this._maxCanvasSize,B=this.getPixelRatio(),X=b*B,V=z*B;return Math.min(X>k?k/X:1,V>J?J/V:1)*B}getPixelRatio(){var b;return(b=this._overridePixelRatio)!==null&&b!==void 0?b:devicePixelRatio}setPixelRatio(b){this._overridePixelRatio=b,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(g5.convert(b)),this._update()}setMinZoom(b){if((b=b==null?-2:b)>=-2&&b<=this.transform.maxZoom)return this.transform.setMinZoom(b),this._update(),this.getZoom()<b&&this.setZoom(b),this;throw Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b==null?22:b)>=this.transform.minZoom)return this.transform.setMaxZoom(b),this._update(),this.getZoom()>b&&this.setZoom(b),this;throw Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b==null?0:b)<0)throw Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.setMinPitch(b),this._update(),this.getPitch()<b&&this.setPitch(b),this;throw Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b==null?60:b)>180)throw Error("maxPitch must be less than or equal to 180");if(b>=this.transform.minPitch)return this.transform.setMaxPitch(b),this._update(),this.getPitch()>b&&this.setPitch(b),this;throw Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.setRenderWorldCopies(b),this._update()}setTransformConstrain(b){return this.transform.setConstrain(b),this._update()}project(b){return this.transform.locationToScreenPoint(Z.S.convert(b),this.style&&this.terrain)}unproject(b){return this.transform.screenPointToLocation(Z.P.convert(b),this.terrain)}isMoving(){var b;return this._moving||((b=this.handlers)===null||b===void 0?void 0:b.isMoving())}isZooming(){var b;return this._zooming||((b=this.handlers)===null||b===void 0?void 0:b.isZooming())}isRotating(){var b;return this._rotating||((b=this.handlers)===null||b===void 0?void 0:b.isRotating())}_createDelegatedListener(b,z,k){if(b==="mouseenter"||b==="mouseover"){let J=!1;return{layers:z,listener:k,delegates:{mousemove:(X)=>{let V=z.filter((F)=>this.getLayer(F)),L=V.length!==0?this.queryRenderedFeatures(X.point,{layers:V}):[];L.length?J||(J=!0,k.call(this,new _2(b,this,X.originalEvent,{features:L}))):J=!1},mouseout:()=>{J=!1}}}}if(b==="mouseleave"||b==="mouseout"){let J=!1;return{layers:z,listener:k,delegates:{mousemove:(V)=>{let L=z.filter((F)=>this.getLayer(F));(L.length!==0?this.queryRenderedFeatures(V.point,{layers:L}):[]).length?J=!0:J&&(J=!1,k.call(this,new _2(b,this,V.originalEvent)))},mouseout:(V)=>{J&&(J=!1,k.call(this,new _2(b,this,V.originalEvent)))}}}}{let J=(B)=>{let X=z.filter((L)=>this.getLayer(L)),V=X.length!==0?this.queryRenderedFeatures(B.point,{layers:X}):[];V.length&&(B.features=V,k.call(this,B),delete B.features)};return{layers:z,listener:k,delegates:{[b]:J}}}}_saveDelegatedListener(b,z){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(z)}_removeDelegatedListener(b,z,k){if(!this._delegatedListeners||!this._delegatedListeners[b])return;let J=this._delegatedListeners[b];for(let B=0;B<J.length;B++){let X=J[B];if(X.listener===k&&X.layers.length===z.length&&X.layers.every((V)=>z.includes(V))){for(let V in X.delegates)this.off(V,X.delegates[V]);return void J.splice(B,1)}}}on(b,z,k){if(k===void 0)return super.on(b,z);let J=typeof z=="string"?[z]:z,B=this._createDelegatedListener(b,J,k);this._saveDelegatedListener(b,B);for(let X in B.delegates)this.on(X,B.delegates[X]);return{unsubscribe:()=>{this._removeDelegatedListener(b,J,k)}}}once(b,z,k){if(k===void 0)return super.once(b,z);let J=typeof z=="string"?[z]:z,B=this._createDelegatedListener(b,J,k);for(let X in B.delegates){let V=B.delegates[X];B.delegates[X]=(...L)=>{this._removeDelegatedListener(b,J,k),V(...L)}}this._saveDelegatedListener(b,B);for(let X in B.delegates)this.once(X,B.delegates[X]);return this}off(b,z,k){return k===void 0?super.off(b,z):(this._removeDelegatedListener(b,typeof z=="string"?[z]:z,k),this)}queryRenderedFeatures(b,z){if(!this.style)return[];let k,J=b instanceof Z.P||Array.isArray(b),B=J?b:[[0,0],[this.transform.width,this.transform.height]];if(z=z||(J?{}:b)||{},B instanceof Z.P||typeof B[0]=="number")k=[Z.P.convert(B)];else{let X=Z.P.convert(B[0]),V=Z.P.convert(B[1]);k=[X,new Z.P(V.x,X.y),V,new Z.P(X.x,V.y),X]}return this.style.queryRenderedFeatures(k,z,this.transform)}querySourceFeatures(b,z){return this.style.querySourceFeatures(b,z)}setStyle(b,z){return(z=Z.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},z)).diff!==!1&&z.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,z),this):(this._localIdeographFontFamily=z.localIdeographFontFamily,this._updateStyle(b,z))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){let z=this._locale[b];if(z==null)throw Error(`Missing UI string '${b}'`);return z}_updateStyle(b,z){var k,J;if(z.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(b,z));let B=this.style&&z.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!b)),b?(this.style=new F7(this,z||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b,z,B):this.style.loadJSON(b,z,B),this):((J=(k=this.style)===null||k===void 0?void 0:k.projection)===null||J===void 0||J.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new F7(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,z){if(typeof b=="string"){let k=this._requestManager.transformRequest(b,"Style");Z.j(k,new AbortController).then((J)=>{this._updateDiff(J.data,z)}).catch((J)=>{J&&this.fire(new Z.k(J))})}else typeof b=="object"&&this._updateDiff(b,z)}_updateDiff(b,z){try{this.style.setState(b,z)&&this._update(!0)}catch(k){Z.w(`Unable to perform style diff: ${k.message||k.error||k}.  Rebuilding the style from scratch.`),this._updateStyle(b,z)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():Z.w("There is no style added to the map.")}addSource(b,z){return this._lazyInitEmptyStyle(),this.style.addSource(b,z),this._update(!0)}isSourceLoaded(b){let z=this.style&&this.style.sourceCaches[b];if(z!==void 0)return z.loaded();this.fire(new Z.k(Error(`There is no source with ID '${b}'`)))}setTerrain(b){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),b){let z=this.style.sourceCaches[b.source];if(!z)throw Error(`cannot load terrain, because there exists no source with ID: ${b.source}`);this.terrain===null&&z.reload();for(let k in this.style._layers){let J=this.style._layers[k];J.type==="hillshade"&&J.source===b.source&&Z.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),J.type==="color-relief"&&J.source===b.source&&Z.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new lg(this.painter,z,b),this.painter.renderToTexture=new zx(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=(k)=>{var J;k.dataType==="style"?this.terrain.sourceCache.freeRtt():k.dataType==="source"&&k.tile&&(k.sourceId!==b.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((J=k.source)===null||J===void 0?void 0:J.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(k.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new Z.l("terrain",{terrain:b})),this}getTerrain(){var b,z;return(z=(b=this.terrain)===null||b===void 0?void 0:b.options)!==null&&z!==void 0?z:null}areTilesLoaded(){let b=this.style&&this.style.sourceCaches;for(let z in b){let k=b[z]._tiles;for(let J in k){let B=k[J];if(B.state!=="loaded"&&B.state!=="errored")return!1}}return!0}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}setSourceTileLodParams(b,z,k){if(k){let J=this.getSource(k);if(!J)throw Error(`There is no source with ID "${k}", cannot set LOD parameters`);J.calculateTileZoom=M1(Math.max(1,b),Math.max(1,z))}else for(let J in this.style.sourceCaches)this.style.sourceCaches[J].getSource().calculateTileZoom=M1(Math.max(1,b),Math.max(1,z));return this._update(!0),this}refreshTiles(b,z){let k=this.style.sourceCaches[b];if(!k)throw Error(`There is no source cache with ID "${b}", cannot refresh tile`);z===void 0?k.reload(!0):k.refreshTiles(z.map((J)=>new Z.a4(J.z,J.x,J.y)))}addImage(b,z,k={}){let{pixelRatio:J=1,sdf:B=!1,stretchX:X,stretchY:V,content:L,textFitWidth:F,textFitHeight:C}=k;if(this._lazyInitEmptyStyle(),!(z instanceof HTMLImageElement||Z.b(z))){if(z.width===void 0||z.height===void 0)return this.fire(new Z.k(Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:O,height:d,data:y}=z,T=z;return this.style.addImage(b,{data:new Z.R({width:O,height:d},new Uint8Array(y)),pixelRatio:J,stretchX:X,stretchY:V,content:L,textFitWidth:F,textFitHeight:C,sdf:B,version:0,userImage:T}),T.onAdd&&T.onAdd(this,b),this}}{let{width:O,height:d,data:y}=H1.getImageData(z);this.style.addImage(b,{data:new Z.R({width:O,height:d},y),pixelRatio:J,stretchX:X,stretchY:V,content:L,textFitWidth:F,textFitHeight:C,sdf:B,version:0})}}updateImage(b,z){let k=this.style.getImage(b);if(!k)return this.fire(new Z.k(Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let J=z instanceof HTMLImageElement||Z.b(z)?H1.getImageData(z):z,{width:B,height:X,data:V}=J;if(B===void 0||X===void 0)return this.fire(new Z.k(Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(B!==k.data.width||X!==k.data.height)return this.fire(new Z.k(Error("The width and height of the updated image must be that same as the previous version of the image")));let L=!(z instanceof HTMLImageElement||Z.b(z));return k.data.replace(V,L),this.style.updateImage(b,k),this}getImage(b){return this.style.getImage(b)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new Z.k(Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b){return F1.getImage(this._requestManager.transformRequest(b,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(b,z){return this._lazyInitEmptyStyle(),this.style.addLayer(b,z),this._update(!0)}moveLayer(b,z){return this.style.moveLayer(b,z),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(b,z,k){return this.style.setLayerZoomRange(b,z,k),this._update(!0)}setFilter(b,z,k={}){return this.style.setFilter(b,z,k),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,z,k,J={}){return this.style.setPaintProperty(b,z,k,J),this._update(!0)}getPaintProperty(b,z){return this.style.getPaintProperty(b,z)}setLayoutProperty(b,z,k,J={}){return this.style.setLayoutProperty(b,z,k,J),this._update(!0)}getLayoutProperty(b,z){return this.style.getLayoutProperty(b,z)}setGlyphs(b,z={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(b,z),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(b,z,k={}){return this._lazyInitEmptyStyle(),this.style.addSprite(b,z,k,(J)=>{J||this._update(!0)}),this}removeSprite(b){return this._lazyInitEmptyStyle(),this.style.removeSprite(b),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(b,z={}){return this._lazyInitEmptyStyle(),this.style.setSprite(b,z,(k)=>{k||this._update(!0)}),this}setLight(b,z={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,z),this._update(!0)}getLight(){return this.style.getLight()}setSky(b,z={}){return this._lazyInitEmptyStyle(),this.style.setSky(b,z),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(b,z){return this.style.setFeatureState(b,z),this._update()}removeFeatureState(b,z){return this.style.removeFeatureState(b,z),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,z=0;return this._container&&(b=this._container.clientWidth||400,z=this._container.clientHeight||300),[b,z]}_setupContainer(){let b=this._container;b.classList.add("maplibregl-map");let z=this._canvasContainer=u.create("div","maplibregl-canvas-container",b);this._interactive&&z.classList.add("maplibregl-interactive"),this._canvas=u.create("canvas","maplibregl-canvas",z),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");let k=this._containerDimensions(),J=this._getClampedPixelRatio(k[0],k[1]);this._resizeCanvas(k[0],k[1],J);let B=this._controlContainer=u.create("div","maplibregl-control-container",b),X=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((V)=>{X[V]=u.create("div",`maplibregl-ctrl-${V} `,B)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,z,k){this._canvas.width=Math.floor(k*b),this._canvas.height=Math.floor(k*z),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${z}px`}_setupPainter(){let b=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0}),z=null;this._canvas.addEventListener("webglcontextcreationerror",(J)=>{z={requestedAttributes:b},J&&(z.statusMessage=J.statusMessage,z.type=J.type)},{once:!0});let k=null;if(k=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,b):this._canvas.getContext("webgl2",b)||this._canvas.getContext("webgl",b),!k)throw z?(z.message="Failed to initialize WebGL",Error(JSON.stringify(z))):Error("Failed to initialize WebGL");this.painter=new Ag(k,this.transform),R1.testSupport(k)}migrateProjection(b,z){super.migrateProjection(b,z),this.painter.transform=b,this.fire(new Z.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){var z,k,J,B,X;let V=this._idleTriggered?this._fadeDuration:0,L=((z=this.style.projection)===null||z===void 0?void 0:z.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let F=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let d=this.transform.zoom,y=z1();this.style.zoomHistory.update(d,y);let T=new Z.F(d,{now:y,fadeDuration:V,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),E=T.crossFadingFactor();E===1&&E===this._crossFadingFactor||(F=!0,this._crossFadingFactor=E),this.style.update(T)}let C=((k=this.style.projection)===null||k===void 0?void 0:k.transitionState)>0!==L;(J=this.style.projection)===null||J===void 0||J.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((B=this.style.projection)===null||B===void 0?void 0:B.transitionState,(X=this.style.projection)===null||X===void 0?void 0:X.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||C)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,V,this._crossSourceCollisions,C),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:V,showPadding:this.showPadding}),this.fire(new Z.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,Z.cw.mark(Z.cx.load),this.fire(new Z.l("load"))),this.style&&(this.style.hasTransitions()||F)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let O=this._sourcesDirty||this._styleDirty||this._placementDirty;return O||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new Z.l("idle")),!this._loaded||this._fullyLoaded||O||(this._fullyLoaded=!0,Z.cw.mark(Z.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var b;this._hash&&this._hash.remove();for(let k of this._controls)k.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),F1.removeThrottleControl(this._imageQueueHandle),(b=this._resizeObserver)===null||b===void 0||b.disconnect();let z=this.painter.context.gl.getExtension("WEBGL_lose_context");(z==null?void 0:z.loseContext)&&z.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),u.remove(this._canvasContainer),u.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),Z.cw.clearMetrics(),this._removed=!0,this.fire(new Z.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,H1.frame(this._frameRequest,(b)=>{Z.cw.frame(b),this._frameRequest=null;try{this._render(b)}catch(z){if(!Z.cy(z)&&!function(k){return k.message===Tz}(z))throw z}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get version(){return B5}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(b){return this._lazyInitEmptyStyle(),this.style.setProjection(b),this._update(!0)}},U.MapMouseEvent=_2,U.MapTouchEvent=L2,U.MapWheelEvent=J3,U.Marker=y4,U.NavigationControl=class{constructor(b){this._updateZoomButtons=()=>{let z=this._map.getZoom(),k=z===this._map.getMaxZoom(),J=z===this._map.getMinZoom();this._zoomInButton.disabled=k,this._zoomOutButton.disabled=J,this._zoomInButton.setAttribute("aria-disabled",k.toString()),this._zoomOutButton.setAttribute("aria-disabled",J.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),0.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),0.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(z,k)=>{let J=this._map._getUIString(`NavigationControl.${k}`);z.title=J,z.setAttribute("aria-label",J)},this.options=Z.e({},xx,b),this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(z)=>z.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(z)=>this._map.zoomIn({},{originalEvent:z})),u.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(z)=>this._map.zoomOut({},{originalEvent:z})),u.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(z)=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:z}):this._map.resetNorth({},{originalEvent:z})}),this._compassIcon=u.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new I7(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){u.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,z){let k=u.create("button",b,this._container);return k.type="button",k.addEventListener("click",z),k}},U.Popup=class extends Z.E{constructor(b){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&u.remove(this._content),this._container&&(u.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new Z.l("close"))),this),this._onMouseUp=(z)=>{this._update(z.point)},this._onMouseMove=(z)=>{this._update(z.point)},this._onDrag=(z)=>{this._update(z.point)},this._update=(z)=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=u.create("div","maplibregl-popup",this._map.getContainer()),this._tip=u.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let V of this.options.className.split(" "))this._container.classList.add(V);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=i8(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!z)return;let k=this._flatPos=this._pos=this._trackPointer&&z?z:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&z?z:this._map.transform.locationToScreenPoint(this._lngLat));let J=this.options.anchor,B=w9(this.options.offset);if(!J){let V=this._container.offsetWidth,L=this._container.offsetHeight,F;F=k.y+B.bottom.y<L?["top"]:k.y>this._map.transform.height-L?["bottom"]:[],k.x<V/2?F.push("left"):k.x>this._map.transform.width-V/2&&F.push("right"),J=F.length===0?"bottom":F.join("-")}let X=k.add(B[J]);this.options.subpixelPositioning||(X=X.round()),u.setTransform(this._container,`${S6[J]} translate(${X.x}px,${X.y}px)`),t8(this._container,J,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=Z.e(Object.create(Mw),b)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new Z.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=Z.S.convert(b),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){let z=document.createDocumentFragment(),k=document.createElement("body"),J;for(k.innerHTML=b;J=k.firstChild,J;)z.appendChild(J);return this.setDOMContent(z)}getMaxWidth(){var b;return(b=this._container)===null||b===void 0?void 0:b.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=u.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){return this._container&&this._container.classList.add(b),this}removeClassName(b){return this._container&&this._container.classList.remove(b),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}setSubpixelPositioning(b){this.options.subpixelPositioning=b}_createCloseButton(){this.options.closeButton&&(this._closeButton=u.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let b=this._container.querySelector(Xw);b&&b.focus()}},U.RasterDEMTileSource=O2,U.RasterTileSource=Q3,U.ScaleControl=class{constructor(b){this._onMove=()=>{e8(this._map,this._container,this.options)},this.setUnit=(z)=>{this.options.unit=z,e8(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Aw),b)}getDefaultPosition(){return"bottom-left"}onAdd(b){return this._map=b,this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){u.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},U.ScrollZoomHandler=v4,U.Style=F7,U.TerrainControl=class{constructor(b){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=b}onAdd(b){return this._map=b,this._container=u.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=u.create("button","maplibregl-ctrl-terrain",this._container),u.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){u.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},U.TwoFingersTouchPitchHandler=c8,U.TwoFingersTouchRotateHandler=Fg,U.TwoFingersTouchZoomHandler=p8,U.TwoFingersTouchZoomRotateHandler=r8,U.VectorTileSource=z4,U.VideoSource=T3,U.addSourceType=(b,z)=>Z._(void 0,void 0,void 0,function*(){if(t2(b))throw Error(`A source type called "${b}" already exists.`);((k,J)=>{u5[k]=J})(b,z)}),U.clearPrewarmedResources=function(){let b=Z0;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(Q5),Z0=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},U.createTileMesh=K8,U.getMaxParallelImageRequests=function(){return Z.a.MAX_PARALLEL_IMAGE_REQUESTS},U.getRTLTextPluginStatus=function(){return V3().getRTLTextPluginStatus()},U.getVersion=function(){return b9},U.getWorkerCount=function(){return R5.workerCount},U.getWorkerUrl=function(){return Z.a.WORKER_URL},U.importScriptInWorkers=function(b){return j0().broadcast("IS",b)},U.isTimeFrozen=function(){return r.isFrozen()},U.prewarm=function(){P0().acquire(Q5)},U.restoreNow=function(){r.restoreNow()},U.setMaxParallelImageRequests=function(b){Z.a.MAX_PARALLEL_IMAGE_REQUESTS=b},U.setNow=function(b){r.setNow(b)},U.setRTLTextPlugin=function(b,z){return V3().setRTLTextPlugin(b,z)},U.setWorkerCount=function(b){R5.workerCount=b},U.setWorkerUrl=function(b){Z.a.WORKER_URL=b}});var G=g;return G})});var LQ=o5(Z3(),1),WQ=o5(UJ(),1);var GZ=o5(Z3(),1);var vX=(g)=>g.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),cF=(g)=>g.replace(/^([A-Z])|[\s-_]+(\w)/g,(x,Y,G)=>G?G.toUpperCase():Y.toLowerCase()),BJ=(g)=>{let x=cF(g);return x.charAt(0).toUpperCase()+x.slice(1)},JZ=(...g)=>g.filter((x,Y,G)=>{return Boolean(x)&&x.trim()!==""&&G.indexOf(x)===Y}).join(" ").trim(),JX=(g)=>{for(let x in g)if(x.startsWith("aria-")||x==="role"||x==="title")return!0};var nf=o5(Z3(),1);var GX={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};var HX=nf.forwardRef(({color:g="currentColor",size:x=24,strokeWidth:Y=2,absoluteStrokeWidth:G,className:U="",children:Z,iconNode:l,...N},P)=>nf.createElement("svg",{ref:P,...GX,width:x,height:x,stroke:g,strokeWidth:G?Number(Y)*24/Number(x):Y,className:JZ("lucide",U),...!Z&&!JX(N)&&{"aria-hidden":"true"},...N},[...l.map(([w1,H1])=>nf.createElement(w1,H1)),...Array.isArray(Z)?Z:[Z]]));var G5=(g,x)=>{let Y=GZ.forwardRef(({className:G,...U},Z)=>GZ.createElement(HX,{ref:Z,iconNode:x,className:JZ(`lucide-${vX(BJ(g))}`,`lucide-${g}`,G),...U}));return Y.displayName=BJ(g),Y};var aF=[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]],sf=G5("bug",aF);var rF=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],tf=G5("chevron-down",rF);var oF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],B8=G5("circle-check",oF);var nF=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["path",{d:"M20 12v5",key:"12wsvk"}],["path",{d:"M20 21h.01",key:"1p6o6n"}],["path",{d:"M21.25 8.2A10 10 0 1 0 16 21.16",key:"17fp9f"}]],ef=G5("clock-alert",nF);var sF=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],wz=G5("compass",sF);var iF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],bz=G5("info",iF);var tF=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],U7=G5("loader-circle",tF);var eF=[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}]],gz=G5("locate",eF);var wK=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["path",{d:"m14.5 7.5-5 5",key:"3lb6iw"}],["path",{d:"m9.5 7.5 5 5",key:"ko136h"}]],fz=G5("map-pin-x-inside",wK);var bK=[["path",{d:"M19.752 11.901A7.78 7.78 0 0 0 20 10a8 8 0 0 0-16 0c0 4.993 5.539 10.193 7.399 11.799a1 1 0 0 0 1.202 0 19 19 0 0 0 .09-.077",key:"y0ewhp"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"m21.5 15.5-5 5",key:"11iqnx"}],["path",{d:"m21.5 20.5-5-5",key:"1bylgx"}]],zz=G5("map-pin-x",bK);var gK=[["path",{d:"M5 12h14",key:"1ays0h"}]],xz=G5("minus",gK);var fK=[["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"M2.586 16.726A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2h6.624a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586z",key:"2d38gg"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],A8=G5("octagon-x",fK);var zK=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],qz=G5("plus",zK);var xK=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],M8=G5("triangle-alert",xK);var f4=o5(Z3(),1),qK=(g,x,Y,G,U,Z,l,N)=>{let P=document.documentElement,w1=["light","dark"];function H1(u){(Array.isArray(g)?g:[g]).forEach((R1)=>{let P1=R1==="class",s1=P1&&Z?U.map((f1)=>Z[f1]||f1):U;P1?(P.classList.remove(...s1),P.classList.add(Z&&Z[u]?Z[u]:u)):P.setAttribute(R1,u)}),r(u)}function r(u){N&&w1.includes(u)&&(P.style.colorScheme=u)}function z1(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(G)H1(G);else try{let u=localStorage.getItem(x)||Y,R1=l&&u==="system"?z1():u;H1(R1)}catch(u){}};var ZK=f4.createContext(void 0),YK={setTheme:(g)=>{},themes:[]},UX=()=>{var g;return(g=f4.useContext(ZK))!=null?g:YK};var RC=f4.memo(({forcedTheme:g,storageKey:x,attribute:Y,enableSystem:G,enableColorScheme:U,defaultTheme:Z,value:l,themes:N,nonce:P,scriptProps:w1})=>{let H1=JSON.stringify([Y,x,Z,g,N,l,G,U]).slice(1,-1);return f4.createElement("script",{...w1,suppressHydrationWarning:!0,nonce:typeof window>"u"?P:"",dangerouslySetInnerHTML:{__html:`(${qK.toString()})(${H1})`}})});var p1=o5(Z3(),1),MX=o5(Ex(),1);function kK(g){if(!g||typeof document>"u")return;let x=document.head||document.getElementsByTagName("head")[0],Y=document.createElement("style");Y.type="text/css",x.appendChild(Y),Y.styleSheet?Y.styleSheet.cssText=g:Y.appendChild(document.createTextNode(g))}var vK=(g)=>{switch(g){case"success":return HK;case"info":return BK;case"warning":return UK;case"error":return AK;default:return null}},JK=Array(12).fill(0),GK=({visible:g,className:x})=>{return p1.default.createElement("div",{className:["sonner-loading-wrapper",x].filter(Boolean).join(" "),"data-visible":g},p1.default.createElement("div",{className:"sonner-spinner"},JK.map((Y,G)=>p1.default.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${G}`}))))},HK=p1.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},p1.default.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),UK=p1.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},p1.default.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),BK=p1.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},p1.default.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),AK=p1.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},p1.default.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),MK=p1.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},p1.default.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),p1.default.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),XK=()=>{let[g,x]=p1.default.useState(document.hidden);return p1.default.useEffect(()=>{let Y=()=>{x(document.hidden)};return document.addEventListener("visibilitychange",Y),()=>window.removeEventListener("visibilitychange",Y)},[]),g},AJ=1;class XX{constructor(){this.subscribe=(g)=>{return this.subscribers.push(g),()=>{let x=this.subscribers.indexOf(g);this.subscribers.splice(x,1)}},this.publish=(g)=>{this.subscribers.forEach((x)=>x(g))},this.addToast=(g)=>{this.publish(g),this.toasts=[...this.toasts,g]},this.create=(g)=>{var x;let{message:Y,...G}=g,U=typeof(g==null?void 0:g.id)==="number"||((x=g.id)==null?void 0:x.length)>0?g.id:AJ++,Z=this.toasts.find((N)=>{return N.id===U}),l=g.dismissible===void 0?!0:g.dismissible;if(this.dismissedToasts.has(U))this.dismissedToasts.delete(U);if(Z)this.toasts=this.toasts.map((N)=>{if(N.id===U)return this.publish({...N,...g,id:U,title:Y}),{...N,...g,id:U,dismissible:l,title:Y};return N});else this.addToast({title:Y,...G,dismissible:l,id:U});return U},this.dismiss=(g)=>{if(g)this.dismissedToasts.add(g),requestAnimationFrame(()=>this.subscribers.forEach((x)=>x({id:g,dismiss:!0})));else this.toasts.forEach((x)=>{this.subscribers.forEach((Y)=>Y({id:x.id,dismiss:!0}))});return g},this.message=(g,x)=>{return this.create({...x,message:g})},this.error=(g,x)=>{return this.create({...x,message:g,type:"error"})},this.success=(g,x)=>{return this.create({...x,type:"success",message:g})},this.info=(g,x)=>{return this.create({...x,type:"info",message:g})},this.warning=(g,x)=>{return this.create({...x,type:"warning",message:g})},this.loading=(g,x)=>{return this.create({...x,type:"loading",message:g})},this.promise=(g,x)=>{if(!x)return;let Y=void 0;if(x.loading!==void 0)Y=this.create({...x,promise:g,type:"loading",message:x.loading,description:typeof x.description!=="function"?x.description:void 0});let G=Promise.resolve(g instanceof Function?g():g),U=Y!==void 0,Z,l=G.then(async(P)=>{if(Z=["resolve",P],p1.default.isValidElement(P))U=!1,this.create({id:Y,type:"default",message:P});else if(VK(P)&&!P.ok){U=!1;let H1=typeof x.error==="function"?await x.error(`HTTP error! status: ${P.status}`):x.error,r=typeof x.description==="function"?await x.description(`HTTP error! status: ${P.status}`):x.description,u=typeof H1==="object"&&!p1.default.isValidElement(H1)?H1:{message:H1};this.create({id:Y,type:"error",description:r,...u})}else if(P instanceof Error){U=!1;let H1=typeof x.error==="function"?await x.error(P):x.error,r=typeof x.description==="function"?await x.description(P):x.description,u=typeof H1==="object"&&!p1.default.isValidElement(H1)?H1:{message:H1};this.create({id:Y,type:"error",description:r,...u})}else if(x.success!==void 0){U=!1;let H1=typeof x.success==="function"?await x.success(P):x.success,r=typeof x.description==="function"?await x.description(P):x.description,u=typeof H1==="object"&&!p1.default.isValidElement(H1)?H1:{message:H1};this.create({id:Y,type:"success",description:r,...u})}}).catch(async(P)=>{if(Z=["reject",P],x.error!==void 0){U=!1;let w1=typeof x.error==="function"?await x.error(P):x.error,H1=typeof x.description==="function"?await x.description(P):x.description,z1=typeof w1==="object"&&!p1.default.isValidElement(w1)?w1:{message:w1};this.create({id:Y,type:"error",description:H1,...z1})}}).finally(()=>{if(U)this.dismiss(Y),Y=void 0;x.finally==null||x.finally.call(x)}),N=()=>new Promise((P,w1)=>l.then(()=>Z[0]==="reject"?w1(Z[1]):P(Z[1])).catch(w1));if(typeof Y!=="string"&&typeof Y!=="number")return{unwrap:N};else return Object.assign(Y,{unwrap:N})},this.custom=(g,x)=>{let Y=(x==null?void 0:x.id)||AJ++;return this.create({jsx:g(Y),id:Y,...x}),Y},this.getActiveToasts=()=>{return this.toasts.filter((g)=>!this.dismissedToasts.has(g.id))},this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}var S3=new XX,QK=(g,x)=>{let Y=(x==null?void 0:x.id)||AJ++;return S3.addToast({title:g,...x,id:Y}),Y},VK=(g)=>{return g&&typeof g==="object"&&"ok"in g&&typeof g.ok==="boolean"&&"status"in g&&typeof g.status==="number"},LK=QK,WK=()=>S3.toasts,hK=()=>S3.getActiveToasts(),QX=Object.assign(LK,{success:S3.success,info:S3.info,warning:S3.warning,error:S3.error,custom:S3.custom,message:S3.message,promise:S3.promise,dismiss:S3.dismiss,loading:S3.loading},{getHistory:WK,getToasts:hK});kK("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function HZ(g){return g.label!==void 0}var FK=3,KK="24px",lK="16px",BX=4000,CK=356,DK=14,dK=45,OK=200;function B7(...g){return g.filter(Boolean).join(" ")}function yK(g){let[x,Y]=g.split("-"),G=[];if(x)G.push(x);if(Y)G.push(Y);return G}var RK=(g)=>{var x,Y,G,U,Z,l,N,P,w1;let{invert:H1,toast:r,unstyled:z1,interacting:u,setHeights:R1,visibleToasts:P1,heights:s1,index:f1,toasts:Y1,expanded:B1,removeToast:F1,defaultRichColors:i1,closeButton:k0,style:r1,cancelButtonStyle:$1,actionButtonStyle:q0,className:G0="",descriptionClassName:T5="",duration:i5,position:X5,gap:A2,expandByDefault:y5,classNames:C0,icons:J0,closeButtonAriaLabel:b0="Close toast"}=g,[W5,Q5]=p1.default.useState(null),[R5,s2]=p1.default.useState(null),[Z0,U0]=p1.default.useState(!1),[P0,s0]=p1.default.useState(!1),[j0,a0]=p1.default.useState(!1),[M2,h5]=p1.default.useState(!1),[d2,r0]=p1.default.useState(!1),[g5,i2]=p1.default.useState(0),[z4,Q3]=p1.default.useState(0),O2=p1.default.useRef(r.duration||i5||BX),x4=p1.default.useRef(null),E5=p1.default.useRef(null),T3=f1===0,Y3=f1+1<=P1,u5=r.type,t2=r.dismissible!==!1,e2=r.className||"",c4=r.descriptionClassName||"",$3=p1.default.useMemo(()=>s1.findIndex((N1)=>N1.toastId===r.id)||0,[s1,r.id]),V3=p1.default.useMemo(()=>{var N1;return(N1=r.closeButton)!=null?N1:k0},[r.closeButton,k0]),I=p1.default.useMemo(()=>r.duration||i5||BX,[r.duration,i5]),S=p1.default.useRef(0),m=p1.default.useRef(0),e=p1.default.useRef(0),b1=p1.default.useRef(null),[J1,A1]=X5.split("-"),v1=p1.default.useMemo(()=>{return s1.reduce((N1,v0,M0)=>{if(M0>=$3)return N1;return N1+v0.height},0)},[s1,$3]),X1=XK(),l1=r.invert||H1,C1=u5==="loading";m.current=p1.default.useMemo(()=>$3*A2+v1,[$3,v1]),p1.default.useEffect(()=>{O2.current=I},[I]),p1.default.useEffect(()=>{U0(!0)},[]),p1.default.useEffect(()=>{let N1=E5.current;if(N1){let v0=N1.getBoundingClientRect().height;return Q3(v0),R1((M0)=>[{toastId:r.id,height:v0,position:r.position},...M0]),()=>R1((M0)=>M0.filter((e0)=>e0.toastId!==r.id))}},[R1,r.id]),p1.default.useLayoutEffect(()=>{if(!Z0)return;let N1=E5.current,v0=N1.style.height;N1.style.height="auto";let M0=N1.getBoundingClientRect().height;N1.style.height=v0,Q3(M0),R1((e0)=>{if(!e0.find((m0)=>m0.toastId===r.id))return[{toastId:r.id,height:M0,position:r.position},...e0];else return e0.map((m0)=>m0.toastId===r.id?{...m0,height:M0}:m0)})},[Z0,r.title,r.description,R1,r.id,r.jsx,r.action,r.cancel]);let m1=p1.default.useCallback(()=>{s0(!0),i2(m.current),R1((N1)=>N1.filter((v0)=>v0.toastId!==r.id)),setTimeout(()=>{F1(r)},OK)},[r,F1,R1,m]);p1.default.useEffect(()=>{if(r.promise&&u5==="loading"||r.duration===1/0||r.type==="loading")return;let N1,v0=()=>{if(e.current<S.current){let e0=new Date().getTime()-S.current;O2.current=O2.current-e0}e.current=new Date().getTime()},M0=()=>{if(O2.current===1/0)return;S.current=new Date().getTime(),N1=setTimeout(()=>{r.onAutoClose==null||r.onAutoClose.call(r,r),m1()},O2.current)};if(B1||u||X1)v0();else M0();return()=>clearTimeout(N1)},[B1,u,r,u5,X1,m1]),p1.default.useEffect(()=>{if(r.delete)m1(),r.onDismiss==null||r.onDismiss.call(r,r)},[m1,r.delete]);function w0(){var N1;if(J0==null?void 0:J0.loading){var v0;return p1.default.createElement("div",{className:B7(C0==null?void 0:C0.loader,r==null?void 0:(v0=r.classNames)==null?void 0:v0.loader,"sonner-loader"),"data-visible":u5==="loading"},J0.loading)}return p1.default.createElement(GK,{className:B7(C0==null?void 0:C0.loader,r==null?void 0:(N1=r.classNames)==null?void 0:N1.loader),visible:u5==="loading"})}let M1=r.icon||(J0==null?void 0:J0[u5])||vK(u5);var y0,i0;return p1.default.createElement("li",{tabIndex:0,ref:E5,className:B7(G0,e2,C0==null?void 0:C0.toast,r==null?void 0:(x=r.classNames)==null?void 0:x.toast,C0==null?void 0:C0.default,C0==null?void 0:C0[u5],r==null?void 0:(Y=r.classNames)==null?void 0:Y[u5]),"data-sonner-toast":"","data-rich-colors":(y0=r.richColors)!=null?y0:i1,"data-styled":!Boolean(r.jsx||r.unstyled||z1),"data-mounted":Z0,"data-promise":Boolean(r.promise),"data-swiped":d2,"data-removed":P0,"data-visible":Y3,"data-y-position":J1,"data-x-position":A1,"data-index":f1,"data-front":T3,"data-swiping":j0,"data-dismissible":t2,"data-type":u5,"data-invert":l1,"data-swipe-out":M2,"data-swipe-direction":R5,"data-expanded":Boolean(B1||y5&&Z0),"data-testid":r.testId,style:{"--index":f1,"--toasts-before":f1,"--z-index":Y1.length-f1,"--offset":`${P0?g5:m.current}px`,"--initial-height":y5?"auto":`${z4}px`,...r1,...r.style},onDragEnd:()=>{a0(!1),Q5(null),b1.current=null},onPointerDown:(N1)=>{if(N1.button===2)return;if(C1||!t2)return;if(x4.current=new Date,i2(m.current),N1.target.setPointerCapture(N1.pointerId),N1.target.tagName==="BUTTON")return;a0(!0),b1.current={x:N1.clientX,y:N1.clientY}},onPointerUp:()=>{var N1,v0,M0;if(M2||!t2)return;b1.current=null;let e0=Number(((N1=E5.current)==null?void 0:N1.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),F5=Number(((v0=E5.current)==null?void 0:v0.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),m0=new Date().getTime()-((M0=x4.current)==null?void 0:M0.getTime()),D0=W5==="x"?e0:F5,z5=Math.abs(D0)/m0;if(Math.abs(D0)>=dK||z5>0.11){if(i2(m.current),r.onDismiss==null||r.onDismiss.call(r,r),W5==="x")s2(e0>0?"right":"left");else s2(F5>0?"down":"up");m1(),h5(!0);return}else{var L0,d1;(L0=E5.current)==null||L0.style.setProperty("--swipe-amount-x","0px"),(d1=E5.current)==null||d1.style.setProperty("--swipe-amount-y","0px")}r0(!1),a0(!1),Q5(null)},onPointerMove:(N1)=>{var v0,M0,e0;if(!b1.current||!t2)return;if(((v0=window.getSelection())==null?void 0:v0.toString().length)>0)return;let m0=N1.clientY-b1.current.y,D0=N1.clientX-b1.current.x;var z5;let L0=(z5=g.swipeDirections)!=null?z5:yK(X5);if(!W5&&(Math.abs(D0)>1||Math.abs(m0)>1))Q5(Math.abs(D0)>Math.abs(m0)?"x":"y");let d1={x:0,y:0},w3=(V5)=>{return 1/(1.5+Math.abs(V5)/20)};if(W5==="y"){if(L0.includes("top")||L0.includes("bottom"))if(L0.includes("top")&&m0<0||L0.includes("bottom")&&m0>0)d1.y=m0;else{let V5=m0*w3(m0);d1.y=Math.abs(V5)<Math.abs(m0)?V5:m0}}else if(W5==="x"){if(L0.includes("left")||L0.includes("right"))if(L0.includes("left")&&D0<0||L0.includes("right")&&D0>0)d1.x=D0;else{let V5=D0*w3(D0);d1.x=Math.abs(V5)<Math.abs(D0)?V5:D0}}if(Math.abs(d1.x)>0||Math.abs(d1.y)>0)r0(!0);(M0=E5.current)==null||M0.style.setProperty("--swipe-amount-x",`${d1.x}px`),(e0=E5.current)==null||e0.style.setProperty("--swipe-amount-y",`${d1.y}px`)}},V3&&!r.jsx&&u5!=="loading"?p1.default.createElement("button",{"aria-label":b0,"data-disabled":C1,"data-close-button":!0,onClick:C1||!t2?()=>{}:()=>{m1(),r.onDismiss==null||r.onDismiss.call(r,r)},className:B7(C0==null?void 0:C0.closeButton,r==null?void 0:(G=r.classNames)==null?void 0:G.closeButton)},(i0=J0==null?void 0:J0.close)!=null?i0:MK):null,(u5||r.icon||r.promise)&&r.icon!==null&&((J0==null?void 0:J0[u5])!==null||r.icon)?p1.default.createElement("div",{"data-icon":"",className:B7(C0==null?void 0:C0.icon,r==null?void 0:(U=r.classNames)==null?void 0:U.icon)},r.promise||r.type==="loading"&&!r.icon?r.icon||w0():null,r.type!=="loading"?M1:null):null,p1.default.createElement("div",{"data-content":"",className:B7(C0==null?void 0:C0.content,r==null?void 0:(Z=r.classNames)==null?void 0:Z.content)},p1.default.createElement("div",{"data-title":"",className:B7(C0==null?void 0:C0.title,r==null?void 0:(l=r.classNames)==null?void 0:l.title)},r.jsx?r.jsx:typeof r.title==="function"?r.title():r.title),r.description?p1.default.createElement("div",{"data-description":"",className:B7(T5,c4,C0==null?void 0:C0.description,r==null?void 0:(N=r.classNames)==null?void 0:N.description)},typeof r.description==="function"?r.description():r.description):null),p1.default.isValidElement(r.cancel)?r.cancel:r.cancel&&HZ(r.cancel)?p1.default.createElement("button",{"data-button":!0,"data-cancel":!0,style:r.cancelButtonStyle||$1,onClick:(N1)=>{if(!HZ(r.cancel))return;if(!t2)return;r.cancel.onClick==null||r.cancel.onClick.call(r.cancel,N1),m1()},className:B7(C0==null?void 0:C0.cancelButton,r==null?void 0:(P=r.classNames)==null?void 0:P.cancelButton)},r.cancel.label):null,p1.default.isValidElement(r.action)?r.action:r.action&&HZ(r.action)?p1.default.createElement("button",{"data-button":!0,"data-action":!0,style:r.actionButtonStyle||q0,onClick:(N1)=>{if(!HZ(r.action))return;if(r.action.onClick==null||r.action.onClick.call(r.action,N1),N1.defaultPrevented)return;m1()},className:B7(C0==null?void 0:C0.actionButton,r==null?void 0:(w1=r.classNames)==null?void 0:w1.actionButton)},r.action.label):null)};function AX(){if(typeof window>"u")return"ltr";if(typeof document>"u")return"ltr";let g=document.documentElement.getAttribute("dir");if(g==="auto"||!g)return window.getComputedStyle(document.documentElement).direction;return g}function NK(g,x){let Y={};return[g,x].forEach((G,U)=>{let Z=U===1,l=Z?"--mobile-offset":"--offset",N=Z?lK:KK;function P(w1){["top","right","bottom","left"].forEach((H1)=>{Y[`${l}-${H1}`]=typeof w1==="number"?`${w1}px`:w1})}if(typeof G==="number"||typeof G==="string")P(G);else if(typeof G==="object")["top","right","bottom","left"].forEach((w1)=>{if(G[w1]===void 0)Y[`${l}-${w1}`]=N;else Y[`${l}-${w1}`]=typeof G[w1]==="number"?`${G[w1]}px`:G[w1]});else P(N)}),Y}var VX=p1.default.forwardRef(function(x,Y){let{id:G,invert:U,position:Z="bottom-right",hotkey:l=["altKey","KeyT"],expand:N,closeButton:P,className:w1,offset:H1,mobileOffset:r,theme:z1="light",richColors:u,duration:R1,style:P1,visibleToasts:s1=FK,toastOptions:f1,dir:Y1=AX(),gap:B1=DK,icons:F1,containerAriaLabel:i1="Notifications"}=x,[k0,r1]=p1.default.useState([]),$1=p1.default.useMemo(()=>{if(G)return k0.filter((Z0)=>Z0.toasterId===G);return k0.filter((Z0)=>!Z0.toasterId)},[k0,G]),q0=p1.default.useMemo(()=>{return Array.from(new Set([Z].concat($1.filter((Z0)=>Z0.position).map((Z0)=>Z0.position))))},[$1,Z]),[G0,T5]=p1.default.useState([]),[i5,X5]=p1.default.useState(!1),[A2,y5]=p1.default.useState(!1),[C0,J0]=p1.default.useState(z1!=="system"?z1:typeof window<"u"?window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":"light"),b0=p1.default.useRef(null),W5=l.join("+").replace(/Key/g,"").replace(/Digit/g,""),Q5=p1.default.useRef(null),R5=p1.default.useRef(!1),s2=p1.default.useCallback((Z0)=>{r1((U0)=>{var P0;if(!((P0=U0.find((s0)=>s0.id===Z0.id))==null?void 0:P0.delete))S3.dismiss(Z0.id);return U0.filter(({id:s0})=>s0!==Z0.id)})},[]);return p1.default.useEffect(()=>{return S3.subscribe((Z0)=>{if(Z0.dismiss){requestAnimationFrame(()=>{r1((U0)=>U0.map((P0)=>P0.id===Z0.id?{...P0,delete:!0}:P0))});return}setTimeout(()=>{MX.default.flushSync(()=>{r1((U0)=>{let P0=U0.findIndex((s0)=>s0.id===Z0.id);if(P0!==-1)return[...U0.slice(0,P0),{...U0[P0],...Z0},...U0.slice(P0+1)];return[Z0,...U0]})})})})},[k0]),p1.default.useEffect(()=>{if(z1!=="system"){J0(z1);return}if(z1==="system")if(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches)J0("dark");else J0("light");if(typeof window>"u")return;let Z0=window.matchMedia("(prefers-color-scheme: dark)");try{Z0.addEventListener("change",({matches:U0})=>{if(U0)J0("dark");else J0("light")})}catch(U0){Z0.addListener(({matches:P0})=>{try{if(P0)J0("dark");else J0("light")}catch(s0){console.error(s0)}})}},[z1]),p1.default.useEffect(()=>{if(k0.length<=1)X5(!1)},[k0]),p1.default.useEffect(()=>{let Z0=(U0)=>{var P0;if(l.every((a0)=>U0[a0]||U0.code===a0)){var j0;X5(!0),(j0=b0.current)==null||j0.focus()}if(U0.code==="Escape"&&(document.activeElement===b0.current||((P0=b0.current)==null?void 0:P0.contains(document.activeElement))))X5(!1)};return document.addEventListener("keydown",Z0),()=>document.removeEventListener("keydown",Z0)},[l]),p1.default.useEffect(()=>{if(b0.current)return()=>{if(Q5.current)Q5.current.focus({preventScroll:!0}),Q5.current=null,R5.current=!1}},[b0.current]),p1.default.createElement("section",{ref:Y,"aria-label":`${i1} ${W5}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},q0.map((Z0,U0)=>{var P0;let[s0,j0]=Z0.split("-");if(!$1.length)return null;return p1.default.createElement("ol",{key:Z0,dir:Y1==="auto"?AX():Y1,tabIndex:-1,ref:b0,className:w1,"data-sonner-toaster":!0,"data-sonner-theme":C0,"data-y-position":s0,"data-x-position":j0,style:{"--front-toast-height":`${((P0=G0[0])==null?void 0:P0.height)||0}px`,"--width":`${CK}px`,"--gap":`${B1}px`,...P1,...NK(H1,r)},onBlur:(a0)=>{if(R5.current&&!a0.currentTarget.contains(a0.relatedTarget)){if(R5.current=!1,Q5.current)Q5.current.focus({preventScroll:!0}),Q5.current=null}},onFocus:(a0)=>{if(a0.target instanceof HTMLElement&&a0.target.dataset.dismissible==="false")return;if(!R5.current)R5.current=!0,Q5.current=a0.relatedTarget},onMouseEnter:()=>X5(!0),onMouseMove:()=>X5(!0),onMouseLeave:()=>{if(!A2)X5(!1)},onDragEnd:()=>X5(!1),onPointerDown:(a0)=>{if(a0.target instanceof HTMLElement&&a0.target.dataset.dismissible==="false")return;y5(!0)},onPointerUp:()=>y5(!1)},$1.filter((a0)=>!a0.position&&U0===0||a0.position===Z0).map((a0,M2)=>{var h5,d2;return p1.default.createElement(RK,{key:a0.id,icons:F1,index:M2,toast:a0,defaultRichColors:u,duration:(h5=f1==null?void 0:f1.duration)!=null?h5:R1,className:f1==null?void 0:f1.className,descriptionClassName:f1==null?void 0:f1.descriptionClassName,invert:U,visibleToasts:s1,closeButton:(d2=f1==null?void 0:f1.closeButton)!=null?d2:P,interacting:A2,position:Z0,style:f1==null?void 0:f1.style,unstyled:f1==null?void 0:f1.unstyled,classNames:f1==null?void 0:f1.classNames,cancelButtonStyle:f1==null?void 0:f1.cancelButtonStyle,actionButtonStyle:f1==null?void 0:f1.actionButtonStyle,closeButtonAriaLabel:f1==null?void 0:f1.closeButtonAriaLabel,removeToast:s2,toasts:$1.filter((r0)=>r0.position==a0.position),heights:G0.filter((r0)=>r0.position==a0.position),setHeights:T5,expandByDefault:N,gap:B1,expanded:i5,swipeDirections:x.swipeDirections})}))}))});var IK=Symbol.for("react.transitional.element"),SK=Symbol.for("react.fragment");function LX(g,x,Y){var G=null;if(Y!==void 0&&(G=""+Y),x.key!==void 0&&(G=""+x.key),"key"in x){Y={};for(var U in x)U!=="key"&&(Y[U]=x[U])}else Y=x;return x=Y.ref,{$$typeof:IK,type:g,key:G,ref:x!==void 0?x:null,props:Y}}var UZ=SK,k1=LX,S5=LX;var WX=({...g})=>{let{theme:x="system"}=UX();return k1(VX,{theme:x,className:"toaster group",icons:{success:k1(B8,{className:"size-4"}),info:k1(bz,{className:"size-4"}),warning:k1(M8,{className:"size-4"}),error:k1(A8,{className:"size-4"}),loading:k1(U7,{className:"size-4 animate-spin"})},style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)","--border-radius":"var(--radius)"},...g})};var Z6=o5(Z3(),1);var hX=Z6.createContext({theme:"system",mode:"dark",setTheme:()=>null});function FX({children:g,defaultTheme:x="system",storageKey:Y="theme",...G}){let[U,Z]=Z6.useState(()=>localStorage.getItem(Y)||x),[l,N]=Z6.useState("dark");Z6.useEffect(()=>{let w1=window.document.documentElement;if(w1.classList.remove("light","dark"),console.log(U),U==="system"){let H1=window.matchMedia("(prefers-color-scheme: dark)"),r=()=>{let z1=H1.matches?"dark":"light";N(z1),w1.classList.add(z1)};return r(),H1.addEventListener("change",r),()=>H1.removeEventListener("change",r)}else N(U),w1.classList.add(U)},[U]);let P={theme:U,mode:l,setTheme:(w1)=>{localStorage.setItem(Y,w1),Z(w1)}};return k1(hX.Provider,{...G,value:P,children:g})}var KX=()=>{let g=Z6.useContext(hX);if(g===void 0)throw Error("useTheme must be used within a ThemeProvider");return g};function MJ({children:g}){return S5(FX,{children:[k1("main",{children:g}),k1(WX,{})]})}function lX(g){var x,Y,G="";if(typeof g=="string"||typeof g=="number")G+=g;else if(typeof g=="object")if(Array.isArray(g)){var U=g.length;for(x=0;x<U;x++)g[x]&&(Y=lX(g[x]))&&(G&&(G+=" "),G+=Y)}else for(Y in g)g[Y]&&(G&&(G+=" "),G+=Y);return G}function BZ(){for(var g,x,Y=0,G="",U=arguments.length;Y<U;Y++)(g=arguments[Y])&&(x=lX(g))&&(G&&(G+=" "),G+=x);return G}var TK=(g)=>{let x=jK(g),{conflictingClassGroups:Y,conflictingClassGroupModifiers:G}=g;return{getClassGroupId:(l)=>{let N=l.split("-");if(N[0]===""&&N.length!==1)N.shift();return yX(N,x)||$K(l)},getConflictingClassGroupIds:(l,N)=>{let P=Y[l]||[];if(N&&G[l])return[...P,...G[l]];return P}}},yX=(g,x)=>{if(g.length===0)return x.classGroupId;let Y=g[0],G=x.nextPart.get(Y),U=G?yX(g.slice(1),G):void 0;if(U)return U;if(x.validators.length===0)return;let Z=g.join("-");return x.validators.find(({validator:l})=>l(Z))?.classGroupId},CX=/^\[(.+)\]$/,$K=(g)=>{if(CX.test(g)){let x=CX.exec(g)[1],Y=x?.substring(0,x.indexOf(":"));if(Y)return"arbitrary.."+Y}},jK=(g)=>{let{theme:x,classGroups:Y}=g,G={nextPart:new Map,validators:[]};for(let U in Y)VJ(Y[U],G,U,x);return G},VJ=(g,x,Y,G)=>{g.forEach((U)=>{if(typeof U==="string"){let Z=U===""?x:DX(x,U);Z.classGroupId=Y;return}if(typeof U==="function"){if(mK(U)){VJ(U(G),x,Y,G);return}x.validators.push({validator:U,classGroupId:Y});return}Object.entries(U).forEach(([Z,l])=>{VJ(l,DX(x,Z),Y,G)})})},DX=(g,x)=>{let Y=g;return x.split("-").forEach((G)=>{if(!Y.nextPart.has(G))Y.nextPart.set(G,{nextPart:new Map,validators:[]});Y=Y.nextPart.get(G)}),Y},mK=(g)=>g.isThemeGetter,_K=(g)=>{if(g<1)return{get:()=>{return},set:()=>{}};let x=0,Y=new Map,G=new Map,U=(Z,l)=>{if(Y.set(Z,l),x++,x>g)x=0,G=Y,Y=new Map};return{get(Z){let l=Y.get(Z);if(l!==void 0)return l;if((l=G.get(Z))!==void 0)return U(Z,l),l},set(Z,l){if(Y.has(Z))Y.set(Z,l);else U(Z,l)}}};var PK=(g)=>{let{prefix:x,experimentalParseClassName:Y}=g,G=(U)=>{let Z=[],l=0,N=0,P=0,w1;for(let R1=0;R1<U.length;R1++){let P1=U[R1];if(l===0&&N===0){if(P1===":"){Z.push(U.slice(P,R1)),P=R1+1;continue}if(P1==="/"){w1=R1;continue}}if(P1==="[")l++;else if(P1==="]")l--;else if(P1==="(")N++;else if(P1===")")N--}let H1=Z.length===0?U:U.substring(P),r=EK(H1),z1=r!==H1,u=w1&&w1>P?w1-P:void 0;return{modifiers:Z,hasImportantModifier:z1,baseClassName:r,maybePostfixModifierPosition:u}};if(x){let U=x+":",Z=G;G=(l)=>l.startsWith(U)?Z(l.substring(U.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:l,maybePostfixModifierPosition:void 0}}if(Y){let U=G;G=(Z)=>Y({className:Z,parseClassName:U})}return G},EK=(g)=>{if(g.endsWith("!"))return g.substring(0,g.length-1);if(g.startsWith("!"))return g.substring(1);return g},uK=(g)=>{let x=Object.fromEntries(g.orderSensitiveModifiers.map((G)=>[G,!0]));return(G)=>{if(G.length<=1)return G;let U=[],Z=[];return G.forEach((l)=>{if(l[0]==="["||x[l])U.push(...Z.sort(),l),Z=[];else Z.push(l)}),U.push(...Z.sort()),U}},pK=(g)=>({cache:_K(g.cacheSize),parseClassName:PK(g),sortModifiers:uK(g),...TK(g)}),cK=/\s+/,aK=(g,x)=>{let{parseClassName:Y,getClassGroupId:G,getConflictingClassGroupIds:U,sortModifiers:Z}=x,l=[],N=g.trim().split(cK),P="";for(let w1=N.length-1;w1>=0;w1-=1){let H1=N[w1],{isExternal:r,modifiers:z1,hasImportantModifier:u,baseClassName:R1,maybePostfixModifierPosition:P1}=Y(H1);if(r){P=H1+(P.length>0?" "+P:P);continue}let s1=!!P1,f1=G(s1?R1.substring(0,P1):R1);if(!f1){if(!s1){P=H1+(P.length>0?" "+P:P);continue}if(f1=G(R1),!f1){P=H1+(P.length>0?" "+P:P);continue}s1=!1}let Y1=Z(z1).join(":"),B1=u?Y1+"!":Y1,F1=B1+f1;if(l.includes(F1))continue;l.push(F1);let i1=U(f1,s1);for(let k0=0;k0<i1.length;++k0){let r1=i1[k0];l.push(B1+r1)}P=H1+(P.length>0?" "+P:P)}return P};function rK(){let g=0,x,Y,G="";while(g<arguments.length)if(x=arguments[g++]){if(Y=RX(x))G&&(G+=" "),G+=Y}return G}var RX=(g)=>{if(typeof g==="string")return g;let x,Y="";for(let G=0;G<g.length;G++)if(g[G]){if(x=RX(g[G]))Y&&(Y+=" "),Y+=x}return Y};function oK(g,...x){let Y,G,U,Z=l;function l(P){let w1=x.reduce((H1,r)=>r(H1),g());return Y=pK(w1),G=Y.cache.get,U=Y.cache.set,Z=N,N(P)}function N(P){let w1=G(P);if(w1)return w1;let H1=aK(P,Y);return U(P,H1),H1}return function(){return Z(rK.apply(null,arguments))}}var l2=(g)=>{let x=(Y)=>Y[g]||[];return x.isThemeGetter=!0,x},NX=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,IX=/^\((?:(\w[\w-]*):)?(.+)\)$/i,nK=/^\d+\/\d+$/,sK=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,iK=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,tK=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,eK=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,wl=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,yb=(g)=>nK.test(g),_0=(g)=>!!g&&!Number.isNaN(Number(g)),X8=(g)=>!!g&&Number.isInteger(Number(g)),XJ=(g)=>g.endsWith("%")&&_0(g.slice(0,-1)),Y6=(g)=>sK.test(g),bl=()=>!0,gl=(g)=>iK.test(g)&&!tK.test(g),SX=()=>!1,fl=(g)=>eK.test(g),zl=(g)=>wl.test(g),xl=(g)=>!f0(g)&&!z0(g),ql=(g)=>Rb(g,jX,SX),f0=(g)=>NX.test(g),I9=(g)=>Rb(g,mX,gl),QJ=(g)=>Rb(g,Jl,_0),dX=(g)=>Rb(g,TX,SX),Zl=(g)=>Rb(g,$X,zl),AZ=(g)=>Rb(g,_X,fl),z0=(g)=>IX.test(g),Zz=(g)=>Nb(g,mX),Yl=(g)=>Nb(g,Gl),OX=(g)=>Nb(g,TX),kl=(g)=>Nb(g,jX),vl=(g)=>Nb(g,$X),MZ=(g)=>Nb(g,_X,!0),Rb=(g,x,Y)=>{let G=NX.exec(g);if(G){if(G[1])return x(G[1]);return Y(G[2])}return!1},Nb=(g,x,Y=!1)=>{let G=IX.exec(g);if(G){if(G[1])return x(G[1]);return Y}return!1},TX=(g)=>g==="position"||g==="percentage",$X=(g)=>g==="image"||g==="url",jX=(g)=>g==="length"||g==="size"||g==="bg-size",mX=(g)=>g==="length",Jl=(g)=>g==="number",Gl=(g)=>g==="family-name",_X=(g)=>g==="shadow";var Hl=()=>{let g=l2("color"),x=l2("font"),Y=l2("text"),G=l2("font-weight"),U=l2("tracking"),Z=l2("leading"),l=l2("breakpoint"),N=l2("container"),P=l2("spacing"),w1=l2("radius"),H1=l2("shadow"),r=l2("inset-shadow"),z1=l2("text-shadow"),u=l2("drop-shadow"),R1=l2("blur"),P1=l2("perspective"),s1=l2("aspect"),f1=l2("ease"),Y1=l2("animate"),B1=()=>["auto","avoid","all","avoid-page","page","left","right","column"],F1=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],i1=()=>[...F1(),z0,f0],k0=()=>["auto","hidden","clip","visible","scroll"],r1=()=>["auto","contain","none"],$1=()=>[z0,f0,P],q0=()=>[yb,"full","auto",...$1()],G0=()=>[X8,"none","subgrid",z0,f0],T5=()=>["auto",{span:["full",X8,z0,f0]},X8,z0,f0],i5=()=>[X8,"auto",z0,f0],X5=()=>["auto","min","max","fr",z0,f0],A2=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],y5=()=>["start","end","center","stretch","center-safe","end-safe"],C0=()=>["auto",...$1()],J0=()=>[yb,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...$1()],b0=()=>[g,z0,f0],W5=()=>[...F1(),OX,dX,{position:[z0,f0]}],Q5=()=>["no-repeat",{repeat:["","x","y","space","round"]}],R5=()=>["auto","cover","contain",kl,ql,{size:[z0,f0]}],s2=()=>[XJ,Zz,I9],Z0=()=>["","none","full",w1,z0,f0],U0=()=>["",_0,Zz,I9],P0=()=>["solid","dashed","dotted","double"],s0=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],j0=()=>[_0,XJ,OX,dX],a0=()=>["","none",R1,z0,f0],M2=()=>["none",_0,z0,f0],h5=()=>["none",_0,z0,f0],d2=()=>[_0,z0,f0],r0=()=>[yb,"full",...$1()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Y6],breakpoint:[Y6],color:[bl],container:[Y6],"drop-shadow":[Y6],ease:["in","out","in-out"],font:[xl],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Y6],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Y6],shadow:[Y6],spacing:["px",_0],text:[Y6],"text-shadow":[Y6],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",yb,f0,z0,s1]}],container:["container"],columns:[{columns:[_0,f0,z0,N]}],"break-after":[{"break-after":B1()}],"break-before":[{"break-before":B1()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:i1()}],overflow:[{overflow:k0()}],"overflow-x":[{"overflow-x":k0()}],"overflow-y":[{"overflow-y":k0()}],overscroll:[{overscroll:r1()}],"overscroll-x":[{"overscroll-x":r1()}],"overscroll-y":[{"overscroll-y":r1()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:q0()}],"inset-x":[{"inset-x":q0()}],"inset-y":[{"inset-y":q0()}],start:[{start:q0()}],end:[{end:q0()}],top:[{top:q0()}],right:[{right:q0()}],bottom:[{bottom:q0()}],left:[{left:q0()}],visibility:["visible","invisible","collapse"],z:[{z:[X8,"auto",z0,f0]}],basis:[{basis:[yb,"full","auto",N,...$1()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[_0,yb,"auto","initial","none",f0]}],grow:[{grow:["",_0,z0,f0]}],shrink:[{shrink:["",_0,z0,f0]}],order:[{order:[X8,"first","last","none",z0,f0]}],"grid-cols":[{"grid-cols":G0()}],"col-start-end":[{col:T5()}],"col-start":[{"col-start":i5()}],"col-end":[{"col-end":i5()}],"grid-rows":[{"grid-rows":G0()}],"row-start-end":[{row:T5()}],"row-start":[{"row-start":i5()}],"row-end":[{"row-end":i5()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":X5()}],"auto-rows":[{"auto-rows":X5()}],gap:[{gap:$1()}],"gap-x":[{"gap-x":$1()}],"gap-y":[{"gap-y":$1()}],"justify-content":[{justify:[...A2(),"normal"]}],"justify-items":[{"justify-items":[...y5(),"normal"]}],"justify-self":[{"justify-self":["auto",...y5()]}],"align-content":[{content:["normal",...A2()]}],"align-items":[{items:[...y5(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...y5(),{baseline:["","last"]}]}],"place-content":[{"place-content":A2()}],"place-items":[{"place-items":[...y5(),"baseline"]}],"place-self":[{"place-self":["auto",...y5()]}],p:[{p:$1()}],px:[{px:$1()}],py:[{py:$1()}],ps:[{ps:$1()}],pe:[{pe:$1()}],pt:[{pt:$1()}],pr:[{pr:$1()}],pb:[{pb:$1()}],pl:[{pl:$1()}],m:[{m:C0()}],mx:[{mx:C0()}],my:[{my:C0()}],ms:[{ms:C0()}],me:[{me:C0()}],mt:[{mt:C0()}],mr:[{mr:C0()}],mb:[{mb:C0()}],ml:[{ml:C0()}],"space-x":[{"space-x":$1()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":$1()}],"space-y-reverse":["space-y-reverse"],size:[{size:J0()}],w:[{w:[N,"screen",...J0()]}],"min-w":[{"min-w":[N,"screen","none",...J0()]}],"max-w":[{"max-w":[N,"screen","none","prose",{screen:[l]},...J0()]}],h:[{h:["screen","lh",...J0()]}],"min-h":[{"min-h":["screen","lh","none",...J0()]}],"max-h":[{"max-h":["screen","lh",...J0()]}],"font-size":[{text:["base",Y,Zz,I9]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[G,z0,QJ]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",XJ,f0]}],"font-family":[{font:[Yl,f0,x]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[U,z0,f0]}],"line-clamp":[{"line-clamp":[_0,"none",z0,QJ]}],leading:[{leading:[Z,...$1()]}],"list-image":[{"list-image":["none",z0,f0]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",z0,f0]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:b0()}],"text-color":[{text:b0()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...P0(),"wavy"]}],"text-decoration-thickness":[{decoration:[_0,"from-font","auto",z0,I9]}],"text-decoration-color":[{decoration:b0()}],"underline-offset":[{"underline-offset":[_0,"auto",z0,f0]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:$1()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",z0,f0]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",z0,f0]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:W5()}],"bg-repeat":[{bg:Q5()}],"bg-size":[{bg:R5()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},X8,z0,f0],radial:["",z0,f0],conic:[X8,z0,f0]},vl,Zl]}],"bg-color":[{bg:b0()}],"gradient-from-pos":[{from:s2()}],"gradient-via-pos":[{via:s2()}],"gradient-to-pos":[{to:s2()}],"gradient-from":[{from:b0()}],"gradient-via":[{via:b0()}],"gradient-to":[{to:b0()}],rounded:[{rounded:Z0()}],"rounded-s":[{"rounded-s":Z0()}],"rounded-e":[{"rounded-e":Z0()}],"rounded-t":[{"rounded-t":Z0()}],"rounded-r":[{"rounded-r":Z0()}],"rounded-b":[{"rounded-b":Z0()}],"rounded-l":[{"rounded-l":Z0()}],"rounded-ss":[{"rounded-ss":Z0()}],"rounded-se":[{"rounded-se":Z0()}],"rounded-ee":[{"rounded-ee":Z0()}],"rounded-es":[{"rounded-es":Z0()}],"rounded-tl":[{"rounded-tl":Z0()}],"rounded-tr":[{"rounded-tr":Z0()}],"rounded-br":[{"rounded-br":Z0()}],"rounded-bl":[{"rounded-bl":Z0()}],"border-w":[{border:U0()}],"border-w-x":[{"border-x":U0()}],"border-w-y":[{"border-y":U0()}],"border-w-s":[{"border-s":U0()}],"border-w-e":[{"border-e":U0()}],"border-w-t":[{"border-t":U0()}],"border-w-r":[{"border-r":U0()}],"border-w-b":[{"border-b":U0()}],"border-w-l":[{"border-l":U0()}],"divide-x":[{"divide-x":U0()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":U0()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...P0(),"hidden","none"]}],"divide-style":[{divide:[...P0(),"hidden","none"]}],"border-color":[{border:b0()}],"border-color-x":[{"border-x":b0()}],"border-color-y":[{"border-y":b0()}],"border-color-s":[{"border-s":b0()}],"border-color-e":[{"border-e":b0()}],"border-color-t":[{"border-t":b0()}],"border-color-r":[{"border-r":b0()}],"border-color-b":[{"border-b":b0()}],"border-color-l":[{"border-l":b0()}],"divide-color":[{divide:b0()}],"outline-style":[{outline:[...P0(),"none","hidden"]}],"outline-offset":[{"outline-offset":[_0,z0,f0]}],"outline-w":[{outline:["",_0,Zz,I9]}],"outline-color":[{outline:b0()}],shadow:[{shadow:["","none",H1,MZ,AZ]}],"shadow-color":[{shadow:b0()}],"inset-shadow":[{"inset-shadow":["none",r,MZ,AZ]}],"inset-shadow-color":[{"inset-shadow":b0()}],"ring-w":[{ring:U0()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:b0()}],"ring-offset-w":[{"ring-offset":[_0,I9]}],"ring-offset-color":[{"ring-offset":b0()}],"inset-ring-w":[{"inset-ring":U0()}],"inset-ring-color":[{"inset-ring":b0()}],"text-shadow":[{"text-shadow":["none",z1,MZ,AZ]}],"text-shadow-color":[{"text-shadow":b0()}],opacity:[{opacity:[_0,z0,f0]}],"mix-blend":[{"mix-blend":[...s0(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":s0()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[_0]}],"mask-image-linear-from-pos":[{"mask-linear-from":j0()}],"mask-image-linear-to-pos":[{"mask-linear-to":j0()}],"mask-image-linear-from-color":[{"mask-linear-from":b0()}],"mask-image-linear-to-color":[{"mask-linear-to":b0()}],"mask-image-t-from-pos":[{"mask-t-from":j0()}],"mask-image-t-to-pos":[{"mask-t-to":j0()}],"mask-image-t-from-color":[{"mask-t-from":b0()}],"mask-image-t-to-color":[{"mask-t-to":b0()}],"mask-image-r-from-pos":[{"mask-r-from":j0()}],"mask-image-r-to-pos":[{"mask-r-to":j0()}],"mask-image-r-from-color":[{"mask-r-from":b0()}],"mask-image-r-to-color":[{"mask-r-to":b0()}],"mask-image-b-from-pos":[{"mask-b-from":j0()}],"mask-image-b-to-pos":[{"mask-b-to":j0()}],"mask-image-b-from-color":[{"mask-b-from":b0()}],"mask-image-b-to-color":[{"mask-b-to":b0()}],"mask-image-l-from-pos":[{"mask-l-from":j0()}],"mask-image-l-to-pos":[{"mask-l-to":j0()}],"mask-image-l-from-color":[{"mask-l-from":b0()}],"mask-image-l-to-color":[{"mask-l-to":b0()}],"mask-image-x-from-pos":[{"mask-x-from":j0()}],"mask-image-x-to-pos":[{"mask-x-to":j0()}],"mask-image-x-from-color":[{"mask-x-from":b0()}],"mask-image-x-to-color":[{"mask-x-to":b0()}],"mask-image-y-from-pos":[{"mask-y-from":j0()}],"mask-image-y-to-pos":[{"mask-y-to":j0()}],"mask-image-y-from-color":[{"mask-y-from":b0()}],"mask-image-y-to-color":[{"mask-y-to":b0()}],"mask-image-radial":[{"mask-radial":[z0,f0]}],"mask-image-radial-from-pos":[{"mask-radial-from":j0()}],"mask-image-radial-to-pos":[{"mask-radial-to":j0()}],"mask-image-radial-from-color":[{"mask-radial-from":b0()}],"mask-image-radial-to-color":[{"mask-radial-to":b0()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":F1()}],"mask-image-conic-pos":[{"mask-conic":[_0]}],"mask-image-conic-from-pos":[{"mask-conic-from":j0()}],"mask-image-conic-to-pos":[{"mask-conic-to":j0()}],"mask-image-conic-from-color":[{"mask-conic-from":b0()}],"mask-image-conic-to-color":[{"mask-conic-to":b0()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:W5()}],"mask-repeat":[{mask:Q5()}],"mask-size":[{mask:R5()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",z0,f0]}],filter:[{filter:["","none",z0,f0]}],blur:[{blur:a0()}],brightness:[{brightness:[_0,z0,f0]}],contrast:[{contrast:[_0,z0,f0]}],"drop-shadow":[{"drop-shadow":["","none",u,MZ,AZ]}],"drop-shadow-color":[{"drop-shadow":b0()}],grayscale:[{grayscale:["",_0,z0,f0]}],"hue-rotate":[{"hue-rotate":[_0,z0,f0]}],invert:[{invert:["",_0,z0,f0]}],saturate:[{saturate:[_0,z0,f0]}],sepia:[{sepia:["",_0,z0,f0]}],"backdrop-filter":[{"backdrop-filter":["","none",z0,f0]}],"backdrop-blur":[{"backdrop-blur":a0()}],"backdrop-brightness":[{"backdrop-brightness":[_0,z0,f0]}],"backdrop-contrast":[{"backdrop-contrast":[_0,z0,f0]}],"backdrop-grayscale":[{"backdrop-grayscale":["",_0,z0,f0]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[_0,z0,f0]}],"backdrop-invert":[{"backdrop-invert":["",_0,z0,f0]}],"backdrop-opacity":[{"backdrop-opacity":[_0,z0,f0]}],"backdrop-saturate":[{"backdrop-saturate":[_0,z0,f0]}],"backdrop-sepia":[{"backdrop-sepia":["",_0,z0,f0]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":$1()}],"border-spacing-x":[{"border-spacing-x":$1()}],"border-spacing-y":[{"border-spacing-y":$1()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",z0,f0]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[_0,"initial",z0,f0]}],ease:[{ease:["linear","initial",f1,z0,f0]}],delay:[{delay:[_0,z0,f0]}],animate:[{animate:["none",Y1,z0,f0]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[P1,z0,f0]}],"perspective-origin":[{"perspective-origin":i1()}],rotate:[{rotate:M2()}],"rotate-x":[{"rotate-x":M2()}],"rotate-y":[{"rotate-y":M2()}],"rotate-z":[{"rotate-z":M2()}],scale:[{scale:h5()}],"scale-x":[{"scale-x":h5()}],"scale-y":[{"scale-y":h5()}],"scale-z":[{"scale-z":h5()}],"scale-3d":["scale-3d"],skew:[{skew:d2()}],"skew-x":[{"skew-x":d2()}],"skew-y":[{"skew-y":d2()}],transform:[{transform:[z0,f0,"","none","gpu","cpu"]}],"transform-origin":[{origin:i1()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:r0()}],"translate-x":[{"translate-x":r0()}],"translate-y":[{"translate-y":r0()}],"translate-z":[{"translate-z":r0()}],"translate-none":["translate-none"],accent:[{accent:b0()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:b0()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",z0,f0]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":$1()}],"scroll-mx":[{"scroll-mx":$1()}],"scroll-my":[{"scroll-my":$1()}],"scroll-ms":[{"scroll-ms":$1()}],"scroll-me":[{"scroll-me":$1()}],"scroll-mt":[{"scroll-mt":$1()}],"scroll-mr":[{"scroll-mr":$1()}],"scroll-mb":[{"scroll-mb":$1()}],"scroll-ml":[{"scroll-ml":$1()}],"scroll-p":[{"scroll-p":$1()}],"scroll-px":[{"scroll-px":$1()}],"scroll-py":[{"scroll-py":$1()}],"scroll-ps":[{"scroll-ps":$1()}],"scroll-pe":[{"scroll-pe":$1()}],"scroll-pt":[{"scroll-pt":$1()}],"scroll-pr":[{"scroll-pr":$1()}],"scroll-pb":[{"scroll-pb":$1()}],"scroll-pl":[{"scroll-pl":$1()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",z0,f0]}],fill:[{fill:["none",...b0()]}],"stroke-w":[{stroke:[_0,Zz,I9,QJ]}],stroke:[{stroke:["none",...b0()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}};var PX=oK(Hl);function C2(...g){return PX(BZ(g))}var p4=o5(Z3(),1),pX=o5(hJ(),1);class EX{baseUrl="tiles.openfreemap.org/styles";style={light:"liberty",dark:"positron"};getStyleSpec(g){return`https://${this.baseUrl}/${this.style[g]}`}}class uX{baseUrl="api.maptiler.com/maps";style={light:"bright-v2",dark:"019a3f9e-4c56-720c-a239-19d8197629e0"};apiKey;constructor(g){this.apiKey=g}getStyleSpec(g){return`https://${this.baseUrl}/${this.style[g]}/style.json?key=${this.apiKey}`}}var XZ=null;function Ul(){if(XZ)return XZ;let g="Gf0lzVDzJ6znr38YomDG";return XZ=g?new uX(g):new EX,XZ}var FJ=(g)=>{return Ul().getStyleSpec(g)};var cX=p4.createContext(null);function aX({children:g,...x}){let{mode:Y}=KX(),G=p4.useRef(null),[U,Z]=p4.useState(null);return p4.useEffect(()=>{if(!G.current)return;let l=new pX.Map({container:G.current,style:FJ(Y),center:[-96.00597,38.71427],zoom:4});return Z(l),()=>l.remove()},[]),p4.useEffect(()=>{U?.setStyle(FJ(Y))},[Y]),k1(cX.Provider,{value:U,children:S5("div",{...x,className:C2("h-full w-full",x.className),children:[k1("div",{ref:G,className:"w-full h-full"}),U&&g]})})}function Ib(){let g=p4.useContext(cX);if(!g)throw Error("useMap must be used within a MapProvider");return g}var D2=o5(Z3(),1);var Bl=o5(Z3(),1);function rX(g,x){if(typeof g==="function")return g(x);else if(g!==null&&g!==void 0)g.current=x}function oX(...g){return(x)=>{let Y=!1,G=g.map((U)=>{let Z=rX(U,x);if(!Y&&typeof Z=="function")Y=!0;return Z});if(Y)return()=>{for(let U=0;U<G.length;U++){let Z=G[U];if(typeof Z=="function")Z();else rX(g[U],null)}}}}function KJ(g){let x=Al(g),Y=D2.forwardRef((G,U)=>{let{children:Z,...l}=G,N=D2.Children.toArray(Z),P=N.find(Xl);if(P){let w1=P.props.children,H1=N.map((r)=>{if(r===P){if(D2.Children.count(w1)>1)return D2.Children.only(null);return D2.isValidElement(w1)?w1.props.children:null}else return r});return k1(x,{...l,ref:U,children:D2.isValidElement(w1)?D2.cloneElement(w1,void 0,H1):null})}return k1(x,{...l,ref:U,children:Z})});return Y.displayName=`${g}.Slot`,Y}var nX=KJ("Slot");function Al(g){let x=D2.forwardRef((Y,G)=>{let{children:U,...Z}=Y;if(D2.isValidElement(U)){let l=Vl(U),N=Ql(Z,U.props);if(U.type!==D2.Fragment)N.ref=G?oX(G,l):l;return D2.cloneElement(U,N)}return D2.Children.count(U)>1?D2.Children.only(null):null});return x.displayName=`${g}.SlotClone`,x}var Ml=Symbol("radix.slottable");function Xl(g){return D2.isValidElement(g)&&typeof g.type==="function"&&"__radixId"in g.type&&g.type.__radixId===Ml}function Ql(g,x){let Y={...x};for(let G in x){let U=g[G],Z=x[G];if(/^on[A-Z]/.test(G)){if(U&&Z)Y[G]=(...N)=>{let P=Z(...N);return U(...N),P};else if(U)Y[G]=U}else if(G==="style")Y[G]={...U,...Z};else if(G==="className")Y[G]=[U,Z].filter(Boolean).join(" ")}return{...g,...Y}}function Vl(g){let x=Object.getOwnPropertyDescriptor(g.props,"ref")?.get,Y=x&&"isReactWarning"in x&&x.isReactWarning;if(Y)return g.ref;if(x=Object.getOwnPropertyDescriptor(g,"ref")?.get,Y=x&&"isReactWarning"in x&&x.isReactWarning,Y)return g.props.ref;return g.props.ref||g.ref}var sX=(g)=>typeof g==="boolean"?`${g}`:g===0?"0":g,iX=BZ,QZ=(g,x)=>(Y)=>{var G;if((x===null||x===void 0?void 0:x.variants)==null)return iX(g,Y===null||Y===void 0?void 0:Y.class,Y===null||Y===void 0?void 0:Y.className);let{variants:U,defaultVariants:Z}=x,l=Object.keys(U).map((w1)=>{let H1=Y===null||Y===void 0?void 0:Y[w1],r=Z===null||Z===void 0?void 0:Z[w1];if(H1===null)return null;let z1=sX(H1)||sX(r);return U[w1][z1]}),N=Y&&Object.entries(Y).reduce((w1,H1)=>{let[r,z1]=H1;if(z1===void 0)return w1;return w1[r]=z1,w1},{}),P=x===null||x===void 0?void 0:(G=x.compoundVariants)===null||G===void 0?void 0:G.reduce((w1,H1)=>{let{class:r,className:z1,...u}=H1;return Object.entries(u).every((R1)=>{let[P1,s1]=R1;return Array.isArray(s1)?s1.includes({...Z,...N}[P1]):{...Z,...N}[P1]===s1})?[...w1,r,z1]:w1},[]);return iX(g,l,P,Y===null||Y===void 0?void 0:Y.class,Y===null||Y===void 0?void 0:Y.className)};var bQ=o5(Z3(),1);var tX=o5(Z3(),1),Ll=o5(Ex(),1);var Wl=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],eX=Wl.reduce((g,x)=>{let Y=KJ(`Primitive.${x}`),G=tX.forwardRef((U,Z)=>{let{asChild:l,...N}=U,P=l?Y:x;if(typeof window<"u")window[Symbol.for("radix-ui")]=!0;return k1(P,{...N,ref:Z})});return G.displayName=`Primitive.${x}`,{...g,[x]:G}},{});var hl="Separator",wQ="horizontal",Fl=["horizontal","vertical"],gQ=bQ.forwardRef((g,x)=>{let{decorative:Y,orientation:G=wQ,...U}=g,Z=Kl(G)?G:wQ,N=Y?{role:"none"}:{"aria-orientation":Z==="vertical"?Z:void 0,role:"separator"};return k1(eX.div,{"data-orientation":Z,...N,...U,ref:x})});gQ.displayName=hl;function Kl(g){return Fl.includes(g)}var fQ=gQ;function lJ({className:g,orientation:x="horizontal",decorative:Y=!0,...G}){return k1(fQ,{"data-slot":"separator",decorative:Y,orientation:x,className:C2("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",g),...G})}var Cl=QZ("flex w-fit items-stretch [&>*]:focus-visible:z-10 [&>*]:focus-visible:relative [&>[data-slot=select-trigger]:not([class*='w-'])]:w-fit [&>input]:flex-1 has-[select[aria-hidden=true]:last-child]:[&>[data-slot=select-trigger]:last-of-type]:rounded-r-md has-[>[data-slot=button-group]]:gap-2",{variants:{orientation:{horizontal:"[&>*:not(:first-child)]:rounded-l-none [&>*:not(:first-child)]:border-l-0 [&>*:not(:last-child)]:rounded-r-none",vertical:"flex-col [&>*:not(:first-child)]:rounded-t-none [&>*:not(:first-child)]:border-t-0 [&>*:not(:last-child)]:rounded-b-none"}},defaultVariants:{orientation:"horizontal"}});function zQ({className:g,orientation:x,...Y}){return k1("div",{role:"group","data-slot":"button-group","data-orientation":x,className:C2(Cl({orientation:x}),g),...Y})}var Dl=QZ("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function Yz({className:g,variant:x,size:Y,asChild:G=!1,...U}){return k1(G?nX:"button",{"data-slot":"button",className:C2(Dl({variant:x,size:Y,className:g})),...U})}function xQ(g){let x=Ib();return S5(zQ,{orientation:"vertical","aria-label":"Zoom controls",className:"h-fit",children:[k1(Yz,{...g,size:"icon",className:C2("rounded-2xl hover:rounded-lg",g.className),onClick:()=>x.zoomIn(),children:k1(qz,{})}),k1(lJ,{}),k1(Yz,{...g,size:"icon",className:C2("rounded-2xl hover:rounded-lg",g.className),onClick:()=>x.zoomIn(),children:k1(xz,{})})]})}function qQ({className:g,...x}){return k1(U7,{role:"status","aria-label":"Loading",className:C2("size-4 animate-spin",g),...x})}function ZQ({size:g=4,...x}){return S5("span",{...x,className:C2(`flex size-${g}`,x.className),children:[k1("span",{className:"absolute inline-flex h-full w-full animate-ping scale-150 rounded-full bg-primary opacity-75",style:{animation:"ping 1.3s ease-in-out infinite"}}),k1("span",{className:`relative inline-flex size-${g} rounded-full bg-primary shadow-lg shadow-primary-foreground/90 inset-ring-1 inset-ring-primary-foreground/20`})]})}function YQ(g){return g===1||g===2||g===3}var CJ={1:{title:"Permission Denied",body:"Location access was denied. Please enable permissions in your browser settings.",icon:zz},2:{title:"Position Unavailable",body:"Unable to determine your location. Please check your network or GPS.",icon:fz},3:{title:"Timeout",body:"The request for location took too long. Please try again.",icon:ef}};function kQ({errorCode:g}){let x=g?CJ[g]:{title:"Unknown error",body:"Something went wrong while trying to geolocate"};return S5("div",{className:"ml-2",children:[k1("h1",{className:"font-extrabold",children:x.title}),k1("h2",{children:x.body})]})}var vQ=(g)=>{if(YQ(g.code))return[k1(kQ,{errorCode:g.code}),CJ[g.code].icon];return[k1(kQ,{}),sf]};class JQ{data;constructor(g){this.data=g}}class DJ extends JQ{trigger="fly-to"}var GQ=o5(hJ(),1);var S9=o5(Z3(),1),HQ=o5(UJ(),1);function UQ(g){let x=Ib(),[Y,G]=S9.useState(!1),U=S9.useRef(null),Z=S9.useRef(null),l=()=>{U.current?.remove(),Z.current?.unmount(),Z.current=null;let r=document.createElement("div"),z1=HQ.createRoot(r);z1.render(k1(ZQ,{})),Z.current=z1;let u=new GQ.Marker({element:r});return U.current=u,u},N=async(r)=>{let z1={lat:r.coords.latitude,lon:r.coords.longitude},u=U.current??l(),R1={center:z1,zoom:14};x.flyTo(R1,new DJ({...R1,marker:u}))},P=(r)=>{console.error(r),G(!1);let[z1,u]=vQ(r);QX.error(z1,{position:"top-center",richColors:!0,icon:k1(u,{})})},w1=()=>{G(!0),navigator.geolocation.getCurrentPosition(N,P,{enableHighAccuracy:!0})},H1=(r)=>{switch(r.trigger){case"fly-to":r.target.resetNorthPitch(),G(!1),r.data.marker?.setLngLat(r.data.center).addTo(r.target);break}};return S9.useEffect(()=>{return x.on("moveend",H1),()=>{x.off("moveend",H1)}},[x]),k1(Yz,{...g,className:C2("rounded-xl hover:rounded-lg",g.className),onClick:w1,children:Y?k1(qQ,{}):k1(gz,{})})}function BQ({width:g=100,height:x=100,...Y}){return S5("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",width:g,height:x,role:"img","aria-labelledby":"title desc",fill:"none",stroke:"currentColor",...Y,children:[k1("title",{id:"title",children:"360 degree protractor icon (scaled with extended ticks)"}),k1("desc",{id:"desc",children:"Circular protractor."}),k1("circle",{cx:50,cy:50,r:49,strokeWidth:2}),k1("circle",{cx:50,cy:50,r:25,strokeWidth:0.8,opacity:0.6}),S5("g",{strokeLinecap:"round",children:[k1("line",{x1:50,y1:1,x2:50,y2:19,strokeWidth:2}),k1("line",{x1:50,y1:99,x2:50,y2:81,strokeWidth:2}),k1("line",{x1:1,y1:50,x2:19,y2:50,strokeWidth:2}),k1("line",{x1:99,y1:50,x2:81,y2:50,strokeWidth:2})]}),S5("g",{strokeLinecap:"round",strokeWidth:1.4,children:[k1("g",{transform:"rotate(45 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:15})}),k1("g",{transform:"rotate(135 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:15})}),k1("g",{transform:"rotate(225 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:15})}),k1("g",{transform:"rotate(315 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:15})})]}),S5("g",{strokeLinecap:"round",strokeWidth:1.2,children:[k1("g",{transform:"rotate(15 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})}),k1("g",{transform:"rotate(30 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})}),k1("g",{transform:"rotate(60 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})}),k1("g",{transform:"rotate(75 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})}),k1("g",{transform:"rotate(105 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})}),k1("g",{transform:"rotate(120 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})}),k1("g",{transform:"rotate(150 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})}),k1("g",{transform:"rotate(165 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})}),k1("g",{transform:"rotate(195 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})}),k1("g",{transform:"rotate(210 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})}),k1("g",{transform:"rotate(240 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})}),k1("g",{transform:"rotate(255 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})}),k1("g",{transform:"rotate(285 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})}),k1("g",{transform:"rotate(300 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})}),k1("g",{transform:"rotate(330 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})}),k1("g",{transform:"rotate(345 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:11})})]}),S5("g",{strokeLinecap:"round",strokeWidth:0.8,children:[k1("g",{transform:"rotate(5 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(10 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(20 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(25 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(35 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(40 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(50 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(55 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(65 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(70 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(80 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(85 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(95 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(100 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(110 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(115 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(125 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(130 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(140 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(145 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(155 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(160 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(170 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(175 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(185 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(190 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(200 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(205 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(215 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(220 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(230 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(235 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(245 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(250 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(260 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(265 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(275 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(280 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(290 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(295 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(305 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(310 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(320 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(325 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(335 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(340 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(350 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})}),k1("g",{transform:"rotate(355 50 50)",children:k1("line",{x1:50,y1:1,x2:50,y2:7})})]})]})}function AQ({bearing:g,direction:x,...Y}){return S5("div",{...Y,className:C2("compass-button-group flex items-center justify-center cursor-pointer",Y.className),children:[k1("div",{className:"absolute",style:{transform:`rotate(${-g}deg)`},children:k1(BQ,{className:"w-full h-full"})}),k1("div",{className:"flex w-full h-full",children:k1(wz,{strokeWidth:1,className:"w-20"})})]})}var dJ=["N","NE","E","SE","S","SW","W","NW"],OJ=(g)=>{let x=(g+360)%360,Y=Math.floor(x/360*dJ.length+0.5)%dJ.length;return dJ[Y]};var h4=o5(Z3(),1);function MQ(g){let x=Ib(),[Y,G]=h4.useState("compass"),[U,Z]=h4.useState(()=>({pitch:x.getPitch(),bearing:x.getBearing()})),l=OJ(x.getBearing()),[N,P]=h4.useState(l),w1=h4.useRef(l),H1=h4.useCallback((R1)=>{if(Y==="direction"){let P1=OJ(R1);if(P1!==w1.current)w1.current=P1,P(P1)}},[Y]),r=h4.useCallback((R1)=>{let P1=R1.target.getBearing();Z({bearing:P1,pitch:R1.target.getPitch()}),H1(P1)},[H1]),z1=(R1)=>{R1.preventDefault(),G((P1)=>P1==="compass"?"direction":"compass")};h4.useEffect(()=>{H1(U.bearing)},[Y]),h4.useEffect(()=>{return x.on("move",r),()=>{x.off("move",r)}},[x,r]);let u=Y==="compass"?k1(AQ,{bearing:U.bearing,direction:N}):k1("div",{className:`font-compass font-extrabold text-4xl ${N==="N"?"text-red-500":""}`,children:N});return k1("div",{className:`
      absolute bottom-15 right-9
      ${U.bearing!==0?"opacity-100 scale-100":"opacity-0 scale-90 pointer-events-none"}
      ${Y==="compass"?"bg-primary/15":"bg-primary/30"}
      text-primary rounded-full cursor-pointer
      transition-all duration-300 ease-in-out
    `,onClick:()=>x.resetNorthPitch(),onContextMenu:z1,children:S5("div",{className:"size-24 flex items-center justify-center",children:[u,k1("div",{className:"absolute inset-0 transition-transform duration-300 ease-out",style:{transform:`rotate(${-U.bearing}deg)`},children:k1(tf,{className:"absolute top-0 left-1/2 -translate-x-1/2 -translate-y-[75%] text-red-500",strokeWidth:3})})]})})}function XQ(){return S5(UZ,{children:[S5("div",{className:"absolute top-5 right-5 flex flex-col gap-3",children:[k1(xQ,{className:"size-10"}),k1(UQ,{})]}),k1(MQ,{})]})}function QQ(){return k1(aX,{children:k1(XQ,{})})}function VQ(){return k1(MJ,{children:k1(QQ,{})})}var dl=document.getElementById("root"),Ol=k1(LQ.StrictMode,{children:k1(VQ,{})});WQ.createRoot(dl).render(Ol);

//# debugId=57CF748955CEA87164756E2164756E21
//# sourceMappingURL=chunk-g17n8e5t.js.map
